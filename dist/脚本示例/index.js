import*as e from'https://testingcf.jsdelivr.net/npm/klona/+esm';import{createPinia as t,defineStore as a,storeToRefs as n}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';import{default as o}from'https://testingcf.jsdelivr.net/npm/dedent/+esm';var r={67:()=>{$(()=>{replaceScriptButtons([{name:'æ™šä¸Šå¥½',visible:!0}]),eventOn(getButtonEvent('æ™šä¸Šå¥½'),()=>{toastr.warning('æ™šå®‰, ç»œç»œ')})})},280:(e,t,a)=>{var n=a(1138);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('1ec9380e',n,!1,{ssrId:!0})},390:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.progress-bar-container[data-v-be0274c0]{display:flex;flex-direction:row;align-items:center;gap:12px;width:100%}.progress-bar-label[data-v-be0274c0]{font-size:12px;color:#888;letter-spacing:.5px;font-weight:500;min-width:100px;flex-shrink:0}.progress-bar-wrapper[data-v-be0274c0]{position:relative;height:20px;background:#333;border-radius:10px;border:1px solid #555;overflow:hidden;display:flex;align-items:center;padding:0 8px;flex:1}.progress-bar-fill[data-v-be0274c0]{position:absolute;left:0;top:0;height:100%;border-radius:10px;transition:width .3s ease;z-index:1}.progress-bar-value[data-v-be0274c0]{position:relative;z-index:2;font-size:13px;font-weight:700;color:#fff;white-space:nowrap;text-shadow:0 0 2px #000,0 0 4px rgba(0,0,0,.9),0 0 8px rgba(0,0,0,.7),0 1px 2px rgba(0,0,0,.8);-webkit-text-stroke:.5px rgba(0,0,0,.5)}','']);const i=l},391:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.location-tabs-container[data-v-890af5d4]{color:#e0e0e0;max-width:1000px;margin:0 auto;padding:16px}.location-tabs-container h3[data-v-890af5d4]{color:#007acc;margin-bottom:24px;font-size:20px}.location-fold-bar[data-v-890af5d4]{margin-bottom:16px}.location-fold-bar[data-v-890af5d4] .fold-bar-btn{background:linear-gradient(135deg,#2a2a2a 0%,#333333 100%);border:1px solid #555;box-shadow:0 2px 8px rgba(0,0,0,.3);padding:12px 16px;font-size:16px;font-weight:600;color:#e0e0e0;transition:all .3s ease}.location-fold-bar[data-v-890af5d4] .fold-bar-btn:hover{background:linear-gradient(135deg,#333333 0%,#404040 100%);border-color:#666;box-shadow:0 4px 12px rgba(0,0,0,.4)}.location-fold-bar[data-v-890af5d4] .fold-bar-content{background:linear-gradient(135deg,#1a1a1a 0%,#222222 100%);border:1px solid #555;border-top:none;box-shadow:0 2px 8px rgba(0,0,0,.3)}.location-fold-bar[data-v-890af5d4] .fold-bar-content-text{padding:20px}.location-fold-bar[data-v-890af5d4] .fold-bar-footer-toggle{background:linear-gradient(135deg,#2a2a2a 0%,#333333 100%);border-top:1px solid #555;color:#b0b0b0;font-size:13px;font-weight:500;padding:12px 16px;transition:all .3s ease}.location-fold-bar[data-v-890af5d4] .fold-bar-footer-toggle:hover{background:linear-gradient(135deg,#333333 0%,#404040 100%);color:#e0e0e0;border-color:#666}.location-fold-bar[data-v-890af5d4] .fold-bar-toggle-icon{color:#007acc;font-size:14px;font-weight:bold}.location-fold-bar.location-incomplete[data-v-890af5d4] .fold-bar-btn span{color:#ff6b6b !important}.remove-location-btn[data-v-890af5d4]{background:#b91c1c;border:1px solid #b91c1c;border-radius:3px;color:#fff;font-size:16px;font-weight:bold;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer}.remove-location-btn span[data-v-890af5d4]{line-height:1;margin-top:-1px}.location-info-container .section[data-v-890af5d4]{margin-bottom:16px}.section[data-v-890af5d4]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.section h4[data-v-890af5d4]{color:#b0b0b0;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.form-grid[data-v-890af5d4]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.input-group.full-width[data-v-890af5d4]{grid-column:1/-1}.input-group label[data-v-890af5d4]{display:block;margin-bottom:8px;color:#b0b0b0;font-weight:500}.text-input[data-v-890af5d4]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.text-input[data-v-890af5d4]:focus{border-color:#007acc}.text-input[data-v-890af5d4]::placeholder{color:#666}.text-area[data-v-890af5d4]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;font-family:inherit;outline:none;resize:vertical;min-height:80px;transition:border-color .2s ease}.text-area[data-v-890af5d4]:focus{border-color:#007acc}.text-area[data-v-890af5d4]::placeholder{color:#666}.sub-locations-container[data-v-890af5d4]{display:flex;flex-direction:column;gap:8px}.sub-location-item[data-v-890af5d4]{display:flex;align-items:center;gap:8px}.sub-location-item .text-input[data-v-890af5d4]{flex:1}.sub-location-item .remove-sub-location-btn[data-v-890af5d4]{background:#b91c1c;border:1px solid #b91c1c;border-radius:3px;color:#fff;font-size:16px;font-weight:bold;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer}.sub-location-item .remove-sub-location-btn span[data-v-890af5d4]{line-height:1;margin-top:-1px}.add-sub-location-btn[data-v-890af5d4]{padding:8px 16px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:6px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .3s ease;align-self:flex-start}.add-sub-location-btn[data-v-890af5d4]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px)}.add-sub-location-btn span[data-v-890af5d4]{font-size:16px;font-weight:bold}.bulk-generate-section[data-v-890af5d4]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.bulk-generate-section h4[data-v-890af5d4]{color:#007acc;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.count-input-row[data-v-890af5d4]{display:flex;align-items:center;gap:16px;flex-wrap:wrap}.count-input[data-v-890af5d4]{flex:0 0 auto;width:120px}.ai-count-checkbox[data-v-890af5d4]{display:flex;align-items:center;gap:8px;margin-bottom:0}.ai-count-checkbox input[type=checkbox][data-v-890af5d4]{width:16px;height:16px;accent-color:#007acc;cursor:pointer}.ai-count-checkbox label[data-v-890af5d4]{color:#b0b0b0;font-size:14px;font-weight:500;cursor:pointer;margin-bottom:0;-webkit-user-select:none;user-select:none}.ai-count-checkbox label[data-v-890af5d4]:hover{color:#e0e0e0}.bulk-generate-btn[data-v-890af5d4]{padding:14px 32px;background-color:#28a745;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center;gap:8px;width:100%;margin-top:16px}.bulk-generate-btn[data-v-890af5d4]:hover:not(:disabled){background-color:#218838}.bulk-generate-btn[data-v-890af5d4]:disabled{background-color:#666;cursor:not-allowed}.add-location-section[data-v-890af5d4]{display:flex;justify-content:center;padding:20px 0;margin-top:20px;border-top:1px solid #404040}.add-location-btn[data-v-890af5d4]{padding:12px 24px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px}.add-location-btn[data-v-890af5d4]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 12px rgba(40,167,69,.3)}.add-location-btn span[data-v-890af5d4]{font-size:18px;font-weight:bold}@media (max-width:768px){.section[data-v-890af5d4]{padding:16px}.form-grid[data-v-890af5d4]{grid-template-columns:1fr}.input-group.full-width[data-v-890af5d4]{grid-column:1}.location-tabs-container[data-v-890af5d4]{max-width:100%;margin:0}.add-location-section[data-v-890af5d4]{padding:16px 0;margin-top:16px}.add-location-btn[data-v-890af5d4]{padding:10px 20px;font-size:14px}.add-location-btn span[data-v-890af5d4]{font-size:16px}.count-input-row[data-v-890af5d4]{flex-direction:column;align-items:flex-start;gap:12px}.count-input[data-v-890af5d4]{width:100%}.ai-count-checkbox[data-v-890af5d4]{font-size:13px}.remove-location-btn[data-v-890af5d4]{width:20px;height:20px;font-size:14px}[data-v-890af5d4] .fold-bar-content-text{padding:16px}.action-section[data-v-890af5d4]{flex-direction:row;align-items:stretch;gap:12px}.action-section .generate-btn[data-v-890af5d4],.action-section .apply-all-btn[data-v-890af5d4]{flex:1;width:auto;max-width:none}}.generated-result[data-v-890af5d4]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-890af5d4]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-890af5d4]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word}.generated-result .replace-btn[data-v-890af5d4]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-890af5d4]:hover{background-color:#218838}.action-section[data-v-890af5d4]{display:flex;justify-content:space-between;gap:16px;padding:20px 0}.action-section .generate-btn[data-v-890af5d4],.action-section .apply-all-btn[data-v-890af5d4]{flex:1;max-width:none}.generate-btn[data-v-890af5d4]{padding:14px 32px;background-color:#28a745;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center;gap:8px}.generate-btn[data-v-890af5d4]:hover:not(:disabled){background-color:#218838}.generate-btn[data-v-890af5d4]:disabled{background-color:#666;cursor:not-allowed}.loading-spinner[data-v-890af5d4]{width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-890af5d4 1s linear infinite}@keyframes spin-890af5d4{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.apply-all-btn[data-v-890af5d4]{padding:14px 32px;background-color:#007acc;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.apply-all-btn[data-v-890af5d4]:hover:not(:disabled){background-color:#0056b3}.apply-all-btn[data-v-890af5d4]:disabled{background-color:#666;cursor:not-allowed}','']);const i=l},751:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.confirm-dialog-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;z-index:9999}.confirm-dialog{background-color:#2a2a2a;border-radius:12px;border:1px solid #404040;min-width:300px;max-width:90vw;box-shadow:0 4px 20px rgba(0,0,0,.3)}.confirm-dialog-header{padding:20px 20px 0 20px}.confirm-dialog-header h3{margin:0;color:#e0e0e0;font-size:18px;font-weight:600}.confirm-dialog-body{padding:16px 20px}.confirm-dialog-body p{margin:0;color:#b0b0b0;line-height:1.5;font-size:14px}.confirm-dialog-footer{padding:0 20px 20px 20px;display:flex;gap:12px;justify-content:flex-end}.confirm-btn{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.confirm-btn.cancel-btn{background-color:#404040;color:#b0b0b0}.confirm-btn.cancel-btn:hover{background-color:#505050}.confirm-btn.confirm-action-btn{background-color:#007acc;color:#fff}.confirm-btn.confirm-action-btn:hover{background-color:#0056b3}.confirm-btn.confirm-action-btn:active{background-color:#004085}.confirm-btn.confirm-action-btn[data-confirm-text=åˆªé™¤]{background-color:#dc3545}.confirm-btn.confirm-action-btn[data-confirm-text=åˆªé™¤]:hover{background-color:#c82333}.confirm-btn.confirm-action-btn[data-confirm-text=åˆªé™¤]:active{background-color:#bd2130}','']);const i=l},1026:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.summary-tab-container[data-v-3de5c4ec]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.summary-content[data-v-3de5c4ec]{flex:1;padding:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--v70237b32);max-height:var(--v70237b32)}.summary-content[data-v-3de5c4ec]::-webkit-scrollbar{width:8px}.summary-content[data-v-3de5c4ec]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.summary-content[data-v-3de5c4ec]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.summary-content[data-v-3de5c4ec]::-webkit-scrollbar-thumb:hover{background:#666}.summary-section[data-v-3de5c4ec]{margin-bottom:16px}.summary-section[data-v-3de5c4ec]:last-child{margin-bottom:0}.section-title[data-v-3de5c4ec]{font-size:18px;font-weight:600;color:#007acc;margin:0 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.add-summary-button[data-v-3de5c4ec]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff;margin-top:12px;width:100%}.add-summary-button[data-v-3de5c4ec]:hover{background:#005a99}.summary-list[data-v-3de5c4ec]{display:flex;flex-direction:column;gap:8px}.summary-row[data-v-3de5c4ec]{background:#252525;padding:12px 16px;border-radius:8px;border:1px solid #404040;display:flex;flex-direction:column;gap:8px;font-size:14px;transition:background-color .2s}.summary-row[data-v-3de5c4ec]:hover{background:#2a2a2a;border-color:#555}.new-summary-row[data-v-3de5c4ec]{background:#2a2a2a;border-color:#007acc;border-style:dashed}.summary-first-row[data-v-3de5c4ec]{display:flex;justify-content:space-between;align-items:center;gap:12px}.summary-weighting-last-message-group[data-v-3de5c4ec]{display:flex;gap:12px;align-items:center}.summary-datetime-row[data-v-3de5c4ec]{margin-bottom:4px}.summary-datetime[data-v-3de5c4ec]{font-weight:500;color:#4caf50;font-size:14px;flex-shrink:0}.summary-weighting[data-v-3de5c4ec]{font-weight:500;color:#ff9800;font-size:13px}.summary-last-message-id[data-v-3de5c4ec]{font-weight:500;color:#bb86fc;font-size:13px}.summary-status[data-v-3de5c4ec]{font-weight:500;font-size:12px;padding:2px 6px;border-radius:4px;text-align:center;min-width:50px}.summary-status.status-used[data-v-3de5c4ec]{background-color:#4caf50;color:#fff}.summary-status.status-unused[data-v-3de5c4ec]{background-color:#ff9800;color:#fff}.summary-content-display[data-v-3de5c4ec]{color:#a0a0a0;line-height:1.4;font-size:13px}.summary-actions[data-v-3de5c4ec]{display:flex;gap:8px}.edit-summary-button[data-v-3de5c4ec],.delete-summary-button[data-v-3de5c4ec]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.edit-summary-button[data-v-3de5c4ec]{background:#007acc;color:#fff}.edit-summary-button[data-v-3de5c4ec]:hover{background:#005a99}.delete-summary-button[data-v-3de5c4ec]{background:#f44336;color:#fff}.delete-summary-button[data-v-3de5c4ec]:hover{background:#da190b}.no-summaries-message[data-v-3de5c4ec]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}.summary-edit-mode[data-v-3de5c4ec]{display:flex;flex-direction:column;gap:8px}.summary-edit-first-row[data-v-3de5c4ec]{display:flex;justify-content:space-between;align-items:center;gap:12px}.summary-weighting-last-message-input-group[data-v-3de5c4ec]{display:flex;gap:12px;align-items:center}.summary-weighting-input-group[data-v-3de5c4ec],.summary-last-message-id-input-group[data-v-3de5c4ec]{display:flex;gap:4px;align-items:center;font-size:13px;color:#a0a0a0}.summary-edit-actions[data-v-3de5c4ec]{display:flex;gap:8px;justify-content:flex-end}.summary-edit-datetime-row[data-v-3de5c4ec]{margin-bottom:4px}.summary-datetime-input-group[data-v-3de5c4ec]{display:flex;gap:4px;flex-shrink:0;font-weight:500;color:#4caf50;font-size:14px}.summary-datetime-input[data-v-3de5c4ec]{background:#333;border:1px solid #555;border-radius:4px;color:#4caf50;font-size:14px;padding:4px 8px;width:35px;-webkit-appearance:none;appearance:none;text-align:center}.summary-datetime-input[data-v-3de5c4ec]:focus{outline:none;border-color:#007acc}.summary-datetime-input[data-v-3de5c4ec]::-webkit-outer-spin-button,.summary-datetime-input[data-v-3de5c4ec]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.summary-datetime-input[type=number][data-v-3de5c4ec]{-webkit-appearance:textfield;appearance:textfield}.summary-datetime-year-input[data-v-3de5c4ec]{width:60px}.summary-weighting-input[data-v-3de5c4ec]{background:#333;border:1px solid #555;border-radius:4px;color:#ff9800;font-size:14px;padding:4px 8px;width:60px;-webkit-appearance:none;appearance:none;text-align:center}.summary-weighting-input[data-v-3de5c4ec]:focus{outline:none;border-color:#007acc}.summary-weighting-input[data-v-3de5c4ec]::-webkit-outer-spin-button,.summary-weighting-input[data-v-3de5c4ec]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.summary-weighting-input[type=number][data-v-3de5c4ec]{-webkit-appearance:textfield;appearance:textfield}.summary-last-message-id-input[data-v-3de5c4ec]{background:#333;border:1px solid #555;border-radius:4px;color:#9c27b0;font-size:14px;padding:4px 8px;width:40px;-webkit-appearance:none;appearance:none;text-align:center}.summary-last-message-id-input[data-v-3de5c4ec]:focus{outline:none;border-color:#007acc}.summary-last-message-id-input[data-v-3de5c4ec]::-webkit-outer-spin-button,.summary-last-message-id-input[data-v-3de5c4ec]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.summary-last-message-id-input[type=number][data-v-3de5c4ec]{-webkit-appearance:textfield;appearance:textfield}.summary-content-input[data-v-3de5c4ec]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:6px 8px;resize:vertical;min-height:60px;line-height:1.4;width:100%}.summary-content-input[data-v-3de5c4ec]:focus{outline:none;border-color:#007acc}.confirm-button[data-v-3de5c4ec],.cancel-button[data-v-3de5c4ec]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.confirm-button[data-v-3de5c4ec]{background:#4caf50;color:#fff}.confirm-button[data-v-3de5c4ec]:hover:not(:disabled){background:#45a049}.confirm-button[data-v-3de5c4ec]:disabled{background:#666;color:#ccc;cursor:not-allowed}.cancel-button[data-v-3de5c4ec]{background:#f44336;color:#fff}.cancel-button[data-v-3de5c4ec]:hover{background:#da190b}@media (max-width:768px){.summary-content[data-v-3de5c4ec]{padding:12px}.section-title[data-v-3de5c4ec]{font-size:18px}.summary-row[data-v-3de5c4ec]{padding:10px 12px;gap:6px}.summary-first-row[data-v-3de5c4ec]{gap:8px}.summary-weighting-last-message-group[data-v-3de5c4ec]{gap:8px}.summary-datetime-row[data-v-3de5c4ec]{margin-bottom:3px}.summary-content-display[data-v-3de5c4ec]{font-size:12px}.summary-actions[data-v-3de5c4ec]{gap:6px}.edit-summary-button[data-v-3de5c4ec],.delete-summary-button[data-v-3de5c4ec]{padding:5px 10px;font-size:11px}.summary-edit-first-row[data-v-3de5c4ec]{gap:8px}.summary-weighting-last-message-input-group[data-v-3de5c4ec]{gap:8px}.summary-edit-actions[data-v-3de5c4ec]{gap:6px}.summary-datetime-input[data-v-3de5c4ec]{font-size:13px;padding:3px 6px}.summary-datetime-year-input[data-v-3de5c4ec]{width:50px}.summary-weighting-input[data-v-3de5c4ec]{width:50px}.summary-last-message-id-input[data-v-3de5c4ec]{width:35px}.summary-content-input[data-v-3de5c4ec]{font-size:12px;padding:4px 6px;min-height:50px}.confirm-button[data-v-3de5c4ec],.cancel-button[data-v-3de5c4ec]{padding:5px 10px;font-size:11px}}','']);const i=l},1034:(e,t,a)=>{var n=a(3e3);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('18f9314a',n,!1,{ssrId:!0})},1138:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.user-profile-container[data-v-76149319]{padding:20px;color:#e0e0e0;max-width:1000px;margin:0 0;min-height:600px}.user-profile-container h3[data-v-76149319]{color:#007acc;margin-bottom:24px;font-size:20px}.user-profile-container h4[data-v-76149319]{color:#b0b0b0;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.section[data-v-76149319]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.form-grid[data-v-76149319]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.input-group.full-width[data-v-76149319]{grid-column:1/-1}.birthday-inputs[data-v-76149319]{display:flex;gap:8px}.birthday-inputs .birthday-input[data-v-76149319]{flex:1;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.birthday-inputs .birthday-input[data-v-76149319]:focus{border-color:#007acc}.birthday-inputs .birthday-input[data-v-76149319]::placeholder{color:#666}.text-input[data-v-76149319]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.text-input[data-v-76149319]:focus{border-color:#007acc}.text-input[data-v-76149319]::placeholder{color:#666}.display-text[data-v-76149319]{width:100%;padding:12px 16px;background-color:rgba(0,0,0,0);border:1px dashed #555;border-radius:8px;color:#888;font-size:14px;display:flex;align-items:center;font-style:italic}.text-area[data-v-76149319]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;font-family:inherit;outline:none;resize:vertical;min-height:80px;transition:border-color .2s ease}.text-area[data-v-76149319]:focus{border-color:#007acc}.text-area[data-v-76149319]::placeholder{color:#666}.input-group label[data-v-76149319]{display:block;margin-bottom:8px;color:#b0b0b0;font-weight:500}.generated-result[data-v-76149319]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-76149319]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-76149319]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word}.generated-result .replace-btn[data-v-76149319]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-76149319]:hover{background-color:#218838}.action-section[data-v-76149319]{display:flex;justify-content:center;gap:16px;padding:20px 0}.generate-btn[data-v-76149319]{padding:14px 32px;background-color:#28a745;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center;gap:8px}.generate-btn[data-v-76149319]:hover:not(:disabled){background-color:#218838}.generate-btn[data-v-76149319]:disabled{background-color:#666;cursor:not-allowed}.loading-spinner[data-v-76149319]{width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-76149319 1s linear infinite}@keyframes spin-76149319{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.apply-all-btn[data-v-76149319]{padding:14px 32px;background-color:#007acc;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.apply-all-btn[data-v-76149319]:hover:not(:disabled){background-color:#0056b3}.apply-all-btn[data-v-76149319]:disabled{background-color:#666;cursor:not-allowed}.relations-list[data-v-76149319]{display:flex;flex-direction:column;gap:8px}.relation-item[data-v-76149319]{display:flex;align-items:center;flex-wrap:wrap;gap:8px;padding:12px;background:linear-gradient(135deg,#1e1e1e 0%,#252525 100%);border:1px solid #555;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.2);transition:border-color .2s ease}.relation-item[data-v-76149319]:hover{border-color:#666}.relation-item .relation-target[data-v-76149319]{color:#4fc3f7;font-weight:600;font-size:14px;min-width:60px;padding:4px 8px;background-color:#2a2a2a;border-radius:4px;text-align:center;flex-shrink:0}.relation-item .relation-input[data-v-76149319]{flex:1;min-width:120px;padding:10px 14px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.relation-item .relation-input[data-v-76149319]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.relation-item .relation-input[data-v-76149319]::placeholder{color:#888}.relation-item .remove-relation-btn[data-v-76149319]{background:linear-gradient(135deg,#dc3545 0%,#c82333 100%);border:1px solid #dc3545;border-radius:6px;color:#fff;font-size:16px;font-weight:bold;width:24px;height:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(220,53,69,.3);flex-shrink:0}.relation-item .remove-relation-btn[data-v-76149319]:hover{background:linear-gradient(135deg,#c82333 0%,#a02622 100%);border-color:#bd2130;transform:translateY(-1px);box-shadow:0 4px 8px rgba(220,53,69,.4)}.relation-item .remove-relation-btn[data-v-76149319]:active{transform:translateY(0)}.add-relation[data-v-76149319]{display:flex;flex-wrap:wrap;gap:8px;align-items:center;padding:12px;background:linear-gradient(135deg,#252525 0%,#2a2a2a 100%);border:1px solid #555;border-radius:8px;margin-top:12px}.add-relation .relation-select[data-v-76149319]{flex:1;min-width:150px;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.add-relation .relation-select[data-v-76149319]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.add-relation .add-relation-btn[data-v-76149319]{padding:10px 16px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:6px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(40,167,69,.3);flex-shrink:0}.add-relation .add-relation-btn[data-v-76149319]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 8px rgba(40,167,69,.4)}.add-relation .add-relation-btn[data-v-76149319]:disabled{background-color:#666;border-color:#666;cursor:not-allowed;box-shadow:none;transform:none}.add-relation .add-relation-btn[data-v-76149319]:active{transform:translateY(0)}.inventory-list[data-v-76149319]{display:flex;flex-direction:column;gap:8px}.inventory-item[data-v-76149319]{display:flex;align-items:center;flex-wrap:wrap;gap:8px;padding:12px;background:linear-gradient(135deg,#1e1e1e 0%,#252525 100%);border:1px solid #555;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.2);transition:border-color .2s ease}.inventory-item[data-v-76149319]:hover{border-color:#666}.inventory-item .inventory-target[data-v-76149319]{color:#4fc3f7;font-weight:600;font-size:14px;min-width:60px;padding:4px 8px;background-color:#2a2a2a;border-radius:4px;text-align:center;flex-shrink:0}.inventory-item .inventory-input[data-v-76149319]{flex:1;min-width:80px;padding:10px 14px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.inventory-item .inventory-input[data-v-76149319]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.inventory-item .inventory-input[data-v-76149319]::placeholder{color:#888}.inventory-item .remove-inventory-btn[data-v-76149319]{background:linear-gradient(135deg,#dc3545 0%,#c82333 100%);border:1px solid #dc3545;border-radius:6px;color:#fff;font-size:16px;font-weight:bold;width:24px;height:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(220,53,69,.3);flex-shrink:0}.inventory-item .remove-inventory-btn[data-v-76149319]:hover{background:linear-gradient(135deg,#c82333 0%,#a02622 100%);border-color:#bd2130;transform:translateY(-1px);box-shadow:0 4px 8px rgba(220,53,69,.4)}.inventory-item .remove-inventory-btn[data-v-76149319]:active{transform:translateY(0)}.add-inventory[data-v-76149319]{display:flex;flex-wrap:wrap;gap:8px;align-items:center;padding:12px;background:linear-gradient(135deg,#252525 0%,#2a2a2a 100%);border:1px solid #555;border-radius:8px;margin-top:12px}.add-inventory .inventory-select[data-v-76149319]{flex:1;min-width:150px;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.add-inventory .inventory-select[data-v-76149319]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.add-inventory .quantity-input[data-v-76149319]{padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease;width:80px;flex:1;min-width:80px}.add-inventory .quantity-input[data-v-76149319]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.add-inventory .quantity-input[data-v-76149319]::placeholder{color:#888}.add-inventory .quantity-input[data-v-76149319]:disabled{background-color:#333;color:#666;cursor:not-allowed}.add-inventory .add-inventory-btn[data-v-76149319]{padding:10px 16px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:6px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(40,167,69,.3);flex-shrink:0}.add-inventory .add-inventory-btn[data-v-76149319]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 8px rgba(40,167,69,.4)}.add-inventory .add-inventory-btn[data-v-76149319]:disabled{background-color:#666;border-color:#666;cursor:not-allowed;box-shadow:none;transform:none}.add-inventory .add-inventory-btn[data-v-76149319]:active{transform:translateY(0)}@media (max-width:768px){.user-profile-container[data-v-76149319]{padding:16px}.section[data-v-76149319]{padding:16px}.form-grid[data-v-76149319]{grid-template-columns:1fr}.birthday-inputs[data-v-76149319]{flex-direction:column}}','']);const i=l},1332:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.main-interface-container[data-v-9fb68f82]{display:flex;flex-direction:column;width:100%;height:100%;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.main-content[data-v-9fb68f82]{flex:1;display:flex;flex-direction:column}.conversation-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.user-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.character-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.item-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.storage-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.location-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.promise-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.summary-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.world-info-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.settings-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.tab-navigation[data-v-9fb68f82]{display:flex;flex-direction:column;background-color:#2a2a2a;border-bottom:1px solid #404040;flex-shrink:0}.tab-navigation.top[data-v-9fb68f82]{border-top:none}.time-row[data-v-9fb68f82]{display:flex;padding:4px 12px;background-color:rgba(0,0,0,.3);border-bottom:1px solid #404040;align-items:center}.current-time[data-v-9fb68f82]{font-size:14px;font-weight:600;color:#fff;font-family:"Courier New",monospace}.tab-row[data-v-9fb68f82]{display:flex;border-bottom:1px solid #404040}.tab-row[data-v-9fb68f82]:last-child{border-bottom:none}.tab-button[data-v-9fb68f82]{flex:1;padding:10px;background:none;border:none;border-right:1px solid #404040;color:#b0b0b0;font-size:16px;cursor:pointer;transition:all .2s ease}.tab-button.active[data-v-9fb68f82]{color:#007acc;background-color:#3a3a3a}.tab-button[data-v-9fb68f82]:hover{background-color:#3a3a3a}.tab-button[data-v-9fb68f82]:last-child{border-right:none}@media (max-width:768px){.tab-button[data-v-9fb68f82]{padding:8px;font-size:14px}}.slide-right-enter-active[data-v-9fb68f82],.slide-right-leave-active[data-v-9fb68f82]{transition:all .2s cubic-bezier(0.25,0.46,0.45,0.94)}.slide-right-enter-from[data-v-9fb68f82]{opacity:0;transform:translateX(-50px)}.slide-right-leave-to[data-v-9fb68f82]{opacity:0;transform:translateX(50px)}.slide-left-enter-active[data-v-9fb68f82],.slide-left-leave-active[data-v-9fb68f82]{transition:all .2s cubic-bezier(0.25,0.46,0.45,0.94)}.slide-left-enter-from[data-v-9fb68f82]{opacity:0;transform:translateX(50px)}.slide-left-leave-to[data-v-9fb68f82]{opacity:0;transform:translateX(-50px)}.no-transition-enter-active[data-v-9fb68f82],.no-transition-leave-active[data-v-9fb68f82]{transition:none}.no-transition-enter-from[data-v-9fb68f82],.no-transition-leave-to[data-v-9fb68f82]{opacity:1;transform:none}','']);const i=l},1391:()=>{$(()=>{toastr.success('ä½ å·²ç»æˆåŠŸåŠ è½½ç¤ºä¾‹è„šæœ¬!','æ­å–œä½ !')}),$(window).on('pagehide',()=>{toastr.info('ä½ å·²ç»å¸è½½ç¤ºä¾‹è„šæœ¬!','å†è§!')})},1500:(e,t,a)=>{var n=a(5654);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('fe738eb0',n,!1,{ssrId:!0})},1592:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.item-tabs-container[data-v-d8256cea]{color:#e0e0e0;max-width:1000px;margin:0 auto;padding:16px}.item-tabs-container h3[data-v-d8256cea]{color:#007acc;margin-bottom:24px;font-size:20px}.item-fold-bar[data-v-d8256cea]{margin-bottom:16px}.item-fold-bar[data-v-d8256cea] .fold-bar-btn{background:linear-gradient(135deg,#2a2a2a 0%,#333333 100%);border:1px solid #555;box-shadow:0 2px 8px rgba(0,0,0,.3);padding:12px 16px;font-size:16px;font-weight:600;color:#e0e0e0;transition:all .3s ease}.item-fold-bar[data-v-d8256cea] .fold-bar-btn:hover{background:linear-gradient(135deg,#333333 0%,#404040 100%);border-color:#666;box-shadow:0 4px 12px rgba(0,0,0,.4)}.item-fold-bar[data-v-d8256cea] .fold-bar-content{background:linear-gradient(135deg,#1a1a1a 0%,#222222 100%);border:1px solid #555;border-top:none;box-shadow:0 2px 8px rgba(0,0,0,.3)}.item-fold-bar[data-v-d8256cea] .fold-bar-content-text{padding:20px}.item-fold-bar[data-v-d8256cea] .fold-bar-footer-toggle{background:linear-gradient(135deg,#2a2a2a 0%,#333333 100%);border-top:1px solid #555;color:#b0b0b0;font-size:13px;font-weight:500;padding:12px 16px;transition:all .3s ease}.item-fold-bar[data-v-d8256cea] .fold-bar-footer-toggle:hover{background:linear-gradient(135deg,#333333 0%,#404040 100%);color:#e0e0e0;border-color:#666}.item-fold-bar[data-v-d8256cea] .fold-bar-toggle-icon{color:#007acc;font-size:14px;font-weight:bold}.item-fold-bar.item-incomplete[data-v-d8256cea] .fold-bar-btn span{color:#ff6b6b !important}.remove-item-btn[data-v-d8256cea]{background:#b91c1c;border:1px solid #b91c1c;border-radius:3px;color:#fff;font-size:16px;font-weight:bold;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer}.remove-item-btn span[data-v-d8256cea]{line-height:1;margin-top:-1px}.item-info-container .section[data-v-d8256cea]{margin-bottom:16px}.section[data-v-d8256cea]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.section h4[data-v-d8256cea]{color:#b0b0b0;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.form-grid[data-v-d8256cea]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.input-group.full-width[data-v-d8256cea]{grid-column:1/-1}.input-group label[data-v-d8256cea]{display:block;margin-bottom:8px;color:#b0b0b0;font-weight:500}.text-input[data-v-d8256cea]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.text-input[data-v-d8256cea]:focus{border-color:#007acc}.text-input[data-v-d8256cea]::placeholder{color:#666}.text-area[data-v-d8256cea]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;font-family:inherit;outline:none;resize:vertical;min-height:80px;transition:border-color .2s ease}.text-area[data-v-d8256cea]:focus{border-color:#007acc}.text-area[data-v-d8256cea]::placeholder{color:#666}.add-item-section[data-v-d8256cea]{display:flex;justify-content:center;padding:20px 0;margin-top:20px;border-top:1px solid #404040}.add-item-btn[data-v-d8256cea]{padding:12px 24px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px}.add-item-btn[data-v-d8256cea]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 12px rgba(40,167,69,.3)}.add-item-btn span[data-v-d8256cea]{font-size:18px;font-weight:bold}@media (max-width:768px){.section[data-v-d8256cea]{padding:16px}.form-grid[data-v-d8256cea]{grid-template-columns:1fr}.input-group.full-width[data-v-d8256cea]{grid-column:1}.item-tabs-container[data-v-d8256cea]{max-width:100%;margin:0}.add-item-section[data-v-d8256cea]{padding:16px 0;margin-top:16px}.add-item-btn[data-v-d8256cea]{padding:10px 20px;font-size:14px}.add-item-btn span[data-v-d8256cea]{font-size:16px}.remove-item-btn[data-v-d8256cea]{width:20px;height:20px;font-size:14px}[data-v-d8256cea] .fold-bar-content-text{padding:16px}.action-section[data-v-d8256cea]{flex-direction:row;align-items:stretch;gap:12px}.action-section .generate-btn[data-v-d8256cea],.action-section .apply-all-btn[data-v-d8256cea]{flex:1;width:auto;max-width:none}}.generated-result[data-v-d8256cea]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-d8256cea]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-d8256cea]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word}.generated-result .replace-btn[data-v-d8256cea]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-d8256cea]:hover{background-color:#218838}.action-section[data-v-d8256cea]{display:flex;justify-content:space-between;gap:16px;padding:20px 0}.action-section .generate-btn[data-v-d8256cea],.action-section .apply-all-btn[data-v-d8256cea]{flex:1;max-width:none}.generate-btn[data-v-d8256cea]{padding:14px 32px;background-color:#28a745;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center;gap:8px}.generate-btn[data-v-d8256cea]:hover:not(:disabled){background-color:#218838}.generate-btn[data-v-d8256cea]:disabled{background-color:#666;cursor:not-allowed}.loading-spinner[data-v-d8256cea]{width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-d8256cea 1s linear infinite}@keyframes spin-d8256cea{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.apply-all-btn[data-v-d8256cea]{padding:14px 32px;background-color:#007acc;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.apply-all-btn[data-v-d8256cea]:hover:not(:disabled){background-color:#0056b3}.apply-all-btn[data-v-d8256cea]:disabled{background-color:#666;cursor:not-allowed}','']);const i=l},1634:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.world-background-container[data-v-6467ee74]{padding:20px;color:#e0e0e0;max-width:800px;margin:0 0;min-height:600px}.world-background-container h3[data-v-6467ee74]{color:#007acc;margin-bottom:24px;font-size:20px}.input-group[data-v-6467ee74]{margin-bottom:20px}.input-group label[data-v-6467ee74]{display:block;margin-bottom:8px;color:#b0b0b0;font-weight:500}.text-input[data-v-6467ee74]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.text-input[data-v-6467ee74]:focus{border-color:#007acc}.text-input[data-v-6467ee74]::placeholder{color:#666}.text-area[data-v-6467ee74]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;font-family:inherit;outline:none;resize:vertical;min-height:80px;transition:border-color .2s ease}.text-area[data-v-6467ee74]:focus{border-color:#007acc}.text-area[data-v-6467ee74]::placeholder{color:#666}.generate-btn[data-v-6467ee74]{width:100%;padding:14px;background-color:#007acc;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;margin-bottom:24px;display:flex;align-items:center;justify-content:center;gap:8px}.generate-btn[data-v-6467ee74]:hover:not(:disabled){background-color:#0056b3}.generate-btn[data-v-6467ee74]:disabled{background-color:#666;cursor:not-allowed}.loading-spinner[data-v-6467ee74]{width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-6467ee74 1s linear infinite}@keyframes spin-6467ee74{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.info-section[data-v-6467ee74]{background-color:#2a2a2a;padding:24px;border-radius:12px;border:1px solid #404040}.replace-btn[data-v-6467ee74]{width:100%;padding:14px;background-color:#28a745;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.replace-btn[data-v-6467ee74]:hover:not(:disabled){background-color:#218838}.replace-btn[data-v-6467ee74]:disabled{background-color:#666;cursor:not-allowed}@media (max-width:768px){.world-background-container[data-v-6467ee74]{padding:16px}.info-section[data-v-6467ee74]{padding:20px}.text-input[data-v-6467ee74],.text-area[data-v-6467ee74]{font-size:16px}}','']);const i=l},1937:(e,t,a)=>{var n=a(3263);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('c90d1576',n,!1,{ssrId:!0})},2076:()=>{eventOn(tavern_events.MESSAGE_UPDATED,e=>{toastr.error(`è°è®©ä½ åŠ¨æˆ‘ç¬¬ ${e} æ¥¼æ¶ˆæ¯çš„ðŸ˜¡`,'å¹²ä»€ä¹ˆ!')})},2270:(e,t,a)=>{var n=a(1592);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('de53ba7c',n,!1,{ssrId:!0})},2813:(e,t,a)=>{var n=a(391);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('fd8d3c16',n,!1,{ssrId:!0})},2959:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.settings-container[data-v-d8917884]{display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;overflow:hidden;min-height:var(--v50c01ddd);max-height:var(--v50c01ddd)}.settings-header[data-v-d8917884]{padding:20px 16px 16px 16px;border-bottom:1px solid #404040}.settings-header h2[data-v-d8917884]{margin:0;font-size:24px;font-weight:600;color:#e0e0e0}.settings-list[data-v-d8917884]{flex:1;overflow-y:auto;padding:8px 0}.setting-item[data-v-d8917884]{display:flex;align-items:center;justify-content:space-between;padding:16px;border-bottom:1px solid #2a2a2a;transition:background-color .2s ease}.setting-item[data-v-d8917884]:hover{background-color:hsla(0,0%,100%,.02)}.setting-item[data-v-d8917884]:last-child{border-bottom:none}.setting-item.version-item[data-v-d8917884]{border-bottom:1px solid #2a2a2a}.setting-item.xml-rules-item[data-v-d8917884]{border-bottom:none;padding-bottom:8px}.setting-label[data-v-d8917884]{flex:1;display:flex;flex-direction:column;gap:4px}.setting-title[data-v-d8917884]{font-size:16px;font-weight:500;color:#e0e0e0}.setting-description[data-v-d8917884]{font-size:14px;color:#888;line-height:1.4}.setting-control[data-v-d8917884]{display:flex;align-items:center;margin-left:16px}.switch[data-v-d8917884]{position:relative;display:inline-block;width:50px;height:24px}.switch input[data-v-d8917884]{opacity:0;width:0;height:0}.slider[data-v-d8917884]{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#404040;transition:.3s;border-radius:24px}.slider[data-v-d8917884]:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;transition:.3s;border-radius:50%}input:checked+.slider[data-v-d8917884]{background-color:#007acc}input:checked+.slider[data-v-d8917884]:before{transform:translateX(26px)}.number-input[data-v-d8917884]{width:80px;padding:8px 12px;background-color:#2a2a2a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;text-align:center;outline:none;transition:border-color .2s ease}.number-input[data-v-d8917884]:focus{border-color:#007acc}.number-input[data-v-d8917884]::placeholder{color:#888}.number-input[data-v-d8917884]::-webkit-outer-spin-button,.number-input[data-v-d8917884]::-webkit-inner-spin-button{-webkit-appearance:none;appearance:none;margin:0}.number-input[type=number][data-v-d8917884]{-webkit-appearance:textfield;appearance:textfield}.setting-section-header[data-v-d8917884]{padding:16px 16px 8px 16px;display:flex;align-items:center;gap:12px}.setting-section-header h3[data-v-d8917884]{margin:0;font-size:18px;font-weight:600;color:#e0e0e0}.setting-section-header .section-description[data-v-d8917884]{font-size:14px;color:#888;line-height:1.4}.folding-rules-fullwidth[data-v-d8917884]{margin-top:8px;padding:0 16px}.folding-rules-container[data-v-d8917884]{width:100%;border:1px solid #404040;border-radius:8px;overflow:hidden}.rules-header[data-v-d8917884]{display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr auto;gap:12px;padding:12px 16px;background-color:#2a2a2a;border-bottom:1px solid #404040;font-size:12px;font-weight:500;color:#b0b0b0;text-transform:uppercase;letter-spacing:.5px}.header-cell[data-v-d8917884]{text-align:center;padding:4px 0}.folding-rule-row[data-v-d8917884]{display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr auto;gap:12px;padding:12px 16px;background-color:#1a1a1a;border-bottom:1px solid #2a2a2a;align-items:center}.folding-rule-row[data-v-d8917884]:last-child{border-bottom:none}.folding-rule-row[data-v-d8917884]:hover{background-color:#202020}.rule-cell[data-v-d8917884]{display:flex;align-items:center;justify-content:center;min-height:32px}.field-label[data-v-d8917884]{font-size:12px;font-weight:500;color:#b0b0b0;text-transform:uppercase;letter-spacing:.5px}.text-input[data-v-d8917884]{padding:6px 8px;background-color:#2a2a2a;border:1px solid #404040;border-radius:4px;color:#e0e0e0;font-size:13px;outline:none;transition:border-color .2s ease;width:100%;min-width:80px}.text-input[data-v-d8917884]:focus{border-color:#007acc}.text-input[data-v-d8917884]::placeholder{color:#666}.text-input.compact[data-v-d8917884]{padding:4px 6px;font-size:12px;min-width:60px}.select-input[data-v-d8917884]{padding:6px 8px;background-color:#2a2a2a;border:1px solid #404040;border-radius:4px;color:#e0e0e0;font-size:13px;outline:none;cursor:pointer;transition:border-color .2s ease;width:100%;min-width:80px}.select-input[data-v-d8917884]:focus{border-color:#007acc}.select-input.compact[data-v-d8917884]{padding:4px 6px;font-size:12px;min-width:60px}.radio-group[data-v-d8917884]{display:flex;flex-direction:column;gap:4px;width:100%}.radio-group.compact[data-v-d8917884]{gap:2px}.radio-option[data-v-d8917884]{display:flex;align-items:center;gap:4px;cursor:pointer;padding:2px 4px;border-radius:3px;transition:background-color .2s ease;justify-content:center}.radio-option[data-v-d8917884]:hover{background-color:hsla(0,0%,100%,.05)}.radio-option.compact[data-v-d8917884]{padding:1px 2px;gap:2px}.radio-option input[type=radio][data-v-d8917884]{margin:0;width:14px;height:14px;accent-color:#007acc;cursor:pointer}.radio-option .radio-label[data-v-d8917884]{font-size:11px;color:#b0b0b0;-webkit-user-select:none;user-select:none;white-space:nowrap}.delete-rule-btn[data-v-d8917884]{padding:6px 10px;background-color:#dc3545;border:none;border-radius:4px;color:#fff;font-size:11px;font-weight:500;cursor:pointer;transition:background-color .2s ease;white-space:nowrap;min-width:50px}.delete-rule-btn[data-v-d8917884]:hover{background-color:#c82333}.delete-rule-btn.compact[data-v-d8917884]{padding:4px 8px;font-size:10px;min-width:40px}.add-rule-row[data-v-d8917884]{display:flex;justify-content:center;padding:12px 0}.add-rule-btn[data-v-d8917884]{padding:10px 20px;background-color:#007acc;border:none;border-radius:8px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.add-rule-btn[data-v-d8917884]:hover{background-color:#0056b3}@media (max-width:768px){.settings-header[data-v-d8917884]{padding:16px 12px 12px 12px}.settings-header h2[data-v-d8917884]{font-size:20px}.setting-item[data-v-d8917884]{padding:12px}.setting-title[data-v-d8917884]{font-size:15px}.setting-description[data-v-d8917884]{font-size:13px}.number-input[data-v-d8917884]{width:70px;padding:6px 10px;font-size:13px}.rules-header[data-v-d8917884]{font-size:10px;padding:8px 12px}.folding-rule-row[data-v-d8917884]{padding:8px 12px;gap:6px}.rule-cell[data-v-d8917884]{min-height:28px}.text-input.compact[data-v-d8917884],.select-input.compact[data-v-d8917884]{font-size:11px;padding:3px 4px;min-width:45px}.radio-option.compact .radio-label[data-v-d8917884]{font-size:10px}.delete-rule-btn.compact[data-v-d8917884]{padding:3px 6px;font-size:9px;min-width:35px}}.version-number[data-v-d8917884]{font-size:16px;font-weight:600;color:#007acc;padding:6px 12px;min-width:80px;text-align:center;-webkit-user-select:text;user-select:text}','']);const i=l},3e3:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.initializations-container[data-v-252c6a8b]{display:flex;flex-direction:column;width:100%;height:100%;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.main-content[data-v-252c6a8b]{flex:1;display:flex;flex-direction:column;overflow:hidden}.initialization-area[data-v-252c6a8b]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a;overflow-y:auto}.tab-navigation[data-v-252c6a8b]{display:flex;background-color:#2a2a2a;border-bottom:1px solid #404040;flex-shrink:0}.tab-navigation.top[data-v-252c6a8b]{border-top:none}.tab-navigation.first-row[data-v-252c6a8b]{border-bottom:none}.tab-navigation.second-row[data-v-252c6a8b]{border-top:none}.tab-button[data-v-252c6a8b]{flex:1;padding:16px;background:none;border:none;color:#b0b0b0;font-size:16px;cursor:pointer;transition:all .2s ease}.tab-button.active[data-v-252c6a8b]{color:#007acc;background-color:#3a3a3a}.tab-button[data-v-252c6a8b]:hover{background-color:#3a3a3a}@media (max-width:768px){.tab-button[data-v-252c6a8b]{padding:14px;font-size:14px}}','']);const i=l},3054:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var a='',n=void 0!==t[5];return t[4]&&(a+='@supports ('.concat(t[4],') {')),t[2]&&(a+='@media '.concat(t[2],' {')),n&&(a+='@layer'.concat(t[5].length>0?' '.concat(t[5]):'',' {')),a+=e(t),n&&(a+='}'),t[2]&&(a+='}'),t[4]&&(a+='}'),a}).join('')},t.i=function(e,a,n,o,r){'string'==typeof e&&(e=[[null,e,void 0]]);var l={};if(n)for(var i=0;i<this.length;i++){var d=this[i][0];null!=d&&(l[d]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);n&&l[c[0]]||(void 0!==r&&(void 0===c[5]||(c[1]='@layer'.concat(c[5].length>0?' '.concat(c[5]):'',' {').concat(c[1],'}')),c[5]=r),a&&(c[2]?(c[1]='@media '.concat(c[2],' {').concat(c[1],'}'),c[2]=a):c[2]=a),o&&(c[4]?(c[1]='@supports ('.concat(c[4],') {').concat(c[1],'}'),c[4]=o):c[4]=''.concat(o)),t.push(c))}},t}},3235:(e,t)=>{t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[e,n]of t)a[e]=n;return a}},3263:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.conversation-tab-container[data-v-18297b7b]{display:flex;flex-direction:column;width:100%;height:100%}.main-content[data-v-18297b7b]{flex:1;display:flex;flex-direction:column;overflow:hidden}.dialogue-fullscreen[data-v-18297b7b]{display:flex;flex-direction:column;flex:1;overflow:hidden}.messages-container[data-v-18297b7b]{flex:1;overflow-y:auto;background-color:#1a1a1a;min-height:var(--v14702539);max-height:var(--v14702539)}.messages-container[data-v-18297b7b]::-webkit-scrollbar{width:8px}.messages-container[data-v-18297b7b]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.messages-container[data-v-18297b7b]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.messages-container[data-v-18297b7b]::-webkit-scrollbar-thumb:hover{background:#666}.load-more-container[data-v-18297b7b]{display:flex;justify-content:center;padding:16px;margin-bottom:16px}.load-more-btn[data-v-18297b7b]{background-color:#2a2a2a;border:1px solid #404040;border-radius:20px;color:#b0b0b0;padding:8px 16px;font-size:14px;cursor:pointer;transition:all .2s ease}.load-more-btn[data-v-18297b7b]:hover{background-color:#3a3a3a;border-color:#007acc;color:#007acc}.message[data-v-18297b7b]{position:relative;border-bottom:1px solid #404040}.message.user[data-v-18297b7b]{background:linear-gradient(135deg,rgba(0,122,204,0.05) 0%,rgba(0,122,204,0.02) 100%);border-left:3px solid #007acc}.message.assistant[data-v-18297b7b]{background:linear-gradient(135deg,rgba(40,167,69,0.05) 0%,rgba(40,167,69,0.02) 100%);border-left:3px solid #28a745}.message-content[data-v-18297b7b]{line-height:1.5;word-wrap:break-word;white-space:pre-wrap;padding:16px 16px 24px 16px}[data-v-18297b7b] .dialogue-text{color:#f4c430;font-weight:500}.message-header[data-v-18297b7b]{margin-bottom:8px;background-color:rgba(0,0,0,.3);border-radius:8px 8px 0 0;overflow:hidden}.message-header-row[data-v-18297b7b]{display:flex;align-items:center;justify-content:space-between;padding:8px 16px}.message-status-row[data-v-18297b7b]{padding:4px 16px;background-color:rgba(0,0,0,.2);border-top:1px solid hsla(0,0%,100%,.1)}.message-id[data-v-18297b7b]{color:#b0b0b0;font-size:12px;font-weight:500;opacity:.8}.status-info[data-v-18297b7b]{color:#e0e0e0;font-size:12px;font-weight:400;opacity:.9;text-align:center;overflow:hidden;text-overflow:ellipsis}.status-datetime[data-v-18297b7b]{margin-bottom:2px}.status-location[data-v-18297b7b]{font-size:11px;opacity:.8}.message-actions[data-v-18297b7b]{display:flex;gap:8px}.edit-message-btn[data-v-18297b7b],.rewind-message-btn[data-v-18297b7b]{background:none;border:none;color:#888;font-size:14px;cursor:pointer;opacity:1;transition:opacity .2s ease;padding:4px 8px;border-radius:4px}.edit-message-btn[data-v-18297b7b]:hover,.rewind-message-btn[data-v-18297b7b]:hover{background-color:hsla(0,0%,100%,.1)}.edit-message-btn[data-v-18297b7b]:hover{color:#007acc}.rewind-message-btn[data-v-18297b7b]:hover{color:#28a745}.edit-mode[data-v-18297b7b]{width:100%;padding-left:16px}.edit-textarea[data-v-18297b7b]{width:100%;padding:12px;background-color:#2a2a2a;border:1px solid #007acc;border-radius:8px;color:#e0e0e0;font-size:14px;font-family:inherit;line-height:1.4;resize:none;outline:none;min-height:60px;field-sizing:content}.edit-textarea[data-v-18297b7b]:focus{border-color:#0056b3}.edit-textarea[data-v-18297b7b]::placeholder{color:#888}.edit-controls[data-v-18297b7b]{display:flex;justify-content:flex-end;gap:8px;margin-top:8px}.edit-btn[data-v-18297b7b]{width:32px;height:32px;border:none;border-radius:50%;cursor:pointer;font-size:16px;font-weight:bold;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.edit-btn.confirm-btn[data-v-18297b7b]{background-color:#28a745;color:#fff}.edit-btn.confirm-btn[data-v-18297b7b]:hover{background-color:#218838}.edit-btn.cancel-btn[data-v-18297b7b]{background-color:#dc3545;color:#fff}.edit-btn.cancel-btn[data-v-18297b7b]:hover{background-color:#c82333}.swipe-controls[data-v-18297b7b]{display:flex;align-items:center;justify-content:center;gap:8px;padding:12px 16px;background-color:rgba(0,0,0,.4);border:1px solid hsla(0,0%,100%,.1);backdrop-filter:blur(4px)}.swipe-btn[data-v-18297b7b]{background:none;border:none;color:#007acc;font-size:18px;font-weight:bold;cursor:pointer;padding:2px 6px;border-radius:4px;transition:background-color .2s ease}.swipe-btn[data-v-18297b7b]:hover:not(:disabled){background-color:rgba(0,122,204,.2)}.swipe-btn[data-v-18297b7b]:disabled{color:#666;cursor:not-allowed}.swipe-indicator[data-v-18297b7b]{color:#b0b0b0;font-size:12px;font-weight:500;min-width:40px;text-align:center}.delete-btn[data-v-18297b7b]{color:#ff6b6b !important;font-size:16px;font-weight:bold}.delete-btn[data-v-18297b7b]:hover:not(:disabled){background-color:rgba(255,107,107,.2)}.delete-btn[data-v-18297b7b]:disabled{color:#666 !important;cursor:not-allowed}.input-area[data-v-18297b7b]{padding:16px;background-color:#1a1a1a;border-top:1px solid #404040}.input-container[data-v-18297b7b]{display:flex;gap:8px;align-items:center}.message-input[data-v-18297b7b]{flex:1;padding:12px 16px;background-color:#2a2a2a;border:1px solid #404040;border-radius:24px;color:#e0e0e0;font-size:16px;outline:none;transition:border-color .2s ease;resize:none;min-height:20px;max-height:120px}.message-input[data-v-18297b7b]::-webkit-scrollbar{display:none}.message-input[data-v-18297b7b]{-ms-overflow-style:none;scrollbar-width:none}.message-input[data-v-18297b7b]:focus{border-color:#007acc}.message-input[data-v-18297b7b]::placeholder{color:#888}.send-button[data-v-18297b7b]{padding:12px 20px;background-color:#007acc;border:none;border-radius:24px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;white-space:nowrap}.send-button[data-v-18297b7b]:hover{background-color:#0056b3}.send-button[data-v-18297b7b]:active{background-color:#004085}.loading-spinner[data-v-18297b7b]{width:20px;height:20px;border:2px solid #404040;border-top:2px solid #007acc;border-radius:50%;animation:spin-18297b7b 1s linear infinite;flex-shrink:0}@keyframes spin-18297b7b{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@media (max-width:768px){.input-area[data-v-18297b7b]{padding:12px}.message-input[data-v-18297b7b]{font-size:16px}.send-button[data-v-18297b7b]{padding:12px 16px;font-size:14px}}','']);const i=l},3541:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'body{overflow-y:auto}','']);const i=l},3548:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.item-tab-container[data-v-b32ed7ea]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.item-content[data-v-b32ed7ea]{flex:1;padding:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--f33397ea);max-height:var(--f33397ea)}.item-content[data-v-b32ed7ea]::-webkit-scrollbar{width:8px}.item-content[data-v-b32ed7ea]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.item-content[data-v-b32ed7ea]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.item-content[data-v-b32ed7ea]::-webkit-scrollbar-thumb:hover{background:#666}.item-section[data-v-b32ed7ea]:last-child{margin-bottom:0}.section-title[data-v-b32ed7ea]{font-size:18px;font-weight:600;color:#007acc;margin:0 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.add-item-button[data-v-b32ed7ea]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff;margin-top:12px}.add-item-button[data-v-b32ed7ea]:hover{background:#005a99}.item-list[data-v-b32ed7ea]{display:flex;flex-direction:column;gap:8px}.item-row[data-v-b32ed7ea]{background:#252525;padding:12px 16px;border-radius:8px;border:1px solid #404040;display:flex;flex-direction:column;gap:8px;font-size:14px;transition:background-color .2s}.item-row[data-v-b32ed7ea]:hover{background:#2a2a2a;border-color:#555}.new-item-row[data-v-b32ed7ea]{background:#2a2a2a;border-color:#007acc;border-style:dashed}.item-info[data-v-b32ed7ea]{display:flex;flex-direction:column;gap:6px;flex:1}.item-id-name-row[data-v-b32ed7ea]{display:flex;gap:12px;align-items:center}.item-id[data-v-b32ed7ea]{font-weight:500;color:#007acc;font-size:14px}.item-name[data-v-b32ed7ea]{font-weight:500;color:#fff;font-size:16px}.item-description[data-v-b32ed7ea]{color:#a0a0a0;line-height:1.4;font-size:13px}.item-value-actions-row[data-v-b32ed7ea]{display:flex;justify-content:space-between;align-items:center}.item-value[data-v-b32ed7ea]{font-weight:600;color:#4caf50;font-size:14px}.item-actions[data-v-b32ed7ea]{display:flex;gap:8px}.edit-item-button[data-v-b32ed7ea],.delete-item-button[data-v-b32ed7ea]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.edit-item-button[data-v-b32ed7ea]{background:#007acc;color:#fff}.edit-item-button[data-v-b32ed7ea]:hover{background:#005a99}.delete-item-button[data-v-b32ed7ea]{background:#f44336;color:#fff}.delete-item-button[data-v-b32ed7ea]:hover{background:#da190b}.item-id-input[data-v-b32ed7ea],.item-name-input[data-v-b32ed7ea],.item-value-input[data-v-b32ed7ea]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:14px;padding:4px 8px}.item-id-input[data-v-b32ed7ea]:focus,.item-name-input[data-v-b32ed7ea]:focus,.item-value-input[data-v-b32ed7ea]:focus{outline:none;border-color:#007acc}.item-id-input[data-v-b32ed7ea]{font-weight:500;color:#007acc;font-size:14px;width:50px;flex-shrink:0;text-align:center}.item-name-input[data-v-b32ed7ea]{font-weight:500;color:#fff;font-size:16px;flex:1}.item-value-input[data-v-b32ed7ea]{font-weight:600;color:#4caf50;font-size:14px;width:50px;text-align:left;outline:none}.item-value-input-wrapper[data-v-b32ed7ea]{display:flex;align-items:center;font-weight:600;color:#4caf50;font-size:14px}.dollar-sign[data-v-b32ed7ea]{margin-right:2px}.item-description-input[data-v-b32ed7ea]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:6px 8px;resize:vertical;min-height:60px;line-height:1.4}.item-description-input[data-v-b32ed7ea]:focus{outline:none;border-color:#007acc}.confirm-button[data-v-b32ed7ea],.cancel-button[data-v-b32ed7ea]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.confirm-button[data-v-b32ed7ea]{background:#4caf50;color:#fff}.confirm-button[data-v-b32ed7ea]:hover{background:#45a049}.cancel-button[data-v-b32ed7ea]{background:#f44336;color:#fff}.cancel-button[data-v-b32ed7ea]:hover{background:#da190b}.no-items-message[data-v-b32ed7ea]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}@media (max-width:768px){.item-content[data-v-b32ed7ea]{padding:12px}.section-title[data-v-b32ed7ea]{font-size:18px}.item-row[data-v-b32ed7ea]{padding:10px 12px;gap:6px}.item-info[data-v-b32ed7ea]{gap:4px}.item-name[data-v-b32ed7ea]{font-size:15px}.item-description[data-v-b32ed7ea]{font-size:12px}.item-actions[data-v-b32ed7ea]{gap:6px}.edit-item-button[data-v-b32ed7ea],.delete-item-button[data-v-b32ed7ea]{padding:5px 10px;font-size:11px}.item-id-input[data-v-b32ed7ea],.item-name-input[data-v-b32ed7ea],.item-value-input[data-v-b32ed7ea]{font-size:13px;padding:3px 6px}.item-description-input[data-v-b32ed7ea]{font-size:12px;padding:4px 6px;min-height:50px}.confirm-button[data-v-b32ed7ea],.cancel-button[data-v-b32ed7ea]{padding:5px 10px;font-size:11px}}','']);const i=l},3645:(e,t,a)=>{var n=a(751);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('1541082c',n,!1,{ssrId:!0})},3773:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.user-tab-container[data-v-ada46c14]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.user-content[data-v-ada46c14]{flex:1;padding:16px;overflow-y:auto;gap:20px;display:flex;flex-direction:column;min-height:var(--v68dcf940);max-height:var(--v68dcf940)}.user-content[data-v-ada46c14]::-webkit-scrollbar{width:8px}.user-content[data-v-ada46c14]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.user-content[data-v-ada46c14]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.user-content[data-v-ada46c14]::-webkit-scrollbar-thumb:hover{background:#666}.user-header[data-v-ada46c14]{text-align:center;position:relative}.user-name[data-v-ada46c14]{font-size:28px;font-weight:700;color:#007acc;margin:0;text-shadow:0 2px 4px rgba(0,0,0,.3)}.attributes-grid[data-v-ada46c14]{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;margin-bottom:20px}.attribute-item[data-v-ada46c14]{background:#252525;padding:12px;border-radius:8px;text-align:center;border:1px solid #404040}.attribute-item.full-width[data-v-ada46c14]{grid-column:1/-1;text-align:left;padding:16px}.attribute-item.horizontal[data-v-ada46c14]{display:flex;justify-content:space-between;align-items:center;text-align:left}.attribute-item.horizontal .attribute-label[data-v-ada46c14]{margin-bottom:0;flex-shrink:0}.attribute-item.horizontal .attribute-value[data-v-ada46c14]{margin-left:auto}.attribute-item.horizontal .attribute-input[data-v-ada46c14]{margin-left:8px}.attribute-item.birthday-fullwidth[data-v-ada46c14]{display:flex;justify-content:space-between;align-items:center;text-align:left}.attribute-item.birthday-fullwidth .attribute-label[data-v-ada46c14]{margin-bottom:0;flex-shrink:0}.attribute-item.birthday-fullwidth .attribute-value[data-v-ada46c14]{margin-left:auto}.attribute-item.birthday-fullwidth .birthday-edit-container[data-v-ada46c14]{margin-left:auto;justify-content:flex-end}.attribute-label[data-v-ada46c14]{display:block;font-size:12px;color:#888;margin-bottom:6px;text-transform:uppercase;letter-spacing:.5px;font-weight:500}.attribute-label.unit-label[data-v-ada46c14]{text-transform:none}.attribute-value[data-v-ada46c14]{display:block;font-size:16px;font-weight:600;color:#e0e0e0}.attribute-value.money[data-v-ada46c14]{color:#4caf50;font-weight:700}.attribute-value.no-bold[data-v-ada46c14]{font-weight:400}.section-title[data-v-ada46c14]{font-size:18px;font-weight:600;color:#007acc;margin:20px 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.relations-section[data-v-ada46c14],.inventory-section[data-v-ada46c14]{margin-bottom:16px}.relations-section[data-v-ada46c14]:last-child,.inventory-section[data-v-ada46c14]:last-child{margin-bottom:0}.relations-list[data-v-ada46c14],.inventory-list[data-v-ada46c14],.relations-edit-list[data-v-ada46c14],.inventory-edit-list[data-v-ada46c14]{display:flex;flex-direction:column;gap:8px}.relation-item[data-v-ada46c14]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;font-size:14px;color:#e0e0e0;line-height:1.4}.relation-highlight[data-v-ada46c14]{color:#fff;font-weight:500}.relation-connector[data-v-ada46c14]{color:#888;font-weight:400}.relation-edit-item[data-v-ada46c14]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;display:flex;align-items:center;gap:8px;flex-wrap:wrap}.relation-edit-connector[data-v-ada46c14]{color:#888;font-weight:400;font-size:14px;white-space:nowrap}.relation-input[data-v-ada46c14]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;flex:1;min-width:50px}.relation-input[data-v-ada46c14]:focus{outline:none;border-color:#007acc}.relation-select[data-v-ada46c14],.inventory-select[data-v-ada46c14]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;min-width:120px;flex-shrink:0}.relation-select[data-v-ada46c14]:focus,.inventory-select[data-v-ada46c14]:focus{outline:none;border-color:#007acc}.relation-select option[data-v-ada46c14],.inventory-select option[data-v-ada46c14]{background:#333;color:#e0e0e0}.relation-select option[data-v-ada46c14]:disabled,.inventory-select option[data-v-ada46c14]:disabled{color:#888;font-style:italic}.relation-remove-btn[data-v-ada46c14],.add-relation-btn[data-v-ada46c14],.add-inventory-btn[data-v-ada46c14]{background:#007acc;color:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;margin-top:8px;transition:background-color .2s}.relation-remove-btn[data-v-ada46c14]:hover,.add-relation-btn[data-v-ada46c14]:hover,.add-inventory-btn[data-v-ada46c14]:hover{background:#005a99}.inventory-item[data-v-ada46c14]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;display:flex;flex-direction:column;gap:6px}.inventory-first-row[data-v-ada46c14]{display:flex;justify-content:space-between;align-items:center}.item-name-id[data-v-ada46c14]{font-weight:500;color:#fff;font-size:14px}.item-quantity[data-v-ada46c14]{font-weight:600;color:#e0e0e0;background:#007acc;padding:2px 8px;border-radius:12px;font-size:12px}.storage-indicator[data-v-ada46c14]{font-weight:600;color:#fff;background:#4caf50;padding:2px 8px;border-radius:12px;font-size:12px}[data-v-ada46c14] .inventory-item-tag{background:#4caf50;color:#fff;padding:2px 6px;border-radius:4px;font-size:12px;display:flex;align-items:center;gap:4px;white-space:nowrap;flex-shrink:0}[data-v-ada46c14] .storage-item-tag{background:#ff9800;color:#fff;padding:2px 6px;border-radius:4px;font-size:12px;display:flex;align-items:center;gap:4px;white-space:nowrap;flex-shrink:0}.inventory-second-row[data-v-ada46c14]{font-size:12px;color:#a0a0a0;line-height:1.6}.inventory-tags-container[data-v-ada46c14]{display:flex;flex-wrap:wrap;gap:4px;align-items:flex-start;row-gap:6px;margin-top:4px}.inventory-third-row[data-v-ada46c14]{display:flex;flex-direction:column;gap:4px}.no-inventory[data-v-ada46c14]{color:#888;font-style:italic;font-size:13px}.inventory-items[data-v-ada46c14]{display:flex;flex-wrap:wrap;gap:4px}.inventory-edit-item[data-v-ada46c14]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;display:flex;align-items:center;gap:8px;flex-wrap:wrap}.inventory-edit-connector[data-v-ada46c14]{color:#888;font-weight:400;font-size:14px;white-space:nowrap}.inventory-quantity-input[data-v-ada46c14]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;width:80px;text-align:center}.inventory-quantity-input[data-v-ada46c14]:focus{outline:none;border-color:#007acc}.inventory-remove-btn[data-v-ada46c14]{background:#f44336;color:#fff;border:none;border-radius:4px;width:24px;height:24px;cursor:pointer;font-size:16px;font-weight:bold;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-left:auto}.inventory-remove-btn[data-v-ada46c14]:hover{background:#da190b}.attribute-input[data-v-ada46c14]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;width:100%}.attribute-input[data-v-ada46c14]:focus{outline:none;border-color:#007acc}.birthday-inputs[data-v-ada46c14]{display:flex;align-items:center;gap:2px;width:auto;margin-left:auto}.birthday-edit-container[data-v-ada46c14]{display:flex;justify-content:flex-start;width:100%}.birthday-input-group[data-v-ada46c14]{display:flex;align-items:center;gap:4px;padding:4px 0}.birthday-month[data-v-ada46c14],.birthday-date[data-v-ada46c14]{width:50px;flex-shrink:0}.birthday-separator[data-v-ada46c14]{color:#888;font-size:14px;white-space:nowrap}.attribute-textarea[data-v-ada46c14]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:8px;font-size:14px;width:100%;min-height:60px;resize:vertical;font-family:inherit}.attribute-textarea[data-v-ada46c14]:focus{outline:none;border-color:#007acc}.edit-buttons[data-v-ada46c14]{display:flex;justify-content:center;gap:16px;margin-top:20px;padding-top:20px;border-top:1px solid #404040}.edit-button[data-v-ada46c14]{position:absolute;top:0;left:0;padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff}.edit-button[data-v-ada46c14]:hover{background:#005a99}.confirm-button[data-v-ada46c14],.cancel-button[data-v-ada46c14]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s}.confirm-button[data-v-ada46c14]{background:#4caf50;color:#fff}.confirm-button[data-v-ada46c14]:hover{background:#45a049}.cancel-button[data-v-ada46c14]{background:#f44336;color:#fff}.cancel-button[data-v-ada46c14]:hover{background:#da190b}@media (max-width:768px){.user-content[data-v-ada46c14]{padding:12px;gap:16px}.user-name[data-v-ada46c14]{font-size:24px}.attributes-grid[data-v-ada46c14]{grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:8px}.attribute-item[data-v-ada46c14]{padding:10px}.attribute-item.full-width[data-v-ada46c14]{padding:12px}.attribute-value[data-v-ada46c14]{font-size:14px}.inventory-item[data-v-ada46c14]{gap:4px}[data-v-ada46c14] .inventory-item-tag{font-size:12px;padding:2px 6px}.inventory-third-row[data-v-ada46c14] .inventory-item-tag{font-size:12px;padding:2px 6px}}.no-relations-message[data-v-ada46c14],.no-inventory-message[data-v-ada46c14]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}','']);const i=l},4015:(t,a,n)=>{t.exports=(e=>{var t={};return n.d(t,e),t})({klona:()=>e.klona})},4061:e=>{e.exports=Vue},4248:(e,t,a)=>{var n=a(390);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('469f5388',n,!1,{ssrId:!0})},4424:(e,t,a)=>{function n(e,t){for(var a=[],n={},o=0;o<t.length;o++){var r=t[o],l=r[0],i={id:e+':'+o,css:r[1],media:r[2],sourceMap:r[3]};n[l]?n[l].parts.push(i):a.push(n[l]={id:l,parts:[i]})}return a}a.d(t,{A:()=>v});var o='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!o)throw new Error('vue-style-loader cannot be used in a non-browser environment. Use { target: \'node\' } in your Webpack config to indicate a server-rendering environment.');var r={},l=o&&(document.head||document.getElementsByTagName('head')[0]),i=null,d=0,s=!1,c=function(){},u=null,p='data-vue-ssr-id',m='undefined'!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function v(e,t,a,o){s=a,u=o||{};var l=n(e,t);return g(l),function(t){for(var a=[],o=0;o<l.length;o++){var i=l[o];(d=r[i.id]).refs--,a.push(d)}t?g(l=n(e,t)):l=[];for(o=0;o<a.length;o++){var d;if(0===(d=a[o]).refs){for(var s=0;s<d.parts.length;s++)d.parts[s]();delete r[d.id]}}}}function g(e){for(var t=0;t<e.length;t++){var a=e[t],n=r[a.id];if(n){n.refs++;for(var o=0;o<n.parts.length;o++)n.parts[o](a.parts[o]);for(;o<a.parts.length;o++)n.parts.push(f(a.parts[o]));n.parts.length>a.parts.length&&(n.parts.length=a.parts.length)}else{var l=[];for(o=0;o<a.parts.length;o++)l.push(f(a.parts[o]));r[a.id]={id:a.id,refs:1,parts:l}}}}function b(){var e=document.createElement('style');return e.type='text/css',l.appendChild(e),e}function f(e){var t,a,n=document.querySelector('style['+p+'~="'+e.id+'"]');if(n){if(s)return c;n.parentNode.removeChild(n)}if(m){var o=d++;n=i||(i=b()),t=y.bind(null,n,o,!1),a=y.bind(null,n,o,!0)}else n=b(),t=E.bind(null,n),a=function(){n.parentNode.removeChild(n)};return t(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;t(e=n)}else a()}}var h,x=(h=[],function(e,t){return h[e]=t,h.filter(Boolean).join('\n')});function y(e,t,a,n){var o=a?'':n.css;if(e.styleSheet)e.styleSheet.cssText=x(t,o);else{var r=document.createTextNode(o),l=e.childNodes;l[t]&&e.removeChild(l[t]),l.length?e.insertBefore(r,l[t]):e.appendChild(r)}}function E(e,t){var a=t.css,n=t.media,o=t.sourceMap;if(n&&e.setAttribute('media',n),u.ssrId&&e.setAttribute(p,t.id),o&&(a+='\n/*# sourceURL='+o.sources[0]+' */',a+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+' */'),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}},4939:(e,t,a)=>{var n=a(3541);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('d87ab640',n,!1,{ssrId:!0})},5067:(e,t,a)=>{var n=a(8933);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('1937bdfb',n,!1,{ssrId:!0})},5168:(e,t,a)=>{var n=a(8990);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('18708d64',n,!1,{ssrId:!0})},5283:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.app-container[data-v-e8f6a8aa]{display:flex;flex-direction:column;width:100%;height:100%;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.initialization-wrapper[data-v-e8f6a8aa]{height:100%;width:100%;display:flex;flex-direction:column}','']);const i=l},5654:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.location-tab-container[data-v-bd354e5e]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.location-content[data-v-bd354e5e]{flex:1;padding:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--v77958077);max-height:var(--v77958077)}.location-content[data-v-bd354e5e]::-webkit-scrollbar{width:8px}.location-content[data-v-bd354e5e]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.location-content[data-v-bd354e5e]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.location-content[data-v-bd354e5e]::-webkit-scrollbar-thumb:hover{background:#666}.location-section[data-v-bd354e5e]:last-child{margin-bottom:0}.section-title[data-v-bd354e5e]{font-size:18px;font-weight:600;color:#007acc;margin:0 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.add-location-button[data-v-bd354e5e]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff;margin-top:12px}.add-location-button[data-v-bd354e5e]:hover{background:#005a99}.location-list[data-v-bd354e5e]{display:flex;flex-direction:column;gap:8px}.location-row[data-v-bd354e5e]{background:#252525;padding:12px 16px;border-radius:8px;border:1px solid #404040;display:flex;flex-direction:column;gap:8px;font-size:14px;transition:background-color .2s}.location-row[data-v-bd354e5e]:hover{background:#2a2a2a;border-color:#555}.new-location-row[data-v-bd354e5e]{background:#2a2a2a;border-color:#007acc;border-style:dashed}.location-first-row[data-v-bd354e5e]{display:flex;justify-content:space-between;align-items:center;gap:12px}.location-location-row[data-v-bd354e5e]{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-top:6px}.location-location-group[data-v-bd354e5e]{display:flex;align-items:center;gap:8px}.location-location-label[data-v-bd354e5e]{font-weight:500;color:#a0a0a0;font-size:13px;min-width:40px}.location-edit-actions[data-v-bd354e5e]{display:flex;gap:8px}.location-id-name-group[data-v-bd354e5e]{display:flex;gap:12px;align-items:center;flex:1}.location-id[data-v-bd354e5e]{font-weight:500;color:#007acc;font-size:14px}.location-name[data-v-bd354e5e]{font-weight:500;color:#fff;font-size:16px}.location-location[data-v-bd354e5e]{font-weight:500;color:#fff;font-size:16px}.location-location-input[data-v-bd354e5e]{font-weight:500;color:#fff;font-size:16px;width:35px;flex-shrink:0}.location-location-input-edit[data-v-bd354e5e]{background:#333;border:1px solid #555;border-radius:4px;padding:4px 8px}.location-location-input-edit[data-v-bd354e5e]:focus{outline:none;border-color:#007acc}.location-parent-display[data-v-bd354e5e]{display:flex;flex-wrap:wrap;gap:4px}.location-parent-tag[data-v-bd354e5e]{background:#007acc;color:#fff;padding:4px 10px;border-radius:4px;font-size:13px;display:flex;align-items:center;gap:4px;cursor:pointer;transition:opacity .2s}.location-parent-tag[data-v-bd354e5e]:hover{opacity:.8}.location-children-display[data-v-bd354e5e]{display:flex;flex-wrap:wrap;gap:4px}.location-child-tag[data-v-bd354e5e]{background:#4caf50;color:#fff;padding:4px 10px;border-radius:4px;font-size:13px;display:flex;align-items:center;gap:4px;cursor:pointer;transition:opacity .2s}.location-child-tag[data-v-bd354e5e]:hover{opacity:.8}.location-storages-display[data-v-bd354e5e]{display:flex;flex-wrap:wrap;gap:4px}.location-storage-tag[data-v-bd354e5e]{background:#ff9800;color:#fff;padding:4px 10px;border-radius:4px;font-size:13px;display:flex;align-items:center;gap:4px}.location-description[data-v-bd354e5e]{color:#a0a0a0;line-height:1.4;font-size:13px}.location-actions[data-v-bd354e5e]{display:flex;gap:8px}.edit-location-button[data-v-bd354e5e],.delete-location-button[data-v-bd354e5e]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.edit-location-button[data-v-bd354e5e]{background:#007acc;color:#fff}.edit-location-button[data-v-bd354e5e]:hover{background:#005a99}.delete-location-button[data-v-bd354e5e]{background:#f44336;color:#fff}.delete-location-button[data-v-bd354e5e]:hover{background:#da190b}.location-id-input[data-v-bd354e5e],.location-name-input[data-v-bd354e5e],.location-location-input[data-v-bd354e5e],.location-description-input[data-v-bd354e5e]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:14px;padding:4px 8px;width:35px;-webkit-appearance:none;appearance:none;appearance:none}.location-id-input[data-v-bd354e5e]:focus,.location-name-input[data-v-bd354e5e]:focus,.location-location-input[data-v-bd354e5e]:focus,.location-description-input[data-v-bd354e5e]:focus{outline:none;border-color:#007acc}.location-id-input[data-v-bd354e5e]::-webkit-outer-spin-button,.location-id-input[data-v-bd354e5e]::-webkit-inner-spin-button,.location-name-input[data-v-bd354e5e]::-webkit-outer-spin-button,.location-name-input[data-v-bd354e5e]::-webkit-inner-spin-button,.location-location-input[data-v-bd354e5e]::-webkit-outer-spin-button,.location-location-input[data-v-bd354e5e]::-webkit-inner-spin-button,.location-description-input[data-v-bd354e5e]::-webkit-outer-spin-button,.location-description-input[data-v-bd354e5e]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.location-id-input[type=number][data-v-bd354e5e],.location-name-input[type=number][data-v-bd354e5e],.location-location-input[type=number][data-v-bd354e5e],.location-description-input[type=number][data-v-bd354e5e]{-webkit-appearance:textfield;appearance:textfield}.location-id-input[data-v-bd354e5e]{font-weight:500;color:#007acc;font-size:14px;width:50px;flex-shrink:0;text-align:center}.location-name-input[data-v-bd354e5e]{font-weight:500;color:#fff;font-size:16px;width:120px;flex-shrink:0}.location-parent-input-group[data-v-bd354e5e]{display:flex;flex-direction:column;gap:6px}.location-children-input-group[data-v-bd354e5e]{display:flex;flex-direction:column;gap:6px}.selected-children[data-v-bd354e5e]{display:flex;flex-wrap:wrap;gap:4px}.selected-child-tag[data-v-bd354e5e]{background:#4caf50;color:#fff;padding:3px 8px;border-radius:4px;font-size:11px;display:flex;align-items:center;gap:4px}.remove-child-btn[data-v-bd354e5e]{background:none;border:none;color:#fff;cursor:pointer;font-size:14px;line-height:1;padding:0;margin-left:2px}.remove-child-btn[data-v-bd354e5e]:hover{color:#ccc}.location-storages-input-group[data-v-bd354e5e]{display:flex;flex-direction:column;gap:6px}.selected-storages[data-v-bd354e5e]{display:flex;flex-wrap:wrap;gap:4px}.selected-storage-tag[data-v-bd354e5e]{background:#ff9800;color:#fff;padding:3px 8px;border-radius:4px;font-size:11px;display:flex;align-items:center;gap:4px}.remove-storage-btn[data-v-bd354e5e]{background:none;border:none;color:#fff;cursor:pointer;font-size:14px;line-height:1;padding:0;margin-left:2px}.remove-storage-btn[data-v-bd354e5e]:hover{color:#ccc}.parent-location-select[data-v-bd354e5e],.child-location-select[data-v-bd354e5e],.storage-location-select[data-v-bd354e5e]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:4px 8px}.parent-location-select[data-v-bd354e5e]:focus,.child-location-select[data-v-bd354e5e]:focus,.storage-location-select[data-v-bd354e5e]:focus{outline:none;border-color:#007acc}.location-description-input[data-v-bd354e5e]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:6px 8px;resize:vertical;min-height:60px;line-height:1.4;width:100%}.location-description-input[data-v-bd354e5e]:focus{outline:none;border-color:#007acc}.confirm-button[data-v-bd354e5e],.cancel-button[data-v-bd354e5e]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.confirm-button[data-v-bd354e5e]{background:#4caf50;color:#fff}.confirm-button[data-v-bd354e5e]:hover{background:#45a049}.cancel-button[data-v-bd354e5e]{background:#f44336;color:#fff}.cancel-button[data-v-bd354e5e]:hover{background:#da190b}.no-locations-message[data-v-bd354e5e]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}@media (max-width:768px){.location-content[data-v-bd354e5e]{padding:12px}.section-title[data-v-bd354e5e]{font-size:18px}.location-row[data-v-bd354e5e]{padding:10px 12px;gap:6px}.location-first-row[data-v-bd354e5e]{gap:8px}.location-location-row[data-v-bd354e5e]{gap:6px;margin-top:4px}.location-location-group[data-v-bd354e5e]{gap:6px}.location-location-label[data-v-bd354e5e]{font-size:12px;min-width:35px}.location-name[data-v-bd354e5e]{font-size:15px}.location-location[data-v-bd354e5e]{font-size:15px}.location-location-input[data-v-bd354e5e]{font-size:15px;width:100px}.location-edit-actions[data-v-bd354e5e]{gap:6px}.location-description[data-v-bd354e5e]{font-size:12px}.location-actions[data-v-bd354e5e]{gap:6px}.edit-location-button[data-v-bd354e5e],.delete-location-button[data-v-bd354e5e]{padding:5px 10px;font-size:11px}.location-id-input[data-v-bd354e5e],.location-name-input[data-v-bd354e5e],.location-location-input[data-v-bd354e5e]{font-size:13px;padding:3px 6px}.location-id-input[data-v-bd354e5e]{width:40px}.location-name-input[data-v-bd354e5e]{width:100px}.parent-location-select[data-v-bd354e5e],.child-location-select[data-v-bd354e5e],.storage-location-select[data-v-bd354e5e]{font-size:12px;padding:3px 6px}.selected-child-tag[data-v-bd354e5e],.location-child-tag[data-v-bd354e5e],.location-parent-tag[data-v-bd354e5e],.location-storage-tag[data-v-bd354e5e],.selected-storage-tag[data-v-bd354e5e]{font-size:12px;padding:2px 6px}.location-description-input[data-v-bd354e5e]{font-size:12px;padding:4px 6px;min-height:50px}.confirm-button[data-v-bd354e5e],.cancel-button[data-v-bd354e5e]{padding:5px 10px;font-size:11px}}','']);const i=l},5784:(e,t,a)=>{var n=a(1026);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('aa26a08a',n,!1,{ssrId:!0})},5825:(e,t,a)=>{var n=a(8663);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('74a8992f',n,!1,{ssrId:!0})},6129:(e,t,a)=>{var n=a(2959);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('11ca28f4',n,!1,{ssrId:!0})},6224:(e,t,a)=>{var n=a(1634);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('7db4e676',n,!1,{ssrId:!0})},6482:(e,t,a)=>{var n=a(7280);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('ba795040',n,!1,{ssrId:!0})},7234:(e,t,a)=>{var n=a(8704);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('5be7058a',n,!1,{ssrId:!0})},7280:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.storage-tab-container[data-v-62b84623]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.storage-content[data-v-62b84623]{flex:1;padding:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--v4efc9d77);max-height:var(--v4efc9d77)}.storage-content[data-v-62b84623]::-webkit-scrollbar{width:8px}.storage-content[data-v-62b84623]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.storage-content[data-v-62b84623]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.storage-content[data-v-62b84623]::-webkit-scrollbar-thumb:hover{background:#666}.storage-section[data-v-62b84623]:last-child{margin-bottom:0}.section-title[data-v-62b84623]{font-size:18px;font-weight:600;color:#007acc;margin:0 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.add-storage-button[data-v-62b84623]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff;margin-top:12px}.add-storage-button[data-v-62b84623]:hover{background:#005a99}.storage-list[data-v-62b84623]{display:flex;flex-direction:column;gap:8px}.storage-row[data-v-62b84623]{background:#252525;padding:12px 16px;border-radius:8px;border:1px solid #404040;display:flex;flex-direction:column;gap:8px;font-size:14px;transition:background-color .2s}.storage-row[data-v-62b84623]:hover{background:#2a2a2a;border-color:#555}.new-storage-row[data-v-62b84623]{background:#2a2a2a;border-color:#007acc;border-style:dashed}.storage-first-row[data-v-62b84623]{display:flex;justify-content:space-between;align-items:center;gap:12px}.storage-money-row[data-v-62b84623]{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-top:6px}.storage-money-group[data-v-62b84623]{display:flex;align-items:center;gap:8px}.storage-money-label[data-v-62b84623]{font-weight:500;color:#a0a0a0;font-size:16px;min-width:40px}.storage-edit-actions[data-v-62b84623]{display:flex;gap:8px}.storage-id-name-group[data-v-62b84623]{display:flex;gap:12px;align-items:center;flex:1}.storage-id[data-v-62b84623]{font-weight:500;color:#007acc;font-size:14px}.storage-name[data-v-62b84623]{font-weight:500;color:#fff;font-size:16px}.storage-money[data-v-62b84623]{font-weight:500;color:#4caf50;font-size:16px}.storage-money-input[data-v-62b84623]{font-weight:500;color:#fff;font-size:16px;width:80px;flex-shrink:0}.storage-money-input-edit[data-v-62b84623]{background:#333;border:1px solid #555;border-radius:4px;padding:4px 8px}.storage-money-input-edit[data-v-62b84623]:focus{outline:none;border-color:#007acc}.storage-parent-display[data-v-62b84623]{display:flex;flex-wrap:wrap;gap:4px}.storage-parent-tag[data-v-62b84623]{background:#007acc;color:#fff;padding:4px 10px;border-radius:4px;font-size:13px;display:flex;align-items:center;gap:4px}.storage-inventory-display[data-v-62b84623]{display:flex;flex-direction:column;gap:4px}.no-inventory[data-v-62b84623]{color:#888;font-style:italic;font-size:13px}.inventory-items[data-v-62b84623]{display:flex;flex-wrap:wrap;gap:4px}.inventory-item-tag[data-v-62b84623]{background:#4caf50;color:#fff;padding:2px 6px;border-radius:4px;font-size:13px;display:flex;align-items:center;gap:4px;white-space:nowrap;flex-shrink:0}.storage-item-tag[data-v-62b84623]{background:#ff9800;color:#fff;padding:2px 6px;border-radius:4px;font-size:12px;display:flex;align-items:center;gap:4px;white-space:nowrap;flex-shrink:0}.storage-description[data-v-62b84623]{color:#a0a0a0;line-height:1.4;font-size:13px}.storage-actions[data-v-62b84623]{display:flex;gap:8px}.edit-storage-button[data-v-62b84623],.delete-storage-button[data-v-62b84623]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.edit-storage-button[data-v-62b84623]{background:#007acc;color:#fff}.edit-storage-button[data-v-62b84623]:hover{background:#005a99}.delete-storage-button[data-v-62b84623]{background:#f44336;color:#fff}.delete-storage-button[data-v-62b84623]:hover{background:#da190b}.storage-id-input[data-v-62b84623],.storage-name-input[data-v-62b84623],.storage-money-input[data-v-62b84623],.storage-description-input[data-v-62b84623]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:14px;padding:4px 8px;width:35px;-webkit-appearance:none;appearance:none}.storage-id-input[data-v-62b84623]:focus,.storage-name-input[data-v-62b84623]:focus,.storage-money-input[data-v-62b84623]:focus,.storage-description-input[data-v-62b84623]:focus{outline:none;border-color:#007acc}.storage-id-input[data-v-62b84623]::-webkit-outer-spin-button,.storage-id-input[data-v-62b84623]::-webkit-inner-spin-button,.storage-name-input[data-v-62b84623]::-webkit-outer-spin-button,.storage-name-input[data-v-62b84623]::-webkit-inner-spin-button,.storage-money-input[data-v-62b84623]::-webkit-outer-spin-button,.storage-money-input[data-v-62b84623]::-webkit-inner-spin-button,.storage-description-input[data-v-62b84623]::-webkit-outer-spin-button,.storage-description-input[data-v-62b84623]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.storage-id-input[type=number][data-v-62b84623],.storage-name-input[type=number][data-v-62b84623],.storage-money-input[type=number][data-v-62b84623],.storage-description-input[type=number][data-v-62b84623]{-webkit-appearance:textfield;appearance:textfield}.storage-id-input[data-v-62b84623]{font-weight:500;color:#007acc;font-size:14px;width:50px;flex-shrink:0;text-align:center}.storage-name-input[data-v-62b84623]{font-weight:500;color:#fff;font-size:16px;width:120px;flex-shrink:0}.storage-parent-input-group[data-v-62b84623]{display:flex;flex-direction:column;gap:6px}.storage-inventory-input-group[data-v-62b84623]{display:flex;flex-direction:column;gap:6px}.selected-inventory[data-v-62b84623]{display:flex;flex-direction:column;gap:4px}.selected-inventory-item[data-v-62b84623]{display:flex;align-items:center;gap:8px;background:#333;padding:4px 8px;border-radius:4px}.item-name[data-v-62b84623]{flex:1;color:#e0e0e0;font-size:13px}.item-quantity-input[data-v-62b84623]{width:60px;background:#444;border:1px solid #555;border-radius:3px;color:#e0e0e0;padding:2px 4px;font-size:12px;text-align:center}.item-quantity-input[data-v-62b84623]:focus{outline:none;border-color:#007acc}.item-quantity-input[data-v-62b84623]::-webkit-outer-spin-button,.item-quantity-input[data-v-62b84623]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.item-quantity-input[type=number][data-v-62b84623]{-webkit-appearance:textfield;appearance:textfield}.inventory-edit-connector[data-v-62b84623]{color:#888;font-weight:400;font-size:14px;white-space:nowrap}.storage-indicator[data-v-62b84623]{font-weight:600;color:#fff;background:#4caf50;padding:2px 8px;border-radius:12px;font-size:12px}.remove-item-btn[data-v-62b84623]{background:none;border:none;color:#f44336;cursor:pointer;font-size:16px;line-height:1;padding:0;margin-left:4px}.remove-item-btn[data-v-62b84623]:hover{color:#da190b}.parent-select[data-v-62b84623],.item-select[data-v-62b84623]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:4px 8px}.parent-select[data-v-62b84623]:focus,.item-select[data-v-62b84623]:focus{outline:none;border-color:#007acc}.storage-description-input[data-v-62b84623]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:6px 8px;resize:vertical;min-height:60px;line-height:1.4;width:100%}.storage-description-input[data-v-62b84623]:focus{outline:none;border-color:#007acc}.confirm-button[data-v-62b84623],.cancel-button[data-v-62b84623]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.confirm-button[data-v-62b84623]{background:#4caf50;color:#fff}.confirm-button[data-v-62b84623]:hover:not(:disabled){background:#45a049}.confirm-button[data-v-62b84623]:disabled{background:#666;cursor:not-allowed;opacity:.6}.cancel-button[data-v-62b84623]{background:#f44336;color:#fff}.cancel-button[data-v-62b84623]:hover{background:#da190b}.no-storages-message[data-v-62b84623]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}@media (max-width:768px){.storage-content[data-v-62b84623]{padding:12px}.section-title[data-v-62b84623]{font-size:18px}.storage-row[data-v-62b84623]{padding:10px 12px;gap:6px}.storage-first-row[data-v-62b84623]{gap:8px}.storage-money-row[data-v-62b84623]{gap:6px;margin-top:4px}.storage-money-group[data-v-62b84623]{gap:6px}.storage-money-label[data-v-62b84623]{font-size:15px;min-width:35px}.storage-name[data-v-62b84623]{font-size:15px}.storage-money[data-v-62b84623]{font-size:15px}.storage-money-input[data-v-62b84623]{font-size:15px;width:70px}.storage-edit-actions[data-v-62b84623]{gap:6px}.storage-description[data-v-62b84623]{font-size:12px}.storage-actions[data-v-62b84623]{gap:6px}.edit-storage-button[data-v-62b84623],.delete-storage-button[data-v-62b84623]{padding:5px 10px;font-size:11px}.storage-id-input[data-v-62b84623],.storage-name-input[data-v-62b84623],.storage-money-input[data-v-62b84623]{font-size:13px;padding:3px 6px}.storage-id-input[data-v-62b84623]{width:40px}.storage-name-input[data-v-62b84623]{width:100px}.parent-select[data-v-62b84623],.item-select[data-v-62b84623]{font-size:12px;padding:3px 6px}.selected-inventory-item[data-v-62b84623]{padding:3px 6px}.item-name[data-v-62b84623]{font-size:12px}.item-quantity-input[data-v-62b84623]{width:50px;font-size:11px;padding:2px 3px}.inventory-item-tag[data-v-62b84623],.storage-parent-tag[data-v-62b84623]{font-size:12px;padding:2px 6px}.storage-description-input[data-v-62b84623]{font-size:12px;padding:4px 6px;min-height:50px}.confirm-button[data-v-62b84623],.cancel-button[data-v-62b84623]{padding:5px 10px;font-size:11px}}','']);const i=l},7502:(e,t,a)=>{var n=a(1332);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('ac95d1d8',n,!1,{ssrId:!0})},7807:(e,t,a)=>{var n=a(8661);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('2193c2ce',n,!1,{ssrId:!0})},8093:e=>{e.exports=function(e){return e[1]}},8131:(e,t,a)=>{var n=a(8733);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('6350f039',n,!1,{ssrId:!0})},8607:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.fold-bar[data-v-112e8be8]{background:rgba(0,0,0,0);border:none;border-radius:0;box-shadow:none;font-size:14px;font-weight:500;color:#e0e0e0;padding:0;margin:0}.fold-bar-header[data-v-112e8be8]{margin-bottom:0;padding-bottom:0;display:flex;align-items:center;justify-content:flex-start;position:relative}.fold-bar-header-actions[data-v-112e8be8]{display:flex;align-items:center;gap:8px;position:absolute;right:0;top:0;bottom:0}.fold-bar-btn[data-v-112e8be8]{cursor:pointer;display:flex;align-items:center;background:#333;border:1px solid #404040;border-bottom:none;flex:1;text-align:left;color:#e0e0e0;font-size:14px;font-weight:500;padding:6px 12px;border-radius:0}.fold-bar-title-actions[data-v-112e8be8]{display:flex;align-items:center;gap:4px;margin-left:auto;margin-right:8px}.fold-bar-btn[data-v-112e8be8]:hover{background:#404040}.fold-bar-btn[data-v-112e8be8]:focus{outline:none}.fold-bar-toggle-icon[data-v-112e8be8]{margin-left:8px;flex-shrink:0;font-size:12px;color:#b0b0b0;transition:transform .3s ease}.fold-bar-toggle-icon[data-v-112e8be8]::before{content:"â–¼"}.fold-bar-toggle-icon.open[data-v-112e8be8]{transform:rotate(180deg)}.fold-bar-content[data-v-112e8be8]{max-height:0;overflow:hidden;transition:max-height .3s ease;background:#1a1a1a;border:1px solid #404040;border-top:none;padding:0}.fold-bar-content.open[data-v-112e8be8]{overflow-y:auto;scrollbar-width:none;-ms-overflow-style:none}.fold-bar-content.open[data-v-112e8be8]::-webkit-scrollbar{display:none}.fold-bar-content-text[data-v-112e8be8]{padding:0 12px}.fold-bar-footer-toggle[data-v-112e8be8]{text-align:center;color:#888;font-size:12px;cursor:pointer;margin-top:8px;padding:8px 12px;border-top:1px solid #404040;background:#333}.fold-bar-footer-toggle[data-v-112e8be8]:hover{color:#b0b0b0;background:#404040}@media (max-width:768px){.fold-bar-btn[data-v-112e8be8]{font-size:12px}.fold-bar-footer-toggle[data-v-112e8be8]{font-size:11px}}','']);const i=l},8661:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.start-container[data-v-ef5b3c42]{color:#e0e0e0;max-width:1000px;margin:0 0;padding:16px}.start-container h3[data-v-ef5b3c42]{color:#007acc;margin-bottom:24px;font-size:20px}.section[data-v-ef5b3c42]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.section .input-group[data-v-ef5b3c42],.section .datetime-group[data-v-ef5b3c42]{margin-bottom:16px}.section .input-group[data-v-ef5b3c42]:last-child,.section .datetime-group[data-v-ef5b3c42]:last-child{margin-bottom:0}.section .input-group label[data-v-ef5b3c42],.section .datetime-group label[data-v-ef5b3c42]{display:block;margin-bottom:6px;color:#b0b0b0;font-weight:500;font-size:13px}.section .datetime-inputs[data-v-ef5b3c42]{display:flex;gap:8px;flex-wrap:wrap}.section .datetime-inputs .datetime-input[data-v-ef5b3c42]{display:flex;align-items:center;gap:4px}.section .datetime-inputs .datetime-input .form-input[data-v-ef5b3c42]{width:80px;text-align:center}.section .datetime-inputs .datetime-input .unit[data-v-ef5b3c42]{color:#b0b0b0;font-size:12px;font-weight:500;min-width:12px}.section .form-input[data-v-ef5b3c42],.section .form-textarea[data-v-ef5b3c42]{width:100%;padding:8px 12px;background:#2a2a2a;border:1px solid #404040;border-radius:4px;color:#e0e0e0;font-size:14px;font-family:inherit;transition:all .2s ease}.section .form-input[data-v-ef5b3c42]:focus,.section .form-textarea[data-v-ef5b3c42]:focus{outline:none;border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.section .form-input[data-v-ef5b3c42]::placeholder,.section .form-textarea[data-v-ef5b3c42]::placeholder{color:#666}.section .form-textarea[data-v-ef5b3c42]{resize:vertical;min-height:60px;line-height:1.4}.item-actions[data-v-ef5b3c42]{display:flex;gap:8px;margin-top:12px}.item-actions .action-btn[data-v-ef5b3c42]{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;min-width:0}.settings-actions[data-v-ef5b3c42]{display:flex;gap:8px;margin-top:20px}.settings-actions .action-btn[data-v-ef5b3c42]{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;min-width:0}.settings-actions .import[data-v-ef5b3c42]{display:flex;align-items:center;justify-content:center}.start-action[data-v-ef5b3c42]{margin-top:20px;display:flex;justify-content:center}.start-action .action-btn[data-v-ef5b3c42]{min-width:120px;padding:12px 24px;font-size:16px;font-weight:600}.generated-result[data-v-ef5b3c42]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-ef5b3c42]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-ef5b3c42]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word;white-space:pre-wrap}.generated-result .replace-btn[data-v-ef5b3c42]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-ef5b3c42]:hover{background-color:#218838}.action-btn[data-v-ef5b3c42]{padding:8px 16px;border:1px solid #555;background:#2a2a2a;color:#e0e0e0;border-radius:4px;cursor:pointer;font-size:13px;font-weight:500;transition:all .2s ease}.action-btn[data-v-ef5b3c42]:hover{background:#404040;border-color:#777}.action-btn.generate[data-v-ef5b3c42]{background-color:#28a745;border-color:#28a745;color:#fff}.action-btn.generate[data-v-ef5b3c42]:hover:not(:disabled){background-color:#218838;transform:translateY(-1px)}.action-btn.generate[data-v-ef5b3c42]:active{transform:translateY(0)}.action-btn.generate[data-v-ef5b3c42]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.apply[data-v-ef5b3c42]{background:linear-gradient(135deg,#28a745,#20c997);border-color:#28a745;color:#fff}.action-btn.apply[data-v-ef5b3c42]:hover:not(:disabled){background:linear-gradient(135deg,#218838,#1aa085);transform:translateY(-1px)}.action-btn.apply[data-v-ef5b3c42]:active{transform:translateY(0)}.action-btn.apply[data-v-ef5b3c42]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.apply-all[data-v-ef5b3c42]{background:linear-gradient(135deg,#007acc,#005999);border-color:#007acc;color:#fff}.action-btn.apply-all[data-v-ef5b3c42]:hover:not(:disabled){background:linear-gradient(135deg,#005999,#004477);transform:translateY(-1px)}.action-btn.apply-all[data-v-ef5b3c42]:active{transform:translateY(0)}.action-btn.apply-all[data-v-ef5b3c42]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.start[data-v-ef5b3c42]{background:linear-gradient(135deg,#28a745,#20c997);border-color:#28a745;color:#fff;box-shadow:0 2px 4px rgba(40,167,69,.3)}.action-btn.start[data-v-ef5b3c42]:hover:not(:disabled){background:linear-gradient(135deg,#218838,#1aa085);transform:translateY(-1px);box-shadow:0 4px 8px rgba(40,167,69,.4)}.action-btn.start[data-v-ef5b3c42]:active{transform:translateY(0)}.action-btn.start[data-v-ef5b3c42]:disabled{background:linear-gradient(135deg,#444,#333);border-color:#555;color:#888;box-shadow:none;cursor:not-allowed;transform:none;opacity:.6}.action-btn.start[data-v-ef5b3c42]:disabled::before{content:"ðŸ”’";margin-right:8px}.action-btn.export[data-v-ef5b3c42]{background:linear-gradient(135deg,#007acc,#005999);border-color:#007acc;color:#fff}.action-btn.export[data-v-ef5b3c42]:hover{background:linear-gradient(135deg,#005999,#004477);transform:translateY(-1px)}.action-btn.export[data-v-ef5b3c42]:active{transform:translateY(0)}.action-btn.import[data-v-ef5b3c42]{background:linear-gradient(135deg,#ffc107,#e0a800);border-color:#ffc107;color:#212529;cursor:pointer}.action-btn.import[data-v-ef5b3c42]:hover{background:linear-gradient(135deg,#e0a800,#d39e00);transform:translateY(-1px)}.action-btn.import[data-v-ef5b3c42]:active{transform:translateY(0)}@media (max-width:768px){.start-container[data-v-ef5b3c42]{padding:16px}.section[data-v-ef5b3c42]{padding:16px}.section .datetime-inputs[data-v-ef5b3c42]{gap:6px}.section .datetime-inputs .datetime-input .form-input[data-v-ef5b3c42]{width:70px}.section .datetime-inputs .datetime-input .unit[data-v-ef5b3c42]{font-size:11px;min-width:10px}.item-actions[data-v-ef5b3c42]{gap:6px}.item-actions .action-btn[data-v-ef5b3c42]{padding:6px 12px;font-size:12px}.settings-actions[data-v-ef5b3c42]{gap:6px}.settings-actions .action-btn[data-v-ef5b3c42]{padding:8px 12px;font-size:13px}.completion-status[data-v-ef5b3c42]{padding:12px}.completion-status .status-item[data-v-ef5b3c42]{padding:6px 8px;margin-bottom:6px}.completion-status .status-item .status-label[data-v-ef5b3c42]{font-size:13px}.completion-status .status-item .status-value[data-v-ef5b3c42]{font-size:13px}.start-action .action-btn[data-v-ef5b3c42]{min-width:100px;padding:10px 20px;font-size:14px}}.loading-spinner[data-v-ef5b3c42]{display:inline-block;width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-ef5b3c42 1s linear infinite;flex-shrink:0}@keyframes spin-ef5b3c42{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.completion-status[data-v-ef5b3c42]{margin-top:20px;padding:16px;background-color:#2a2a2a;border-radius:12px;border:1px solid #404040}.completion-status .status-item[data-v-ef5b3c42]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;margin-bottom:8px;border-radius:6px;background-color:#1a1a1a;border:1px solid #555;transition:all .2s ease}.completion-status .status-item[data-v-ef5b3c42]:last-child{margin-bottom:0}.completion-status .status-item.completed[data-v-ef5b3c42]{background-color:#0f2a0f;border-color:#28a745}.completion-status .status-item.completed .status-label[data-v-ef5b3c42]{color:#4ade80}.completion-status .status-item.completed .status-value[data-v-ef5b3c42]{color:#28a745;font-weight:600}.completion-status .status-item[data-v-ef5b3c42]:not(.completed){background-color:#2a0f0f;border-color:#dc3545}.completion-status .status-item:not(.completed) .status-label[data-v-ef5b3c42]{color:#fca5a5}.completion-status .status-item:not(.completed) .status-value[data-v-ef5b3c42]{color:#dc3545;font-weight:600}.completion-status .status-item .status-label[data-v-ef5b3c42]{font-size:14px;font-weight:500}.completion-status .status-item .status-value[data-v-ef5b3c42]{font-size:14px}','']);const i=l},8663:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.character-tabs-container[data-v-41c909bc]{color:#e0e0e0;max-width:1000px;margin:0 auto;padding:16px}.character-tabs-container h3[data-v-41c909bc]{color:#007acc;margin-bottom:24px;font-size:20px}.character-fold-bar[data-v-41c909bc]{margin-bottom:16px}.character-fold-bar[data-v-41c909bc] .fold-bar-btn{background:linear-gradient(135deg,#2a2a2a 0%,#333333 100%);border:1px solid #555;box-shadow:0 2px 8px rgba(0,0,0,.3);padding:12px 16px;font-size:16px;font-weight:600;color:#e0e0e0;transition:all .3s ease}.character-fold-bar[data-v-41c909bc] .fold-bar-btn:hover{background:linear-gradient(135deg,#333333 0%,#404040 100%);border-color:#666;box-shadow:0 4px 12px rgba(0,0,0,.4)}.character-fold-bar[data-v-41c909bc] .fold-bar-content{background:linear-gradient(135deg,#1a1a1a 0%,#222222 100%);border:1px solid #555;border-top:none;box-shadow:0 2px 8px rgba(0,0,0,.3)}.character-fold-bar[data-v-41c909bc] .fold-bar-content-text{padding:20px}.character-fold-bar[data-v-41c909bc] .fold-bar-footer-toggle{background:linear-gradient(135deg,#2a2a2a 0%,#333333 100%);border-top:1px solid #555;color:#b0b0b0;font-size:13px;font-weight:500;padding:12px 16px;transition:all .3s ease}.character-fold-bar[data-v-41c909bc] .fold-bar-footer-toggle:hover{background:linear-gradient(135deg,#333333 0%,#404040 100%);color:#e0e0e0;border-color:#666}.character-fold-bar[data-v-41c909bc] .fold-bar-toggle-icon{color:#007acc;font-size:14px;font-weight:bold}.character-fold-bar.character-incomplete[data-v-41c909bc] .fold-bar-btn span{color:#ff6b6b !important}.remove-character-btn[data-v-41c909bc]{background:#b91c1c;border:1px solid #b91c1c;border-radius:3px;color:#fff;font-size:16px;font-weight:bold;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer}.remove-character-btn span[data-v-41c909bc]{line-height:1;margin-top:-1px}.character-info-container .section[data-v-41c909bc]{margin-bottom:16px}.section[data-v-41c909bc]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.section h4[data-v-41c909bc]{color:#b0b0b0;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.form-grid[data-v-41c909bc]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.input-group.full-width[data-v-41c909bc]{grid-column:1/-1}.input-group label[data-v-41c909bc]{display:block;margin-bottom:8px;color:#b0b0b0;font-weight:500}.text-input[data-v-41c909bc]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.text-input[data-v-41c909bc]:focus{border-color:#007acc}.text-input[data-v-41c909bc]::placeholder{color:#666}.text-area[data-v-41c909bc]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;font-family:inherit;outline:none;resize:vertical;min-height:80px;transition:border-color .2s ease}.text-area[data-v-41c909bc]:focus{border-color:#007acc}.text-area[data-v-41c909bc]::placeholder{color:#666}.birthday-inputs[data-v-41c909bc]{display:flex;gap:8px}.birthday-inputs .birthday-input[data-v-41c909bc]{flex:1;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.birthday-inputs .birthday-input[data-v-41c909bc]:focus{border-color:#007acc}.birthday-inputs .birthday-input[data-v-41c909bc]::placeholder{color:#666}.relations-list[data-v-41c909bc]{display:flex;flex-direction:column;gap:8px}.relation-item[data-v-41c909bc]{display:flex;align-items:center;flex-wrap:wrap;gap:8px;padding:12px;background:linear-gradient(135deg,#1e1e1e 0%,#252525 100%);border:1px solid #555;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.2);transition:border-color .2s ease}.relation-item[data-v-41c909bc]:hover{border-color:#666}.relation-item .relation-target[data-v-41c909bc]{color:#4fc3f7;font-weight:600;font-size:13px;flex-shrink:0;min-width:60px;padding:6px 8px;background-color:#2a2a2a;border-radius:4px;text-align:center}.relation-item .relation-input[data-v-41c909bc]{flex:1;min-width:120px;padding:10px 14px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.relation-item .relation-input[data-v-41c909bc]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.relation-item .relation-input[data-v-41c909bc]::placeholder{color:#888}.relation-item .remove-relation-btn[data-v-41c909bc]{background:linear-gradient(135deg,#dc3545 0%,#c82333 100%);border:1px solid #dc3545;border-radius:6px;color:#fff;font-size:14px;font-weight:bold;width:24px;height:24px;flex-shrink:0;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(220,53,69,.3)}.relation-item .remove-relation-btn[data-v-41c909bc]:hover{background:linear-gradient(135deg,#c82333 0%,#a02622 100%);border-color:#bd2130;transform:translateY(-1px);box-shadow:0 4px 8px rgba(220,53,69,.4)}.relation-item .remove-relation-btn[data-v-41c909bc]:active{transform:translateY(0)}.add-relation[data-v-41c909bc]{display:flex;flex-wrap:wrap;gap:8px;align-items:center;padding:12px;background:linear-gradient(135deg,#252525 0%,#2a2a2a 100%);border:1px solid #555;border-radius:8px;margin-top:12px}.add-relation .relation-select[data-v-41c909bc]{flex:1;min-width:150px;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.add-relation .relation-select[data-v-41c909bc]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.add-relation .add-relation-btn[data-v-41c909bc]{flex-shrink:0;padding:10px 16px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:6px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(40,167,69,.3)}.add-relation .add-relation-btn[data-v-41c909bc]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 8px rgba(40,167,69,.4)}.add-relation .add-relation-btn[data-v-41c909bc]:disabled{background-color:#666;border-color:#666;cursor:not-allowed;box-shadow:none;transform:none}.add-relation .add-relation-btn[data-v-41c909bc]:active{transform:translateY(0)}.inventory-list[data-v-41c909bc]{display:flex;flex-direction:column;gap:8px}.inventory-item[data-v-41c909bc]{display:flex;align-items:center;flex-wrap:wrap;gap:8px;padding:12px;background:linear-gradient(135deg,#1e1e1e 0%,#252525 100%);border:1px solid #555;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.2);transition:border-color .2s ease}.inventory-item[data-v-41c909bc]:hover{border-color:#666}.inventory-item .inventory-target[data-v-41c909bc]{color:#4fc3f7;font-weight:600;font-size:13px;flex-shrink:0;min-width:60px;padding:6px 8px;background-color:#2a2a2a;border-radius:4px;text-align:center}.inventory-item .inventory-input[data-v-41c909bc]{flex:1;min-width:120px;padding:10px 14px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.inventory-item .inventory-input[data-v-41c909bc]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.inventory-item .inventory-input[data-v-41c909bc]::placeholder{color:#888}.inventory-item .remove-inventory-btn[data-v-41c909bc]{background:linear-gradient(135deg,#dc3545 0%,#c82333 100%);border:1px solid #dc3545;border-radius:6px;color:#fff;font-size:14px;font-weight:bold;width:24px;height:24px;flex-shrink:0;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(220,53,69,.3)}.inventory-item .remove-inventory-btn[data-v-41c909bc]:hover{background:linear-gradient(135deg,#c82333 0%,#a02622 100%);border-color:#bd2130;transform:translateY(-1px);box-shadow:0 4px 8px rgba(220,53,69,.4)}.inventory-item .remove-inventory-btn[data-v-41c909bc]:active{transform:translateY(0)}.add-inventory[data-v-41c909bc]{display:flex;flex-wrap:wrap;gap:8px;align-items:center;padding:12px;background:linear-gradient(135deg,#252525 0%,#2a2a2a 100%);border:1px solid #555;border-radius:8px;margin-top:12px}.add-inventory .inventory-select[data-v-41c909bc]{flex:1;min-width:150px;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.add-inventory .inventory-select[data-v-41c909bc]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.add-inventory .quantity-input[data-v-41c909bc]{flex:1;min-width:80px;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.add-inventory .quantity-input[data-v-41c909bc]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.add-inventory .quantity-input[data-v-41c909bc]::placeholder{color:#888}.add-inventory .quantity-input[data-v-41c909bc]:disabled{background-color:#333;color:#666;cursor:not-allowed}.add-inventory .add-inventory-btn[data-v-41c909bc]{flex-shrink:0;padding:10px 16px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:6px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(40,167,69,.3)}.add-inventory .add-inventory-btn[data-v-41c909bc]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 8px rgba(40,167,69,.4)}.add-inventory .add-inventory-btn[data-v-41c909bc]:disabled{background-color:#666;border-color:#666;cursor:not-allowed;box-shadow:none;transform:none}.add-inventory .add-inventory-btn[data-v-41c909bc]:active{transform:translateY(0)}.generated-result[data-v-41c909bc]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-41c909bc]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-41c909bc]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word}.generated-result .replace-btn[data-v-41c909bc]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-41c909bc]:hover{background-color:#218838}.action-section[data-v-41c909bc]{display:flex;justify-content:space-between;gap:16px;padding:20px 0}.action-section .generate-btn[data-v-41c909bc],.action-section .apply-all-btn[data-v-41c909bc]{flex:1;max-width:none}.add-character-section[data-v-41c909bc]{display:flex;justify-content:center;padding:20px 0;margin-top:20px;border-top:1px solid #404040}.add-character-btn[data-v-41c909bc]{padding:12px 24px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px}.add-character-btn[data-v-41c909bc]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 12px rgba(40,167,69,.3)}.add-character-btn span[data-v-41c909bc]{font-size:18px;font-weight:bold}.generate-btn[data-v-41c909bc]{padding:14px 32px;background-color:#28a745;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center;gap:8px}.generate-btn[data-v-41c909bc]:hover:not(:disabled){background-color:#218838}.generate-btn[data-v-41c909bc]:disabled{background-color:#666;cursor:not-allowed}.loading-spinner[data-v-41c909bc]{width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-41c909bc 1s linear infinite}@keyframes spin-41c909bc{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.apply-all-btn[data-v-41c909bc]{padding:14px 32px;background-color:#007acc;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.apply-all-btn[data-v-41c909bc]:hover:not(:disabled){background-color:#0056b3}.apply-all-btn[data-v-41c909bc]:disabled{background-color:#666;cursor:not-allowed}@media (max-width:768px){.section[data-v-41c909bc]{padding:16px}.form-grid[data-v-41c909bc]{grid-template-columns:1fr}.input-group.full-width[data-v-41c909bc]{grid-column:1}.birthday-inputs[data-v-41c909bc]{flex-direction:column}.info-item[data-v-41c909bc]{flex-direction:column;align-items:flex-start;gap:4px}.info-item label[data-v-41c909bc]{min-width:unset}.character-tabs-container[data-v-41c909bc]{max-width:100%;margin:0}.action-section[data-v-41c909bc]{flex-direction:row;align-items:stretch;gap:12px}.action-section .generate-btn[data-v-41c909bc],.action-section .apply-all-btn[data-v-41c909bc]{flex:1;width:auto;max-width:none}.add-character-section[data-v-41c909bc]{padding:16px 0;margin-top:16px}.add-character-btn[data-v-41c909bc]{padding:10px 20px;font-size:14px}.add-character-btn span[data-v-41c909bc]{font-size:16px}.remove-character-btn[data-v-41c909bc]{width:20px;height:20px;font-size:14px}}','']);const i=l},8704:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.extra-container[data-v-09fb0ec2]{color:#e0e0e0;max-width:1000px;margin:0 0;padding:16px}.extra-container h3[data-v-09fb0ec2]{color:#007acc;margin-bottom:24px;font-size:20px}.section[data-v-09fb0ec2]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.section h4[data-v-09fb0ec2]{color:#b0b0b0;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.sortable-container[data-v-09fb0ec2]{margin-bottom:16px}.sortable-item[data-v-09fb0ec2]{margin-bottom:8px;transition:all .2s ease;position:relative}.sortable-item.dragging[data-v-09fb0ec2]{opacity:.7;transform:scale(1.02);box-shadow:0 4px 12px rgba(0,122,204,.3);z-index:1000}.sortable-item[data-v-09fb0ec2]:not(.dragging){transform:translateY(0)}.draggable-fold-bar.incomplete[data-v-09fb0ec2] .fold-bar-btn span{color:#ef4444 !important}.drop-indicator[data-v-09fb0ec2]{height:4px;background:linear-gradient(90deg,#007acc,#005999);border-radius:2px;margin:4px 0;box-shadow:0 0 8px rgba(0,122,204,.6);animation:pulse-09fb0ec2 1.5s ease-in-out infinite;position:relative}.drop-indicator[data-v-09fb0ec2]::before{content:"";position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:8px;height:8px;background:#007acc;border-radius:50%;box-shadow:0 0 12px rgba(0,122,204,.8)}@keyframes pulse-09fb0ec2{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.7;transform:scale(1.1)}}.fold-content[data-v-09fb0ec2]{padding:12px 0}.fold-content .input-group[data-v-09fb0ec2]{margin-bottom:16px}.fold-content .input-group[data-v-09fb0ec2]:last-child{margin-bottom:0}.fold-content .input-group label[data-v-09fb0ec2]{display:block;margin-bottom:6px;color:#b0b0b0;font-weight:500;font-size:13px}.fold-content .input-group .form-input[data-v-09fb0ec2],.fold-content .input-group .form-textarea[data-v-09fb0ec2]{width:100%;padding:8px 12px;background:#2a2a2a;border:1px solid #404040;border-radius:4px;color:#e0e0e0;font-size:14px;font-family:inherit;transition:all .2s ease}.fold-content .input-group .form-input[data-v-09fb0ec2]:focus,.fold-content .input-group .form-textarea[data-v-09fb0ec2]:focus{outline:none;border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.fold-content .input-group .form-input[data-v-09fb0ec2]::placeholder,.fold-content .input-group .form-textarea[data-v-09fb0ec2]::placeholder{color:#666}.fold-content .input-group .form-textarea[data-v-09fb0ec2]{resize:vertical;min-height:60px;line-height:1.4}.item-actions[data-v-09fb0ec2]{display:flex;gap:8px;margin-top:12px}.item-actions .action-btn[data-v-09fb0ec2]{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;min-width:0}.generated-result[data-v-09fb0ec2]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-09fb0ec2]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-09fb0ec2]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word;white-space:pre-wrap}.generated-result .replace-btn[data-v-09fb0ec2]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-09fb0ec2]:hover{background-color:#218838}.remove-btn[data-v-09fb0ec2]{background:#b91c1c;border:1px solid #b91c1c;border-radius:3px;color:#fff;font-size:16px;font-weight:bold;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer}.remove-btn span[data-v-09fb0ec2]{line-height:1;margin-top:-1px}.action-btn[data-v-09fb0ec2]{padding:8px 16px;border:1px solid #555;background:#2a2a2a;color:#e0e0e0;border-radius:4px;cursor:pointer;font-size:13px;font-weight:500;transition:all .2s ease}.action-btn[data-v-09fb0ec2]:hover{background:#404040;border-color:#777}.action-btn.generate[data-v-09fb0ec2]{background:linear-gradient(135deg,#007acc,#005999);border-color:#007acc;color:#fff}.action-btn.generate[data-v-09fb0ec2]:hover:not(:disabled){background:linear-gradient(135deg,#005999,#004477);transform:translateY(-1px)}.action-btn.generate[data-v-09fb0ec2]:active{transform:translateY(0)}.action-btn.generate[data-v-09fb0ec2]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.apply[data-v-09fb0ec2]{background:linear-gradient(135deg,#28a745,#20c997);border-color:#28a745;color:#fff}.action-btn.apply[data-v-09fb0ec2]:hover:not(:disabled){background:linear-gradient(135deg,#218838,#1aa085);transform:translateY(-1px)}.action-btn.apply[data-v-09fb0ec2]:active{transform:translateY(0)}.action-btn.apply[data-v-09fb0ec2]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.delete[data-v-09fb0ec2]{background:#3a1a1a;border-color:#622}.action-btn.delete[data-v-09fb0ec2]:hover{background:#622}.add-item-section[data-v-09fb0ec2]{text-align:center;margin-top:16px}.add-btn[data-v-09fb0ec2]{padding:10px 20px;background:linear-gradient(135deg,#007acc,#005999);border:none;color:#fff;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s ease}.add-btn[data-v-09fb0ec2]:hover{background:linear-gradient(135deg,#005999,#004477);transform:translateY(-1px)}.add-btn[data-v-09fb0ec2]:active{transform:translateY(0)}@media (max-width:768px){.extra-container[data-v-09fb0ec2]{padding:16px}.section[data-v-09fb0ec2]{padding:16px}.item-actions[data-v-09fb0ec2]{gap:6px}.item-actions .action-btn[data-v-09fb0ec2]{padding:6px 12px;font-size:12px}.add-btn[data-v-09fb0ec2]{width:100%}}.loading-spinner[data-v-09fb0ec2]{display:inline-block;width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-09fb0ec2 1s linear infinite;flex-shrink:0}@keyframes spin-09fb0ec2{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}','']);const i=l},8733:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.promise-tab-container[data-v-25ffb8d9]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.promise-content[data-v-25ffb8d9]{flex:1;padding:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--v592213a0);max-height:var(--v592213a0)}.promise-content[data-v-25ffb8d9]::-webkit-scrollbar{width:8px}.promise-content[data-v-25ffb8d9]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.promise-content[data-v-25ffb8d9]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.promise-content[data-v-25ffb8d9]::-webkit-scrollbar-thumb:hover{background:#666}.promise-section[data-v-25ffb8d9]:last-child{margin-bottom:0}.section-title[data-v-25ffb8d9]{font-size:18px;font-weight:600;color:#007acc;margin:0 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.add-promise-button[data-v-25ffb8d9]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff;margin-top:12px}.add-promise-button[data-v-25ffb8d9]:hover{background:#005a99}.promise-list[data-v-25ffb8d9]{display:flex;flex-direction:column;gap:8px}.promise-row[data-v-25ffb8d9]{background:#252525;padding:12px 16px;border-radius:8px;border:1px solid #404040;display:flex;flex-direction:column;gap:8px;font-size:14px;transition:background-color .2s}.promise-row[data-v-25ffb8d9]:hover{background:#2a2a2a;border-color:#555}.new-promise-row[data-v-25ffb8d9]{background:#2a2a2a;border-color:#007acc;border-style:dashed}.promise-first-row[data-v-25ffb8d9]{display:flex;justify-content:space-between;align-items:center;gap:12px}.promise-location-row[data-v-25ffb8d9]{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-top:6px}.promise-location-group[data-v-25ffb8d9]{display:flex;align-items:center;gap:8px}.promise-location-label[data-v-25ffb8d9]{font-weight:500;color:#a0a0a0;font-size:13px;min-width:40px}.promise-edit-actions[data-v-25ffb8d9]{display:flex;gap:8px}.promise-id-name-group[data-v-25ffb8d9]{display:flex;gap:12px;align-items:center;flex:1}.promise-id[data-v-25ffb8d9]{font-weight:500;color:#007acc;font-size:14px}.promise-location[data-v-25ffb8d9]{font-weight:500;color:#fff;font-size:16px}.promise-location-input[data-v-25ffb8d9]{font-weight:500;color:#fff;font-size:16px;width:200px;flex-shrink:0}.promise-location-input-edit[data-v-25ffb8d9]{background:#333;border:1px solid #555;border-radius:4px;padding:4px 8px}.promise-location-input-edit[data-v-25ffb8d9]:focus{outline:none;border-color:#007acc}.promise-deadline[data-v-25ffb8d9]{font-weight:500;color:#4caf50;font-size:14px;flex-shrink:0}.promise-character-ids-display[data-v-25ffb8d9]{display:flex;flex-wrap:wrap;gap:4px}.promise-character-id-tag[data-v-25ffb8d9]{background:#007acc;color:#fff;padding:3px 8px;border-radius:4px;font-size:11px;display:flex;align-items:center;gap:4px}.promise-description[data-v-25ffb8d9]{color:#a0a0a0;line-height:1.4;font-size:13px}.promise-actions[data-v-25ffb8d9]{display:flex;gap:8px}.edit-promise-button[data-v-25ffb8d9],.delete-promise-button[data-v-25ffb8d9]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.edit-promise-button[data-v-25ffb8d9]{background:#007acc;color:#fff}.edit-promise-button[data-v-25ffb8d9]:hover{background:#005a99}.delete-promise-button[data-v-25ffb8d9]{background:#f44336;color:#fff}.delete-promise-button[data-v-25ffb8d9]:hover{background:#da190b}.promise-id-input[data-v-25ffb8d9],.promise-deadline-input[data-v-25ffb8d9],.promise-character-ids-input[data-v-25ffb8d9]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:14px;padding:4px 8px;width:35px;-webkit-appearance:none;appearance:none;appearance:none}.promise-id-input[data-v-25ffb8d9]:focus,.promise-deadline-input[data-v-25ffb8d9]:focus,.promise-character-ids-input[data-v-25ffb8d9]:focus{outline:none;border-color:#007acc}.promise-id-input[data-v-25ffb8d9]::-webkit-outer-spin-button,.promise-id-input[data-v-25ffb8d9]::-webkit-inner-spin-button,.promise-deadline-input[data-v-25ffb8d9]::-webkit-outer-spin-button,.promise-deadline-input[data-v-25ffb8d9]::-webkit-inner-spin-button,.promise-character-ids-input[data-v-25ffb8d9]::-webkit-outer-spin-button,.promise-character-ids-input[data-v-25ffb8d9]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.promise-id-input[type=number][data-v-25ffb8d9],.promise-deadline-input[type=number][data-v-25ffb8d9],.promise-character-ids-input[type=number][data-v-25ffb8d9]{-webkit-appearance:textfield;appearance:textfield}.promise-id-input[data-v-25ffb8d9]{font-weight:500;color:#007acc;font-size:14px;width:50px;flex-shrink:0;text-align:center}.promise-deadline-input[data-v-25ffb8d9]{color:#4caf50;text-align:center}.promise-deadline-year-input[data-v-25ffb8d9]{width:60px}.promise-deadline-input-group[data-v-25ffb8d9]{display:flex;gap:4px;flex-shrink:0;font-weight:500;color:#4caf50;font-size:14px}.promise-deadline-year[data-v-25ffb8d9],.promise-deadline-month[data-v-25ffb8d9],.promise-deadline-day[data-v-25ffb8d9],.promise-deadline-hour[data-v-25ffb8d9],.promise-deadline-minute[data-v-25ffb8d9]{background:#333;border:1px solid #555;border-radius:4px;color:#4caf50;font-size:12px;padding:4px 6px;width:45px;text-align:center}.promise-deadline-year[data-v-25ffb8d9]:focus,.promise-deadline-month[data-v-25ffb8d9]:focus,.promise-deadline-day[data-v-25ffb8d9]:focus,.promise-deadline-hour[data-v-25ffb8d9]:focus,.promise-deadline-minute[data-v-25ffb8d9]:focus{outline:none;border-color:#007acc}.promise-location-input[data-v-25ffb8d9]{font-weight:500;color:#fff;font-size:16px;width:200px;flex-shrink:0}.promise-character-ids-input-group[data-v-25ffb8d9]{display:flex;flex-direction:column;gap:6px}.selected-characters[data-v-25ffb8d9]{display:flex;flex-wrap:wrap;gap:4px}.selected-character-tag[data-v-25ffb8d9]{background:#007acc;color:#fff;padding:3px 8px;border-radius:4px;font-size:11px;display:flex;align-items:center;gap:4px}.remove-character-btn[data-v-25ffb8d9]{background:none;border:none;color:#fff;cursor:pointer;font-size:14px;line-height:1;padding:0;margin-left:2px}.remove-character-btn[data-v-25ffb8d9]:hover{color:#ccc}.character-select[data-v-25ffb8d9]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:4px 8px}.character-select[data-v-25ffb8d9]:focus{outline:none;border-color:#007acc}.promise-description-input[data-v-25ffb8d9]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:6px 8px;resize:vertical;min-height:60px;line-height:1.4;width:100%}.promise-description-input[data-v-25ffb8d9]:focus{outline:none;border-color:#007acc}.confirm-button[data-v-25ffb8d9],.cancel-button[data-v-25ffb8d9]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.confirm-button[data-v-25ffb8d9]{background:#4caf50;color:#fff}.confirm-button[data-v-25ffb8d9]:hover{background:#45a049}.cancel-button[data-v-25ffb8d9]{background:#f44336;color:#fff}.cancel-button[data-v-25ffb8d9]:hover{background:#da190b}.no-promises-message[data-v-25ffb8d9]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}@media (max-width:768px){.promise-content[data-v-25ffb8d9]{padding:12px}.section-title[data-v-25ffb8d9]{font-size:18px}.promise-row[data-v-25ffb8d9]{padding:10px 12px;gap:6px}.promise-first-row[data-v-25ffb8d9]{gap:8px}.promise-location-row[data-v-25ffb8d9]{gap:6px;margin-top:4px}.promise-location-group[data-v-25ffb8d9]{gap:6px}.promise-location-label[data-v-25ffb8d9]{font-size:12px;min-width:35px}.promise-location[data-v-25ffb8d9]{font-size:15px}.promise-location-input[data-v-25ffb8d9]{font-size:15px;width:200px}.promise-edit-actions[data-v-25ffb8d9]{gap:6px}.promise-description[data-v-25ffb8d9]{font-size:12px}.promise-actions[data-v-25ffb8d9]{gap:6px}.edit-promise-button[data-v-25ffb8d9],.delete-promise-button[data-v-25ffb8d9]{padding:5px 10px;font-size:11px}.promise-id-input[data-v-25ffb8d9],.promise-deadline-input[data-v-25ffb8d9],.promise-location-input[data-v-25ffb8d9]{font-size:13px;padding:3px 6px}.promise-deadline-year-input[data-v-25ffb8d9]{width:50px}.promise-deadline-year[data-v-25ffb8d9],.promise-deadline-month[data-v-25ffb8d9],.promise-deadline-day[data-v-25ffb8d9],.promise-deadline-hour[data-v-25ffb8d9],.promise-deadline-minute[data-v-25ffb8d9]{font-size:11px;padding:3px 4px;width:35px}.character-select[data-v-25ffb8d9]{font-size:12px;padding:3px 6px}.selected-character-tag[data-v-25ffb8d9],.promise-character-id-tag[data-v-25ffb8d9]{font-size:10px;padding:1px 4px}.promise-description-input[data-v-25ffb8d9]{font-size:12px;padding:4px 6px;min-height:50px}.confirm-button[data-v-25ffb8d9],.cancel-button[data-v-25ffb8d9]{padding:5px 10px;font-size:11px}}','']);const i=l},8933:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.world-info-container[data-v-ee3aed0a]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.world-info-content[data-v-ee3aed0a]{flex:1;padding:12px;gap:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--ae590e90);max-height:var(--ae590e90)}.world-info-content[data-v-ee3aed0a]::-webkit-scrollbar{width:8px}.world-info-content[data-v-ee3aed0a]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.world-info-content[data-v-ee3aed0a]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.world-info-content[data-v-ee3aed0a]::-webkit-scrollbar-thumb:hover{background:#666}.section[data-v-ee3aed0a]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.section h4[data-v-ee3aed0a]{color:#b0b0b0;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.sortable-container[data-v-ee3aed0a]{margin-bottom:16px}.sortable-item[data-v-ee3aed0a]{margin-bottom:8px;transition:all .2s ease;position:relative}.sortable-item.dragging[data-v-ee3aed0a]{opacity:.7;transform:scale(1.02);box-shadow:0 4px 12px rgba(0,122,204,.3);z-index:1000}.sortable-item[data-v-ee3aed0a]:not(.dragging){transform:translateY(0)}.draggable-fold-bar.incomplete[data-v-ee3aed0a] .fold-bar-btn span{color:#ef4444 !important}.drop-indicator[data-v-ee3aed0a]{height:4px;background:linear-gradient(90deg,#007acc,#005999);border-radius:2px;margin:4px 0;box-shadow:0 0 8px rgba(0,122,204,.6);animation:pulse-ee3aed0a 1.5s ease-in-out infinite;position:relative}.drop-indicator[data-v-ee3aed0a]::before{content:"";position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:8px;height:8px;background:#007acc;border-radius:50%;box-shadow:0 0 12px rgba(0,122,204,.8)}@keyframes pulse-ee3aed0a{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.7;transform:scale(1.1)}}.fold-content[data-v-ee3aed0a]{padding:12px 0}.fold-content .input-group[data-v-ee3aed0a]{margin-bottom:16px}.fold-content .input-group[data-v-ee3aed0a]:last-child{margin-bottom:0}.fold-content .input-group label[data-v-ee3aed0a]{display:block;margin-bottom:6px;color:#b0b0b0;font-weight:500;font-size:13px}.fold-content .input-group .form-input[data-v-ee3aed0a],.fold-content .input-group .form-textarea[data-v-ee3aed0a]{width:100%;padding:8px 12px;background:#2a2a2a;border:1px solid #404040;border-radius:4px;color:#e0e0e0;font-size:14px;font-family:inherit;transition:all .2s ease}.fold-content .input-group .form-input[data-v-ee3aed0a]:focus,.fold-content .input-group .form-textarea[data-v-ee3aed0a]:focus{outline:none;border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.fold-content .input-group .form-input[data-v-ee3aed0a]::placeholder,.fold-content .input-group .form-textarea[data-v-ee3aed0a]::placeholder{color:#666}.fold-content .input-group .form-textarea[data-v-ee3aed0a]{resize:vertical;min-height:60px;line-height:1.4}.item-actions[data-v-ee3aed0a]{display:flex;gap:8px;margin-top:12px}.item-actions .action-btn[data-v-ee3aed0a]{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;min-width:0}.generated-result[data-v-ee3aed0a]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-ee3aed0a]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-ee3aed0a]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word;white-space:pre-wrap}.generated-result .replace-btn[data-v-ee3aed0a]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-ee3aed0a]:hover{background-color:#218838}.remove-btn[data-v-ee3aed0a]{background:#b91c1c;border:1px solid #b91c1c;border-radius:3px;color:#fff;font-size:16px;font-weight:bold;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer}.remove-btn span[data-v-ee3aed0a]{line-height:1;margin-top:-1px}.action-btn[data-v-ee3aed0a]{padding:8px 16px;border:1px solid #555;background:#2a2a2a;color:#e0e0e0;border-radius:4px;cursor:pointer;font-size:13px;font-weight:500;transition:all .2s ease}.action-btn[data-v-ee3aed0a]:hover{background:#404040;border-color:#777}.action-btn.generate[data-v-ee3aed0a]{background:linear-gradient(135deg,#007acc,#005999);border-color:#007acc;color:#fff}.action-btn.generate[data-v-ee3aed0a]:hover:not(:disabled){background:linear-gradient(135deg,#005999,#004477);transform:translateY(-1px)}.action-btn.generate[data-v-ee3aed0a]:active{transform:translateY(0)}.action-btn.generate[data-v-ee3aed0a]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.apply[data-v-ee3aed0a]{background:linear-gradient(135deg,#28a745,#20c997);border-color:#28a745;color:#fff}.action-btn.apply[data-v-ee3aed0a]:hover:not(:disabled){background:linear-gradient(135deg,#218838,#1aa085);transform:translateY(-1px)}.action-btn.apply[data-v-ee3aed0a]:active{transform:translateY(0)}.action-btn.apply[data-v-ee3aed0a]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.delete[data-v-ee3aed0a]{background:#3a1a1a;border-color:#622}.action-btn.delete[data-v-ee3aed0a]:hover{background:#622}.add-item-section[data-v-ee3aed0a]{text-align:center;margin-top:16px}.add-btn[data-v-ee3aed0a]{padding:10px 20px;background:linear-gradient(135deg,#007acc,#005999);border:none;color:#fff;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s ease}.add-btn[data-v-ee3aed0a]:hover{background:linear-gradient(135deg,#005999,#004477);transform:translateY(-1px)}.add-btn[data-v-ee3aed0a]:active{transform:translateY(0)}@media (max-width:768px){.world-info-content[data-v-ee3aed0a]{padding:12px}.section[data-v-ee3aed0a]{padding:16px}.item-actions[data-v-ee3aed0a]{gap:6px}.item-actions .action-btn[data-v-ee3aed0a]{padding:6px 12px;font-size:12px}.add-btn[data-v-ee3aed0a]{width:100%}}.loading-spinner[data-v-ee3aed0a]{display:inline-block;width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-ee3aed0a 1s linear infinite;flex-shrink:0}@keyframes spin-ee3aed0a{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}','']);const i=l},8990:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),o=a.n(n),r=a(3054),l=a.n(r)()(o());l.push([e.id,'.character-tab-container[data-v-684d53c6]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.add-character-button[data-v-684d53c6]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff;margin-top:12px}.add-character-button[data-v-684d53c6]:hover{background:#005a99}.character-content[data-v-684d53c6],.character-detail-content[data-v-684d53c6]{flex:1;padding:12px;gap:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--v1299b277);max-height:var(--v1299b277)}.character-content[data-v-684d53c6]::-webkit-scrollbar,.character-detail-content[data-v-684d53c6]::-webkit-scrollbar{width:8px}.character-content[data-v-684d53c6]::-webkit-scrollbar-track,.character-detail-content[data-v-684d53c6]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.character-content[data-v-684d53c6]::-webkit-scrollbar-thumb,.character-detail-content[data-v-684d53c6]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.character-content[data-v-684d53c6]::-webkit-scrollbar-thumb:hover,.character-detail-content[data-v-684d53c6]::-webkit-scrollbar-thumb:hover{background:#666}.character-section[data-v-684d53c6]{margin-bottom:24px}.character-section[data-v-684d53c6]:last-child{margin-bottom:0}.section-title[data-v-684d53c6]{font-size:18px;font-weight:600;color:#007acc;margin:0 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.character-list[data-v-684d53c6]{display:flex;flex-direction:column;gap:8px}.character-item[data-v-684d53c6]{background:#252525;padding:12px 16px;border-radius:8px;border:1px solid #404040;display:flex;flex-direction:row;align-items:center;gap:16px;font-size:14px;transition:background-color .2s}.character-item.clickable[data-v-684d53c6]{cursor:pointer}.character-item.clickable[data-v-684d53c6]:hover{background:#2a2a2a;border-color:#555}.toggle-status-button[data-v-684d53c6]{background:#007acc;color:#fff;border:none;border-radius:4px;width:24px;height:24px;cursor:pointer;font-size:14px;font-weight:bold;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:background-color .2s}.toggle-status-button[data-v-684d53c6]:hover{background:#005a99}.toggle-status-button[data-v-684d53c6]:active{background:#004080}.character-id[data-v-684d53c6]{color:#fff;font-weight:700;min-width:40px;text-align:center;padding:6px 10px;border-radius:6px;font-size:14px;display:flex;align-items:center;justify-content:center;height:24px;text-shadow:0 1px 2px rgba(0,0,0,.3)}.user-id[data-v-684d53c6]{color:#fff;font-weight:700;min-width:40px;text-align:center;padding:6px 10px;border-radius:6px;font-size:14px;display:flex;align-items:center;justify-content:center;height:24px;width:80px;text-shadow:0 1px 2px rgba(0,0,0,.3)}.character-name[data-v-684d53c6]{color:#e0e0e0;font-weight:500;text-align:center;flex:1}.user-name[data-v-684d53c6]{color:#e0e0e0;font-weight:500;flex:1}.character-info[data-v-684d53c6]{display:flex;flex-direction:column;gap:8px;flex-shrink:0;min-width:0;width:80px}.user-character-info[data-v-684d53c6]{flex-direction:row;align-items:center;-moz-column-gap:16px;column-gap:16px;height:auto;width:auto}.character-progress-bars[data-v-684d53c6]{display:flex;flex-direction:column;gap:4px;flex:1;min-width:0}.character-progress-bars[data-v-684d53c6] .progress-bar-wrapper{height:16px}.character-progress-bars[data-v-684d53c6] .progress-bar-value{font-size:12px}.no-characters-message[data-v-684d53c6]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}.character-header[data-v-684d53c6]{text-align:center;position:relative}.character-detail-name[data-v-684d53c6]{font-size:24px;font-weight:700;color:#007acc;margin:0;text-shadow:0 2px 4px rgba(0,0,0,.3)}.header-buttons[data-v-684d53c6]{position:absolute;top:0;left:0;display:flex;gap:8px}.edit-button[data-v-684d53c6],.delete-button[data-v-684d53c6]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff}.edit-button[data-v-684d53c6]:hover,.delete-button[data-v-684d53c6]:hover{background:#005a99}.delete-button[data-v-684d53c6]{background:#f44336}.delete-button[data-v-684d53c6]:hover{background:#da190b}.back-button[data-v-684d53c6]{position:absolute;top:0;right:0;background:#007acc;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:background-color .2s}.back-button[data-v-684d53c6]:hover{background:#005a99}.attributes-grid[data-v-684d53c6]{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;margin-bottom:20px}.attribute-item[data-v-684d53c6]{background:#252525;padding:12px;border-radius:8px;text-align:center;border:1px solid #404040}.attribute-item.full-width[data-v-684d53c6]{grid-column:1/-1;text-align:left;padding:16px}.attribute-item.horizontal[data-v-684d53c6]{display:flex;justify-content:space-between;align-items:center;text-align:left}.attribute-item.horizontal .attribute-label[data-v-684d53c6]{margin-bottom:0;flex-shrink:0}.attribute-item.horizontal .attribute-value[data-v-684d53c6]{margin-left:auto}.attribute-item.horizontal .attribute-input[data-v-684d53c6]{margin-left:8px}.attribute-item.birthday-fullwidth[data-v-684d53c6]{display:flex;justify-content:space-between;align-items:center;text-align:left}.attribute-item.birthday-fullwidth .attribute-label[data-v-684d53c6]{margin-bottom:0;flex-shrink:0}.attribute-item.birthday-fullwidth .attribute-value[data-v-684d53c6]{margin-left:auto}.attribute-item.birthday-fullwidth .birthday-edit-container[data-v-684d53c6]{margin-left:auto;justify-content:flex-end}.attribute-item.mood-horny-layout[data-v-684d53c6]{display:flex;justify-content:space-between;align-items:center;text-align:left}.attribute-item.mood-horny-layout .attribute-label[data-v-684d53c6]{margin-bottom:0;flex-shrink:0}.attribute-item.mood-horny-layout .attribute-value[data-v-684d53c6]{margin-left:auto}.attribute-item.mood-horny-layout .attribute-input[data-v-684d53c6]{margin-left:auto;width:auto;min-width:80px}.attribute-item .progress-edit-container[data-v-684d53c6]{display:flex;justify-content:space-between;align-items:center;gap:12px}.attribute-item .progress-edit-container .attribute-label[data-v-684d53c6]{margin-bottom:0;flex-shrink:0}.attribute-item .progress-edit-container .attribute-input[data-v-684d53c6]{width:auto;min-width:80px}.attribute-label[data-v-684d53c6]{display:block;font-size:12px;color:#888;margin-bottom:6px;text-transform:uppercase;letter-spacing:.5px;font-weight:500}.attribute-label.unit-label[data-v-684d53c6]{text-transform:none}.required-asterisk[data-v-684d53c6]{color:#f44336;font-weight:bold;margin-left:2px}.attribute-value[data-v-684d53c6]{display:block;font-size:16px;font-weight:600;color:#e0e0e0}.attribute-value.money[data-v-684d53c6]{color:#4caf50;font-weight:700}.attribute-value.no-bold[data-v-684d53c6]{font-weight:400}.relations-section[data-v-684d53c6],.inventory-section[data-v-684d53c6],.friendships-section[data-v-684d53c6],.loves-section[data-v-684d53c6]{margin-bottom:16px}.relations-section[data-v-684d53c6]:last-child,.inventory-section[data-v-684d53c6]:last-child,.friendships-section[data-v-684d53c6]:last-child,.loves-section[data-v-684d53c6]:last-child{margin-bottom:0}.list-container[data-v-684d53c6],.relations-list[data-v-684d53c6],.inventory-list[data-v-684d53c6],.friendships-list[data-v-684d53c6],.loves-list[data-v-684d53c6],.relations-edit-list[data-v-684d53c6],.inventory-edit-list[data-v-684d53c6],.friendships-edit-list[data-v-684d53c6],.loves-edit-list[data-v-684d53c6]{display:flex;flex-direction:column;gap:8px}.relation-item[data-v-684d53c6]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;font-size:14px;color:#e0e0e0;line-height:1.4}.friendship-item[data-v-684d53c6],.love-item[data-v-684d53c6]{background:#252525;padding:12px;border-radius:6px;border:1px solid #404040;display:flex;flex-direction:row;align-items:center;gap:12px}.relation-highlight[data-v-684d53c6]{color:#fff;font-weight:500}.friendship-name[data-v-684d53c6],.love-name[data-v-684d53c6]{font-size:14px;color:#e0e0e0;line-height:1.4;white-space:nowrap;flex-shrink:0}.friendship-highlight[data-v-684d53c6],.love-highlight[data-v-684d53c6]{color:#fff;font-weight:500}.connector[data-v-684d53c6]{color:#888;font-weight:400}.edit-item[data-v-684d53c6]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;display:flex;align-items:center;gap:8px;flex-wrap:wrap}.edit-connector[data-v-684d53c6]{color:#888;font-weight:400;font-size:14px;white-space:nowrap}.input-field[data-v-684d53c6]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;flex:1;min-width:50px}.input-field[data-v-684d53c6]:focus{outline:none;border-color:#007acc}.relation-select[data-v-684d53c6],.inventory-select[data-v-684d53c6]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;min-width:120px;flex-shrink:0}.relation-select[data-v-684d53c6]:focus,.inventory-select[data-v-684d53c6]:focus{outline:none;border-color:#007acc}.relation-select option[data-v-684d53c6],.inventory-select option[data-v-684d53c6]{background:#333;color:#e0e0e0}.relation-select option[data-v-684d53c6]:disabled,.inventory-select option[data-v-684d53c6]:disabled{color:#888;font-style:italic}.btn[data-v-684d53c6],.action-btn[data-v-684d53c6],.relation-remove-btn[data-v-684d53c6],.add-relation-btn[data-v-684d53c6],.friendship-remove-btn[data-v-684d53c6],.add-friendship-btn[data-v-684d53c6],.love-remove-btn[data-v-684d53c6],.add-love-btn[data-v-684d53c6],.add-inventory-btn[data-v-684d53c6]{background:#007acc;color:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;margin-top:8px;transition:background-color .2s}.btn[data-v-684d53c6]:hover,.action-btn[data-v-684d53c6]:hover,.relation-remove-btn[data-v-684d53c6]:hover,.add-relation-btn[data-v-684d53c6]:hover,.friendship-remove-btn[data-v-684d53c6]:hover,.add-friendship-btn[data-v-684d53c6]:hover,.love-remove-btn[data-v-684d53c6]:hover,.add-love-btn[data-v-684d53c6]:hover,.add-inventory-btn[data-v-684d53c6]:hover{background:#005a99}.inventory-item[data-v-684d53c6]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;display:flex;flex-direction:column;gap:6px}.inventory-first-row[data-v-684d53c6]{display:flex;justify-content:space-between;align-items:center}.item-name-id[data-v-684d53c6]{font-weight:500;color:#fff;font-size:14px}.item-quantity[data-v-684d53c6]{font-weight:600;color:#e0e0e0;background:#007acc;padding:2px 8px;border-radius:12px;font-size:12px}.storage-indicator[data-v-684d53c6]{font-weight:600;color:#fff;background:#4caf50;padding:2px 8px;border-radius:12px;font-size:12px}[data-v-684d53c6] .inventory-item-tag{background:#4caf50;color:#fff;padding:2px 6px;border-radius:4px;font-size:12px;display:flex;align-items:center;gap:4px;white-space:nowrap;flex-shrink:0}[data-v-684d53c6] .storage-item-tag{background:#ff9800;color:#fff;padding:2px 6px;border-radius:4px;font-size:12px;display:flex;align-items:center;gap:4px;white-space:nowrap;flex-shrink:0}.inventory-second-row[data-v-684d53c6]{font-size:12px;color:#a0a0a0;line-height:1.4}.inventory-third-row[data-v-684d53c6]{display:flex;flex-direction:column;gap:4px}.no-inventory[data-v-684d53c6]{color:#888;font-style:italic;font-size:13px}.inventory-items[data-v-684d53c6]{display:flex;flex-wrap:wrap;gap:4px}.inventory-edit-item[data-v-684d53c6]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;display:flex;align-items:center;gap:8px;flex-wrap:wrap}.inventory-edit-connector[data-v-684d53c6]{color:#888;font-weight:400;font-size:14px;white-space:nowrap}.inventory-quantity-input[data-v-684d53c6]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;width:80px;text-align:center}.inventory-quantity-input[data-v-684d53c6]:focus{outline:none;border-color:#007acc}.inventory-remove-btn[data-v-684d53c6]{background:#f44336;color:#fff;border:none;border-radius:4px;width:24px;height:24px;cursor:pointer;font-size:16px;font-weight:bold;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-left:auto}.inventory-remove-btn[data-v-684d53c6]:hover{background:#da190b}.attribute-input[data-v-684d53c6]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;width:100%}.attribute-input[data-v-684d53c6]:focus{outline:none;border-color:#007acc}.birthday-inputs[data-v-684d53c6]{display:flex;align-items:center;gap:2px;width:auto;margin-left:auto}.birthday-edit-container[data-v-684d53c6]{display:flex;justify-content:flex-start;width:100%}.birthday-input-group[data-v-684d53c6]{display:flex;align-items:center;gap:4px;padding:4px 0}.birthday-month[data-v-684d53c6],.birthday-date[data-v-684d53c6]{width:50px;flex-shrink:0}.birthday-separator[data-v-684d53c6]{color:#888;font-size:14px;white-space:nowrap}.attribute-textarea[data-v-684d53c6]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:8px;font-size:14px;width:100%;min-height:60px;resize:vertical;font-family:inherit}.attribute-textarea[data-v-684d53c6]:focus{outline:none;border-color:#007acc}.edit-buttons[data-v-684d53c6]{display:flex;justify-content:center;gap:16px;margin-top:20px;padding-top:20px;border-top:1px solid #404040}.confirm-button[data-v-684d53c6],.cancel-button[data-v-684d53c6]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff}.confirm-button[data-v-684d53c6]:hover,.cancel-button[data-v-684d53c6]:hover{background:#005a99}.confirm-button[data-v-684d53c6]{background:#4caf50;color:#fff}.confirm-button[data-v-684d53c6]:hover:not(:disabled){background:#45a049}.confirm-button[data-v-684d53c6]:disabled{background:#666;cursor:not-allowed;opacity:.6}.cancel-button[data-v-684d53c6]{background:#f44336;color:#fff}.cancel-button[data-v-684d53c6]:hover{background:#da190b}@media (max-width:768px){.character-content[data-v-684d53c6],.character-detail-content[data-v-684d53c6]{padding:12px}.character-name[data-v-684d53c6]{font-size:24px}.attributes-grid[data-v-684d53c6]{grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:8px}.attribute-item[data-v-684d53c6]{padding:10px}.attribute-item.full-width[data-v-684d53c6]{padding:12px}.attribute-value[data-v-684d53c6]{font-size:14px}.inventory-item[data-v-684d53c6]{gap:4px}[data-v-684d53c6] .inventory-item-tag{font-size:12px;padding:2px 6px}.inventory-third-row[data-v-684d53c6] .inventory-item-tag{font-size:12px;padding:2px 6px}.character-item[data-v-684d53c6]{padding:10px 12px;gap:12px;flex-wrap:wrap}.user-character-info[data-v-684d53c6]{-moz-column-gap:16px;column-gap:16px;height:auto}.character-progress-bars[data-v-684d53c6]{gap:2px;flex:1;min-width:120px}.character-id[data-v-684d53c6]{min-width:35px;padding:3px 6px;font-size:11px;height:16px}.user-id[data-v-684d53c6]{min-width:35px;padding:3px 6px;font-size:11px;height:16px}.character-name[data-v-684d53c6]{font-size:13px;line-height:1.2}}.no-message[data-v-684d53c6]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}','']);const i=l},9457:(e,t,a)=>{var n=a(8607);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('36bb1569',n,!1,{ssrId:!0})},9458:(e,t,a)=>{var n=a(3548);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('5033b616',n,!1,{ssrId:!0})},9627:(e,t,a)=>{var n=a(3773);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('a70f811a',n,!1,{ssrId:!0})},9645:(e,t,a)=>{var n=a(5283);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('560689cc',n,!1,{ssrId:!0})}},l={};function i(e){var t=l[e];if(void 0!==t)return t.exports;var a=l[e]={id:e,exports:{}};return r[e](a,a.exports,i),a.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},(()=>{i(1391),i(67),i(2076);!function(){let e=SillyTavern.getCurrentChatId();eventOn(tavern_events.CHAT_CHANGED,t=>{e!==t&&(e=t,window.location.reload())})}();var e=i(4061);const r=z;var l=i(4015);const d=r.z.object({button_selected:r.z.boolean().default(!1)}).prefault({}),s=a('settings',()=>{const t=(0,e.ref)(d.parse(getVariables({type:'script',script_id:getScriptId()})));return(0,e.watchEffect)(()=>{insertOrAssignVariables((0,l.klona)(t.value),{type:'script',script_id:getScriptId()})}),{settings:t}}),c={class:'example-extension-settings'},u={class:'inline-drawer'},p={class:'inline-drawer-content'},m={class:'example-extension_block flex-container'},v=(0,e.defineComponent)({__name:'è®¾ç½®ç•Œé¢',setup(t){const{settings:a}=n(s()),o=()=>{toastr.success('ä½ å¥½å‘€!')};return(t,n)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',c,[(0,e.createElementVNode)('div',u,[n[3]||(n[3]=(0,e.createElementVNode)('div',{class:'inline-drawer-toggle inline-drawer-header'},[(0,e.createElementVNode)('b',null,(0,e.toDisplayString)('è„šæœ¬ç¤ºä¾‹')),(0,e.createElementVNode)('div',{class:'inline-drawer-icon fa-solid fa-circle-chevron-down down'})],-1)),(0,e.createElementVNode)('div',p,[(0,e.createElementVNode)('div',{class:'example-extension_block flex-container'},[(0,e.createElementVNode)('input',{class:'menu_button',type:'submit',value:'ç¤ºä¾‹æŒ‰é’®',onClick:o})]),(0,e.createElementVNode)('div',m,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':n[0]||(n[0]=t=>(0,e.unref)(a).button_selected=t),type:'checkbox'},null,512),[[e.vModelCheckbox,(0,e.unref)(a).button_selected]]),n[1]||(n[1]=(0,e.createElementVNode)('label',{for:'example_setting'},(0,e.toDisplayString)('ç¤ºä¾‹å¼€å…³'),-1))]),n[2]||(n[2]=(0,e.createElementVNode)('hr',{class:'sysHR'},null,-1))])])]))}}),g=(0,e.createApp)(v).use(t());$(()=>{const e=$('<div>').attr('script_id',getScriptId());$('#extensions_settings2').append(e),function(){if($(`head > div[script_id="${getScriptId()}"]`).length>0)return;const e=$('<div>').attr('script_id',getScriptId()).append($('head > style',document).clone());$('head').append(e)}(),g.mount(e[0])}),$(window).on('pagehide',()=>{g.unmount(),$(`head > div[script_id="${getScriptId()}"]`).remove(),$(`div[script_id="${getScriptId()}"]`).remove()}),$(async()=>{0===getLastMessageId()&&await createChatMessages([{role:'assistant',message:o('\n                   [æŸ¥çœ‹æ—¥è®°: è¿™æ˜¯ç¬¬äºŒæ¬¡çœ‹æˆ‘çš„æ—¥è®°äº†å‘¢~]\n                   <roleplay_options>\n                   æŽ¥å—æ—¥è®°æœ¬å¹¶ç¿»é˜…: é’ç©ºé»ŽæŽ¥è¿‡å¥¹é€’æ¥çš„ç²‰è‰²æ—¥è®°æœ¬ï¼Œåœ¨å¤©å°é˜³å…‰ä¸‹ç¼“ç¼“ç¿»å¼€ç¬¬ä¸€é¡µ\n                   ä¿æŒæ²‰é»˜ç›¯ç€å¥¹çœ‹: é’ç©ºé»Žæ²¡æœ‰æŽ¥æœ¬å­ï¼Œåªæ˜¯ç›¯ç€å¥¹ç•¥æ˜¾ç´§å¼ çš„è¡¨æƒ…å’Œè½»é¢¤çš„å£°éŸ³\n                   ååˆ°å¥¹èº«è¾¹: é’ç©ºé»Žæ²¡æœ‰ç«‹åˆ»å›žåº”ï¼Œè€Œæ˜¯ç¼“ç¼“èµ°åˆ°ç»œç»œèº«è¾¹åä¸‹ï¼Œç­‰å¾…å¥¹è‡ªå·±ç»§ç»­è¯´\n                   å¼€çŽ©ç¬‘åŒ–è§£æ°”æ°›: é’ç©ºé»Žå¾®å¾®ä¸€ç¬‘ï¼Œå¼€çŽ©ç¬‘åœ°è¯´ã€Œæ‰€ä»¥ï¼Œæ˜¯è¦è®©æˆ‘å½“ç›‘ç£å®˜å•¦ï¼Ÿã€\n                   è·³è¿‡æ—¶é—´: é’ç©ºé»ŽæŽ¥è¿‡æ—¥è®°æœ¬ï¼Œå®‰é™åœ°ç¿»äº†å‡ é¡µï¼Œæ—¶é—´æ‚„ç„¶æµé€è‡³é»„æ˜æ·±å¤„\n                   å’Œç»œç»œèŠå¤©: é’ç©ºé»Žè¯•æŽ¢æ€§åœ°é—®ï¼šã€Œè¿™æœ¬æ˜¯ä»Žå“ªå¤©å¼€å§‹å†™çš„ï¼Ÿéƒ½å†™äº›ä»€ä¹ˆå‘€ï¼Ÿã€\n                   </roleplay_options>\n                 ')},{role:'assistant',message:o('\n                   [æŸ¥çœ‹æ—¥è®°: çœŸæ˜¯çš„, å°±è¿™ä¹ˆå–œæ¬¢çœ‹å—(vã€ƒÏ‰ã€ƒ)]\n                   <roleplay_options>\n                   é˜…è¯»æ—¥è®°ç¬¬ä¸€é¡µï¼šé’ç©ºé»Žæ‰“å¼€ç²‰è‰²çš„æ—¥è®°æœ¬ï¼Œä»Žç¬¬ä¸€é¡µå¼€å§‹è®¤çœŸé˜…è¯»ç»œç»œçš„è®°å½•å†…å®¹ã€‚\n                   é—®å¥¹å°é¢ä¸Šçš„å…”å­è´´çº¸ï¼šé’ç©ºé»Žå¥½å¥‡é‚£æžšè“è‰²å…”å­è´´çº¸çš„æ¥åŽ†ï¼Œè½¬å¤´å‘ç»œç»œè¯¢é—®ã€‚\n                   è§‚å¯Ÿç»œç»œçš„å°åŠ¨ä½œï¼šé’ç©ºé»Žä¸æ€¥ç€ç¿»å¼€æ—¥è®°ï¼Œè€Œæ˜¯æ³¨æ„åˆ°ç»œç»œè¡¨æƒ…é‡Œä¸€ä¸æœŸå¾…ä¸Žä¸å®‰ã€‚\n                   å’Œå¥¹é—²èŠå¤©æ°”ï¼šé’ç©ºé»Žéšå£èŠèµ·å‚æ™šé£Žæœ‰ç‚¹å‡‰ï¼Œè¯•å›¾èˆ’ç¼“ç´§å¼ æ°”æ°›ã€‚\n                   è°ƒä¾ƒå¥¹ï¼šâ€œæœ‰å“ªé¡µæ˜¯â€˜ä¸è®¸çœ‹â€™çš„ï¼Ÿâ€é’ç©ºé»Žè½»æ¾åœ°è¯•å›¾åŒ–è§£å¥¹çš„å°æ…Œä¹±ã€‚\n                   è½¬èº«å›žæ•™å®¤ï¼šé’ç©ºé»ŽæŽ¥è¿‡æ—¥è®°å´å¹¶æœªç«‹åˆ»ç¿»å¼€ï¼Œè€Œæ˜¯è¡¨ç¤ºå›žæ•™å®¤å†çœ‹ï¼Œæ‰“ç®—æ…¢æ…¢é˜…è¯»ã€‚\n                   </roleplay_options>\n                 ')}],{refresh:'all'})})})(),(()=>{var e=i(4061);const t={class:'fold-bar'},a={class:'fold-bar-header'},n={class:'fold-bar-title-actions'},o={class:'fold-bar-header-actions'},r={class:'fold-bar-content-text'},l=(0,e.defineComponent)({__name:'fold_bar',props:{title:{},isOpen:{type:Boolean}},emits:['toggle'],setup(l,{emit:i}){const d=l,s=i,c=(0,e.ref)(d.isOpen),u=(0,e.ref)(),p=()=>{u.value&&(c.value?(c.value=!1,u.value.style.maxHeight='0'):(c.value=!0,setTimeout(()=>{if(u.value){const e=u.value.scrollHeight,t=.8*window.innerHeight,a=Math.min(e,t);u.value.style.maxHeight=a+'px'}},0)),s('toggle',c.value))};return(0,e.watch)(()=>d.isOpen,e=>{e!==c.value&&(u.value&&(e?setTimeout(()=>{if(u.value){const e=u.value.scrollHeight,t=.8*window.innerHeight,a=Math.min(e,t);u.value.style.maxHeight=a+'px'}},0):u.value.style.maxHeight='0'),c.value=e)}),(i,d)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',t,[(0,e.createElementVNode)('div',a,[(0,e.createElementVNode)('button',{class:'fold-bar-btn',onClick:p},[(0,e.createElementVNode)('span',null,(0,e.toDisplayString)(l.title),1),(0,e.createElementVNode)('div',n,[(0,e.renderSlot)(i.$slots,'title-actions')]),(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['fold-bar-toggle-icon',{open:(0,e.unref)(c)}])},null,2)]),(0,e.createElementVNode)('div',o,[(0,e.renderSlot)(i.$slots,'header-actions')])]),(0,e.createElementVNode)('div',{ref_key:'contentRef',ref:u,class:(0,e.normalizeClass)(['fold-bar-content',{open:(0,e.unref)(c)}])},[(0,e.createElementVNode)('div',r,[(0,e.renderSlot)(i.$slots,'default')]),(0,e.createElementVNode)('div',{class:'fold-bar-footer-toggle',onClick:p},'â–² æ”¶èµ· â–²')],2)]))}});i(9457);var d=i(3235);const s=(0,d.A)(l,[['__scopeId','data-v-112e8be8']]),c={class:'character-tabs-container'},u=['onClick'],p={class:'character-info-container'},m={class:'section'},v={class:'form-grid'},g={class:'input-group'},b=['onUpdate:modelValue'],f={key:0,class:'generated-result'},h={class:'generated-text'},x=['onClick'],y={class:'input-group'},E=['onUpdate:modelValue'],k={key:0,class:'generated-result'},V={class:'generated-text'},N=['onClick'],w={class:'input-group'},B=['value','onInput'],C={key:0,class:'generated-result'},S={class:'generated-text'},I=['onClick'],D={class:'input-group'},T=['onUpdate:modelValue'],M={key:0,class:'generated-result'},Y={class:'generated-text'},O=['onClick'],A={class:'input-group'},R=['onUpdate:modelValue'],K={key:0,class:'generated-result'},U={class:'generated-text'},L=['onClick'],F={class:'input-group'},j=['value','onInput'],H={key:0,class:'generated-result'},P={class:'generated-text'},q=['onClick'],G={class:'input-group'},W=['value','onInput'],X={key:0,class:'generated-result'},J={class:'generated-text'},Z=['onClick'],Q={class:'input-group'},ee=['value','onInput'],te={key:0,class:'generated-result'},ae={class:'generated-text'},ne=['onClick'],oe={class:'input-group'},re=['onUpdate:modelValue'],le={key:0,class:'generated-result'},ie={class:'generated-text'},de=['onClick'],se={class:'input-group'},ce=['value','onInput'],ue={key:0,class:'generated-result'},pe={class:'generated-text'},me=['onClick'],ve={class:'input-group'},ge=['value','onInput'],be={key:0,class:'generated-result'},fe={class:'generated-text'},he=['onClick'],xe={class:'input-group full-width'},ye=['onUpdate:modelValue'],_e={key:0,class:'generated-result'},Ee={class:'generated-text'},ke=['onClick'],Ve={class:'input-group full-width'},Ne={class:'birthday-inputs'},we=['value','onInput'],Be=['value','onInput'],Ce={key:0,class:'generated-result'},$e={class:'generated-text'},Se=['onClick'],Ie={class:'section'},ze={class:'form-grid'},De={class:'input-group full-width'},Te=['onUpdate:modelValue'],Me={key:0,class:'generated-result'},Ye={class:'generated-text'},Oe=['onClick'],Ae={class:'input-group full-width'},Re=['onUpdate:modelValue'],Ke={key:0,class:'generated-result'},Ue={class:'generated-text'},Le=['onClick'],Fe={class:'section'},je={class:'form-grid'},He={class:'input-group full-width'},Pe=['onUpdate:modelValue'],qe={key:0,class:'generated-result'},Ge={class:'generated-text'},We=['onClick'],Xe={class:'input-group full-width'},Je=['onUpdate:modelValue'],Ze={key:0,class:'generated-result'},Qe={class:'generated-text'},et=['onClick'],tt={class:'input-group full-width'},at=['onUpdate:modelValue'],nt={key:0,class:'generated-result'},ot={class:'generated-text'},rt=['onClick'],lt={class:'section'},it={class:'form-grid'},dt={class:'input-group'},st=['value','onInput'],ct={key:0,class:'generated-result'},ut={class:'generated-text'},pt=['onClick'],mt={class:'input-group'},vt=['value','onInput'],gt={key:0,class:'generated-result'},bt={class:'generated-text'},ft=['onClick'],ht={class:'input-group'},xt=['value','onInput'],yt={key:0,class:'generated-result'},_t={class:'generated-text'},Et=['onClick'],kt={class:'input-group full-width'},Vt=['onUpdate:modelValue'],Nt={key:0,class:'generated-result'},wt={class:'generated-text'},Bt=['onClick'],Ct={class:'input-group full-width'},$t={class:'relations-list'},St={class:'relation-target'},It=['value','onInput'],zt=['onClick'],Dt={class:'add-relation'},Tt=['onUpdate:modelValue'],Mt=['value'],Yt=['disabled','onClick'],Ot={key:0,class:'generated-result'},At={class:'generated-text'},Rt=['onClick'],Kt={class:'input-group full-width'},Ut={class:'relations-list'},Lt={class:'relation-target'},Ft=['value','onInput'],jt=['onClick'],Ht={class:'add-relation'},Pt=['onUpdate:modelValue'],qt=['value'],Gt=['disabled','onClick'],Wt={key:0,class:'generated-result'},Xt={class:'generated-text'},Jt=['onClick'],Zt={class:'input-group full-width'},Qt={class:'relations-list'},ea={class:'relation-target'},ta=['value','onInput'],aa=['onClick'],na={class:'add-relation'},oa=['onUpdate:modelValue'],ra=['value'],la=['disabled','onClick'],ia={key:0,class:'generated-result'},da={class:'generated-text'},sa=['onClick'],ca={class:'input-group full-width'},ua={class:'inventory-list'},pa={class:'inventory-target'},ma=['value','onInput'],va=['onClick'],ga={class:'add-inventory'},ba=['onUpdate:modelValue'],fa=['value'],ha=['onUpdate:modelValue','disabled'],xa=['disabled','onClick'],ya={key:0,class:'generated-result'},_a={class:'generated-text'},Ea=['onClick'],ka={class:'section'},Va={class:'form-grid'},Na={class:'input-group full-width'},wa=['onUpdate:modelValue'],Ba={class:'action-section'},Ca=['disabled','onClick'],$a={key:0,class:'loading-spinner'},Sa=['disabled','onClick'],Ia=(0,e.defineComponent)({__name:'character_tab',setup(t){const a=(e,t)=>{const a=e[t];return a?.toString()||''},n=(e,t,a)=>{if(''===a||''===a.trim())e[t]=null;else{const n=parseInt(a);e[t]=isNaN(n)?null:n}},o=(e,t,a)=>{const n=Ia.value.get(e);if(!n)return;const o={å§“æ°:{field:'å§“æ°'},åå­—:{field:'åå­—'},å¹´é½¡:{field:'å¹´é½¡',parser:e=>parseInt(e)||null},æ€§åˆ¥:{field:'æ€§åˆ¥'},èº«ä»½:{field:'èº«ä»½'},èº«é«˜:{field:'èº«é«˜',parser:e=>parseInt(e)||null},é«”é‡:{field:'é«”é‡',parser:e=>parseInt(e)||null},èƒ¸åœ:{field:'èƒ¸åœ',parser:e=>parseInt(e)||null},ç½©æ¯:{field:'ç½©æ¯'},è…°åœ:{field:'è…°åœ',parser:e=>parseInt(e)||null},è‡€åœ:{field:'è‡€åœ',parser:e=>parseInt(e)||null},é«®åž‹:{field:'é«®åž‹'},æ¨£è²Œ:{field:'æ¨£è²Œ'},è¡£è‘—:{field:'è¡£è‘—'},ç°¡ä»‹:{field:'ç°¡ä»‹'},æ€§æ ¼:{field:'æ€§æ ¼'},æ„›å¥½:{field:'æ„›å¥½'},é‡‘éŒ¢:{field:'é‡‘éŒ¢',parser:e=>parseInt(e)||null},å¿ƒæƒ…:{field:'å¿ƒæƒ…',parser:e=>parseInt(e)||null},æ€§æ…¾:{field:'æ€§æ…¾',parser:e=>parseInt(e)||null},ç”Ÿæ—¥æœˆä»½:{field:'ç”Ÿæ—¥æœˆä»½',parser:e=>parseInt(e)||null},ç”Ÿæ—¥æ—¥æœŸ:{field:'ç”Ÿæ—¥æ—¥æœŸ',parser:e=>parseInt(e)||null},å…¶ä»–é‡è¦è³‡è¨Š:{field:'å…¶ä»–é‡è¦è³‡è¨Š'}}[t];if(o){const e=o.parser?o.parser(a):a;n[o.field]=e,n[`generated_${t}`]=''}else if('ç”Ÿæ—¥'===t){const e=a.split('-');2===e.length&&(n.ç”Ÿæ—¥æœˆä»½=parseInt(e[0])||null,n.ç”Ÿæ—¥æ—¥æœŸ=parseInt(e[1])||null,n.generated_birthday_month='',n.generated_birthday_day='')}else'é—œä¿‚'===t?r(n,a):'å‹å¥½åº¦'===t?l(n,a):'æ„›æƒ…åº¦'===t?i(n,a):'æ‰€æŒç‰©'===t&&d(n,a);Ia.value.set(e,{...n}),Ha(e)},r=(e,t)=>{e.é—œä¿‚||(e.é—œä¿‚=new Map);const a=t.replace(/^["']|["']$/g,'');if(a.startsWith('[')&&a.endsWith(']')){const t=a.slice(1,-1).split(',').map(e=>e.trim());for(const a of t){const t=a.indexOf(':');if(t>0){const n=a.substring(0,t).replace(/^["']|["']$/g,'').trim(),o=a.substring(t+1).replace(/^["']|["']$/g,'').trim();n&&o&&e.é—œä¿‚.set(n,o)}}}else e.selected_relation_target&&e.é—œä¿‚.set(e.selected_relation_target,t);e.generated_relationship=''},l=(e,t)=>{e.å‹å¥½åº¦||(e.å‹å¥½åº¦=new Map);const a=t.replace(/^["']|["']$/g,'');if(a.startsWith('[')&&a.endsWith(']')){const t=a.slice(1,-1).split(',').map(e=>e.trim());for(const a of t){const t=a.indexOf(':');if(t>0){const n=a.substring(0,t).replace(/^["']|["']$/g,'').trim(),o=parseInt(a.substring(t+1).replace(/^["']|["']$/g,'').trim());n&&!isNaN(o)&&e.å‹å¥½åº¦.set(n,o)}}}e.generated_friendship=''},i=(e,t)=>{e.æ„›æƒ…åº¦||(e.æ„›æƒ…åº¦=new Map);const a=t.replace(/^["']|["']$/g,'');if(a.startsWith('[')&&a.endsWith(']')){const t=a.slice(1,-1).split(',').map(e=>e.trim());for(const a of t){const t=a.indexOf(':');if(t>0){const n=a.substring(0,t).replace(/^["']|["']$/g,'').trim(),o=parseInt(a.substring(t+1).replace(/^["']|["']$/g,'').trim());n&&!isNaN(o)&&e.æ„›æƒ…åº¦.set(n,o)}}}e.generated_love=''},d=(e,t)=>{e.æ‰€æŒç‰©||(e.æ‰€æŒç‰©=new Map);const a=t.replace(/^["']|["']$/g,'');if(a.startsWith('[')&&a.endsWith(']')){const t=a.slice(1,-1).split(',').map(e=>e.trim());for(const a of t){const t=a.indexOf(':');if(t>0){const n=a.substring(0,t).replace(/^["']|["']$/g,'').trim(),o=parseInt(a.substring(t+1).replace(/^["']|["']$/g,'').trim());n&&!isNaN(o)&&o>0&&e.æ‰€æŒç‰©.set(n,o)}}}e.generated_inventory=''},Ia=(0,e.ref)(new Map),za=(0,e.ref)(new Map),Da=(0,e.computed)(()=>{const e=new Map;for(const[t,a]of Ia.value)'c1'!==t&&e.set(t,a);return e}),Ta=(0,e.computed)(()=>Array.from(Da.value.entries())),Ma=t=>{const a=new Map(Ia.value),n=getVariables({type:'chat'}),o=n.characters?.c1;return o&&!a.has('c1')&&a.set('c1',(0,e.reactive)(o)),Array.from(a.entries()).filter(([e])=>e!==t)},Ya=()=>{const t=new Map,a=getVariables({type:'chat'});if(a?.items)for(const[n,o]of Object.entries(a.items))t.set(n,(0,e.reactive)(o));return Array.from(t.entries())},Oa=e=>{const t=getVariables({type:'chat'}),a=t.items?.[e];return a&&a.name||'æœªçŸ¥ç‰©å“'},Aa=e=>`${e?.å§“æ°||''}${e?.åå­—||''}`.trim()||'æœªçŸ¥è§’è‰²',Ra=e=>{const t=getVariables({type:'chat'}),a=t.characters?.[e];if(a){return`${a.å§“æ°||''}${a.åå­—||''}`.trim()||'æœªçŸ¥è§’è‰²'}return'æœªçŸ¥è§’è‰²'},Ka=e=>!!(e?.generated_surname||e?.generated_name||e?.generated_age||e?.generated_gender||e?.generated_identity||e?.generated_height||e?.generated_weight||e?.generated_chest_size||e?.generated_cup_size||e?.generated_waist_size||e?.generated_hips_size||e?.generated_hairstyle||e?.generated_appearance||e?.generated_clothes||e?.generated_introduction||e?.generated_personality||e?.generated_favourite||e?.generated_money||e?.generated_mood||e?.generated_sexuality||e?.generated_birthday_month||e?.generated_birthday_day||e?.generated_extra_information||e?.generated_relationship||e?.generated_friendship||e?.generated_love||e?.generated_inventory),Ua=e=>{const t=(()=>{if(!(e?.é—œä¿‚ instanceof Map))return!1;if(0===e.é—œä¿‚.size)return!0;for(const[t,a]of e.é—œä¿‚)if(!a||!a.trim())return!1;return!0})();return!!(e?.å§“æ°?.trim()&&e?.åå­—?.trim()&&null!==e?.å¹´é½¡&&e?.æ€§åˆ¥?.trim()&&e?.èº«ä»½?.trim()&&null!==e?.èº«é«˜&&null!==e?.é«”é‡&&null!==e?.èƒ¸åœ&&e?.ç½©æ¯?.trim()&&null!==e?.è…°åœ&&null!==e?.è‡€åœ&&e?.é«®åž‹?.trim()&&e?.æ¨£è²Œ?.trim()&&e?.è¡£è‘—?.trim()&&e?.ç°¡ä»‹?.trim()&&e?.æ€§æ ¼?.trim()&&e?.æ„›å¥½?.trim()&&null!==e?.é‡‘éŒ¢&&null!==e?.å¿ƒæƒ…&&null!==e?.æ€§æ…¾&&null!==e?.ç”Ÿæ—¥æœˆä»½&&null!==e?.ç”Ÿæ—¥æ—¥æœŸ&&e?.å…¶ä»–é‡è¦è³‡è¨Š?.trim()&&t)},La=(0,e.computed)(()=>{try{const e=getVariables({type:'chat'});return!!e?.world_info?.trim()}catch{return!1}}),Fa=e=>{['generated_surname','generated_name','generated_age','generated_gender','generated_identity','generated_height','generated_weight','generated_chest_size','generated_cup_size','generated_waist_size','generated_hips_size','generated_hairstyle','generated_appearance','generated_clothes','generated_introduction','generated_personality','generated_favourite','generated_money','generated_mood','generated_sexuality','generated_birthday_month','generated_birthday_day','generated_extra_information','generated_relationship','generated_selected_relation_target','generated_friendship','generated_love','generated_inventory'].forEach(t=>{e[t]||(e[t]='')}),e.generation_requirement||(e.generation_requirement='')},ja=e=>{!e.é—œä¿‚||'object'!=typeof e.é—œä¿‚||e.é—œä¿‚ instanceof Map?e.é—œä¿‚||(e.é—œä¿‚=new Map):e.é—œä¿‚=new Map(Object.entries(e.é—œä¿‚)),!e.å‹å¥½åº¦||'object'!=typeof e.å‹å¥½åº¦||e.å‹å¥½åº¦ instanceof Map?e.å‹å¥½åº¦||(e.å‹å¥½åº¦=new Map):e.å‹å¥½åº¦=new Map(Object.entries(e.å‹å¥½åº¦)),!e.æ„›æƒ…åº¦||'object'!=typeof e.æ„›æƒ…åº¦||e.æ„›æƒ…åº¦ instanceof Map?e.æ„›æƒ…åº¦||(e.æ„›æƒ…åº¦=new Map):e.æ„›æƒ…åº¦=new Map(Object.entries(e.æ„›æƒ…åº¦)),!e.æ‰€æŒç‰©||'object'!=typeof e.æ‰€æŒç‰©||e.æ‰€æŒç‰© instanceof Map?e.æ‰€æŒç‰©||(e.æ‰€æŒç‰©=new Map):e.æ‰€æŒç‰©=new Map(Object.entries(e.æ‰€æŒç‰©)),e.selected_relation_target||(e.selected_relation_target=''),e.selected_friendship_target||(e.selected_friendship_target=''),e.selected_love_target||(e.selected_love_target=''),e.selected_inventory_item||(e.selected_inventory_item=''),void 0!==e.selected_inventory_quantity&&null!==e.selected_inventory_quantity||(e.selected_inventory_quantity=1)},Ha=e=>{try{const t=getVariables({type:'chat'}),a={...t.characters||{}},n=Ia.value.get(e);if(!n)return;const o={å§“æ°:n.å§“æ°||'',åå­—:n.åå­—||'',å¹´é½¡:n.å¹´é½¡,æ€§åˆ¥:n.æ€§åˆ¥||'',èº«ä»½:n.èº«ä»½||'',èº«é«˜:n.èº«é«˜,é«”é‡:n.é«”é‡,èƒ¸åœ:n.èƒ¸åœ,ç½©æ¯:n.ç½©æ¯||'',è…°åœ:n.è…°åœ,è‡€åœ:n.è‡€åœ,é«®åž‹:n.é«®åž‹||'',æ¨£è²Œ:n.æ¨£è²Œ||'',è¡£è‘—:n.è¡£è‘—||'',ç°¡ä»‹:n.ç°¡ä»‹||'',æ€§æ ¼:n.æ€§æ ¼||'',æ„›å¥½:n.æ„›å¥½||'',é‡‘éŒ¢:n.é‡‘éŒ¢,å¿ƒæƒ…:n.å¿ƒæƒ…,æ€§æ…¾:n.æ€§æ…¾,ç”Ÿæ—¥æœˆä»½:n.ç”Ÿæ—¥æœˆä»½,ç”Ÿæ—¥æ—¥æœŸ:n.ç”Ÿæ—¥æ—¥æœŸ,å…¶ä»–é‡è¦è³‡è¨Š:n.å…¶ä»–é‡è¦è³‡è¨Š||'',é—œä¿‚:Object.fromEntries(n.é—œä¿‚||new Map),å‹å¥½åº¦:Object.fromEntries(n.å‹å¥½åº¦||new Map),æ„›æƒ…åº¦:Object.fromEntries(n.æ„›æƒ…åº¦||new Map),æ‰€æŒç‰©:Object.fromEntries(n.æ‰€æŒç‰©||new Map)};a[e]=o,t.characters=a,replaceVariables(t,{type:'chat'})}catch(t){console.error(`ä¿å­˜è§’è‰² ${e} è³‡æ–™å¤±æ•—:`,t)}},Pa=e=>'['+Object.entries(e).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']',qa=(e,t)=>{let a='\n</ä¸–ç•ŒèƒŒæ™¯>\n';return a+='\n',a+=`${(()=>{const e=getVariables({type:'chat'}).characters.c1,t=`${e.å§“æ°}${e.åå­—}`;let a=`<${t}Status>\n`;return a+='idï¼šc1\n',a+=`  å§“æ°ï¼š${e.å§“æ°||''}\n`,a+=`  åå­—ï¼š${e.åå­—||''}\n`,a+=`  å¹´é½¡ï¼š${e.å¹´é½¡||''}\n`,a+=`  æ€§åˆ¥ï¼š${e.æ€§åˆ¥||''}\n`,a+=`  èº«ä»½ï¼š${e.èº«ä»½||''}\n`,a+=`  èº«é«˜ï¼š${e.èº«é«˜||''}\n`,a+=`  é«”é‡ï¼š${e.é«”é‡||''}\n`,a+=`  èƒ¸åœï¼š${e.èƒ¸åœ||''}\n`,a+=`  ç½©æ¯ï¼š${e.ç½©æ¯||''}\n`,a+=`  è…°åœï¼š${e.è…°åœ||''}\n`,a+=`  è‡€åœï¼š${e.è‡€åœ||''}\n`,a+=`  é«®åž‹ï¼š${e.é«®åž‹||''}\n`,a+=`  æ¨£è²Œï¼š${e.æ¨£è²Œ||''}\n`,a+=`  è¡£è‘—ï¼š${e.è¡£è‘—||''}\n`,a+=`  ç°¡ä»‹ï¼š${e.ç°¡ä»‹||''}\n`,a+=`  æ€§æ ¼ï¼š${e.æ€§æ ¼||''}\n`,a+=`  æ„›å¥½ï¼š${e.æ„›å¥½||''}\n`,a+=`  é‡‘éŒ¢ï¼š${e.é‡‘éŒ¢||''}\n`,a+=`  ç”Ÿæ—¥æœˆä»½ï¼š${e.ç”Ÿæ—¥æœˆä»½||''}\n`,a+=`  ç”Ÿæ—¥æ—¥æœŸï¼š${e.ç”Ÿæ—¥æ—¥æœŸ||''}\n`,a+=`  å…¶ä»–é‡è¦è³‡è¨Šï¼š${e.å…¶ä»–é‡è¦è³‡è¨Š||''}\n`,a+=`  é—œä¿‚ï¼š${Pa(e.é—œä¿‚)}\n`,a+=`  å‹å¥½åº¦ï¼š${Pa(e.å‹å¥½åº¦)}\n`,a+=`  æ„›æƒ…åº¦ï¼š${Pa(e.æ„›æƒ…åº¦)}\n`,a+=`</${t}Status>`,a})()}\n`,a+='\n',a+=`${(e=>{const t=getVariables({type:'chat'}).characters;if(void 0===t)return'';let a='<CharacterStatus>\n';for(const[n,o]of Object.entries(t))'c1'!==n&&n!==e&&(a+=`idï¼š${n}\n`,a+=`  å§“æ°ï¼š${o.å§“æ°||''}\n`,a+=`  åå­—ï¼š${o.åå­—||''}\n`,a+=`  å¹´é½¡ï¼š${o.å¹´é½¡||''}\n`,a+=`  æ€§åˆ¥ï¼š${o.æ€§åˆ¥||''}\n`,a+=`  èº«ä»½ï¼š${o.èº«ä»½||''}\n`,a+=`  èº«é«˜ï¼š${o.èº«é«˜||''}\n`,a+=`  é«”é‡ï¼š${o.é«”é‡||''}\n`,a+=`  èƒ¸åœï¼š${o.èƒ¸åœ||''}\n`,a+=`  ç½©æ¯ï¼š${o.ç½©æ¯||''}\n`,a+=`  è…°åœï¼š${o.è…°åœ||''}\n`,a+=`  è‡€åœï¼š${o.è‡€åœ||''}\n`,a+=`  é«®åž‹ï¼š${o.é«®åž‹||''}\n`,a+=`  æ¨£è²Œï¼š${o.æ¨£è²Œ||''}\n`,a+=`  è¡£è‘—ï¼š${o.è¡£è‘—||''}\n`,a+=`  ç°¡ä»‹ï¼š${o.ç°¡ä»‹||''}\n`,a+=`  æ€§æ ¼ï¼š${o.æ€§æ ¼||''}\n`,a+=`  æ„›å¥½ï¼š${o.æ„›å¥½||''}\n`,a+=`  é‡‘éŒ¢ï¼š${o.é‡‘éŒ¢||''}\n`,a+=`  å¿ƒæƒ…ï¼š${o.å¿ƒæƒ…||''}\n`,a+=`  æ€§æ…¾ï¼š${o.æ€§æ…¾||''}\n`,a+=`  ç”Ÿæ—¥æœˆä»½ï¼š${o.ç”Ÿæ—¥æœˆä»½||''}\n`,a+=`  ç”Ÿæ—¥æ—¥æœŸï¼š${o.ç”Ÿæ—¥æ—¥æœŸ||''}\n`,a+=`  å…¶ä»–é‡è¦è³‡è¨Šï¼š${o.å…¶ä»–é‡è¦è³‡è¨Š||''}\n`,a+=`  é—œä¿‚ï¼š${Pa(o.é—œä¿‚)}\n`,a+=`  å‹å¥½åº¦ï¼š${Pa(o.å‹å¥½åº¦)}\n`,a+=`  æ„›æƒ…åº¦ï¼š${Pa(o.æ„›æƒ…åº¦)}\n\n`);return a+='</CharacterStatus>',a})(e)}\n`,a+='\n',a+=`${(()=>{let e='<ItemTable>\n';e+='|id|åç¨±|æè¿°|åƒ¹å€¼|\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).items;if(void 0===t)return'';for(const[a,n]of Object.entries(t))e+=`|${a}|${n.name}|${n.description}|${n.value}|\n`;return e+='</ItemTable>',e})()}\n`,a+='\n',a+=`${(()=>{let e='<LocationTable>\n';e+='|id|åœ°é»ž|ä½ç½®|æè¿°|å­åœ°é»ž|\n',e+='|---|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.location||''}|${n.description}|${t}|\n`}return e+='</LocationTable>',e})()}\n`,a+='\n',a+=`${(()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e})()}\n`,a+='\n',a+='<ç”Ÿæˆè¦æ±‚>\n',a+=`${t.generation_requirement||'ç„¡ç‰¹æ®Šè¦æ±‚'}\n`,a+='</ç”Ÿæˆè¦æ±‚>\n',a+='\n',a+='<example>\n',a+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output. Output anything other than this format is prohibited.\n',a+='å§“æ°ï¼šstring\n',a+='åå­—ï¼šstring\n',a+='å¹´é½¡ï¼šnumber\n',a+='æ€§åˆ¥ï¼š\'ç”·\' | \'å¥³\' | \'ä¸æ˜Ž\'\n',a+='èº«ä»½ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',a+='èº«é«˜ï¼šnumber\n',a+='é«”é‡ï¼šnumber\n',a+='èƒ¸åœï¼šnumber\n',a+='ç½©æ¯ï¼š\'Capital Letter\' | \'ä¸é©ç”¨\'\n',a+='è…°åœï¼šnumber\n',a+='è‡€åœï¼šnumber\n',a+='é«®åž‹ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',a+='æ¨£è²Œï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',a+='è¡£è‘—ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°ç•¶å‰èº«ä¸Šæœè£\'\n',a+='ç°¡ä»‹ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',a+='æ€§æ ¼ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',a+='æ„›å¥½ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',a+='é‡‘éŒ¢ï¼šnumber\n',a+='å¿ƒæƒ…ï¼šnumber[-100~100]\n',a+='æ€§æ…¾ï¼šnumber[0~100]\n',a+='ç”Ÿæ—¥æœˆä»½ï¼šnumber\n',a+='ç”Ÿæ—¥æ—¥æœŸï¼šnumber\n',a+='å…¶ä»–é‡è¦è³‡è¨Šï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',a+='é—œä¿‚ï¼š[\'id\':\'å°æ­¤è§’è‰²çš„é—œä¿‚\', ...]\n',a+='å‹å¥½åº¦ï¼š\'[\'id\':number[-1000~1000], ...]\'\n',a+='æ„›æƒ…åº¦ï¼š\'[\'id\':number[1~1000], ...]\'\n',a+='æ‰€æŒç‰©ï¼š[\'item_id\':quantity, ...]\n',a+='</example>\n',a},Ga=async e=>{const t=Ia.value.get(e);if(!t)return;const a=new Map(za.value);a.set(e,!0),za.value=a;try{const a=(e=>{let t='è«‹æ ¹æ“šä¸–ç•ŒèƒŒæ™¯è³‡è¨Šã€ç”Ÿæˆè¦æ±‚åŠå·²æœ‰è§’è‰²è³‡æ–™ï¼Œç‚ºä»¥ä¸‹è§’è‰²å®Œå–„è§’è‰²è³‡æ–™è¨­å®šï¼š\n\n';return t+=`å§“æ°ï¼š${e.å§“æ°||''}\n`,t+=`åå­—ï¼š${e.åå­—||''}\n`,t+=`å¹´é½¡ï¼š${e.å¹´é½¡||''}\n`,t+=`æ€§åˆ¥ï¼š${e.æ€§åˆ¥||''}\n`,t+=`èº«ä»½ï¼š${e.èº«ä»½||''}\n`,t+=`èº«é«˜ï¼š${e.èº«é«˜||''}\n`,t+=`é«”é‡ï¼š${e.é«”é‡||''}\n`,t+=`èƒ¸åœï¼š${e.èƒ¸åœ||''}\n`,t+=`ç½©æ¯ï¼š${e.ç½©æ¯||''}\n`,t+=`è…°åœï¼š${e.è…°åœ||''}\n`,t+=`è‡€åœï¼š${e.è‡€åœ||''}\n`,t+=`é«®åž‹ï¼š${e.é«®åž‹||''}\n`,t+=`æ¨£è²Œï¼š${e.æ¨£è²Œ||''}\n`,t+=`è¡£è‘—ï¼š${e.è¡£è‘—||''}\n`,t+=`ç°¡ä»‹ï¼š${e.ç°¡ä»‹||''}\n`,t+=`æ€§æ ¼ï¼š${e.æ€§æ ¼||''}\n`,t+=`æ„›å¥½ï¼š${e.æ„›å¥½||''}\n`,t+=`é‡‘éŒ¢ï¼š${e.é‡‘éŒ¢||''}\n`,t+=`å¿ƒæƒ…ï¼š${e.å¿ƒæƒ…||''}\n`,t+=`æ€§æ…¾ï¼š${e.æ€§æ…¾||''}\n`,t+=`ç”Ÿæ—¥æœˆä»½ï¼š${e.ç”Ÿæ—¥æœˆä»½||''}\n`,t+=`ç”Ÿæ—¥æ—¥æœŸï¼š${e.ç”Ÿæ—¥æ—¥æœŸ||''}\n`,t+=`å…¶ä»–é‡è¦è³‡è¨Šï¼š${e.å…¶ä»–é‡è¦è³‡è¨Š||''}\n`,t+=`é—œä¿‚ï¼š${Pa(Object.fromEntries(e.é—œä¿‚||new Map))}\n`,t+=`å‹å¥½åº¦ï¼š${Pa(Object.fromEntries(e.å‹å¥½åº¦||new Map))}\n`,t+=`æ„›æƒ…åº¦ï¼š${Pa(Object.fromEntries(e.æ„›æƒ…åº¦||new Map))}\n`,t+=`æ‰€æŒç‰©ï¼š${Pa(Object.fromEntries(e.æ‰€æŒç‰©||new Map))}\n`,t})(t),n=(()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„è§’è‰²è¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ è±å¯Œå¤šå½©çš„è§’è‰²è¨­å®šã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºè§’è‰²å®Œå–„è³‡æ–™ã€‚\n';return a+='\n',a+='<ä¸–ç•ŒèƒŒæ™¯>\n','ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„è§’è‰²è¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ è±å¯Œå¤šå½©çš„è§’è‰²è¨­å®šã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºè§’è‰²å®Œå–„è³‡æ–™ã€‚\n\n<ä¸–ç•ŒèƒŒæ™¯>\n'})(),o=qa(e,t);((e,t)=>{const a=e.split('\n');for(const e of a){const a=e.indexOf('ï¼š');if(a>0){const n=e.substring(0,a).trim(),o=e.substring(a+1).trim();switch(n){case'å§“æ°':t.generated_surname=o.replace(/^["']|["']$/g,'');break;case'åå­—':t.generated_name=o.replace(/^["']|["']$/g,'');break;case'å¹´é½¡':t.generated_age=o.replace(/[^\d]/g,'');break;case'æ€§åˆ¥':t.generated_gender=o.replace(/^["']|["']$/g,'');break;case'èº«ä»½':t.generated_identity=o.replace(/^["']|["']$/g,'');break;case'èº«é«˜':t.generated_height=o.replace(/[^\d]/g,'');break;case'é«”é‡':t.generated_weight=o.replace(/[^\d]/g,'');break;case'èƒ¸åœ':t.generated_chest_size=o.replace(/[^\d]/g,'');break;case'ç½©æ¯':t.generated_cup_size=o.replace(/^["']|["']$/g,'');break;case'è…°åœ':t.generated_waist_size=o.replace(/[^\d]/g,'');break;case'è‡€åœ':t.generated_hips_size=o.replace(/[^\d]/g,'');break;case'é«®åž‹':t.generated_hairstyle=o.replace(/^["']|["']$/g,'');break;case'æ¨£è²Œ':t.generated_appearance=o.replace(/^["']|["']$/g,'');break;case'è¡£è‘—':t.generated_clothes=o.replace(/^["']|["']$/g,'');break;case'ç°¡ä»‹':t.generated_introduction=o.replace(/^["']|["']$/g,'');break;case'æ€§æ ¼':t.generated_personality=o.replace(/^["']|["']$/g,'');break;case'æ„›å¥½':t.generated_favourite=o.replace(/^["']|["']$/g,'');break;case'é‡‘éŒ¢':t.generated_money=o.replace(/[^\d]/g,'');break;case'å¿ƒæƒ…':t.generated_mood=o.replace(/[^\d]/g,'');break;case'æ€§æ…¾':t.generated_sexuality=o.replace(/[^\d]/g,'');break;case'ç”Ÿæ—¥æœˆä»½':t.generated_birthday_month=o.replace(/[^\d]/g,'');break;case'ç”Ÿæ—¥æ—¥æœŸ':t.generated_birthday_day=o.replace(/[^\d]/g,'');break;case'å…¶ä»–é‡è¦è³‡è¨Š':t.generated_extra_information=o.replace(/^["']|["']$/g,'');break;case'é—œä¿‚':t.generated_relationship=o.replace(/^["']|["']$/g,'');break;case'å‹å¥½åº¦':t.generated_friendship=o.replace(/^["']|["']$/g,'');break;case'æ„›æƒ…åº¦':t.generated_love=o.replace(/^["']|["']$/g,'');break;case'æ‰€æŒç‰©':t.generated_inventory=o.replace(/^["']|["']$/g,'')}}}})(await generateRaw({user_input:a,ordered_prompts:[{role:'system',content:n},'char_description',{role:'system',content:o},'user_input']}),t);try{localStorage.setItem(`character_profile_generated_${e}`,JSON.stringify({generation_requirement:t.generation_requirement,generated_surname:t.generated_surname,generated_name:t.generated_name,generated_age:t.generated_age,generated_gender:t.generated_gender,generated_identity:t.generated_identity,generated_height:t.generated_height,generated_weight:t.generated_weight,generated_chest_size:t.generated_chest_size,generated_cup_size:t.generated_cup_size,generated_waist_size:t.generated_waist_size,generated_hips_size:t.generated_hips_size,generated_hairstyle:t.generated_hairstyle,generated_appearance:t.generated_appearance,generated_clothes:t.generated_clothes,generated_introduction:t.generated_introduction,generated_personality:t.generated_personality,generated_favourite:t.generated_favourite,generated_money:t.generated_money,generated_mood:t.generated_mood,generated_sexuality:t.generated_sexuality,generated_birthday_month:t.generated_birthday_month,generated_birthday_day:t.generated_birthday_day,generated_extra_information:t.generated_extra_information,generated_relationship:t.generated_relationship,generated_friendship:t.generated_friendship,generated_love:t.generated_love,generated_inventory:t.generated_inventory}))}catch(t){console.error(`Failed to save generated character profile for ${e} to localStorage:`,t)}Ia.value.set(e,{...t})}catch(a){console.error(`ç”Ÿæˆè§’è‰² ${e} è³‡æ–™å¤±æ•—:`,a),t.generated_age='ç”Ÿæˆå¤±æ•—ï¼Œè«‹é‡è©¦ã€‚'}finally{const t=new Map(za.value);t.set(e,!1),za.value=t}};(0,e.watch)(()=>getVariables({type:'chat'}),t=>{if(t?.characters){const a=new Map;for(const[n,o]of Object.entries(t.characters)){const t=(0,e.reactive)(o);Fa(t),ja(t),a.set(n,t)}Ia.value=a}},{deep:!0}),(0,e.watch)(Ia,()=>{for(const[e]of Ia.value.entries())Ha(e)},{deep:!0}),(0,e.watch)(()=>Ia.value,t=>{for(const[a,n]of t.entries())(0,e.watch)(()=>n.generation_requirement,e=>{try{const t=localStorage.getItem(`character_profile_generated_${a}`),n=t?JSON.parse(t):{};n.generation_requirement=e,localStorage.setItem(`character_profile_generated_${a}`,JSON.stringify(n))}catch(e){console.error(`Failed to save generation_requirement for ${a} to localStorage:`,e)}},{immediate:!1})},{deep:!0,immediate:!0}),(0,e.onMounted)(()=>{(()=>{try{const t=getVariables({type:'chat'});if(t?.characters){const a=new Map;for(const[n,o]of Object.entries(t.characters)){const t=(0,e.reactive)(o);Fa(t),ja(t),a.set(n,t)}Ia.value=a}else Ia.value=new Map}catch(e){console.error('è¼‰å…¥è§’è‰²è³‡æ–™å¤±æ•—:',e),Ia.value=new Map}try{for(const[e,t]of Ia.value){const a=localStorage.getItem(`character_profile_generated_${e}`);a&&Object.assign(t,JSON.parse(a))}}catch(e){console.error('Failed to load generated character profiles from localStorage:',e)}})()});const Wa=()=>{const t=(()=>{const e=Array.from(Ia.value.keys());let t=2;for(;e.includes(`c${t}`);)t++;return`c${t}`})(),a={å§“æ°:'',åå­—:'',å¹´é½¡:null,æ€§åˆ¥:'',èº«ä»½:'',èº«é«˜:null,é«”é‡:null,èƒ¸åœ:null,ç½©æ¯:'',è…°åœ:null,è‡€åœ:null,é«®åž‹:'',æ¨£è²Œ:'',è¡£è‘—:'',ç°¡ä»‹:'',æ€§æ ¼:'',æ„›å¥½:'',é‡‘éŒ¢:null,å¿ƒæƒ…:50,æ€§æ…¾:0,ç”Ÿæ—¥æœˆä»½:null,ç”Ÿæ—¥æ—¥æœŸ:null,å…¶ä»–é‡è¦è³‡è¨Š:'',é—œä¿‚:new Map,selected_relation_target:'',å‹å¥½åº¦:new Map,æ„›æƒ…åº¦:new Map,selected_friendship_target:'',selected_love_target:'',æ‰€æŒç‰©:new Map,selected_inventory_item:'',selected_inventory_quantity:1,generation_requirement:'',generated_surname:'',generated_name:'',generated_age:'',generated_gender:'',generated_identity:'',generated_height:'',generated_weight:'',generated_chest_size:'',generated_cup_size:'',generated_waist_size:'',generated_hips_size:'',generated_hairstyle:'',generated_appearance:'',generated_clothes:'',generated_introduction:'',generated_personality:'',generated_favourite:'',generated_money:'',generated_mood:'',generated_sexuality:'',generated_birthday_month:'',generated_birthday_day:'',generated_extra_information:''},n=(0,e.reactive)(a);Ia.value.set(t,n);try{const e=getVariables({type:'chat'}).characters||{};e[t]={å§“æ°:'',åå­—:'',å¹´é½¡:null,æ€§åˆ¥:'',èº«ä»½:'',èº«é«˜:null,é«”é‡:null,èƒ¸åœ:null,ç½©æ¯:'',è…°åœ:null,è‡€åœ:null,é«®åž‹:'',æ¨£è²Œ:'',è¡£è‘—:'',ç°¡ä»‹:'',æ€§æ ¼:'',æ„›å¥½:'',é‡‘éŒ¢:null,å¿ƒæƒ…:50,æ€§æ…¾:0,ç”Ÿæ—¥æœˆä»½:null,ç”Ÿæ—¥æ—¥æœŸ:null,å…¶ä»–é‡è¦è³‡è¨Š:'',é—œä¿‚:{},å‹å¥½åº¦:{},æ„›æƒ…åº¦:{}},insertOrAssignVariables({characters:e},{type:'chat'})}catch(e){console.error('Failed to add new character to chat variables:',e)}},Xa=(e,t,a,n,o)=>{const r=Ia.value.get(e);if(!r)return;const l=r[t];l||(r[t]=new Map);const i=new Map(l),d=o?o(n):n;i.set(a,d),r[t]=i,Ia.value.set(e,{...r}),Ha(e)},Ja=(e,t,a,n)=>{const o=Ia.value.get(e);if(!o)return;const r=o[a];if(!r)return;o[t]||(o[t]=new Map),o[t].set(r,n),o[a]='',Ia.value.set(e,{...o}),Ha(e)},Za=(e,t,a)=>{const n=Ia.value.get(e);if(!n)return;const o=n[t];if(!o)return;const r=new Map(o);r.delete(a),n[t]=r,Ia.value.set(e,{...n}),Ha(e)};return(t,Da)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',c,[Da[68]||(Da[68]=(0,e.createElementVNode)('h3',null,'è§’è‰²è³‡æ–™è¨­å®š',-1)),(0,e.createCommentVNode)(' å…¶ä»–è§’è‰²å‹•æ…‹æ‘ºç–Šæ¬„ '),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(Ta.value,([t,c])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:(0,e.normalizeClass)(['character-fold-bar',{'character-incomplete':!Ua(c)}])},[(0,e.createVNode)(s,{title:`${t}: ${Aa(c)}`,'is-open':!1},{'title-actions':(0,e.withCtx)(()=>[(0,e.createElementVNode)('button',{class:'remove-character-btn',title:'ç§»é™¤è§’è‰²',onClick:e=>(e=>{Ia.value.delete(e);try{const t=getVariables({type:'chat'});delete t.characters[e],replaceVariables(t,{type:'chat'})}catch(t){console.error(`Failed to remove character ${e} from chat variables:`,t)}})(t)},[...Da[0]||(Da[0]=[(0,e.createElementVNode)('span',null,'Ã—',-1)])],8,u)]),default:(0,e.withCtx)(()=>[(0,e.createElementVNode)('div',p,[(0,e.createElementVNode)('div',m,[Da[27]||(Da[27]=(0,e.createElementVNode)('h4',null,'åŸºæœ¬è³‡è¨Š',-1)),(0,e.createElementVNode)('div',v,[(0,e.createElementVNode)('div',g,[Da[2]||(Da[2]=(0,e.createElementVNode)('label',null,'å§“æ°',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>c.å§“æ°=e,type:'text',placeholder:'ä¾‹å¦‚ï¼šå¼µ',class:'text-input'},null,8,b),[[e.vModelText,c.å§“æ°]]),c.generated_surname?((0,e.openBlock)(),(0,e.createElementBlock)('div',f,[Da[1]||(Da[1]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',h,(0,e.toDisplayString)(c.generated_surname),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'å§“æ°',c.generated_surname)},' ä½¿ç”¨ ',8,x)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',y,[Da[4]||(Da[4]=(0,e.createElementVNode)('label',null,'åå­—',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>c.åå­—=e,type:'text',placeholder:'ä¾‹å¦‚ï¼šå°æ˜Ž',class:'text-input'},null,8,E),[[e.vModelText,c.åå­—]]),c.generated_name?((0,e.openBlock)(),(0,e.createElementBlock)('div',k,[Da[3]||(Da[3]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',V,(0,e.toDisplayString)(c.generated_name),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'åå­—',c.generated_name)},' ä½¿ç”¨ ',8,N)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',w,[Da[6]||(Da[6]=(0,e.createElementVNode)('label',null,'å¹´é½¡',-1)),(0,e.createElementVNode)('input',{value:a(c,'å¹´é½¡'),type:'number',placeholder:'ä¾‹å¦‚ï¼š18',class:'text-input',min:'0',max:'200',onInput:e=>n(c,'å¹´é½¡',e.target.value)},null,40,B),c.generated_age?((0,e.openBlock)(),(0,e.createElementBlock)('div',C,[Da[5]||(Da[5]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',S,(0,e.toDisplayString)(c.generated_age),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'å¹´é½¡',c.generated_age)},' ä½¿ç”¨ ',8,I)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',D,[Da[8]||(Da[8]=(0,e.createElementVNode)('label',null,'æ€§åˆ¥',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>c.æ€§åˆ¥=e,type:'text',placeholder:'ä¾‹å¦‚ï¼šå¥³',class:'text-input'},null,8,T),[[e.vModelText,c.æ€§åˆ¥]]),c.generated_gender?((0,e.openBlock)(),(0,e.createElementBlock)('div',M,[Da[7]||(Da[7]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Y,(0,e.toDisplayString)(c.generated_gender),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'æ€§åˆ¥',c.generated_gender)},' ä½¿ç”¨ ',8,O)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',A,[Da[10]||(Da[10]=(0,e.createElementVNode)('label',null,'èº«ä»½',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>c.èº«ä»½=e,type:'text',placeholder:'ä¾‹å¦‚ï¼šé«˜ä¸­ç”Ÿ',class:'text-input'},null,8,R),[[e.vModelText,c.èº«ä»½]]),c.generated_identity?((0,e.openBlock)(),(0,e.createElementBlock)('div',K,[Da[9]||(Da[9]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',U,(0,e.toDisplayString)(c.generated_identity),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'èº«ä»½',c.generated_identity)},' ä½¿ç”¨ ',8,L)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',F,[Da[12]||(Da[12]=(0,e.createElementVNode)('label',null,'èº«é«˜ (cm)',-1)),(0,e.createElementVNode)('input',{value:a(c,'èº«é«˜'),type:'number',placeholder:'ä¾‹å¦‚ï¼š165',class:'text-input',min:'0',max:'300',onInput:e=>n(c,'èº«é«˜',e.target.value)},null,40,j),c.generated_height?((0,e.openBlock)(),(0,e.createElementBlock)('div',H,[Da[11]||(Da[11]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',P,(0,e.toDisplayString)(c.generated_height),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'èº«é«˜',c.generated_height)},' ä½¿ç”¨ ',8,q)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',G,[Da[14]||(Da[14]=(0,e.createElementVNode)('label',null,'é«”é‡ (kg)',-1)),(0,e.createElementVNode)('input',{value:a(c,'é«”é‡'),type:'number',placeholder:'ä¾‹å¦‚ï¼š50',class:'text-input',min:'0',max:'500',onInput:e=>n(c,'é«”é‡',e.target.value)},null,40,W),c.generated_weight?((0,e.openBlock)(),(0,e.createElementBlock)('div',X,[Da[13]||(Da[13]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',J,(0,e.toDisplayString)(c.generated_weight),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'é«”é‡',c.generated_weight)},' ä½¿ç”¨ ',8,Z)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Q,[Da[16]||(Da[16]=(0,e.createElementVNode)('label',null,'èƒ¸åœ (cm)',-1)),(0,e.createElementVNode)('input',{value:a(c,'èƒ¸åœ'),type:'number',placeholder:'ä¾‹å¦‚ï¼š85',class:'text-input',min:'0',max:'200',onInput:e=>n(c,'èƒ¸åœ',e.target.value)},null,40,ee),c.generated_chest_size?((0,e.openBlock)(),(0,e.createElementBlock)('div',te,[Da[15]||(Da[15]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',ae,(0,e.toDisplayString)(c.generated_chest_size),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'èƒ¸åœ',c.generated_chest_size)},' ä½¿ç”¨ ',8,ne)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',oe,[Da[18]||(Da[18]=(0,e.createElementVNode)('label',null,'ç½©æ¯',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>c.ç½©æ¯=e,type:'text',placeholder:'ä¾‹å¦‚ï¼šC',class:'text-input'},null,8,re),[[e.vModelText,c.ç½©æ¯]]),c.generated_cup_size?((0,e.openBlock)(),(0,e.createElementBlock)('div',le,[Da[17]||(Da[17]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',ie,(0,e.toDisplayString)(c.generated_cup_size),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'ç½©æ¯',c.generated_cup_size)},' ä½¿ç”¨ ',8,de)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',se,[Da[20]||(Da[20]=(0,e.createElementVNode)('label',null,'è…°åœ (cm)',-1)),(0,e.createElementVNode)('input',{value:a(c,'è…°åœ'),type:'number',placeholder:'ä¾‹å¦‚ï¼š60',class:'text-input',min:'0',max:'200',onInput:e=>n(c,'è…°åœ',e.target.value)},null,40,ce),c.generated_waist_size?((0,e.openBlock)(),(0,e.createElementBlock)('div',ue,[Da[19]||(Da[19]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',pe,(0,e.toDisplayString)(c.generated_waist_size),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'è…°åœ',c.generated_waist_size)},' ä½¿ç”¨ ',8,me)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',ve,[Da[22]||(Da[22]=(0,e.createElementVNode)('label',null,'è‡€åœ (cm)',-1)),(0,e.createElementVNode)('input',{value:a(c,'è‡€åœ'),type:'number',placeholder:'ä¾‹å¦‚ï¼š88',class:'text-input',min:'0',max:'200',onInput:e=>n(c,'è‡€åœ',e.target.value)},null,40,ge),c.generated_hips_size?((0,e.openBlock)(),(0,e.createElementBlock)('div',be,[Da[21]||(Da[21]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',fe,(0,e.toDisplayString)(c.generated_hips_size),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'è‡€åœ',c.generated_hips_size)},' ä½¿ç”¨ ',8,he)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',xe,[Da[24]||(Da[24]=(0,e.createElementVNode)('label',null,'é«®åž‹',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>c.é«®åž‹=e,type:'text',placeholder:'ä¾‹å¦‚ï¼šé»‘è‰²é•·ç›´é«®',class:'text-input'},null,8,ye),[[e.vModelText,c.é«®åž‹]]),c.generated_hairstyle?((0,e.openBlock)(),(0,e.createElementBlock)('div',_e,[Da[23]||(Da[23]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Ee,(0,e.toDisplayString)(c.generated_hairstyle),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'é«®åž‹',c.generated_hairstyle)},' ä½¿ç”¨ ',8,ke)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Ve,[Da[26]||(Da[26]=(0,e.createElementVNode)('label',null,'ç”Ÿæ—¥',-1)),(0,e.createElementVNode)('div',Ne,[(0,e.createElementVNode)('input',{value:a(c,'ç”Ÿæ—¥æœˆä»½'),type:'number',placeholder:'æœˆ',class:'birthday-input',min:'1',max:'12',onInput:e=>n(c,'ç”Ÿæ—¥æœˆä»½',e.target.value)},null,40,we),(0,e.createElementVNode)('input',{value:a(c,'ç”Ÿæ—¥æ—¥æœŸ'),type:'number',placeholder:'æ—¥',class:'birthday-input',min:'1',max:'31',onInput:e=>n(c,'ç”Ÿæ—¥æ—¥æœŸ',e.target.value)},null,40,Be)]),c.generated_birthday_month||c.generated_birthday_day?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ce,[Da[25]||(Da[25]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',$e,(0,e.toDisplayString)(c.generated_birthday_month)+'æœˆ '+(0,e.toDisplayString)(c.generated_birthday_day)+'æ—¥ ',1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'ç”Ÿæ—¥',`${c.generated_birthday_month}-${c.generated_birthday_day}`)},' ä½¿ç”¨ ',8,Se)])):(0,e.createCommentVNode)('v-if',!0)])])]),(0,e.createElementVNode)('div',Ie,[Da[32]||(Da[32]=(0,e.createElementVNode)('h4',null,'å¤–è²Œæè¿°',-1)),(0,e.createElementVNode)('div',ze,[(0,e.createElementVNode)('div',De,[Da[29]||(Da[29]=(0,e.createElementVNode)('label',null,'å¤–è²Œ',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>c.æ¨£è²Œ=e,placeholder:'æè¿°å¤–è²Œç‰¹å¾µ...',class:'text-area',rows:'3'},null,8,Te),[[e.vModelText,c.æ¨£è²Œ]]),c.generated_appearance?((0,e.openBlock)(),(0,e.createElementBlock)('div',Me,[Da[28]||(Da[28]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Ye,(0,e.toDisplayString)(c.generated_appearance),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'æ¨£è²Œ',c.generated_appearance)},' ä½¿ç”¨ ',8,Oe)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Ae,[Da[31]||(Da[31]=(0,e.createElementVNode)('label',null,'æœè£',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>c.è¡£è‘—=e,placeholder:'æè¿°å¸¸ç©¿çš„æœè£...',class:'text-area',rows:'3'},null,8,Re),[[e.vModelText,c.è¡£è‘—]]),c.generated_clothes?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ke,[Da[30]||(Da[30]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Ue,(0,e.toDisplayString)(c.generated_clothes),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'è¡£è‘—',c.generated_clothes)},' ä½¿ç”¨ ',8,Le)])):(0,e.createCommentVNode)('v-if',!0)])])]),(0,e.createElementVNode)('div',Fe,[Da[39]||(Da[39]=(0,e.createElementVNode)('h4',null,'æ€§æ ¼èˆ‡å–œå¥½',-1)),(0,e.createElementVNode)('div',je,[(0,e.createElementVNode)('div',He,[Da[34]||(Da[34]=(0,e.createElementVNode)('label',null,'ç°¡ä»‹',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>c.ç°¡ä»‹=e,placeholder:'ç°¡å–®ä»‹ç´¹è§’è‰²...',class:'text-area',rows:'3'},null,8,Pe),[[e.vModelText,c.ç°¡ä»‹]]),c.generated_introduction?((0,e.openBlock)(),(0,e.createElementBlock)('div',qe,[Da[33]||(Da[33]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Ge,(0,e.toDisplayString)(c.generated_introduction),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'ç°¡ä»‹',c.generated_introduction)},' ä½¿ç”¨ ',8,We)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Xe,[Da[36]||(Da[36]=(0,e.createElementVNode)('label',null,'æ€§æ ¼',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>c.æ€§æ ¼=e,placeholder:'æè¿°æ€§æ ¼ç‰¹é»ž...',class:'text-area',rows:'3'},null,8,Je),[[e.vModelText,c.æ€§æ ¼]]),c.generated_personality?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ze,[Da[35]||(Da[35]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Qe,(0,e.toDisplayString)(c.generated_personality),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'æ€§æ ¼',c.generated_personality)},' ä½¿ç”¨ ',8,et)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',tt,[Da[38]||(Da[38]=(0,e.createElementVNode)('label',null,'æ„›å¥½',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>c.æ„›å¥½=e,placeholder:'æè¿°å–œæ­¡çš„äº‹ç‰©...',class:'text-area',rows:'3'},null,8,at),[[e.vModelText,c.æ„›å¥½]]),c.generated_favourite?((0,e.openBlock)(),(0,e.createElementBlock)('div',nt,[Da[37]||(Da[37]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',ot,(0,e.toDisplayString)(c.generated_favourite),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'æ„›å¥½',c.generated_favourite)},' ä½¿ç”¨ ',8,rt)])):(0,e.createCommentVNode)('v-if',!0)])])]),(0,e.createElementVNode)('div',lt,[Da[64]||(Da[64]=(0,e.createElementVNode)('h4',null,'å…¶ä»–è³‡è¨Š',-1)),(0,e.createElementVNode)('div',it,[(0,e.createElementVNode)('div',dt,[Da[41]||(Da[41]=(0,e.createElementVNode)('label',null,'é‡‘éŒ¢',-1)),(0,e.createElementVNode)('input',{value:a(c,'é‡‘éŒ¢'),type:'number',placeholder:'ä¾‹å¦‚ï¼š10000',class:'text-input',min:'0',onInput:e=>n(c,'é‡‘éŒ¢',e.target.value)},null,40,st),c.generated_money?((0,e.openBlock)(),(0,e.createElementBlock)('div',ct,[Da[40]||(Da[40]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',ut,(0,e.toDisplayString)(c.generated_money),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'é‡‘éŒ¢',c.generated_money)},' ä½¿ç”¨ ',8,pt)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',mt,[Da[43]||(Da[43]=(0,e.createElementVNode)('label',null,'å¿ƒæƒ… (-100~100)',-1)),(0,e.createElementVNode)('input',{value:a(c,'å¿ƒæƒ…'),type:'number',placeholder:'ä¾‹å¦‚ï¼š50',class:'text-input',min:'0',max:'100',onInput:e=>n(c,'å¿ƒæƒ…',e.target.value)},null,40,vt),c.generated_mood?((0,e.openBlock)(),(0,e.createElementBlock)('div',gt,[Da[42]||(Da[42]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',bt,(0,e.toDisplayString)(c.generated_mood),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'å¿ƒæƒ…',c.generated_mood)},' ä½¿ç”¨ ',8,ft)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',ht,[Da[45]||(Da[45]=(0,e.createElementVNode)('label',null,'æ€§æ…¾ (0~100)',-1)),(0,e.createElementVNode)('input',{value:a(c,'æ€§æ…¾'),type:'number',placeholder:'ä¾‹å¦‚ï¼š0',class:'text-input',min:'0',max:'100',onInput:e=>n(c,'æ€§æ…¾',e.target.value)},null,40,xt),c.generated_sexuality?((0,e.openBlock)(),(0,e.createElementBlock)('div',yt,[Da[44]||(Da[44]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',_t,(0,e.toDisplayString)(c.generated_sexuality),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'æ€§æ…¾',c.generated_sexuality)},' ä½¿ç”¨ ',8,Et)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',kt,[Da[47]||(Da[47]=(0,e.createElementVNode)('label',null,'å…¶ä»–é‡è¦è³‡è¨Š',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>c.å…¶ä»–é‡è¦è³‡è¨Š=e,placeholder:'å…¶ä»–éœ€è¦æè¿°çš„è³‡è¨Š...',class:'text-area',rows:'3'},null,8,Vt),[[e.vModelText,c.å…¶ä»–é‡è¦è³‡è¨Š]]),c.generated_extra_information?((0,e.openBlock)(),(0,e.createElementBlock)('div',Nt,[Da[46]||(Da[46]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',wt,(0,e.toDisplayString)(c.generated_extra_information),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'å…¶ä»–é‡è¦è³‡è¨Š',c.generated_extra_information)},' ä½¿ç”¨ ',8,Bt)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Ct,[Da[51]||(Da[51]=(0,e.createElementVNode)('label',null,'é—œä¿‚',-1)),(0,e.createElementVNode)('div',$t,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(Array.from(c.é—œä¿‚||new Map),([a,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:a,class:'relation-item'},[(0,e.createElementVNode)('span',St,'['+(0,e.toDisplayString)(a)+'] '+(0,e.toDisplayString)(Ra(a)),1),Da[48]||(Da[48]=(0,e.createTextVNode)(' æ˜¯æ­¤è§’è‰²çš„ ',-1)),(0,e.createElementVNode)('input',{value:n,type:'text',placeholder:'è¼¸å…¥é—œä¿‚æè¿°',class:'relation-input',onInput:e=>((e,t,a)=>Xa(e,'é—œä¿‚',t,a))(t,a,e.target.value)},null,40,It),(0,e.createElementVNode)('button',{class:'remove-relation-btn',onClick:e=>((e,t)=>Za(e,'é—œä¿‚',t))(t,a)},'Ã—',8,zt)]))),128)),(0,e.createElementVNode)('div',Dt,[(0,e.withDirectives)((0,e.createElementVNode)('select',{'onUpdate:modelValue':e=>c.selected_relation_target=e,class:'relation-select'},[Da[49]||(Da[49]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡ç›®æ¨™è§’è‰²',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(Ma(t),([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t,value:t},(0,e.toDisplayString)(`${t}: ${a.å§“æ°||''}${a.åå­—||''}`),9,Mt))),128))],8,Tt),[[e.vModelSelect,c.selected_relation_target]]),(0,e.createElementVNode)('button',{class:'add-relation-btn',disabled:!c.selected_relation_target,onClick:e=>(e=>Ja(e,'é—œä¿‚','selected_relation_target',''))(t)},' æ·»åŠ é—œä¿‚ ',8,Yt)])]),c.generated_relationship?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ot,[Da[50]||(Da[50]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',At,(0,e.toDisplayString)(c.generated_relationship),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'é—œä¿‚',c.generated_relationship)},' ä½¿ç”¨ ',8,Rt)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Kt,[Da[55]||(Da[55]=(0,e.createElementVNode)('label',null,'å‹å¥½åº¦ (-1000~1000)',-1)),(0,e.createElementVNode)('div',Ut,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(Array.from(c.å‹å¥½åº¦||new Map),([a,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:a,class:'relation-item'},[(0,e.createElementVNode)('span',Lt,'['+(0,e.toDisplayString)(a)+'] '+(0,e.toDisplayString)(Ra(a)),1),Da[52]||(Da[52]=(0,e.createTextVNode)(' : ',-1)),(0,e.createElementVNode)('input',{value:n,type:'number',placeholder:'è¼¸å…¥å‹å¥½åº¦æ•¸å€¼',class:'relation-input',min:'0',max:'100',onInput:e=>((e,t,a)=>Xa(e,'å‹å¥½åº¦',t,a,e=>parseInt(e)||0))(t,a,e.target.value)},null,40,Ft),(0,e.createElementVNode)('button',{class:'remove-relation-btn',onClick:e=>((e,t)=>Za(e,'å‹å¥½åº¦',t))(t,a)},'Ã—',8,jt)]))),128)),(0,e.createElementVNode)('div',Ht,[(0,e.withDirectives)((0,e.createElementVNode)('select',{'onUpdate:modelValue':e=>c.selected_friendship_target=e,class:'relation-select'},[Da[53]||(Da[53]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡ç›®æ¨™è§’è‰²',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(Ma(t),([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t,value:t},(0,e.toDisplayString)(`${t}: ${a.å§“æ°||''}${a.åå­—||''}`),9,qt))),128))],8,Pt),[[e.vModelSelect,c.selected_friendship_target]]),(0,e.createElementVNode)('button',{class:'add-relation-btn',disabled:!c.selected_friendship_target,onClick:e=>(e=>Ja(e,'å‹å¥½åº¦','selected_friendship_target',0))(t)},' æ·»åŠ å‹å¥½åº¦ ',8,Gt)])]),c.generated_friendship?((0,e.openBlock)(),(0,e.createElementBlock)('div',Wt,[Da[54]||(Da[54]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Xt,(0,e.toDisplayString)(c.generated_friendship),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'å‹å¥½åº¦',c.generated_friendship)},' ä½¿ç”¨ ',8,Jt)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Zt,[Da[59]||(Da[59]=(0,e.createElementVNode)('label',null,'æ„›æƒ…åº¦ (0~1000)',-1)),(0,e.createElementVNode)('div',Qt,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(Array.from(c.æ„›æƒ…åº¦||new Map),([a,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:a,class:'relation-item'},[(0,e.createElementVNode)('span',ea,'['+(0,e.toDisplayString)(a)+'] '+(0,e.toDisplayString)(Ra(a)),1),Da[56]||(Da[56]=(0,e.createTextVNode)(' : ',-1)),(0,e.createElementVNode)('input',{value:n,type:'number',placeholder:'è¼¸å…¥æ„›æƒ…åº¦æ•¸å€¼',class:'relation-input',min:'0',max:'100',onInput:e=>((e,t,a)=>Xa(e,'æ„›æƒ…åº¦',t,a,e=>parseInt(e)||0))(t,a,e.target.value)},null,40,ta),(0,e.createElementVNode)('button',{class:'remove-relation-btn',onClick:e=>((e,t)=>Za(e,'æ„›æƒ…åº¦',t))(t,a)},'Ã—',8,aa)]))),128)),(0,e.createElementVNode)('div',na,[(0,e.withDirectives)((0,e.createElementVNode)('select',{'onUpdate:modelValue':e=>c.selected_love_target=e,class:'relation-select'},[Da[57]||(Da[57]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡ç›®æ¨™è§’è‰²',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(Ma(t),([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t,value:t},(0,e.toDisplayString)(`${t}: ${a.å§“æ°||''}${a.åå­—||''}`),9,ra))),128))],8,oa),[[e.vModelSelect,c.selected_love_target]]),(0,e.createElementVNode)('button',{class:'add-relation-btn',disabled:!c.selected_love_target,onClick:e=>(e=>Ja(e,'æ„›æƒ…åº¦','selected_love_target',0))(t)},' æ·»åŠ æ„›æƒ…åº¦ ',8,la)])]),c.generated_love?((0,e.openBlock)(),(0,e.createElementBlock)('div',ia,[Da[58]||(Da[58]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',da,(0,e.toDisplayString)(c.generated_love),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'æ„›æƒ…åº¦',c.generated_love)},' ä½¿ç”¨ ',8,sa)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',ca,[Da[63]||(Da[63]=(0,e.createElementVNode)('label',null,'æ‰€æŒç‰©',-1)),(0,e.createElementVNode)('div',ua,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(Array.from(c.æ‰€æŒç‰©||new Map),([a,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:a,class:'inventory-item'},[(0,e.createElementVNode)('span',pa,'['+(0,e.toDisplayString)(a)+'] '+(0,e.toDisplayString)(Oa(a)),1),Da[60]||(Da[60]=(0,e.createTextVNode)(' : ',-1)),(0,e.createElementVNode)('input',{value:n,type:'number',placeholder:'æ•¸é‡',class:'inventory-input',min:'1',onInput:e=>((e,t,a)=>{const n=Ia.value.get(e);if(!n)return;n.æ‰€æŒç‰©||(n.æ‰€æŒç‰©=new Map);const o=new Map(n.æ‰€æŒç‰©);a>0?o.set(t,a):o.delete(t),n.æ‰€æŒç‰©=o,Ha(e)})(t,a,parseInt(e.target.value)||1)},null,40,ma),(0,e.createElementVNode)('button',{class:'remove-inventory-btn',onClick:e=>((e,t)=>{const a=Ia.value.get(e);if(!a||!a.æ‰€æŒç‰©)return;const n=new Map(a.æ‰€æŒç‰©);n.delete(t),a.æ‰€æŒç‰©=n,Ha(e)})(t,a)},'Ã—',8,va)]))),128)),(0,e.createElementVNode)('div',ga,[(0,e.withDirectives)((0,e.createElementVNode)('select',{'onUpdate:modelValue':e=>c.selected_inventory_item=e,class:'inventory-select'},[Da[61]||(Da[61]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡ç‰©å“',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(Ya(),([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t,value:t},(0,e.toDisplayString)(`${t}: ${a.name||'æœªçŸ¥ç‰©å“'}`),9,fa))),128))],8,ba),[[e.vModelSelect,c.selected_inventory_item]]),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>c.selected_inventory_quantity=e,type:'number',placeholder:'æ•¸é‡',class:'quantity-input',min:'1',disabled:!c.selected_inventory_item},null,8,ha),[[e.vModelText,c.selected_inventory_quantity,void 0,{number:!0}]]),(0,e.createElementVNode)('button',{class:'add-inventory-btn',disabled:!c.selected_inventory_item||!c.selected_inventory_quantity,onClick:e=>(e=>{const t=Ia.value.get(e);if(!t||!t.selected_inventory_item||!t.selected_inventory_quantity)return;t.æ‰€æŒç‰©||(t.æ‰€æŒç‰©=new Map);const a=t.æ‰€æŒç‰©.get(t.selected_inventory_item)||0;t.æ‰€æŒç‰©.set(t.selected_inventory_item,a+t.selected_inventory_quantity),t.selected_inventory_item='',t.selected_inventory_quantity=1,Ha(e)})(t)},' æ·»åŠ ç‰©å“ ',8,xa)])]),c.generated_inventory?((0,e.openBlock)(),(0,e.createElementBlock)('div',ya,[Da[62]||(Da[62]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',_a,(0,e.toDisplayString)(c.generated_inventory),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>o(t,'æ‰€æŒç‰©',c.generated_inventory)},' ä½¿ç”¨ ',8,Ea)])):(0,e.createCommentVNode)('v-if',!0)])])]),(0,e.createCommentVNode)(' ç”Ÿæˆè¦æ±‚å€åŸŸ '),(0,e.createElementVNode)('div',ka,[Da[66]||(Da[66]=(0,e.createElementVNode)('h4',null,'ç”Ÿæˆè¦æ±‚',-1)),(0,e.createElementVNode)('div',Va,[(0,e.createElementVNode)('div',Na,[Da[65]||(Da[65]=(0,e.createElementVNode)('label',null,'å°AIç”Ÿæˆçš„è¦æ±‚',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>c.generation_requirement=e,placeholder:'å°AIç”Ÿæˆçš„è¦æ±‚...',class:'text-area',rows:'3'},null,8,wa),[[e.vModelText,c.generation_requirement]])])])]),(0,e.createCommentVNode)(' ç”ŸæˆæŒ‰éˆ•å€åŸŸ '),(0,e.createElementVNode)('div',Ba,[(0,e.createElementVNode)('button',{class:'generate-btn',disabled:!La.value||za.value.get(t),onClick:e=>Ga(t)},[za.value.get(t)?((0,e.openBlock)(),(0,e.createElementBlock)('span',$a)):(0,e.createCommentVNode)('v-if',!0),(0,e.createTextVNode)(' '+(0,e.toDisplayString)(za.value.get(t)?'ç”Ÿæˆä¸­...':La.value?'ç”Ÿæˆæœªå¡«å¯«çš„å­—æ®µ':'è«‹å…ˆå®Œæˆä¸–ç•ŒèƒŒæ™¯è¨­å®š'),1)],8,Ca),(0,e.createElementVNode)('button',{class:'apply-all-btn',disabled:!Ka(c),onClick:e=>(e=>{const t=Ia.value.get(e);if(!t)return;[{generated:'generated_surname',field:'å§“æ°',parser:e=>e},{generated:'generated_name',field:'åå­—',parser:e=>e},{generated:'generated_age',field:'å¹´é½¡',parser:e=>parseInt(e)||null},{generated:'generated_gender',field:'æ€§åˆ¥',parser:e=>e},{generated:'generated_identity',field:'èº«ä»½',parser:e=>e},{generated:'generated_height',field:'èº«é«˜',parser:e=>parseInt(e)||null},{generated:'generated_weight',field:'é«”é‡',parser:e=>parseInt(e)||null},{generated:'generated_chest_size',field:'èƒ¸åœ',parser:e=>parseInt(e)||null},{generated:'generated_cup_size',field:'ç½©æ¯',parser:e=>e},{generated:'generated_waist_size',field:'è…°åœ',parser:e=>parseInt(e)||null},{generated:'generated_hips_size',field:'è‡€åœ',parser:e=>parseInt(e)||null},{generated:'generated_hairstyle',field:'é«®åž‹',parser:e=>e},{generated:'generated_appearance',field:'æ¨£è²Œ',parser:e=>e},{generated:'generated_clothes',field:'è¡£è‘—',parser:e=>e},{generated:'generated_introduction',field:'ç°¡ä»‹',parser:e=>e},{generated:'generated_personality',field:'æ€§æ ¼',parser:e=>e},{generated:'generated_favourite',field:'æ„›å¥½',parser:e=>e},{generated:'generated_money',field:'é‡‘éŒ¢',parser:e=>parseInt(e)||null},{generated:'generated_mood',field:'å¿ƒæƒ…',parser:e=>parseInt(e)||null},{generated:'generated_sexuality',field:'æ€§æ…¾',parser:e=>parseInt(e)||null},{generated:'generated_birthday_month',field:'ç”Ÿæ—¥æœˆä»½',parser:e=>parseInt(e)||null},{generated:'generated_birthday_day',field:'ç”Ÿæ—¥æ—¥æœŸ',parser:e=>parseInt(e)||null},{generated:'generated_extra_information',field:'å…¶ä»–é‡è¦è³‡è¨Š',parser:e=>e}].forEach(({generated:e,field:a,parser:n})=>{const o=t[e];o&&(t[a]=n(o),t[e]='')}),t.generated_relationship&&r(t,t.generated_relationship),t.generated_friendship&&l(t,t.generated_friendship),t.generated_love&&i(t,t.generated_love),t.generated_inventory&&d(t,t.generated_inventory),Ia.value.set(e,{...t}),Ha(e);try{localStorage.removeItem(`character_profile_generated_${e}`)}catch(t){console.error(`Failed to remove generated character profile for ${e} from localStorage:`,t)}})(t)},' æ‡‰ç”¨å…¨éƒ¨ ',8,Sa)])])]),_:2},1032,['title'])],2))),128)),(0,e.createCommentVNode)(' æ·»åŠ è§’è‰²æŒ‰éˆ• '),(0,e.createElementVNode)('div',{class:'add-character-section'},[(0,e.createElementVNode)('button',{class:'add-character-btn',onClick:Wa},[...Da[67]||(Da[67]=[(0,e.createElementVNode)('span',null,'+ æ·»åŠ è§’è‰²',-1)])])])]))}});i(5825);const za=(0,d.A)(Ia,[['__scopeId','data-v-41c909bc']]),Da={class:'extra-container'},Ta={class:'section'},Ma={class:'sortable-container'},Ya={key:0,class:'drop-indicator'},Oa=['data-id','onDragstart','onDragover','onDrop'],Aa=['onClick'],Ra={class:'fold-content'},Ka={class:'input-group'},Ua=['onUpdate:modelValue'],La={class:'input-group'},Fa=['onUpdate:modelValue'],ja={class:'input-group'},Ha=['onUpdate:modelValue'],Pa={key:0,class:'generated-result'},qa={class:'generated-text'},Ga=['onClick'],Wa={class:'item-actions'},Xa=['disabled','onClick'],Ja={key:0,class:'loading-spinner'},Za=['disabled','onClick'],Qa={key:0,class:'drop-indicator'},en=(0,e.defineComponent)({__name:'extra_tab',setup(t){const a=(0,e.ref)([]),n=(0,e.ref)(new Map),o=(0,e.computed)(()=>{try{const e=getVariables({type:'chat'});return!!e?.world_info?.trim()}catch{return!1}}),r=(0,e.ref)(null),l=(0,e.ref)(null),i=e=>{const t=a.value[e];if(t&&t.generated_content){t.content=t.generated_content,t.generated_content='',a.value[e]={...t};try{t.name&&t.name.trim()&&localStorage.removeItem(`extra_item_generated_${t.name.trim()}`)}catch(e){console.error(`Failed to remove generated extra item for ${t.name} from localStorage:`,e)}}},d=()=>{const e={id:Date.now().toString(),name:'',content:'',generation_requirement:'',is_open:!1,generated_content:''};a.value.push(e)},c=()=>{try{const e=getVariables({type:'chat'}),t=a.value.map(e=>({name:e.name,content:e.content}));e.extra_world_info=t,replaceVariables(e,{type:'chat'}),(()=>{const e=getVariables({type:'chat'});let t='';for(const a of Array.from(e.extra_world_info))''!==a.name.trim()&&''!==a.content.trim()&&(t+=`<${a.name}>\n`,t+=`${a.content}\n`,t+=`</${a.name}>\n`,t+='\n');e.extra_world_info_prompt=t,replaceVariables(e,{type:'chat'})})()}catch(e){console.error('ä¿å­˜ extra_world_info å¤±æ•—:',e)}},u=()=>{try{const e=getVariables({type:'chat'});if(e?.extra_world_info&&Array.isArray(e.extra_world_info)){const t=e.extra_world_info.map((e,t)=>({id:`loaded_${t}_${Date.now()}`,name:e.name||'æœªå‘½åé …ç›®',content:e.content||'',generation_requirement:'',is_open:!1,generated_content:''}));a.value=t}}catch(e){console.error('åŠ è¼‰ extra_world_info å¤±æ•—:',e)}},p=()=>{l.value=null},m=()=>{r.value=null,l.value=null};(0,e.onMounted)(()=>{u(),v()});const v=()=>{try{const e=localStorage.getItem('extra_tab_generation_requirements');if(e){const t=JSON.parse(e);a.value.forEach(e=>{e.name&&e.name.trim()&&t[e.name.trim()]&&(e.generation_requirement=t[e.name.trim()])})}a.value.forEach(e=>{if(e.name&&e.name.trim()){const t=localStorage.getItem(`extra_item_generated_${e.name.trim()}`);if(t)try{const a=JSON.parse(t);a[e.name.trim()]&&(e.generated_content=a[e.name.trim()])}catch(t){console.error(`Failed to parse generated content for ${e.name}:`,t)}}})}catch(e){console.error('å¾ž localStorage åŠ è¼‰ç”Ÿæˆè¦æ±‚å¤±æ•—:',e)}};(0,e.watch)(a,()=>{c(),(()=>{try{const e={};a.value.forEach(t=>{t.name&&t.name.trim()&&(e[t.name.trim()]=t.generation_requirement)}),localStorage.setItem('extra_tab_generation_requirements',JSON.stringify(e))}catch(e){console.error('ä¿å­˜ç”Ÿæˆè¦æ±‚åˆ° localStorage å¤±æ•—:',e)}})()},{deep:!0}),(0,e.watch)(()=>getVariables({type:'chat'}),e=>{e?.extra_world_info&&u()},{deep:!0});const g=e=>{let t='è«‹æ ¹æ“šä¸–ç•ŒèƒŒæ™¯è³‡è¨Šã€ç”Ÿæˆè¦æ±‚åŠå·²æœ‰é …ç›®è³‡æ–™ï¼Œç‚ºä»¥ä¸‹é …ç›®å®Œå–„å…§å®¹è¨­å®šï¼š\n\n';return t+=`åç¨±ï¼š${e.name||''}\n`,t+=`å…§å®¹ï¼š${e.content||''}\n`,t},b=()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„é …ç›®å…§å®¹è¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ è±å¯Œå¤šå½©çš„é …ç›®è¨­å®šã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºé …ç›®å®Œå–„å…§å®¹ã€‚\n';return a+='\n',a+='<ä¸–ç•ŒèƒŒæ™¯>\n','ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„é …ç›®å…§å®¹è¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ è±å¯Œå¤šå½©çš„é …ç›®è¨­å®šã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºé …ç›®å®Œå–„å…§å®¹ã€‚\n\n<ä¸–ç•ŒèƒŒæ™¯>\n'},f=e=>{let t='\n</ä¸–ç•ŒèƒŒæ™¯>\n';return t+='\n',t+=`${(()=>{const e=getVariables({type:'chat'}).characters.c1,t=`${e.å§“æ°}${e.åå­—}`;let a=`<${t}Status>\n`;return a+='idï¼šc1\n',a+=`  å§“æ°ï¼š${e.å§“æ°||''}\n`,a+=`  åå­—ï¼š${e.åå­—||''}\n`,a+=`  å¹´é½¡ï¼š${e.å¹´é½¡||''}\n`,a+=`  æ€§åˆ¥ï¼š${e.æ€§åˆ¥||''}\n`,a+=`  èº«ä»½ï¼š${e.èº«ä»½||''}\n`,a+=`  èº«é«˜ï¼š${e.èº«é«˜||''}\n`,a+=`  é«”é‡ï¼š${e.é«”é‡||''}\n`,a+=`  èƒ¸åœï¼š${e.èƒ¸åœ||''}\n`,a+=`  ç½©æ¯ï¼š${e.ç½©æ¯||''}\n`,a+=`  è…°åœï¼š${e.è…°åœ||''}\n`,a+=`  è‡€åœï¼š${e.è‡€åœ||''}\n`,a+=`  é«®åž‹ï¼š${e.é«®åž‹||''}\n`,a+=`  æ¨£è²Œï¼š${e.æ¨£è²Œ||''}\n`,a+=`  è¡£è‘—ï¼š${e.è¡£è‘—||''}\n`,a+=`  ç°¡ä»‹ï¼š${e.ç°¡ä»‹||''}\n`,a+=`  æ€§æ ¼ï¼š${e.æ€§æ ¼||''}\n`,a+=`  æ„›å¥½ï¼š${e.æ„›å¥½||''}\n`,a+=`  é‡‘éŒ¢ï¼š${e.é‡‘éŒ¢||''}\n`,a+=`  ç”Ÿæ—¥æœˆä»½ï¼š${e.ç”Ÿæ—¥æœˆä»½||''}\n`,a+=`  ç”Ÿæ—¥æ—¥æœŸï¼š${e.ç”Ÿæ—¥æ—¥æœŸ||''}\n`,a+=`  å…¶ä»–é‡è¦è³‡è¨Šï¼š${e.å…¶ä»–é‡è¦è³‡è¨Š||''}\n`,a+=`  é—œä¿‚ï¼š${h(e.é—œä¿‚)}\n`,a+=`  å‹å¥½åº¦ï¼š${h(e.å‹å¥½åº¦)}\n`,a+=`  æ„›æƒ…åº¦ï¼š${h(e.æ„›æƒ…åº¦)}\n`,a+=`</${t}Status>`,a})()}\n`,t+='\n',t+=`${(()=>{const e=getVariables({type:'chat'}).characters;if(void 0===e)return'';let t='<CharacterStatus>\n';for(const[a,n]of Object.entries(e))'c1'!==a&&(t+=`idï¼š${a}\n`,t+=`  å§“æ°ï¼š${n.å§“æ°||''}\n`,t+=`  åå­—ï¼š${n.åå­—||''}\n`,t+=`  å¹´é½¡ï¼š${n.å¹´é½¡||''}\n`,t+=`  æ€§åˆ¥ï¼š${n.æ€§åˆ¥||''}\n`,t+=`  èº«ä»½ï¼š${n.èº«ä»½||''}\n`,t+=`  èº«é«˜ï¼š${n.èº«é«˜||''}\n`,t+=`  é«”é‡ï¼š${n.é«”é‡||''}\n`,t+=`  èƒ¸åœï¼š${n.èƒ¸åœ||''}\n`,t+=`  ç½©æ¯ï¼š${n.ç½©æ¯||''}\n`,t+=`  è…°åœï¼š${n.è…°åœ||''}\n`,t+=`  è‡€åœï¼š${n.è‡€åœ||''}\n`,t+=`  é«®åž‹ï¼š${n.é«®åž‹||''}\n`,t+=`  æ¨£è²Œï¼š${n.æ¨£è²Œ||''}\n`,t+=`  è¡£è‘—ï¼š${n.è¡£è‘—||''}\n`,t+=`  ç°¡ä»‹ï¼š${n.ç°¡ä»‹||''}\n`,t+=`  æ€§æ ¼ï¼š${n.æ€§æ ¼||''}\n`,t+=`  æ„›å¥½ï¼š${n.æ„›å¥½||''}\n`,t+=`  é‡‘éŒ¢ï¼š${n.é‡‘éŒ¢||''}\n`,t+=`  å¿ƒæƒ…ï¼š${n.å¿ƒæƒ…||''}\n`,t+=`  æ€§æ…¾ï¼š${n.æ€§æ…¾||''}\n`,t+=`  ç”Ÿæ—¥æœˆä»½ï¼š${n.ç”Ÿæ—¥æœˆä»½||''}\n`,t+=`  ç”Ÿæ—¥æ—¥æœŸï¼š${n.ç”Ÿæ—¥æ—¥æœŸ||''}\n`,t+=`  å…¶ä»–é‡è¦è³‡è¨Šï¼š${n.å…¶ä»–é‡è¦è³‡è¨Š||''}\n`,t+=`  é—œä¿‚ï¼š${h(n.é—œä¿‚)}\n`,t+=`  å‹å¥½åº¦ï¼š${h(n.å‹å¥½åº¦)}\n`,t+=`  æ„›æƒ…åº¦ï¼š${h(n.æ„›æƒ…åº¦)}\n\n`);return t+='</CharacterStatus>',t})()}\n`,t+='\n',t+=`${(()=>{let e='<ItemTable>\n';e+='|id|åç¨±|æè¿°|åƒ¹å€¼|\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).items;if(void 0===t)return'';for(const[a,n]of Object.entries(t))e+=`|${a}|${n.name}|${n.description}|${n.value}|\n`;return e+='</ItemTable>',e})()}\n`,t+='\n',t+=`${(()=>{let e='<LocationTable>\n';e+='|id|åœ°é»ž|ä½ç½®|æè¿°|å­åœ°é»ž|\n',e+='|---|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.location||''}|${n.description}|${t}|\n`}return e+='</LocationTable>',e})()}\n`,t+='\n',t+=`${(()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e})()}\n`,t+='\n',t+='<ç”Ÿæˆè¦æ±‚>\n',t+=`${e.generation_requirement||'ç„¡ç‰¹æ®Šè¦æ±‚'}\n`,t+='</ç”Ÿæˆè¦æ±‚>\n',t},h=e=>'['+Object.entries(e).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']',x=(e,t)=>{t.generated_content=e};return(t,c)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',Da,[c[5]||(c[5]=(0,e.createElementVNode)('h3',null,'å…¶ä»–è¨­å®š',-1)),(0,e.createElementVNode)('div',Ta,[(0,e.createElementVNode)('div',Ma,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(a.value,(t,d)=>((0,e.openBlock)(),(0,e.createElementBlock)(e.Fragment,{key:t.id},[l.value===d&&null!==r.value&&r.value!==d?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ya)):(0,e.createCommentVNode)('v-if',!0),(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['sortable-item',{dragging:r.value===d}]),'data-id':t.id,draggable:'true',onDragstart:e=>((e,t)=>{r.value=t,e.dataTransfer&&(e.dataTransfer.effectAllowed='move')})(e,d),onDragover:(0,e.withModifiers)(e=>((e,t)=>{e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect='move');const a=e.target.getBoundingClientRect(),n=e.clientY-a.top,o=a.height;l.value=n<o/2?t:t+1})(e,d),['prevent']),onDrop:e=>((e,t)=>{e.preventDefault();const n=r.value;if(null!==n&&n!==t){const e=[...a.value],[o]=e.splice(n,1);e.splice(t,0,o),a.value=e}r.value=null})(e,d),onDragend:m,onDragleave:p},[(0,e.createVNode)(s,{title:t.name||'æœªè¨­å®š','is-open':t.is_open,class:(0,e.normalizeClass)(['draggable-fold-bar',{incomplete:!t.name||!t.content}]),onToggle:e=>(e=>{a.value[e].is_open=!a.value[e].is_open})(d)},{'title-actions':(0,e.withCtx)(()=>[(0,e.createElementVNode)('button',{class:'remove-btn',title:'ç§»é™¤æ­¤é …ç›®',onClick:(0,e.withModifiers)(e=>(e=>{a.value.splice(e,1)})(d),['stop'])},[...c[0]||(c[0]=[(0,e.createElementVNode)('span',null,'Ã—',-1)])],8,Aa)]),default:(0,e.withCtx)(()=>[(0,e.createElementVNode)('div',Ra,[(0,e.createElementVNode)('div',Ka,[c[1]||(c[1]=(0,e.createElementVNode)('label',null,'åç¨±',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>t.name=e,type:'text',class:'form-input',placeholder:'è¼¸å…¥é …ç›®åç¨±'},null,8,Ua),[[e.vModelText,t.name]])]),(0,e.createElementVNode)('div',La,[c[2]||(c[2]=(0,e.createElementVNode)('label',null,'å…§å®¹',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>t.content=e,class:'form-textarea',placeholder:'è¼¸å…¥é …ç›®å…§å®¹',rows:'3'},null,8,Fa),[[e.vModelText,t.content]])]),(0,e.createElementVNode)('div',ja,[c[3]||(c[3]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆè¦æ±‚',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>t.generation_requirement=e,class:'form-textarea',placeholder:'è¼¸å…¥ç”Ÿæˆæ­¤é …ç›®çš„è¦æ±‚',rows:'2'},null,8,Ha),[[e.vModelText,t.generation_requirement]])]),t.generated_content?((0,e.openBlock)(),(0,e.createElementBlock)('div',Pa,[c[4]||(c[4]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',qa,(0,e.toDisplayString)(t.generated_content),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>i(d)},'ä½¿ç”¨',8,Ga)])):(0,e.createCommentVNode)('v-if',!0),(0,e.createElementVNode)('div',Wa,[(0,e.createElementVNode)('button',{class:'action-btn generate',disabled:!(0,e.unref)(o)||n.value.get(t.id),onClick:e=>(async e=>{const t=a.value[e];if(t){n.value.set(t.id,!0);try{const n=g(t),o=b(),r=f(t),l=await generateRaw({user_input:n,ordered_prompts:[{role:'system',content:o},'char_description',{role:'system',content:r},'user_input']});x(l,t);try{if(t.name&&t.name.trim()){const e={};e[t.name.trim()]=t.generated_content||'',localStorage.setItem(`extra_item_generated_${t.name.trim()}`,JSON.stringify(e))}}catch(e){console.error(`Failed to save generated extra item for ${t.name} to localStorage:`,e)}a.value[e]={...t}}catch(e){console.error(`ç”Ÿæˆé …ç›® ${t.name} å…§å®¹å¤±æ•—:`,e)}finally{n.value.set(t.id,!1)}}})(d)},[n.value.get(t.id)?((0,e.openBlock)(),(0,e.createElementBlock)('span',Ja)):(0,e.createCommentVNode)('v-if',!0),(0,e.createTextVNode)(' '+(0,e.toDisplayString)(n.value.get(t.id)?'ç”Ÿæˆä¸­...':(0,e.unref)(o)?'ç”Ÿæˆå…§å®¹':'è«‹å…ˆå®Œæˆä¸–ç•ŒèƒŒæ™¯è¨­å®š'),1)],8,Xa),(0,e.createElementVNode)('button',{class:'action-btn apply',disabled:!t.generated_content,onClick:e=>i(d)},' æ‡‰ç”¨çµæžœ ',8,Za)])])]),_:2},1032,['title','is-open','class','onToggle'])],42,Oa)],64))),128)),l.value===a.value.length&&null!==r.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Qa)):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',{class:'add-item-section'},[(0,e.createElementVNode)('button',{class:'add-btn',onClick:d},'+ æ·»åŠ æ–°é …ç›®')])])]))}});i(7234);const tn=(0,d.A)(en,[['__scopeId','data-v-09fb0ec2']]),an={class:'item-tabs-container'},nn=['onClick'],on={class:'item-info-container'},rn={class:'section'},ln={class:'form-grid'},dn={class:'input-group'},sn=['onUpdate:modelValue'],cn={key:0,class:'generated-result'},un={class:'generated-text'},pn=['onClick'],mn={class:'input-group'},vn=['value','onInput'],gn={key:0,class:'generated-result'},bn={class:'generated-text'},fn=['onClick'],hn={class:'input-group full-width'},xn=['onUpdate:modelValue'],yn={key:0,class:'generated-result'},_n={class:'generated-text'},En=['onClick'],kn={class:'section'},Vn={class:'form-grid'},Nn={class:'input-group full-width'},wn=['onUpdate:modelValue'],Bn={class:'action-section'},Cn=['disabled','onClick'],$n={key:0,class:'loading-spinner'},Sn=['disabled','onClick'],In=(0,e.defineComponent)({__name:'item_tab',setup(t){const a=(e,t)=>{const a=e[t];return a?.toString()||''},n=(0,e.ref)(new Map),o=(0,e.ref)(new Map),r=(0,e.computed)(()=>{try{const e=getVariables({type:'chat'});return!!e?.world_info?.trim()}catch{return!1}}),l=(0,e.computed)(()=>{const e=new Map;for(const[t,a]of n.value)e.set(t,a);return e}),i=(0,e.computed)(()=>Array.from(l.value.entries())),d=e=>e?.name||'æœªçŸ¥ç‰©å“',c=e=>!!(e?.generated_name||e?.generated_description||e?.generated_value),u=e=>!(!e?.name?.trim()||!e?.description?.trim()||null===e?.value),p=e=>{['generated_name','generated_description','generated_value'].forEach(t=>{e[t]||(e[t]='')}),e.generation_requirement||(e.generation_requirement='')},m=e=>{try{const t=getVariables({type:'chat'}),a={...t.items||{}},o=n.value.get(e);if(!o)return;a[e]={name:o.name||'',description:o.description||'',value:o.value},t.items=a,replaceVariables(t,{type:'chat'})}catch(t){console.error(`ä¿å­˜ç‰©å“ ${e} è³‡æ–™å¤±æ•—:`,t)}};(0,e.watch)(()=>getVariables({type:'chat'}),t=>{if(t?.items){const a=new Map;for(const[n,o]of Object.entries(t.items)){const t=(0,e.reactive)(o);p(t),a.set(n,t)}n.value=a}},{deep:!0}),(0,e.watch)(n,()=>{for(const[e]of n.value.entries())m(e)},{deep:!0}),(0,e.watch)(()=>n.value,t=>{for(const[a,n]of t.entries())(0,e.watch)(()=>n.generation_requirement,e=>{try{const t=localStorage.getItem(`item_profile_generated_${a}`),n=t?JSON.parse(t):{};n.generation_requirement=e,localStorage.setItem(`item_profile_generated_${a}`,JSON.stringify(n))}catch(e){console.error(`Failed to save generation_requirement for ${a} to localStorage:`,e)}},{immediate:!1})},{deep:!0,immediate:!0}),(0,e.onMounted)(()=>{(()=>{try{const t=getVariables({type:'chat'});if(t?.items){const a=new Map;for(const[n,o]of Object.entries(t.items)){const t=(0,e.reactive)(o);p(t),a.set(n,t)}n.value=a}else n.value=new Map}catch(e){console.error('è¼‰å…¥ç‰©å“è³‡æ–™å¤±æ•—:',e),n.value=new Map}try{for(const[e,t]of n.value){const a=localStorage.getItem(`item_profile_generated_${e}`);a&&Object.assign(t,JSON.parse(a))}}catch(e){console.error('Failed to load generated item profiles from localStorage:',e)}})()});const v=(e,t,a)=>{const o=n.value.get(e);if(!o)return;const r={name:{field:'name'},description:{field:'description'},value:{field:'value',parser:e=>parseInt(e)||null}}[t];if(r){const e=r.parser?r.parser(a):a;o[r.field]=e,o[`generated_${t}`]=''}n.value.set(e,{...o}),m(e)},g=e=>'['+Object.entries(e).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']',b=()=>{const t=(()=>{const e=Array.from(n.value.keys());let t=1;for(;e.includes(`i${t}`);)t++;return`i${t}`})(),a=(0,e.reactive)({name:'',description:'',value:null,generation_requirement:'',generated_name:'',generated_description:'',generated_value:''});n.value.set(t,a);try{const e=getVariables({type:'chat'}).items||{};e[t]={name:'',description:'',value:null},insertOrAssignVariables({items:e},{type:'chat'})}catch(e){console.error('Failed to add new item to chat variables:',e)}},f=e=>{let t='\n</ä¸–ç•ŒèƒŒæ™¯>\n';return t+='\n',t+=`${(()=>{const e=getVariables({type:'chat'}).characters.c1,t=`${e.å§“æ°}${e.åå­—}`;let a=`<${t}Status>\n`;return a+='idï¼šc1\n',a+=`  å§“æ°ï¼š${e.å§“æ°||''}\n`,a+=`  åå­—ï¼š${e.åå­—||''}\n`,a+=`  å¹´é½¡ï¼š${e.å¹´é½¡||''}\n`,a+=`  æ€§åˆ¥ï¼š${e.æ€§åˆ¥||''}\n`,a+=`  èº«ä»½ï¼š${e.èº«ä»½||''}\n`,a+=`  èº«é«˜ï¼š${e.èº«é«˜||''}\n`,a+=`  é«”é‡ï¼š${e.é«”é‡||''}\n`,a+=`  èƒ¸åœï¼š${e.èƒ¸åœ||''}\n`,a+=`  ç½©æ¯ï¼š${e.ç½©æ¯||''}\n`,a+=`  è…°åœï¼š${e.è…°åœ||''}\n`,a+=`  è‡€åœï¼š${e.è‡€åœ||''}\n`,a+=`  é«®åž‹ï¼š${e.é«®åž‹||''}\n`,a+=`  æ¨£è²Œï¼š${e.æ¨£è²Œ||''}\n`,a+=`  è¡£è‘—ï¼š${e.è¡£è‘—||''}\n`,a+=`  ç°¡ä»‹ï¼š${e.ç°¡ä»‹||''}\n`,a+=`  æ€§æ ¼ï¼š${e.æ€§æ ¼||''}\n`,a+=`  æ„›å¥½ï¼š${e.æ„›å¥½||''}\n`,a+=`  é‡‘éŒ¢ï¼š${e.é‡‘éŒ¢||''}\n`,a+=`  ç”Ÿæ—¥æœˆä»½ï¼š${e.ç”Ÿæ—¥æœˆä»½||''}\n`,a+=`  ç”Ÿæ—¥æ—¥æœŸï¼š${e.ç”Ÿæ—¥æ—¥æœŸ||''}\n`,a+=`  å…¶ä»–é‡è¦è³‡è¨Šï¼š${e.å…¶ä»–é‡è¦è³‡è¨Š||''}\n`,a+=`  é—œä¿‚ï¼š${g(e.é—œä¿‚)}\n`,a+=`  å‹å¥½åº¦ï¼š${g(e.å‹å¥½åº¦)}\n`,a+=`  æ„›æƒ…åº¦ï¼š${g(e.æ„›æƒ…åº¦)}\n`,a+=`</${t}Status>`,a})()}\n`,t+='\n',t+=`${(()=>{const e=getVariables({type:'chat'}).characters;if(void 0===e)return'';let t='<CharacterStatus>\n';for(const[a,n]of Object.entries(e))'c1'!==a&&(t+=`idï¼š${a}\n`,t+=`  å§“æ°ï¼š${n.å§“æ°||''}\n`,t+=`  åå­—ï¼š${n.åå­—||''}\n`,t+=`  å¹´é½¡ï¼š${n.å¹´é½¡||''}\n`,t+=`  æ€§åˆ¥ï¼š${n.æ€§åˆ¥||''}\n`,t+=`  èº«ä»½ï¼š${n.èº«ä»½||''}\n`,t+=`  èº«é«˜ï¼š${n.èº«é«˜||''}\n`,t+=`  é«”é‡ï¼š${n.é«”é‡||''}\n`,t+=`  èƒ¸åœï¼š${n.èƒ¸åœ||''}\n`,t+=`  ç½©æ¯ï¼š${n.ç½©æ¯||''}\n`,t+=`  è…°åœï¼š${n.è…°åœ||''}\n`,t+=`  è‡€åœï¼š${n.è‡€åœ||''}\n`,t+=`  é«®åž‹ï¼š${n.é«®åž‹||''}\n`,t+=`  æ¨£è²Œï¼š${n.æ¨£è²Œ||''}\n`,t+=`  è¡£è‘—ï¼š${n.è¡£è‘—||''}\n`,t+=`  ç°¡ä»‹ï¼š${n.ç°¡ä»‹||''}\n`,t+=`  æ€§æ ¼ï¼š${n.æ€§æ ¼||''}\n`,t+=`  æ„›å¥½ï¼š${n.æ„›å¥½||''}\n`,t+=`  é‡‘éŒ¢ï¼š${n.é‡‘éŒ¢||''}\n`,t+=`  å¿ƒæƒ…ï¼š${n.å¿ƒæƒ…||''}\n`,t+=`  æ€§æ…¾ï¼š${n.æ€§æ…¾||''}\n`,t+=`  ç”Ÿæ—¥æœˆä»½ï¼š${n.ç”Ÿæ—¥æœˆä»½||''}\n`,t+=`  ç”Ÿæ—¥æ—¥æœŸï¼š${n.ç”Ÿæ—¥æ—¥æœŸ||''}\n`,t+=`  å…¶ä»–é‡è¦è³‡è¨Šï¼š${n.å…¶ä»–é‡è¦è³‡è¨Š||''}\n`,t+=`  é—œä¿‚ï¼š${g(n.é—œä¿‚)}\n`,t+=`  å‹å¥½åº¦ï¼š${g(n.å‹å¥½åº¦)}\n`,t+=`  æ„›æƒ…åº¦ï¼š${g(n.æ„›æƒ…åº¦)}\n\n`);return t+='</CharacterStatus>',t})()}\n`,t+='\n',t+=`${(()=>{let e='<ItemTable>\n';e+='|id|åç¨±|æè¿°|åƒ¹å€¼|\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).items;if(void 0===t)return'';for(const[a,n]of Object.entries(t))e+=`|${a}|${n.name}|${n.description}|${n.value}|\n`;return e+='</ItemTable>',e})()}\n`,t+='\n',t+=`${(()=>{let e='<LocationTable>\n';e+='|id|åœ°é»ž|ä½ç½®|æè¿°|å­åœ°é»ž|\n',e+='|---|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.location||''}|${n.description}|${t}|\n`}return e+='</LocationTable>',e})()}\n`,t+='\n',t+=`${(()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e})()}\n`,t+='\n',t+='<ç”Ÿæˆè¦æ±‚>\n',t+=`${e.generation_requirement||'ç„¡ç‰¹æ®Šè¦æ±‚'}\n`,t+='</ç”Ÿæˆè¦æ±‚>\n',t+='\n',t+='<example>\n',t+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output. Output anything other than this format is prohibited.\n',t+='åç¨±ï¼šstring\n',t+='æè¿°ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',t+='åƒ¹å€¼ï¼šnumber\n',t+='</example>\n',t},h=async e=>{const t=n.value.get(e);if(!t)return;const a=new Map(o.value);a.set(e,!0),o.value=a;try{const a=(e=>{let t='è«‹æ ¹æ“šä¸–ç•ŒèƒŒæ™¯è³‡è¨Šã€ç”Ÿæˆè¦æ±‚åŠå·²æœ‰ç‰©å“è³‡æ–™ï¼Œç‚ºä»¥ä¸‹ç‰©å“å®Œå–„ç‰©å“è³‡æ–™è¨­å®šï¼š\n\n';return t+=`åç¨±ï¼š${e.name||''}\n`,t+=`æè¿°ï¼š${e.description||''}\n`,t+=`åƒ¹å€¼ï¼š${e.value||''}\n`,t})(t),o=(()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„ç‰©å“è¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ è±å¯Œå¤šå½©çš„ç‰©å“è¨­å®šã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºç‰©å“å®Œå–„è³‡æ–™ã€‚\n';return a+='\n',a+='<ä¸–ç•ŒèƒŒæ™¯>\n','ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„ç‰©å“è¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ è±å¯Œå¤šå½©çš„ç‰©å“è¨­å®šã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºç‰©å“å®Œå–„è³‡æ–™ã€‚\n\n<ä¸–ç•ŒèƒŒæ™¯>\n'})(),r=f(t);((e,t)=>{const a=e.split('\n');for(const e of a){const a=e.indexOf('ï¼š');if(a>0){const n=e.substring(0,a).trim(),o=e.substring(a+1).trim();switch(n){case'åç¨±':t.generated_name=o.replace(/^["']|["']$/g,'');break;case'æè¿°':t.generated_description=o.replace(/^["']|["']$/g,'');break;case'åƒ¹å€¼':t.generated_value=o.replace(/[^\d]/g,'')}}}})(await generateRaw({user_input:a,ordered_prompts:[{role:'system',content:o},'char_description',{role:'system',content:r},'user_input']}),t);try{localStorage.setItem(`item_profile_generated_${e}`,JSON.stringify({generation_requirement:t.generation_requirement,generated_name:t.generated_name,generated_description:t.generated_description,generated_value:t.generated_value}))}catch(t){console.error(`Failed to save generated item profile for ${e} to localStorage:`,t)}n.value.set(e,{...t})}catch(a){console.error(`ç”Ÿæˆç‰©å“ ${e} è³‡æ–™å¤±æ•—:`,a),t.generated_name='ç”Ÿæˆå¤±æ•—ï¼Œè«‹é‡è©¦ã€‚'}finally{const t=new Map(o.value);t.set(e,!1),o.value=t}};return(t,l)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',an,[l[11]||(l[11]=(0,e.createElementVNode)('h3',null,'ç‰©å“è³‡æ–™è¨­å®š',-1)),(0,e.createCommentVNode)(' å…¶ä»–ç‰©å“å‹•æ…‹æ‘ºç–Šæ¬„ '),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(i.value,([t,i])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:(0,e.normalizeClass)(['item-fold-bar',{'item-incomplete':!u(i)}])},[(0,e.createVNode)(s,{title:`${t}: ${d(i)}`,'is-open':!1},{'title-actions':(0,e.withCtx)(()=>[(0,e.createElementVNode)('button',{class:'remove-item-btn',title:'ç§»é™¤ç‰©å“',onClick:e=>(e=>{n.value.delete(e);try{const t=getVariables({type:'chat'});delete t.items[e],replaceVariables(t,{type:'chat'})}catch(t){console.error(`Failed to remove item ${e} from chat variables:`,t)}})(t)},[...l[0]||(l[0]=[(0,e.createElementVNode)('span',null,'Ã—',-1)])],8,nn)]),default:(0,e.withCtx)(()=>[(0,e.createElementVNode)('div',on,[(0,e.createElementVNode)('div',rn,[l[7]||(l[7]=(0,e.createElementVNode)('h4',null,'åŸºæœ¬è³‡è¨Š',-1)),(0,e.createElementVNode)('div',ln,[(0,e.createElementVNode)('div',dn,[l[2]||(l[2]=(0,e.createElementVNode)('label',null,'åç¨±',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>i.name=e,type:'text',placeholder:'ä¾‹å¦‚ï¼šé­”æ³•æ›¸',class:'text-input'},null,8,sn),[[e.vModelText,i.name]]),i.generated_name?((0,e.openBlock)(),(0,e.createElementBlock)('div',cn,[l[1]||(l[1]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',un,(0,e.toDisplayString)(i.generated_name),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>v(t,'name',i.generated_name)},' ä½¿ç”¨ ',8,pn)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',mn,[l[4]||(l[4]=(0,e.createElementVNode)('label',null,'åƒ¹å€¼',-1)),(0,e.createElementVNode)('input',{value:a(i,'value'),type:'number',placeholder:'ä¾‹å¦‚ï¼š100',class:'text-input',min:'0',onInput:e=>((e,t,a)=>{if(''===a||''===a.trim())e[t]=null;else{const n=parseInt(a);e[t]=isNaN(n)?null:n}})(i,'value',e.target.value)},null,40,vn),i.generated_value?((0,e.openBlock)(),(0,e.createElementBlock)('div',gn,[l[3]||(l[3]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',bn,(0,e.toDisplayString)(i.generated_value),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>v(t,'value',i.generated_value)},' ä½¿ç”¨ ',8,fn)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',hn,[l[6]||(l[6]=(0,e.createElementVNode)('label',null,'æè¿°',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>i.description=e,placeholder:'æè¿°ç‰©å“çš„ç‰¹é»ž...',class:'text-area',rows:'3'},null,8,xn),[[e.vModelText,i.description]]),i.generated_description?((0,e.openBlock)(),(0,e.createElementBlock)('div',yn,[l[5]||(l[5]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',_n,(0,e.toDisplayString)(i.generated_description),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>v(t,'description',i.generated_description)},' ä½¿ç”¨ ',8,En)])):(0,e.createCommentVNode)('v-if',!0)])])]),(0,e.createCommentVNode)(' ç”Ÿæˆè¦æ±‚å€åŸŸ '),(0,e.createElementVNode)('div',kn,[l[9]||(l[9]=(0,e.createElementVNode)('h4',null,'ç”Ÿæˆè¦æ±‚',-1)),(0,e.createElementVNode)('div',Vn,[(0,e.createElementVNode)('div',Nn,[l[8]||(l[8]=(0,e.createElementVNode)('label',null,'å°AIç”Ÿæˆçš„è¦æ±‚',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>i.generation_requirement=e,placeholder:'å°AIç”Ÿæˆçš„è¦æ±‚...',class:'text-area',rows:'3'},null,8,wn),[[e.vModelText,i.generation_requirement]])])])]),(0,e.createCommentVNode)(' ç”ŸæˆæŒ‰éˆ•å€åŸŸ '),(0,e.createElementVNode)('div',Bn,[(0,e.createElementVNode)('button',{class:'generate-btn',disabled:!r.value||o.value.get(t),onClick:e=>h(t)},[o.value.get(t)?((0,e.openBlock)(),(0,e.createElementBlock)('span',$n)):(0,e.createCommentVNode)('v-if',!0),(0,e.createTextVNode)(' '+(0,e.toDisplayString)(o.value.get(t)?'ç”Ÿæˆä¸­...':r.value?'ç”Ÿæˆæœªå¡«å¯«çš„å­—æ®µ':'è«‹å…ˆå®Œæˆä¸–ç•ŒèƒŒæ™¯è¨­å®š'),1)],8,Cn),(0,e.createElementVNode)('button',{class:'apply-all-btn',disabled:!c(i),onClick:e=>(e=>{const t=n.value.get(e);if(!t)return;[{generated:'generated_name',field:'name',parser:e=>e},{generated:'generated_description',field:'description',parser:e=>e},{generated:'generated_value',field:'value',parser:e=>parseInt(e)||null}].forEach(({generated:e,field:a,parser:n})=>{const o=t[e];o&&(t[a]=n(o),t[e]='')}),n.value.set(e,{...t}),m(e);try{localStorage.removeItem(`item_profile_generated_${e}`)}catch(t){console.error(`Failed to remove generated item profile for ${e} from localStorage:`,t)}})(t)},' æ‡‰ç”¨å…¨éƒ¨ ',8,Sn)])])]),_:2},1032,['title'])],2))),128)),(0,e.createCommentVNode)(' æ·»åŠ ç‰©å“æŒ‰éˆ• '),(0,e.createElementVNode)('div',{class:'add-item-section'},[(0,e.createElementVNode)('button',{class:'add-item-btn',onClick:b},[...l[10]||(l[10]=[(0,e.createElementVNode)('span',null,'+ æ·»åŠ ç‰©å“',-1)])])])]))}});i(2270);const zn=(0,d.A)(In,[['__scopeId','data-v-d8256cea']]),Dn={class:'location-tabs-container'},Tn=['onClick'],Mn={class:'location-info-container'},Yn={class:'section'},On={class:'form-grid'},An={class:'input-group'},Rn=['onUpdate:modelValue'],Kn={key:0,class:'generated-result'},Un={class:'generated-text'},Ln=['onClick'],Fn={class:'input-group'},jn=['onUpdate:modelValue'],Hn={key:0,class:'generated-result'},Pn={class:'generated-text'},qn=['onClick'],Gn={class:'input-group full-width'},Wn=['onUpdate:modelValue'],Xn={key:0,class:'generated-result'},Jn={class:'generated-text'},Zn=['onClick'],Qn={class:'input-group full-width'},eo={key:0,class:'generated-result'},to={class:'generated-text'},ao=['onClick'],no={class:'input-group full-width'},oo={class:'sub-locations-container'},ro=['value','onChange'],lo=['value','disabled'],io=['onClick'],so=['onClick'],co={class:'section'},uo={class:'form-grid'},po={class:'input-group full-width'},mo=['onUpdate:modelValue'],vo={class:'action-section'},go=['disabled','onClick'],bo={key:0,class:'loading-spinner'},fo=['disabled','onClick'],ho={class:'bulk-generate-section'},xo={class:'form-grid'},yo={class:'input-group'},_o={class:'count-input-row'},Eo=['disabled'],ko={class:'ai-count-checkbox'},Vo={class:'input-group full-width'},No=['disabled'],wo={key:0,class:'loading-spinner'},Bo=(0,e.defineComponent)({__name:'location_tab',setup(t){const a=(0,e.ref)(new Map),n=(0,e.ref)(new Map),o=(0,e.ref)(!1),r=(0,e.ref)(3),l=(0,e.ref)(''),i=(0,e.ref)(!1),d=['generated_name','generated_location','generated_description'],c=['generated_name','generated_location','generated_description','generated_sub_location'],u=(0,e.computed)(()=>{try{const e=getVariables({type:'chat'});return!!e?.world_info?.trim()}catch{return!1}}),p=(0,e.computed)(()=>Array.from(a.value.entries())),m=e=>e?.name||'æœªçŸ¥åœ°é»ž',v=e=>!!(e?.generated_name||e?.generated_location||e?.generated_description||e?.generated_sub_location),g=e=>!!(e?.name?.trim()&&e?.location?.trim()&&e?.description?.trim()),b=e=>{d.forEach(t=>{e[t]||(e[t]='')}),e.generated_sub_location||(e.generated_sub_location=[]),e.sub_location||(e.sub_location=[]),e.location||(e.location=''),e.generated_location||(e.generated_location=''),e.generation_requirement||(e.generation_requirement='')},f=e=>{try{const t=getVariables({type:'chat'}),n={...t.locations||{}},o=a.value.get(e);if(!o)return;n[e]={name:o.name||'',location:o.location||'',description:o.description||'',sub_location:o.sub_location||[]},t.locations=n,replaceVariables(t,{type:'chat'})}catch(t){console.error(`ä¿å­˜åœ°é»ž ${e} è³‡æ–™å¤±æ•—:`,t)}};(0,e.watch)(()=>getVariables({type:'chat'}),t=>{if(t?.locations){const n=new Map;for(const[a,o]of Object.entries(t.locations)){const t=(0,e.reactive)(o);b(t),n.set(a,t)}a.value=n}},{deep:!0}),(0,e.watch)(a,()=>{for(const[e]of a.value.entries())f(e)},{deep:!0}),(0,e.watch)(()=>a.value,t=>{for(const[a,n]of t.entries())(0,e.watch)(()=>n.generation_requirement,e=>{try{const t=localStorage.getItem(`location_profile_generated_${a}`),n=t?JSON.parse(t):{};n.generation_requirement=e,localStorage.setItem(`location_profile_generated_${a}`,JSON.stringify(n))}catch(e){console.error(`Failed to save generation_requirement for ${a} to localStorage:`,e)}},{immediate:!1})},{deep:!0,immediate:!0}),(0,e.onMounted)(()=>{(()=>{try{const t=getVariables({type:'chat'});if(t?.locations){const n=new Map;for(const[a,o]of Object.entries(t.locations)){const t=(0,e.reactive)(o);b(t),n.set(a,t)}a.value=n}else a.value=new Map}catch(e){console.error('è¼‰å…¥åœ°é»žè³‡æ–™å¤±æ•—:',e),a.value=new Map}try{for(const[e,t]of a.value){const a=localStorage.getItem(`location_profile_generated_${e}`);a&&Object.assign(t,JSON.parse(a))}}catch(e){console.error('Failed to load generated location profiles from localStorage:',e)}try{const e=localStorage.getItem('bulk_location_generation_requirement');e&&(l.value=e);const t=localStorage.getItem('bulk_location_allow_ai_count');t&&(i.value='true'===t)}catch(e){console.error('Failed to load bulk generation settings from localStorage:',e)}})()});const h=()=>{const e=Array.from(a.value.keys());let t=1;for(;e.includes(`l${t}`);)t++;return`l${t}`},x=(e,t,n)=>{const o=a.value.get(e);if(!o)return;const r={name:{field:'name'},location:{field:'location'},description:{field:'description'},sub_location:{field:'sub_location',parser:e=>e}}[t];if(r){const e=r.parser?r.parser(n):n;o[r.field]=e,o[`generated_${t}`]=''}a.value.set(e,{...o}),f(e)},y=()=>{const t=h(),n=(0,e.reactive)({name:'',location:'',description:'',sub_location:[],generation_requirement:'',generated_name:'',generated_location:'',generated_description:'',generated_sub_location:[]});a.value.set(t,n);try{const e=getVariables({type:'chat'}).locations||{};e[t]={name:'',location:'',description:'',sub_location:[]},insertOrAssignVariables({locations:e},{type:'chat'})}catch(e){console.error('Failed to add new location to chat variables:',e)}},E=()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„åœ°é»žè¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ è±å¯Œå¤šå½©çš„åœ°é»žè¨­å®šã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºåœ°é»žå®Œå–„è³‡æ–™ã€‚\n';return a+='\n',a+='<ä¸–ç•ŒèƒŒæ™¯>\n','ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„åœ°é»žè¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ è±å¯Œå¤šå½©çš„åœ°é»žè¨­å®šã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºåœ°é»žå®Œå–„è³‡æ–™ã€‚\n\n<ä¸–ç•ŒèƒŒæ™¯>\n'},k=['å§“æ°','åå­—','å¹´é½¡','æ€§åˆ¥','èº«ä»½','èº«é«˜','é«”é‡','èƒ¸åœ','ç½©æ¯','è…°åœ','è‡€åœ','é«®åž‹','æ¨£è²Œ','è¡£è‘—','ç°¡ä»‹','æ€§æ ¼','æ„›å¥½','é‡‘éŒ¢','ç”Ÿæ—¥æœˆä»½','ç”Ÿæ—¥æ—¥æœŸ','å…¶ä»–é‡è¦è³‡è¨Š'],V=['é—œä¿‚','å‹å¥½åº¦','æ„›æƒ…åº¦'],N=(e,t,a=!1)=>{let n=`idï¼š${t}\n`;return k.forEach(t=>{n+=`  ${t}ï¼š${e[t]||''}\n`}),a&&(n+=`  å¿ƒæƒ…ï¼š${e.å¿ƒæƒ…||''}\n`,n+=`  æ€§æ…¾ï¼š${e.æ€§æ…¾||''}\n`),V.forEach(t=>{var a;n+=`  ${t}ï¼š${a=e[t],'['+Object.entries(a).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']'}\n`}),n},w=()=>{const e=getVariables({type:'chat'}).characters.c1,t=`${e.å§“æ°}${e.åå­—}`;let a=`<${t}Status>\n`;return a+=N(e,'c1'),a+=`</${t}Status>`,a},B=()=>{const e=getVariables({type:'chat'}).characters;if(void 0===e)return'';let t='<CharacterStatus>\n';for(const[a,n]of Object.entries(e))'c1'!==a&&(t+=N(n,a,!0)+'\n');return t+='</CharacterStatus>',t},C=()=>{let e='<LocationTable>\n';e+='|id|åœ°é»ž|ä½ç½®|æè¿°|å­åœ°é»ž|\n',e+='|---|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.location||''}|${n.description}|${t}|\n`}return e+='</LocationTable>',e},S=()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e},I={id:{field:'id',parser:e=>e.replace(/^["']|["']$/g,'')},åœ°é»ž:{field:'name',parser:e=>e.replace(/^["']|["']$/g,'')},ä½ç½®:{field:'location',parser:e=>e.replace(/^["']|["']$/g,'')},æè¿°:{field:'description',parser:e=>e.replace(/^["']|["']$/g,'')},å­åœ°é»ž:{field:'sub_location',parser:e=>{try{let t=e;t.startsWith('\'')&&t.endsWith('\'')&&(t=t.slice(1,-1)),t=t.replace(/'/g,'"');const a=JSON.parse(t);return Array.isArray(a)?a:[]}catch(t){return console.warn('Failed to parse sub_location:',e,t),[]}}}},D=(e,t,a=!1)=>{const n=e.indexOf('ï¼š');if(n<=0)return;const o=e.substring(0,n).trim(),r=e.substring(n+1).trim(),l=I[o];if(l){t[a?`generated_${l.field}`:l.field]=l.parser(r)}},T=async e=>{const t=a.value.get(e);if(!t)return;const o=new Map(n.value);o.set(e,!0),n.value=o;try{const n=(e=>{let t='è«‹æ ¹æ“šä¸–ç•ŒèƒŒæ™¯è³‡è¨Šã€ç”Ÿæˆè¦æ±‚åŠå·²æœ‰åœ°é»žè³‡æ–™ï¼Œç‚ºä»¥ä¸‹åœ°é»žå®Œå–„åœ°é»žè³‡æ–™è¨­å®šï¼š\n\n';return t+=`idï¼š${e.id||''}\n`,t+=`åœ°é»žï¼š${e.name||''}\n`,t+=`ä½ç½®ï¼š${e.location||''}\n`,t+=`æè¿°ï¼š${e.description||''}\n`,t+=`å­åœ°é»žï¼š${e.sub_location&&e.sub_location.length>0?JSON.stringify(e.sub_location):'[]'}\n`,t+='\nè«‹ç”Ÿæˆä¸€å€‹å”¯ä¸€çš„åœ°é»žIDï¼Œæ ¼å¼å¿…é ˆæ˜¯ "l1", "l2", "l3", ... ä¸”ä¸èƒ½èˆ‡ç¾æœ‰åœ°é»žIDé‡è¤‡ã€‚\n',t})(t),o=E(),r=(e=>{let t='\n</ä¸–ç•ŒèƒŒæ™¯>\n';return t+='\n',t+=`${w()}\n`,t+='\n',t+=`${B()}\n`,t+='\n',t+=`${C()}\n`,t+='\n',t+=`${S()}\n`,t+='\n',t+='<ç”Ÿæˆè¦æ±‚>\n',t+=`${e.generation_requirement||'ç„¡ç‰¹æ®Šè¦æ±‚'}\n`,t+='</ç”Ÿæˆè¦æ±‚>\n',t+='\n',t+='<å­åœ°é»žèªªæ˜Ž>\n',t+='å­åœ°é»žè¡¨ç¤ºç›´æŽ¥åŒ…å«åœ¨ç•¶å‰åœ°é»žå…§çš„å­å€åŸŸã€‚ä¾‹å¦‚ï¼š\n',t+='- å¦‚æžœåœ°é»ž l2 ä½æ–¼åœ°é»ž l1 å…§ï¼Œå‰‡ l2 æ˜¯ l1 çš„å­åœ°é»ž\n',t+='- å¦‚æžœåœ°é»ž l3 æ˜¯ l2 çš„å­åœ°é»žï¼Œå‰‡ l3 ä¸æ˜¯ l1 çš„å­åœ°é»žï¼ˆå› ç‚º l3 é–“æŽ¥ä½æ–¼ l1 å…§ï¼‰\n',t+='- å­åœ°é»židå¿…é ˆæ˜¯ç¾æœ‰çš„åœ°é»židï¼Œä¸èƒ½ä½¿ç”¨ä¸å­˜åœ¨çš„id\n',t+='</å­åœ°é»žèªªæ˜Ž>\n',t+='\n',t+='<example>\n',t+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output. Output anything other than this format is prohibited.\n',t+='idï¼šl1\n',t+='åœ°é»žï¼š\'åœ°é»žåç¨±\'\n',t+='ä½ç½®ï¼š\'åœ°é»žçš„åœ°ç†ä½ç½®\'\n',t+='æè¿°ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',t+='å­åœ°é»žï¼š[\'l2\', \'l4\']\n',t+='</example>\n',t})(t);((e,t)=>{e.split('\n').forEach(e=>D(e,t,!0))})(await generateRaw({user_input:n,ordered_prompts:[{role:'system',content:o},'char_description',{role:'system',content:r},'user_input']}),t);try{localStorage.setItem(`location_profile_generated_${e}`,JSON.stringify({generation_requirement:t.generation_requirement,generated_name:t.generated_name,generated_location:t.generated_location,generated_description:t.generated_description,generated_sub_location:t.generated_sub_location}))}catch(t){console.error(`Failed to save generated location profile for ${e} to localStorage:`,t)}a.value.set(e,{...t})}catch(a){console.error(`ç”Ÿæˆåœ°é»ž ${e} è³‡æ–™å¤±æ•—:`,a),t.generated_name='ç”Ÿæˆå¤±æ•—ï¼Œè«‹é‡è©¦ã€‚'}finally{const t=new Map(n.value);t.set(e,!1),n.value=t}},M=async()=>{if(i.value||!(r.value<1||r.value>10)){o.value=!0;try{try{localStorage.setItem('bulk_location_generation_requirement',l.value),localStorage.setItem('bulk_location_allow_ai_count',i.value.toString())}catch(e){console.error('Failed to save bulk generation settings to localStorage:',e)}const t=`è«‹æ ¹æ“šä¸–ç•ŒèƒŒæ™¯è³‡è¨Šå’Œæ‰¹é‡ç”Ÿæˆè¦æ±‚ï¼Œ${i.value?'è«‹æ ¹æ“šä¸–ç•ŒèƒŒæ™¯å’Œç”Ÿæˆè¦æ±‚è‡ªè¡Œæ±ºå®šç”Ÿæˆé©ç•¶æ•¸é‡çš„åœ°é»ž':`è«‹ä¸€æ¬¡æ€§ç”Ÿæˆ ${r.value} å€‹åœ°é»ž`}ã€‚æ¯å€‹åœ°é»žæ‡‰åŒ…å«åœ°é»žåç¨±ã€ä½ç½®ã€æè¿°å’Œå­åœ°é»žæ•¸çµ„ã€‚\n\næ‰¹é‡ç”Ÿæˆè¦æ±‚ï¼š${l.value||'ç„¡ç‰¹æ®Šè¦æ±‚'}\n\nè«‹ä»¥ä»¥ä¸‹æ ¼å¼è¼¸å‡ºï¼Œæ¯å€‹åœ°é»žå ä¸€è¡Œï¼š\nidï¼šl1\nåœ°é»žï¼šåœ°é»žåç¨±\nä½ç½®ï¼šåœ°é»žçš„åœ°ç†ä½ç½®\næè¿°ï¼šåœ°é»žæè¿°\nå­åœ°é»žï¼š['å­åœ°é»žid1', 'å­åœ°é»žid2', ...]\n\n---\n\nè«‹æ³¨æ„ï¼š\n- idæ ¼å¼å¿…é ˆæ˜¯ "l1", "l2", "l3", ... ä¸”ä¸èƒ½èˆ‡ç¾æœ‰åœ°é»židé‡è¤‡\n- å­åœ°é»žIDå¿…é ˆæ˜¯ç¾æœ‰çš„åœ°é»židï¼Œä¸èƒ½ä½¿ç”¨ä¸å­˜åœ¨çš„id\n`,n=E(),o=(()=>{let e='\n</ä¸–ç•ŒèƒŒæ™¯>\n';return e+='\n',e+=`${w()}\n`,e+='\n',e+=`${B()}\n`,e+='\n',e+=`${C()}\n`,e+='\n',e+=`${S()}\n`,e+='\n',e+='<å­åœ°é»žèªªæ˜Ž>\n',e+='å­åœ°é»žè¡¨ç¤ºç›´æŽ¥åŒ…å«åœ¨ç•¶å‰åœ°é»žå…§çš„å­å€åŸŸã€‚ä¾‹å¦‚ï¼š\n',e+='- å¦‚æžœåœ°é»ž l2 ä½æ–¼åœ°é»ž l1 å…§ï¼Œå‰‡ l2 æ˜¯ l1 çš„å­åœ°é»ž\n',e+='- å¦‚æžœåœ°é»ž l3 æ˜¯ l2 çš„å­åœ°é»žï¼Œå‰‡ l3 ä¸æ˜¯ l1 çš„å­åœ°é»žï¼ˆå› ç‚º l3 é–“æŽ¥ä½æ–¼ l1 å…§ï¼‰\n',e+='- å­åœ°é»židå¿…é ˆæ˜¯ç¾æœ‰çš„åœ°é»židï¼Œä¸èƒ½ä½¿ç”¨ä¸å­˜åœ¨çš„id\n',e+='</å­åœ°é»žèªªæ˜Ž>\n',e+='\n',i.value&&(e+='<ç”Ÿæˆæ•¸é‡èªªæ˜Ž>\n',e+='è«‹æ ¹æ“šä¸–ç•ŒèƒŒæ™¯å’Œç”Ÿæˆè¦æ±‚æ±ºå®šç”Ÿæˆé©ç•¶æ•¸é‡çš„åœ°é»žã€‚\n',e+='è«‹æ ¹æ“šä¸–ç•ŒèƒŒæ™¯çš„è¤‡é›œåº¦å’Œç”Ÿæˆè¦æ±‚çš„å…·é«”æ€§ä¾†æ±ºå®šæ•¸é‡ã€‚\n',e+='</ç”Ÿæˆæ•¸é‡èªªæ˜Ž>\n',e+='\n'),e+='<example>\n',e+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output. Output anything other than this format is prohibited.\n',e+='idï¼šl1\n',e+='åœ°é»žï¼š\'åœ°é»žåç¨±\'\n',e+='ä½ç½®ï¼š\'åœ°é»žçš„åœ°ç†ä½ç½®\'\n',e+='æè¿°ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',e+='å­åœ°é»žï¼š[\'id\', ...]\n',e+='\n---\n',e+='idï¼šl2\n',e+='åœ°é»žï¼š\'åœ°é»žåç¨±\'\n',e+='ä½ç½®ï¼š\'åœ°é»žçš„åœ°ç†ä½ç½®\'\n',e+='æè¿°ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',e+='å­åœ°é»žï¼š[\'id\', ...]\n',e+='</example>\n',e})(),d=(e=>{const t=[],a=e.split('---').map(e=>e.trim()).filter(e=>e);for(const e of a){const a=e.split('\n'),n={id:'',name:'',location:'',description:'',sub_location:[]};a.forEach(e=>D(e,n)),n.name&&n.name.trim()&&t.push(n)}return t})(await generateRaw({user_input:t,ordered_prompts:[{role:'system',content:n},'char_description',{role:'system',content:o},'user_input']}));for(const t of d){const n=t.id||h(),o={id:n,name:t.name||'',location:t.location||'',description:t.description||'',sub_location:t.sub_location||[],generation_requirement:l.value,generated_name:'',generated_location:'',generated_description:'',generated_sub_location:[]},r=(0,e.reactive)(o);a.value.set(n,r);try{const e=getVariables({type:'chat'}).locations||{};e[n]={name:o.name,location:o.location,description:o.description,sub_location:o.sub_location},insertOrAssignVariables({locations:e},{type:'chat'})}catch(e){console.error('Failed to add bulk generated location to chat variables:',e)}}toastr.success(`æˆåŠŸç”Ÿæˆ ${d.length} å€‹åœ°é»žï¼`)}catch(e){console.error('æ‰¹é‡ç”Ÿæˆåœ°é»žå¤±æ•—:',e),toastr.error('æ‰¹é‡ç”Ÿæˆå¤±æ•—ï¼Œè«‹é‡è©¦ã€‚')}finally{o.value=!1}}};return(t,d)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',Dn,[d[24]||(d[24]=(0,e.createElementVNode)('h3',null,'åœ°é»žè³‡æ–™è¨­å®š',-1)),(0,e.createCommentVNode)(' å…¶ä»–åœ°é»žå‹•æ…‹æ‘ºç–Šæ¬„ '),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(p.value,([t,o])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:(0,e.normalizeClass)(['location-fold-bar',{'location-incomplete':!g(o)}])},[(0,e.createVNode)(s,{title:`${t}: ${m(o)}`,'is-open':!1},{'title-actions':(0,e.withCtx)(()=>[(0,e.createElementVNode)('button',{class:'remove-location-btn',title:'ç§»é™¤åœ°é»ž',onClick:e=>(e=>{a.value.delete(e);try{const t=getVariables({type:'chat'});delete t.locations[e],replaceVariables(t,{type:'chat'})}catch(t){console.error(`Failed to remove location ${e} from chat variables:`,t)}})(t)},[...d[3]||(d[3]=[(0,e.createElementVNode)('span',null,'Ã—',-1)])],8,Tn)]),default:(0,e.withCtx)(()=>[(0,e.createElementVNode)('div',Mn,[(0,e.createElementVNode)('div',Yn,[d[16]||(d[16]=(0,e.createElementVNode)('h4',null,'åŸºæœ¬è³‡è¨Š',-1)),(0,e.createElementVNode)('div',On,[(0,e.createElementVNode)('div',An,[d[5]||(d[5]=(0,e.createElementVNode)('label',null,'åœ°é»ž',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>o.name=e,type:'text',placeholder:'ä¾‹å¦‚ï¼šé­”æ³•æ£®æž—',class:'text-input'},null,8,Rn),[[e.vModelText,o.name]]),o.generated_name?((0,e.openBlock)(),(0,e.createElementBlock)('div',Kn,[d[4]||(d[4]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Un,(0,e.toDisplayString)(o.generated_name),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>x(t,'name',o.generated_name)},' ä½¿ç”¨ ',8,Ln)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Fn,[d[7]||(d[7]=(0,e.createElementVNode)('label',null,'ä½ç½®',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>o.location=e,type:'text',placeholder:'ä¾‹å¦‚ï¼šæ£®æž—æ·±è™•',class:'text-input'},null,8,jn),[[e.vModelText,o.location]]),o.generated_location?((0,e.openBlock)(),(0,e.createElementBlock)('div',Hn,[d[6]||(d[6]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Pn,(0,e.toDisplayString)(o.generated_location),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>x(t,'location',o.generated_location)},' ä½¿ç”¨ ',8,qn)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Gn,[d[9]||(d[9]=(0,e.createElementVNode)('label',null,'æè¿°',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>o.description=e,placeholder:'æè¿°åœ°é»žçš„ç‰¹é»ž...',class:'text-area',rows:'3'},null,8,Wn),[[e.vModelText,o.description]]),o.generated_description?((0,e.openBlock)(),(0,e.createElementBlock)('div',Xn,[d[8]||(d[8]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Jn,(0,e.toDisplayString)(o.generated_description),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>x(t,'description',o.generated_description)},' ä½¿ç”¨ ',8,Zn)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Qn,[d[11]||(d[11]=(0,e.createElementVNode)('label',null,'å­åœ°é»žç”Ÿæˆçµæžœ',-1)),o.generated_sub_location&&o.generated_sub_location.length>0?((0,e.openBlock)(),(0,e.createElementBlock)('div',eo,[d[10]||(d[10]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',to,(0,e.toDisplayString)(o.generated_sub_location.join(', ')),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>x(t,'sub_location',o.generated_sub_location)},' ä½¿ç”¨ ',8,ao)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',no,[d[15]||(d[15]=(0,e.createElementVNode)('label',null,'å­åœ°é»ž',-1)),(0,e.createElementVNode)('div',oo,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(o.sub_location||[],(n,o)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:o,class:'sub-location-item'},[(0,e.createElementVNode)('select',{value:n,class:'text-input',onChange:e=>((e,t,n)=>{const o=a.value.get(e);o&&o.sub_location&&(o.sub_location[t]=n,a.value.set(e,{...o}),f(e))})(t,o,e.target.value)},[d[12]||(d[12]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡å­åœ°é»ž...',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(a.value,([a,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:a,value:a,disabled:a===t},(0,e.toDisplayString)(a)+': '+(0,e.toDisplayString)(m(n)),9,lo))),128))],40,ro),(0,e.createElementVNode)('button',{class:'remove-sub-location-btn',onClick:e=>((e,t)=>{const n=a.value.get(e);n&&n.sub_location&&(n.sub_location.splice(t,1),a.value.set(e,{...n}),f(e))})(t,o)},[...d[13]||(d[13]=[(0,e.createElementVNode)('span',null,'Ã—',-1)])],8,io)]))),128)),(0,e.createElementVNode)('button',{class:'add-sub-location-btn',onClick:e=>(e=>{const t=a.value.get(e);t&&(t.sub_location||(t.sub_location=[]),t.sub_location.push(''),a.value.set(e,{...t}),f(e))})(t)},[...d[14]||(d[14]=[(0,e.createElementVNode)('span',null,'+ æ·»åŠ å­åœ°é»ž',-1)])],8,so)])])])]),(0,e.createCommentVNode)(' ç”Ÿæˆè¦æ±‚å€åŸŸ '),(0,e.createElementVNode)('div',co,[d[18]||(d[18]=(0,e.createElementVNode)('h4',null,'ç”Ÿæˆè¦æ±‚',-1)),(0,e.createElementVNode)('div',uo,[(0,e.createElementVNode)('div',po,[d[17]||(d[17]=(0,e.createElementVNode)('label',null,'å°AIç”Ÿæˆçš„è¦æ±‚',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>o.generation_requirement=e,placeholder:'å°AIç”Ÿæˆçš„è¦æ±‚...',class:'text-area',rows:'3'},null,8,mo),[[e.vModelText,o.generation_requirement]])])])]),(0,e.createCommentVNode)(' ç”ŸæˆæŒ‰éˆ•å€åŸŸ '),(0,e.createElementVNode)('div',vo,[(0,e.createElementVNode)('button',{class:'generate-btn',disabled:!u.value||n.value.get(t),onClick:e=>T(t)},[n.value.get(t)?((0,e.openBlock)(),(0,e.createElementBlock)('span',bo)):(0,e.createCommentVNode)('v-if',!0),(0,e.createTextVNode)(' '+(0,e.toDisplayString)(n.value.get(t)?'ç”Ÿæˆä¸­...':u.value?'ç”Ÿæˆæœªå¡«å¯«çš„å­—æ®µ':'è«‹å…ˆå®Œæˆä¸–ç•ŒèƒŒæ™¯è¨­å®š'),1)],8,go),(0,e.createElementVNode)('button',{class:'apply-all-btn',disabled:!v(o),onClick:e=>(e=>{const t=a.value.get(e);if(t){c.forEach(e=>{const a=e,n=e.replace('generated_',''),o=t[a];o&&(t[n]=o,t[a]='generated_sub_location'===e?[]:'')}),a.value.set(e,{...t}),f(e);try{localStorage.removeItem(`location_profile_generated_${e}`)}catch(t){console.error(`Failed to remove generated location profile for ${e} from localStorage:`,t)}}})(t)},' æ‡‰ç”¨å…¨éƒ¨ ',8,fo)])])]),_:2},1032,['title'])],2))),128)),(0,e.createCommentVNode)(' æ‰¹é‡ç”Ÿæˆåœ°é»žå€åŸŸ '),(0,e.createElementVNode)('div',ho,[d[22]||(d[22]=(0,e.createElementVNode)('h4',null,'æ‰¹é‡ç”Ÿæˆåœ°é»ž',-1)),(0,e.createElementVNode)('div',xo,[(0,e.createElementVNode)('div',yo,[d[20]||(d[20]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆæ•¸é‡',-1)),(0,e.createElementVNode)('div',_o,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':d[0]||(d[0]=e=>r.value=e),type:'number',min:'1',max:'10',class:'text-input count-input',placeholder:'1-10',disabled:i.value},null,8,Eo),[[e.vModelText,r.value,void 0,{number:!0}]]),(0,e.createElementVNode)('div',ko,[(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'allow_ai_count','onUpdate:modelValue':d[1]||(d[1]=e=>i.value=e),type:'checkbox'},null,512),[[e.vModelCheckbox,i.value]]),d[19]||(d[19]=(0,e.createElementVNode)('label',{for:'allow_ai_count'},'è®“AIæ±ºå®šç”Ÿæˆæ•¸é‡',-1))])])]),(0,e.createElementVNode)('div',Vo,[d[21]||(d[21]=(0,e.createElementVNode)('label',null,'æ‰¹é‡ç”Ÿæˆè¦æ±‚',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':d[2]||(d[2]=e=>l.value=e),placeholder:'æè¿°è¦ç”Ÿæˆçš„åœ°é»žé¡žåž‹ã€ä¸»é¡Œç­‰...',class:'text-area',rows:'3'},null,512),[[e.vModelText,l.value]])])]),(0,e.createElementVNode)('button',{class:'bulk-generate-btn',disabled:!u.value||o.value||!i.value&&(r.value<1||r.value>10),onClick:M},[o.value?((0,e.openBlock)(),(0,e.createElementBlock)('span',wo)):(0,e.createCommentVNode)('v-if',!0),(0,e.createTextVNode)(' '+(0,e.toDisplayString)(o.value?'æ‰¹é‡ç”Ÿæˆä¸­...':u.value?i.value?'è®“AIæ±ºå®šç”Ÿæˆæ•¸é‡':`ç”Ÿæˆ ${r.value} å€‹åœ°é»ž`:'è«‹å…ˆå®Œæˆä¸–ç•ŒèƒŒæ™¯è¨­å®š'),1)],8,No)]),(0,e.createCommentVNode)(' æ·»åŠ åœ°é»žæŒ‰éˆ• '),(0,e.createElementVNode)('div',{class:'add-location-section'},[(0,e.createElementVNode)('button',{class:'add-location-btn',onClick:y},[...d[23]||(d[23]=[(0,e.createElementVNode)('span',null,'+ æ·»åŠ åœ°é»ž',-1)])])])]))}});i(2813);const Co=(0,d.A)(Bo,[['__scopeId','data-v-890af5d4']]);class $o{_date;constructor(e){this._date=e}static fromString(e){return new $o(new Date(e))}toString(){return this._date.toString()}get year(){return this._date.getFullYear()}get month(){return this._date.getMonth()+1}get date(){return this._date.getDate()}get hours(){return this._date.getHours()}get minutes(){return this._date.getMinutes()}get seconds(){return this._date.getSeconds()}toDate(){return this._date}deltaMinutes(e){this._date.setMinutes(this._date.getMinutes()+e)}clone(){return new $o(new Date(this._date))}}class So{name;static NAME_KEY='åç¨±';age;static AGE_KEY='å¹´é½¡';gender;static GENDER_KEY='æ€§åˆ¥';identity;static IDENTITY_KEY='èº«ä»½';introduction;static INTRODUCTION_KEY='ç°¡ä»‹';personality;static PERSONALITY_KEY='æ€§æ ¼';height;static HEIGHT_KEY='èº«é«˜';weight;static WEIGHT_KEY='é«”é‡';chest_size;static CHEST_SIZE_KEY='èƒ¸åœ';cup_size;static CUP_SIZE_KEY='ç½©æ¯';waist_size;static WAIST_SIZE_KEY='è…°åœ';hips_size;static HIPS_SIZE_KEY='è‡€åœ';hairstyle;static HAIRSTYLE_KEY='é«®åž‹';appearance;static APPEARANCE_KEY='æ¨£è²Œ';clothes;static CLOTHES_KEY='è¡£è‘—';birthday;static BIRTHDAY_KEY='ç”Ÿæ—¥';favourite;static FAVOURITE_KEY='æ„›å¥½';extra_information;static EXTRA_INFORMATION_KEY='å…¶ä»–é‡è¦è³‡è¨Š';money;static MONEY_KEY='é‡‘éŒ¢';mood;static MOOD_KEY='å¿ƒæƒ…';horny;static HORNY_KEY='æ€§æ…¾';relations;static RELATIONS_KEY='é—œä¿‚';friendships;static FRIENDSHIPS_KEY='å‹å¥½åº¦';loves;static LOVES_KEY='æ„›æƒ…åº¦';inventory;static INVENTORY_KEY='æ‰€æŒç‰©';static MOOD_LOW=-100;static MOOD_HIGH=100;static HORNY_LOW=0;static HORNY_HIGH=100;static FRIENDSHIP_LOW=-1e3;static FRIENDSHIP_HIGH=1e3;static LOVE_LOW=0;static LOVE_HIGH=1e3;constructor(e,t,a,n,o,r,l,i,d,s,c,u,p,m,v,g,b,f,h,x,y,E,k,V,N){this.name=e,this.age=t,this.gender=a,this.identity=n,this.introduction=o,this.personality=r,this.height=l,this.weight=i,this.chest_size=d,this.cup_size=s,this.waist_size=c,this.hips_size=u,this.hairstyle=p,this.appearance=m,this.clothes=v,this.birthday=g,this.favourite=b,this.extra_information=f,this.money=h,this.mood=x,this.horny=y,this.relations=E,this.friendships=k,this.loves=V,this.inventory=N}static instantiate(){return new So('ç´«æœˆ',17,'ç”·','é«˜ä¸­äºŒå¹´ç´šå­¸ç”Ÿ','ä¸€æ®µä»‹ç´¹','å¹³æ·¡ï¼Œè†½å°',172,52,70,null,50,55,'é»‘è‰²çŸ­é«®','æ™®é€šï¼Œå¹³å¹³ç„¡å¥‡','å±…å®¶æœ',new $o(new Date(1998,8,22,0,0,0)),'å¦¹å¦¹','æ²’æœ‰é¡å¤–è³‡è¨Š',1e4,20,0,new Map([['c2','å“¥å“¥']]),new Map([['c2',100],['c5',70],['c6',-40]]),new Map([['c2',50]]),new Map([['i2',2]]))}static fromRecord(e){return new So(e[So.NAME_KEY],e[So.AGE_KEY],e[So.GENDER_KEY],e[So.IDENTITY_KEY],e[So.INTRODUCTION_KEY],e[So.PERSONALITY_KEY],e[So.HEIGHT_KEY],e[So.WEIGHT_KEY],e[So.CHEST_SIZE_KEY],e[So.CUP_SIZE_KEY]??null,e[So.WAIST_SIZE_KEY],e[So.HIPS_SIZE_KEY],e[So.HAIRSTYLE_KEY],e[So.APPEARANCE_KEY],e[So.CLOTHES_KEY],$o.fromString(e[So.BIRTHDAY_KEY]),e[So.FAVOURITE_KEY],e[So.EXTRA_INFORMATION_KEY],e[So.MONEY_KEY],e[So.MOOD_KEY],e[So.HORNY_KEY],new Map(Object.entries(e[So.RELATIONS_KEY])),new Map(Object.entries(e[So.FRIENDSHIPS_KEY])),new Map(Object.entries(e[So.LOVES_KEY])),new Map(Object.entries(e[So.INVENTORY_KEY])))}toRecord(){return{[So.NAME_KEY]:this.name,[So.AGE_KEY]:this.age,[So.GENDER_KEY]:this.gender,[So.IDENTITY_KEY]:this.identity,[So.INTRODUCTION_KEY]:this.introduction,[So.PERSONALITY_KEY]:this.personality,[So.HEIGHT_KEY]:this.height,[So.WEIGHT_KEY]:this.weight,[So.CHEST_SIZE_KEY]:this.chest_size,[So.CUP_SIZE_KEY]:this.cup_size,[So.WAIST_SIZE_KEY]:this.waist_size,[So.HIPS_SIZE_KEY]:this.hips_size,[So.HAIRSTYLE_KEY]:this.hairstyle,[So.APPEARANCE_KEY]:this.appearance,[So.CLOTHES_KEY]:this.clothes,[So.BIRTHDAY_KEY]:this.birthday.toString(),[So.FAVOURITE_KEY]:this.favourite,[So.EXTRA_INFORMATION_KEY]:this.extra_information,[So.MONEY_KEY]:this.money,[So.MOOD_KEY]:this.mood,[So.HORNY_KEY]:this.horny,[So.RELATIONS_KEY]:Object.fromEntries(this.relations),[So.FRIENDSHIPS_KEY]:Object.fromEntries(this.friendships),[So.LOVES_KEY]:Object.fromEntries(this.loves),[So.INVENTORY_KEY]:Object.fromEntries(this.inventory)}}deltaFriendship(e,t){let a=this.friendships.get(e)||0;a+=t,a<So.FRIENDSHIP_LOW&&(a=So.FRIENDSHIP_LOW),a>So.FRIENDSHIP_HIGH&&(a=So.FRIENDSHIP_HIGH),this.friendships.set(e,a)}deltaLove(e,t){let a=this.loves.get(e)||0;a+=t,a<So.LOVE_LOW&&(a=So.LOVE_LOW),a>So.LOVE_HIGH&&(a=So.LOVE_HIGH),0===a?this.loves.delete(e):this.loves.set(e,a)}deltaMood(e){this.mood+=e,this.mood<So.MOOD_LOW&&(this.mood=So.MOOD_LOW),this.mood>So.MOOD_HIGH&&(this.mood=So.MOOD_HIGH)}deltaHorny(e){this.horny+=e,this.horny<So.HORNY_LOW&&(this.horny=So.HORNY_LOW),this.horny>So.HORNY_HIGH&&(this.horny=So.HORNY_HIGH)}}class Io{name;static NAME_KEY='åç¨±';description;static DESCRIPTION_KEY='æè¿°';value;static VALUE_KEY='åƒ¹å€¼';constructor(e,t,a){this.name=e,this.description=t,this.value=a}static fromRecord(e){return new Io(e[Io.NAME_KEY],e[Io.DESCRIPTION_KEY],e[Io.VALUE_KEY])}toRecord(){return{[Io.NAME_KEY]:this.name,[Io.DESCRIPTION_KEY]:this.description,[Io.VALUE_KEY]:this.value}}}class zo{id;static ID_KEY='id';name;static NAME_KEY='åœ°é»ž';location;static LOCATION_KEY='ä½ç½®';description;static DESCRIPTION_KEY='æè¿°';parent_location_id;static PARENT_LOCATION_ID_KEY='çˆ¶åœ°é»žid';sub_location_ids;static SUB_LOCATION_IDS_KEY='å­åœ°é»žids';storage_ids;static STORAGE_IDS_KEY='è²¯å­˜é»žids';constructor(e,t,a,n,o,r,l){this.id=e,this.name=t,this.location=a,this.description=n,this.parent_location_id=o,this.sub_location_ids=r,this.storage_ids=l}static fromRecord(e){return new zo(e[zo.ID_KEY],e[zo.NAME_KEY],e[zo.LOCATION_KEY],e[zo.DESCRIPTION_KEY],e[zo.PARENT_LOCATION_ID_KEY],e[zo.SUB_LOCATION_IDS_KEY]||[],e[zo.STORAGE_IDS_KEY]||[])}toRecord(){return{[zo.ID_KEY]:this.id,[zo.NAME_KEY]:this.name,[zo.LOCATION_KEY]:this.location,[zo.DESCRIPTION_KEY]:this.description,[zo.PARENT_LOCATION_ID_KEY]:this.parent_location_id,[zo.SUB_LOCATION_IDS_KEY]:this.sub_location_ids,[zo.STORAGE_IDS_KEY]:this.storage_ids}}}class Do{deadline;static DEADLINE_KEY='æœŸé™';character_ids;static CHARACTER_IDS_KEY='è§’è‰²';location_id;static LOCATION_ID_KEY='åœ°é»ž';description;static DESCRIPTION_KEY='å…§å®¹';constructor(e,t,a,n){this.deadline=e,this.character_ids=t,this.location_id=a,this.description=n}static fromRecord(e){return new Do($o.fromString(e[Do.DEADLINE_KEY]),e[Do.CHARACTER_IDS_KEY],e[Do.LOCATION_ID_KEY],e[Do.DESCRIPTION_KEY])}toRecord(){return{[Do.DEADLINE_KEY]:this.deadline.toString(),[Do.CHARACTER_IDS_KEY]:this.character_ids,[Do.LOCATION_ID_KEY]:this.location_id,[Do.DESCRIPTION_KEY]:this.description}}}class To{name;static NAME_KEY='åç¨±';description;static DESCRIPTION_KEY='æè¿°';parent_id;static PARENT_ID_KEY='çˆ¶id';money;static MONEY_KEY='é‡‘éŒ¢';inventory;static INVENTORY_KEY='è²¯å­˜ç‰©';constructor(e,t,a,n,o){this.name=e,this.description=t,this.parent_id=a,this.money=n,this.inventory=o}static fromRecord(e){const t=new Map,a=e[To.INVENTORY_KEY]||{};for(const[e,n]of Object.entries(a))t.set(e,n);return new To(e[To.NAME_KEY],e[To.DESCRIPTION_KEY],e[To.PARENT_ID_KEY],e[To.MONEY_KEY],t)}toRecord(){const e={};for(const[t,a]of Array.from(this.inventory))e[t]=a;return{[To.NAME_KEY]:this.name,[To.DESCRIPTION_KEY]:this.description,[To.PARENT_ID_KEY]:this.parent_id,[To.MONEY_KEY]:this.money,[To.INVENTORY_KEY]:e}}}class Mo{datetime;static DATETIME_KEY='æ™‚é–“';summary;static SUMMARY_KEY='ç¸½çµ';weighting;static WEIGHTING_KEY='æ¬Šé‡';last_message_id;static LAST_MESSAGE_ID_KEY='æœ€å¾Œæ¨“å±¤';constructor(e,t,a,n){this.datetime=e,this.summary=t,this.weighting=a,this.last_message_id=n}static fromRecord(e){return new Mo($o.fromString(e[Mo.DATETIME_KEY]),e[Mo.SUMMARY_KEY],e[Mo.WEIGHTING_KEY],e[Mo.LAST_MESSAGE_ID_KEY])}toRecord(){return{[Mo.DATETIME_KEY]:this.datetime.toString(),[Mo.SUMMARY_KEY]:this.summary,[Mo.WEIGHTING_KEY]:this.weighting,[Mo.LAST_MESSAGE_ID_KEY]:this.last_message_id}}}class Yo{datetime;static DATETIME_KEY='ç•¶å‰æ™‚é–“';current_location_id;static CURRENT_LOCATION_ID_KEY='ç•¶å‰åœ°é»ž';weather;static WEATHER_KEY='å¤©æ°£';current_event;static CURRENT_EVENT_KEY='ç•¶å‰äº‹ä»¶';static CURRENT_EVENT_NULL_VALUE='ç„¡';active_characters;static ACTIVE_CHARACTERS_KEY='ç•¶å‰è§’è‰²';deactive_characters;static DEACTIVE_CHARACTERS_KEY='èƒŒæ™¯è§’è‰²';items;static ITEMS_KEY='ç‰©å“';storages;static STORAGES_KEY='è²¯å­˜é»ž';locations;static LOCATIONS_KEY='åœ°é»ž';promises;static PROMISES_KEY='ç´„å®š';summaries;static SUMMARIES_KEY='ç¸½çµ';constructor(e,t,a,n,o,r,l,i,d,s,c){this.datetime=e,this.current_location_id=t,this.weather=a,this.current_event=n,this.active_characters=o,this.deactive_characters=r,this.items=l,this.storages=i,this.locations=d,this.promises=s,this.summaries=c}static loadFromVariable(e){let t;t=e<0?getVariables({type:'chat'}).state:getVariables({type:'message',message_id:e});const a=new Map,n=t[Yo.ACTIVE_CHARACTERS_KEY];for(const[e,t]of Object.entries(n))a.set(e,So.fromRecord(t));const o=new Map,r=t[Yo.DEACTIVE_CHARACTERS_KEY];for(const[e,t]of Object.entries(r))o.set(e,So.fromRecord(t));const l=new Map,i=t[Yo.ITEMS_KEY];for(const[e,t]of Object.entries(i))l.set(e,Io.fromRecord(t));const d=new Map;if(t[Yo.STORAGES_KEY]){const e=t[Yo.STORAGES_KEY];for(const[t,a]of Object.entries(e))d.set(t,To.fromRecord(a))}const s=new Map,c=t[Yo.LOCATIONS_KEY];for(const[e,t]of Object.entries(c))s.set(e,zo.fromRecord(t));const u=new Map,p=t[Yo.PROMISES_KEY];for(const[e,t]of Object.entries(p))u.set(e,Do.fromRecord(t));const m=new Array,v=t[Yo.SUMMARIES_KEY];for(const e of v)m.push(Mo.fromRecord(e));return new Yo($o.fromString(t[Yo.DATETIME_KEY]),t[Yo.CURRENT_LOCATION_ID_KEY],t[Yo.WEATHER_KEY],t[Yo.CURRENT_EVENT_KEY],a,o,l,d,s,u,m)}saveAsVariable(e){const t={};for(const[e,a]of this.active_characters)t[e]=a.toRecord();const a={};for(const[e,t]of this.deactive_characters)a[e]=t.toRecord();const n={};for(const[e,t]of this.items)n[e]=t.toRecord();const o={};for(const[e,t]of this.storages)o[e]=t.toRecord();const r={};for(const[e,t]of this.locations)r[e]=t.toRecord();const l={};for(const[e,t]of this.promises)l[e]=t.toRecord();const i=[],d=[...this.summaries].sort((e,t)=>e.last_message_id-t.last_message_id);for(const e of d)i.push(e.toRecord());const s={[Yo.DATETIME_KEY]:this.datetime.toString(),[Yo.CURRENT_LOCATION_ID_KEY]:this.current_location_id,[Yo.WEATHER_KEY]:this.weather,[Yo.CURRENT_EVENT_KEY]:this.current_event,[Yo.ACTIVE_CHARACTERS_KEY]:t,[Yo.DEACTIVE_CHARACTERS_KEY]:a,[Yo.ITEMS_KEY]:n,[Yo.STORAGES_KEY]:o,[Yo.LOCATIONS_KEY]:r,[Yo.PROMISES_KEY]:l,[Yo.SUMMARIES_KEY]:i};if(e<0){const e=getVariables({type:'chat'});e.state=s,replaceVariables(e,{type:'chat'})}else replaceVariables(s,{type:'message',message_id:e})}getCharacter(e){return this.active_characters.get(e)||this.deactive_characters.get(e)}hasCharacter(e){return this.active_characters.has(e)||this.deactive_characters.has(e)}getCurrentLocations(){const e=new Set,t=[];let a=this.locations.get(this.current_location_id);for(;a&&!e.has(a.id);)t.push(a),e.add(a.id),a=this.locations.get(a.parent_location_id||'');return t.reverse()}addStorage(e,t,a,n){if(this.storages.has(e))return;if(!(this.hasCharacter(n)||this.storages.has(n)||this.locations.has(n)))return;const o=new To(t,a,n,0,new Map);if(this.storages.set(e,o),this.hasCharacter(n)){const t=this.getCharacter(n);t&&t.inventory.set(e,1)}else if(this.storages.has(n)){const t=this.storages.get(n);t&&t.inventory.set(e,1)}else if(this.locations.has(n)){const t=this.locations.get(n);t&&t.storage_ids.push(e)}}removeStorage(e){const t=this.storages.get(e);if(!t)return;this.storages.delete(e);const a=t.parent_id;if(this.hasCharacter(a)){const t=this.getCharacter(a);t&&t.inventory.delete(e)}else if(this.storages.has(a)){const t=this.storages.get(a);t&&t.inventory.delete(e)}else if(this.locations.has(a)){const t=this.locations.get(a);if(t){const a=t.storage_ids.indexOf(e);-1!==a&&t.storage_ids.splice(a,1)}}}setStorageParent(e,t){const a=this.storages.get(e);if(!a)return;if(!(this.hasCharacter(t)||this.storages.has(t)&&t!==e||this.locations.has(t)))return;const n=a.parent_id;if(this.hasCharacter(n)){const t=this.getCharacter(n);t&&t.inventory.delete(e)}else if(this.storages.has(n)){const t=this.storages.get(n);t&&t.inventory.delete(e)}else if(this.locations.has(n)){const t=this.locations.get(n);if(t){const a=t.storage_ids.indexOf(e);-1!==a&&t.storage_ids.splice(a,1)}}if(a.parent_id=t,this.hasCharacter(t)){const a=this.getCharacter(t);a&&a.inventory.set(e,1)}else if(this.storages.has(t)){const a=this.storages.get(t);a&&a.inventory.set(e,1)}else if(this.locations.has(t)){const a=this.locations.get(t);a&&a.storage_ids.push(e)}}addPromise(e,t,a,n){const o=Array.from(this.promises.keys()).map(e=>parseInt(e.substring(1))).filter(e=>!isNaN(e)),r=`p${Math.max(...o,0)+1}`,l=new Do(e,t,a,n);this.promises.set(r,l)}addSummary(e,t,a){const n=this.datetime.clone();this.summaries.push(new Mo(n,e,t,a))}getLatestSummaryLastMessageId(){const e=getVariables({type:'chat'}),t=e.settings?.exclude_latest_summaries||0;if(t>=this.summaries.length)return-1;const a=this.summaries.slice(0,this.summaries.length-t);return 0===a.length?-1:a[a.length-1].last_message_id}getGeneralStatusPrompt(){const e=this.datetime.year,t=this.datetime.month,a=this.datetime.date,n=this.datetime.hours,o=this.datetime.minutes,r=`${e}å¹´${t}æœˆ${a}æ—¥ (æ˜ŸæœŸ${['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'][this.datetime.toDate().getDay()]}) ${n.toString().padStart(2,'0')}:${o.toString().padStart(2,'0')}`,l=this.getCurrentLocations().map(e=>`${e.name}(${e.id})`).join('-');let i='<GeneralStatus>\n';return i+=`  ${Yo.DATETIME_KEY}:${r}\n`,i+=`  ${Yo.CURRENT_LOCATION_ID_KEY}:${l}\n`,i+=`  ${Yo.WEATHER_KEY}:${this.weather}\n`,i+=`  ${Yo.CURRENT_EVENT_KEY}:${this.current_event}\n`,i+='</GeneralStatus>\n',i}getUserPrompt(){const e=this.active_characters.get('c1');let t=`<${e.name}Status>\n`;t+='id: c1\n',t+=`  ${So.NAME_KEY}:${e.name}\n`,t+=`  ${So.AGE_KEY}:${e.age}\n`,t+=`  ${So.GENDER_KEY}:${e.gender}\n`,t+=`  ${So.IDENTITY_KEY}:${e.identity}\n`,t+=`  ${So.INTRODUCTION_KEY}:${e.introduction}\n`,t+=`  ${So.PERSONALITY_KEY}:${e.personality}\n`,t+=`  ${So.HEIGHT_KEY}:${e.height}\n`,t+=`  ${So.WEIGHT_KEY}:${e.weight}\n`,t+=`  ${So.CHEST_SIZE_KEY}:${e.chest_size}\n`,e.cup_size&&(t+=`  ${So.CUP_SIZE_KEY}:${e.cup_size}\n`),t+=`  ${So.WAIST_SIZE_KEY}:${e.waist_size}\n`,t+=`  ${So.HIPS_SIZE_KEY}:${e.hips_size}\n`,t+=`  ${So.HAIRSTYLE_KEY}:${e.hairstyle}\n`,t+=`  ${So.CLOTHES_KEY}:${e.clothes}\n`,t+=`  ${So.BIRTHDAY_KEY}:${e.birthday.month}æœˆ${e.birthday.date}æ—¥\n`,t+=`  ${So.FAVOURITE_KEY}:${e.favourite}\n`,t+=`  ${So.EXTRA_INFORMATION_KEY}:${e.extra_information}\n`,t+=`  ${So.MONEY_KEY}:${e.money}\n`,t+=`  ${So.RELATIONS_KEY}:\n`;for(const[a,n]of e.relations)t+=`    ${a}:${n}\n`;t+=`  ${So.INVENTORY_KEY}:\n`;for(const[a,n]of e.inventory)t+=`    ${a}:${n}\n`;return t+=`</${e.name}Status>\n`,t}getActiveCharacterPrompt(){let e='<ActiveCharacterStatus>\n';for(const[t,a]of this.active_characters)if('c1'!==t){e+=`id: ${t}\n`,e+=`  ${So.NAME_KEY}:${a.name}\n`,e+=`  ${So.AGE_KEY}:${a.age}\n`,e+=`  ${So.GENDER_KEY}:${a.gender}\n`,e+=`  ${So.IDENTITY_KEY}:${a.identity}\n`,e+=`  ${So.INTRODUCTION_KEY}:${a.introduction}\n`,e+=`  ${So.PERSONALITY_KEY}:${a.personality}\n`,e+=`  ${So.HEIGHT_KEY}:${a.height}\n`,e+=`  ${So.WEIGHT_KEY}:${a.weight}\n`,e+=`  ${So.CHEST_SIZE_KEY}:${a.chest_size}\n`,a.cup_size&&(e+=`  ${So.CUP_SIZE_KEY}:${a.cup_size}\n`),e+=`  ${So.WAIST_SIZE_KEY}:${a.waist_size}\n`,e+=`  ${So.HIPS_SIZE_KEY}:${a.hips_size}\n`,e+=`  ${So.HAIRSTYLE_KEY}:${a.hairstyle}\n`,e+=`  ${So.CLOTHES_KEY}:${a.clothes}\n`,e+=`  ${So.BIRTHDAY_KEY}:${a.birthday.month}æœˆ${a.birthday.date}æ—¥\n`,e+=`  ${So.FAVOURITE_KEY}:${a.favourite}\n`,e+=`  ${So.EXTRA_INFORMATION_KEY}:${a.extra_information}\n`,e+=`  ${So.MONEY_KEY}:${a.money}\n`,e+=`  ${So.MOOD_KEY}:${a.mood}\n`,e+=`  ${So.HORNY_KEY}:${a.horny}\n`,e+=`  ${So.RELATIONS_KEY}:\n`;for(const[t,n]of a.relations)e+=`    ${t}:${n}\n`;e+=`  ${So.FRIENDSHIPS_KEY}:\n`;for(const[t,n]of a.friendships)e+=`    ${t}:${n}\n`;e+=`  ${So.LOVES_KEY}:\n`;for(const[t,n]of a.loves)e+=`    ${t}:${n}\n`;e+=`  ${So.INVENTORY_KEY}:\n`;for(const[t,n]of a.inventory)e+=`    ${t}:${n}\n`;e+='\n'}return e+='</ActiveCharacterStatus>\n',e}getDeactiveCharacterPrompt(){let e='<DeactiveCharacterStatus>\n';for(const[t,a]of this.deactive_characters){e+=`id: ${t}\n`,e+=`  ${So.NAME_KEY}:${a.name}\n`,e+=`  ${So.AGE_KEY}:${a.age}\n`,e+=`  ${So.GENDER_KEY}:${a.gender}\n`,e+=`  ${So.IDENTITY_KEY}:${a.identity}\n`,e+=`  ${So.INTRODUCTION_KEY}:${a.introduction}\n`,e+=`  ${So.PERSONALITY_KEY}:${a.personality}\n`,e+=`  ${So.FAVOURITE_KEY}:${a.favourite}\n`,e+=`  ${So.EXTRA_INFORMATION_KEY}:${a.extra_information}\n`,e+=`  ${So.RELATIONS_KEY}:\n`;for(const[t,n]of a.relations)e+=`    ${t}:${n}\n`;e+=`  ${So.FRIENDSHIPS_KEY}:\n`;for(const[t,n]of a.friendships)e+=`    ${t}:${n}\n`;e+=`  ${So.LOVES_KEY}:\n`;for(const[t,n]of a.loves)e+=`    ${t}:${n}\n`;e+='\n'}return e+='</DeactiveCharacterStatus>\n',e}getItemPrompt(){let e='<ItemTable>\n';e+=`|id|${Io.NAME_KEY}|${Io.DESCRIPTION_KEY}|${Io.VALUE_KEY}|\n`,e+='|---|---|---|---|\n';for(const[t,a]of this.items)e+=`|${t}|${a.name}|${a.description}|${a.value}|\n`;return e+='</ItemTable>\n',e}getLocationPrompt(){let e='<LocationTable>\n';e+=`|id|${zo.NAME_KEY}|${zo.LOCATION_KEY}|${zo.DESCRIPTION_KEY}|${zo.SUB_LOCATION_IDS_KEY}|${zo.STORAGE_IDS_KEY}|\n`,e+='|---|---|---|---|---|\n';for(const[t,a]of this.locations)e+=`|${t}|${a.name}|${a.location}|${a.description}|${a.sub_location_ids.join(',')}|${a.storage_ids.join(',')}|\n`;return e+='</LocationTable>\n',e}getStoragePrompt(){let e='<StorageTable>\n';e+=`|id|${To.NAME_KEY}|${To.DESCRIPTION_KEY}|${To.MONEY_KEY}|${To.INVENTORY_KEY}|\n`,e+='|---|---|---|---|---|\n';for(const[t,a]of this.storages){const n=Array.from(a.inventory.entries()).map(([e,t])=>`${e}:${t}`).join(', ');e+=`|${t}|${a.name}|${a.description}|${a.money}|${n}|\n`}return e+='</StorageTable>\n',e}getPromisePrompt(){let e='<PromiseTable>\n';e+=`|id|${Do.DEADLINE_KEY}|${Do.CHARACTER_IDS_KEY}|${Do.LOCATION_ID_KEY}|${Do.DESCRIPTION_KEY}|\n`,e+='|---|---|---|---|---|\n';for(const[t,a]of this.promises){e+=`|${t}|${`${a.deadline.year}å¹´${a.deadline.month}æœˆ${a.deadline.date}æ—¥ ${a.deadline.hours.toString().padStart(2,'0')}:${a.deadline.minutes.toString().padStart(2,'0')}`}|${a.character_ids.join(',')}|${a.location_id}|${a.description}|\n`}return e+='</PromiseTable>\n',e}getSummaryPrompt(){const e=getVariables({type:'chat'}),t=e.settings?.exclude_latest_summaries||0,a=this.summaries.slice(0,this.summaries.length-t);let n='<HistorySummary>\n';n+=`|${Mo.DATETIME_KEY}|${Mo.SUMMARY_KEY}|${Mo.WEIGHTING_KEY}|\n`,n+='|---|---|---|\n';for(const e of a){n+=`|${`${e.datetime.year}å¹´${e.datetime.month}æœˆ${e.datetime.date}æ—¥ ${e.datetime.hours.toString().padStart(2,'0')}:${e.datetime.minutes.toString().padStart(2,'0')}`}|${e.summary}|${e.weighting.toFixed(2)}|\n`}return n+='</HistorySummary>\n',n}getStartingBackground(){let e='<StartingBackground>\n';return e+=`${getVariables({type:'chat'}).start_settings.information}\n`,e+='</StartingBackground>\n',e}injectPrompt(e){let t='';e&&(t+=`${this.getStartingBackground()}\n`),t+=`${this.getSummaryPrompt()}`;let a=`${this.getGeneralStatusPrompt()}\n`;a+=`${this.getUserPrompt()}\n`,a+=`${this.getActiveCharacterPrompt()}\n`,a+=`${this.getDeactiveCharacterPrompt()}\n`,a+=`${this.getItemPrompt()}\n`,a+=`${this.getStoragePrompt()}\n`,a+=`${this.getLocationPrompt()}\n`,a+=`${this.getPromisePrompt()}`,injectPrompts([{id:'pre-chat_prompt',position:'in_chat',depth:9999,role:'system',content:t,should_scan:!0}]),injectPrompts([{id:'post-chat_prompt',position:'in_chat',depth:0,role:'system',content:a,should_scan:!0}])}}const Oo={class:'start-container'},Ao={class:'section'},Ro={class:'datetime-group'},Ko={class:'datetime-inputs'},Uo={class:'datetime-input'},Lo={class:'datetime-input'},Fo={class:'datetime-input'},jo={class:'datetime-input'},Ho={class:'datetime-input'},Po={key:0,class:'generated-result'},qo={class:'generated-text'},Go={class:'input-group'},Wo=['value'],Xo={key:0,class:'generated-result'},Jo={class:'generated-text'},Zo={class:'input-group'},Qo={key:0,class:'generated-result'},er={class:'generated-text'},tr={class:'input-group'},ar={key:0,class:'generated-result'},nr={class:'generated-text'},or={class:'input-group'},rr={class:'item-actions'},lr=['disabled'],ir={key:0,class:'loading-spinner'},dr=['disabled'],sr={class:'completion-status'},cr={class:'status-value'},ur={class:'status-value'},pr={class:'status-value'},mr={class:'status-value'},vr={class:'status-value'},gr={class:'status-value'},br={class:'status-value'},fr={class:'settings-actions'},hr={class:'action-btn import'},xr={class:'start-action'},yr=['disabled'],_r=(0,e.defineComponent)({__name:'start_tab',setup(t){const a=(0,e.ref)(''),n=(0,e.ref)(''),o=(0,e.ref)(''),r=(0,e.ref)(''),l=(0,e.ref)(''),i=(0,e.ref)(''),d=(0,e.ref)(''),s=(0,e.ref)(''),c=(0,e.ref)(''),u=(0,e.ref)(!1),p=(0,e.ref)(''),m=(0,e.ref)(''),v=(0,e.ref)(''),g=(0,e.ref)(''),b=(0,e.ref)(''),f=(0,e.ref)(''),h=(0,e.ref)(''),x=(0,e.ref)(''),y=(0,e.computed)(()=>{try{const e=getVariables({type:'chat'});return!!e?.world_info?.trim()}catch{return!1}}),E=(0,e.computed)(()=>{try{const e=getVariables({type:'chat'}),t=e?.locations||{},a=new Map;for(const[e,n]of Object.entries(t))a.set(e,n);return a}catch{return new Map}}),k=(0,e.computed)(()=>p.value||m.value||v.value||g.value||b.value||f.value||h.value||x.value),V=(0,e.computed)(()=>''!==String(a.value).trim()&&''!==String(n.value).trim()&&''!==String(o.value).trim()&&''!==String(r.value).trim()&&''!==String(l.value).trim()&&''!==String(i.value).trim()&&''!==String(d.value).trim()&&''!==String(s.value).trim()),N=(0,e.computed)(()=>K()&&U()&&L()&&F()&&j()&&H()&&V.value),w=async()=>{u.value=!0;try{const e=I(),t=D(),c=T(),u=await generateRaw({user_input:e,ordered_prompts:[{role:'system',content:t},'char_description',{role:'system',content:c},'user_input']});Y(u);try{const e={start_year:a.value,start_month:n.value,start_date:o.value,start_hour:r.value,start_minute:l.value,selected_location:i.value,weather:d.value,information:s.value,generated_start_year:p.value,generated_start_month:m.value,generated_start_date:v.value,generated_start_hour:g.value,generated_start_minute:b.value,generated_location:f.value,generated_weather:h.value,generated_information:x.value};localStorage.setItem('start_tab_generated',JSON.stringify(e))}catch(e){console.error('ä¿å­˜ç”Ÿæˆå…§å®¹åˆ° localStorage å¤±æ•—:',e)}}catch(e){console.error('ç”Ÿæˆé–‹å§‹è¨­å®šå…§å®¹å¤±æ•—:',e)}finally{u.value=!1}},B=()=>{try{const e=getVariables({type:'chat'});e.start_settings={start_year:a.value,start_month:n.value,start_date:o.value,start_hour:r.value,start_minute:l.value,selected_location:i.value,weather:d.value,information:s.value},replaceVariables(e,{type:'chat'})}catch(e){console.error('ä¿å­˜é–‹å§‹è¨­å®šå¤±æ•—:',e)}},C=()=>{try{const e=getVariables({type:'chat'});e?.start_settings&&(a.value=String(e.start_settings.start_year||''),n.value=String(e.start_settings.start_month||''),o.value=String(e.start_settings.start_date||''),r.value=String(e.start_settings.start_hour||''),l.value=String(e.start_settings.start_minute||''),i.value=String(e.start_settings.selected_location||''),d.value=String(e.start_settings.weather||''),s.value=String(e.start_settings.information||''));const t=localStorage.getItem('start_tab_generated');if(t)try{const e=JSON.parse(t);a.value||(a.value=e.start_year||''),n.value||(n.value=e.start_month||''),o.value||(o.value=e.start_date||''),r.value||(r.value=e.start_hour||''),l.value||(l.value=e.start_minute||''),i.value||(i.value=e.selected_location||''),d.value||(d.value=e.weather||''),s.value||(s.value=e.information||''),p.value=e.generated_start_year||'',m.value=e.generated_start_month||'',v.value=e.generated_start_date||'',g.value=e.generated_start_hour||'',b.value=e.generated_start_minute||'',f.value=e.generated_location||'',h.value=e.generated_weather||'',x.value=e.generated_information||''}catch(e){console.error('è§£æžç”Ÿæˆå…§å®¹å¤±æ•—:',e)}const u=localStorage.getItem('start_tab_generation_requirement');u&&(c.value=u)}catch(e){console.error('åŠ è¼‰é–‹å§‹è¨­å®šå¤±æ•—:',e)}};(0,e.onMounted)(()=>{C()}),(0,e.watch)([a,n,o,r,l,i,d,s,c],()=>{B(),S()},{deep:!0}),(0,e.watch)(()=>getVariables({type:'chat'}),e=>{e?.start_settings&&C()},{deep:!0});const S=()=>{try{localStorage.setItem('start_tab_generation_requirement',c.value)}catch(e){console.error('ä¿å­˜ç”Ÿæˆè¦æ±‚åˆ° localStorage å¤±æ•—:',e)}},I=()=>{let e='è«‹æ ¹æ“šä¸–ç•ŒèƒŒæ™¯è³‡è¨Šã€ç”Ÿæˆè¦æ±‚åŠå·²æœ‰è³‡æ–™ï¼Œç‚ºéŠæˆ²é–‹å§‹è¨­å®šå®Œå–„ä»¥ä¸‹å…§å®¹ï¼š\n\n';return e+=`èµ·å§‹æ™‚é–“(å¹´)ï¼š${a.value||'æœªè¨­å®š'}\n`,e+=`èµ·å§‹æ™‚é–“(æœˆ)ï¼š${n.value||'æœªè¨­å®š'}\n`,e+=`èµ·å§‹æ™‚é–“(æ—¥)ï¼š${o.value||'æœªè¨­å®š'}\n`,e+=`èµ·å§‹æ™‚é–“(æ™‚)ï¼š${r.value||'æœªè¨­å®š'}\n`,e+=`èµ·å§‹æ™‚é–“(åˆ†)ï¼š${l.value||'æœªè¨­å®š'}\n`,e+=`èµ·å§‹åœ°é»žï¼š${i.value||'æœªè¨­å®š'}\n`,e+=`å¤©æ°£ï¼š${d.value||'æœªè¨­å®š'}\n`,e+=`èµ·å§‹è³‡è¨Šï¼š${s.value||'æœªè¨­å®š'}\n`,e},D=()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„éŠæˆ²é–‹å§‹è¨­å®šè¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ å¼•äººå…¥å‹çš„é–‹å ´å ´æ™¯ã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºéŠæˆ²é–‹å§‹è¨­å®šå®Œå–„å…§å®¹ã€‚\n';return a+='\n',a+='<ä¸–ç•ŒèƒŒæ™¯>\n','ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„éŠæˆ²é–‹å§‹è¨­å®šè¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ å¼•äººå…¥å‹çš„é–‹å ´å ´æ™¯ã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºéŠæˆ²é–‹å§‹è¨­å®šå®Œå–„å…§å®¹ã€‚\n\n<ä¸–ç•ŒèƒŒæ™¯>\n'},T=()=>{let e='\n</ä¸–ç•ŒèƒŒæ™¯>\n';return e+='\n',e+=`${(()=>{const e=getVariables({type:'chat'}).characters.c1,t=`${e.å§“æ°}${e.åå­—}`;let a=`<${t}Status>\n`;return a+='idï¼šc1\n',a+=`  å§“æ°ï¼š${e.å§“æ°||''}\n`,a+=`  åå­—ï¼š${e.åå­—||''}\n`,a+=`  å¹´é½¡ï¼š${e.å¹´é½¡||''}\n`,a+=`  æ€§åˆ¥ï¼š${e.æ€§åˆ¥||''}\n`,a+=`  èº«ä»½ï¼š${e.èº«ä»½||''}\n`,a+=`  èº«é«˜ï¼š${e.èº«é«˜||''}\n`,a+=`  é«”é‡ï¼š${e.é«”é‡||''}\n`,a+=`  èƒ¸åœï¼š${e.èƒ¸åœ||''}\n`,a+=`  ç½©æ¯ï¼š${e.ç½©æ¯||''}\n`,a+=`  è…°åœï¼š${e.è…°åœ||''}\n`,a+=`  è‡€åœï¼š${e.è‡€åœ||''}\n`,a+=`  é«®åž‹ï¼š${e.é«®åž‹||''}\n`,a+=`  æ¨£è²Œï¼š${e.æ¨£è²Œ||''}\n`,a+=`  è¡£è‘—ï¼š${e.è¡£è‘—||''}\n`,a+=`  ç°¡ä»‹ï¼š${e.ç°¡ä»‹||''}\n`,a+=`  æ€§æ ¼ï¼š${e.æ€§æ ¼||''}\n`,a+=`  æ„›å¥½ï¼š${e.æ„›å¥½||''}\n`,a+=`  é‡‘éŒ¢ï¼š${e.é‡‘éŒ¢||''}\n`,a+=`  ç”Ÿæ—¥æœˆä»½ï¼š${e.ç”Ÿæ—¥æœˆä»½||''}\n`,a+=`  ç”Ÿæ—¥æ—¥æœŸï¼š${e.ç”Ÿæ—¥æ—¥æœŸ||''}\n`,a+=`  å…¶ä»–é‡è¦è³‡è¨Šï¼š${e.å…¶ä»–é‡è¦è³‡è¨Š||''}\n`,a+=`  é—œä¿‚ï¼š${M(e.é—œä¿‚)}\n`,a+=`  å‹å¥½åº¦ï¼š${M(e.å‹å¥½åº¦)}\n`,a+=`  æ„›æƒ…åº¦ï¼š${M(e.æ„›æƒ…åº¦)}\n`,a+=`</${t}Status>`,a})()}\n`,e+='\n',e+=`${(()=>{const e=getVariables({type:'chat'}).characters;if(void 0===e)return'';let t='<CharacterStatus>\n';for(const[a,n]of Object.entries(e))'c1'!==a&&(t+=`idï¼š${a}\n`,t+=`  å§“æ°ï¼š${n.å§“æ°||''}\n`,t+=`  åå­—ï¼š${n.åå­—||''}\n`,t+=`  å¹´é½¡ï¼š${n.å¹´é½¡||''}\n`,t+=`  æ€§åˆ¥ï¼š${n.æ€§åˆ¥||''}\n`,t+=`  èº«ä»½ï¼š${n.èº«ä»½||''}\n`,t+=`  èº«é«˜ï¼š${n.èº«é«˜||''}\n`,t+=`  é«”é‡ï¼š${n.é«”é‡||''}\n`,t+=`  èƒ¸åœï¼š${n.èƒ¸åœ||''}\n`,t+=`  ç½©æ¯ï¼š${n.ç½©æ¯||''}\n`,t+=`  è…°åœï¼š${n.è…°åœ||''}\n`,t+=`  è‡€åœï¼š${n.è‡€åœ||''}\n`,t+=`  é«®åž‹ï¼š${n.é«®åž‹||''}\n`,t+=`  æ¨£è²Œï¼š${n.æ¨£è²Œ||''}\n`,t+=`  è¡£è‘—ï¼š${n.è¡£è‘—||''}\n`,t+=`  ç°¡ä»‹ï¼š${n.ç°¡ä»‹||''}\n`,t+=`  æ€§æ ¼ï¼š${n.æ€§æ ¼||''}\n`,t+=`  æ„›å¥½ï¼š${n.æ„›å¥½||''}\n`,t+=`  é‡‘éŒ¢ï¼š${n.é‡‘éŒ¢||''}\n`,t+=`  å¿ƒæƒ…ï¼š${n.å¿ƒæƒ…||''}\n`,t+=`  æ€§æ…¾ï¼š${n.æ€§æ…¾||''}\n`,t+=`  ç”Ÿæ—¥æœˆä»½ï¼š${n.ç”Ÿæ—¥æœˆä»½||''}\n`,t+=`  ç”Ÿæ—¥æ—¥æœŸï¼š${n.ç”Ÿæ—¥æ—¥æœŸ||''}\n`,t+=`  å…¶ä»–é‡è¦è³‡è¨Šï¼š${n.å…¶ä»–é‡è¦è³‡è¨Š||''}\n`,t+=`  é—œä¿‚ï¼š${M(n.é—œä¿‚)}\n`,t+=`  å‹å¥½åº¦ï¼š${M(n.å‹å¥½åº¦)}\n`,t+=`  æ„›æƒ…åº¦ï¼š${M(n.æ„›æƒ…åº¦)}\n\n`);return t+='</CharacterStatus>',t})()}\n`,e+='\n',e+=`${(()=>{let e='<ItemTable>\n';e+='|id|åç¨±|æè¿°|åƒ¹å€¼|\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).items;if(void 0===t)return'';for(const[a,n]of Object.entries(t))e+=`|${a}|${n.name}|${n.description}|${n.value}|\n`;return e+='</ItemTable>',e})()}\n`,e+='\n',e+=`${(()=>{let e='<LocationTable>\n';e+='|id|åç¨±|æè¿°|å­åœ°é»ž|\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.description}|${t}|\n`}return e+='</LocationTable>',e})()}\n`,e+='\n',e+=`${(()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e})()}\n`,e+='\n',e+='<ç”Ÿæˆè¦æ±‚>\n',e+=`${c.value||'ç„¡ç‰¹æ®Šè¦æ±‚'}\n`,e+='</ç”Ÿæˆè¦æ±‚>\n',e+='\n',e+='<example>\n',e+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output. Output anything other than this format is prohibited.\n',e+='èµ·å§‹æ™‚é–“(å¹´)ï¼šnumber\n',e+='èµ·å§‹æ™‚é–“(æœˆ)ï¼šnumber[1~12]\n',e+='èµ·å§‹æ™‚é–“(æ—¥)ï¼šnumber[1~31]\n',e+='èµ·å§‹æ™‚é–“(æ™‚)ï¼šnumber[0~23]\n',e+='èµ·å§‹æ™‚é–“(åˆ†)ï¼šnumber[0~59]\n',e+='èµ·å§‹åœ°é»žï¼šlocation id\n',e+='å¤©æ°£ï¼š\'å¤©æ°£æè¿°ï¼Œå¦‚ï¼šæ™´æœ—ï¼Œé›¨å¤©\'\n',e+='èµ·å§‹è³‡è¨Šï¼š\'éŠæˆ²é–‹å§‹æ™‚çš„å ´æ™¯æè¿°æˆ–é‡è¦è³‡è¨Š\'\n',e+='</example>\n',e},M=e=>'['+Object.entries(e).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']',Y=e=>{const t=e.split('\n'),a={};for(const e of t){const t=e.trim();if(t.includes('ï¼š')){const[e,n]=t.split('ï¼š',2),o=n?.trim().replace(/^["']|["']$/g,'')||'';switch(e.trim()){case'èµ·å§‹æ™‚é–“(å¹´)':a.generated_start_year=o;break;case'èµ·å§‹æ™‚é–“(æœˆ)':a.generated_start_month=o;break;case'èµ·å§‹æ™‚é–“(æ—¥)':a.generated_start_date=o;break;case'èµ·å§‹æ™‚é–“(æ™‚)':a.generated_start_hour=o;break;case'èµ·å§‹æ™‚é–“(åˆ†)':a.generated_start_minute=o;break;case'èµ·å§‹åœ°é»ž':a.generated_location=o;break;case'å¤©æ°£':a.generated_weather=o;break;case'èµ·å§‹è³‡è¨Š':a.generated_information=o}}}Object.assign(p,{value:a.generated_start_year||''}),Object.assign(m,{value:a.generated_start_month||''}),Object.assign(v,{value:a.generated_start_date||''}),Object.assign(g,{value:a.generated_start_hour||''}),Object.assign(b,{value:a.generated_start_minute||''}),Object.assign(f,{value:a.generated_location||''}),Object.assign(h,{value:a.generated_weather||''}),Object.assign(x,{value:a.generated_information||''})},O=()=>{p.value&&(a.value=p.value),m.value&&(n.value=m.value),v.value&&(o.value=v.value),g.value&&(r.value=g.value),b.value&&(l.value=b.value),p.value='',m.value='',v.value='',g.value='',b.value=''},A=()=>{O(),f.value&&(i.value=f.value),h.value&&(d.value=h.value),x.value&&(s.value=x.value),f.value='',h.value='',x.value='',B();try{localStorage.removeItem('start_tab_generated')}catch(e){console.error('å¾ž localStorage ç§»é™¤ç”Ÿæˆå…§å®¹å¤±æ•—:',e)}},R=e=>''===e||(null===e||void 0===e),K=()=>''!==(getVariables({type:'chat'}).world_info||'').trim(),U=()=>{const e=getVariables({type:'chat'}),t=e?.characters?.c1;if(!t)return!1;for(const e of Object.values(t))if(R(e))return!1;return!0},L=()=>{const e=getVariables({type:'chat'}),t=e?.characters;if(!t)return!1;for(const[e,a]of Object.entries(t))if('c1'!==e)for(const e of Object.values(a))if(R(e))return!1;return!0},F=()=>{const e=getVariables({type:'chat'}),t=e?.items;if(!t)return!1;for(const e of Object.values(t))for(const t of Object.values(e))if(R(t))return!1;return!0},j=()=>{const e=getVariables({type:'chat'}),t=e?.extra_world_info;if(!t)return!1;for(const e of Object.values(t))for(const t of Object.values(e))if(R(t))return!1;return!0},H=()=>{const e=getVariables({type:'chat'}),t=e?.locations;if(!t)return!1;const a=Object.keys(t);if(0===a.length)return!1;for(const e of a){const a=t[e];if(!a?.name?.trim()||!a?.location?.trim()||!a?.description?.trim())return!1}return!0},P=()=>{const e=parseInt(a.value),t=parseInt(n.value),s=parseInt(o.value),c=parseInt(r.value),u=parseInt(l.value),p=getVariables({type:'chat'}),m=p?.locations||{},v=i.value,g=d.value;let b=getVariables({type:'chat'});const f=b.characters,h=new Map,x=new Map;for(const[a,n]of Object.entries(f)){const o=`${n.å§“æ°}${n.åå­—}`,r=parseInt(n.å¹´é½¡),l=parseInt(n.ç”Ÿæ—¥æ—¥æœŸ),i=parseInt(n.ç”Ÿæ—¥æœˆä»½);let d=e-r;(t<i||t===i&&s<l)&&(d-=1);const c=new $o(new Date(d,i-1,l));let u=n.ç½©æ¯;/^[a-zA-Z]$/.test(n.ç½©æ¯)||(u=null);const p=new So(o,r,n.æ€§åˆ¥,n.èº«ä»½,n.ç°¡ä»‹,n.æ€§æ ¼,n.èº«é«˜,n.é«”é‡,n.èƒ¸åœ,u,n.è…°åœ,n.è‡€åœ,n.é«®åž‹,n.æ¨£è²Œ,n.è¡£è‘—,c,n.æ„›å¥½,n.å…¶ä»–é‡è¦è³‡è¨Š,n.é‡‘éŒ¢,n.å¿ƒæƒ…,n.æ€§æ…¾,new Map(Object.entries(n.é—œä¿‚)),new Map(Object.entries(n.å‹å¥½åº¦)),new Map(Object.entries(n.æ„›æƒ…åº¦)),new Map(Object.entries(n.æ‰€æŒç‰©)));'c1'===a?h.set(a,p):x.set(a,p)}const y=b.items,E=new Map;for(const[e,t]of Object.entries(y)){const a=new Io(t.name,t.description,t.value);E.set(e,a)}const k=new Map;for(const[e,t]of Object.entries(m)){const a=new zo(e,t.name,t.location,t.description,null,t.sub_location,t.storage_ids||[]);k.set(e,a)}for(const[e,t]of k.entries())for(const a of t.sub_location_ids)k.has(a)&&(k.get(a).parent_location_id=e);const V=new Yo(new $o(new Date(e,t-1,s,c,u)),v,g,Yo.CURRENT_EVENT_NULL_VALUE,h,x,E,new Map,k,new Map,[]);V.saveAsVariable(-1),V.saveAsVariable(0),b=getVariables({type:'chat'}),b.is_initialized=!0,replaceVariables(b,{type:'chat'}),eventEmit('initialization_completed')},q=()=>{try{const e=getVariables({type:'chat'}),t={world_info:e.world_info||'',characters:e.characters||{},items:e.items||{},storages:e.storages||{},locations:e.locations||{},extra_world_info:e.extra_world_info||[],extra_world_info_prompt:e.extra_world_info_prompt||'',start_settings:e.start_settings||{}},a=JSON.stringify(t,null,2),n=new Blob([a],{type:'application/json'}),o=URL.createObjectURL(n),r=document.createElement('a');r.href=o,r.download=`initialization_settings_${(new Date).toISOString().split('T')[0]}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(o),toastr.success('åˆå§‹åŒ–è¨­å®šå·²åŒ¯å‡º')}catch(e){console.error('åŒ¯å‡ºåˆå§‹åŒ–è¨­å®šå¤±æ•—:',e),toastr.error('åŒ¯å‡ºå¤±æ•—')}},G=e=>{const t=e.target.files?.[0];if(!t)return;const a=new FileReader;a.onload=e=>{try{const t=e.target?.result,a=JSON.parse(t),n=['world_info','characters','items','storages','locations','extra_world_info','extra_world_info_prompt','start_settings'];for(const e of n)if(!(e in a))throw new Error(`ç¼ºå°‘å¿…è¦çš„éµ: ${e}`);const o=getVariables({type:'chat'});o.world_info=a.world_info,o.characters=a.characters,o.items=a.items,o.storages=a.storages,o.locations=a.locations,o.extra_world_info=a.extra_world_info,o.extra_world_info_prompt=a.extra_world_info_prompt,o.start_settings=a.start_settings,replaceVariables(o,{type:'chat'}),C(),toastr.success('åˆå§‹åŒ–è¨­å®šå·²åŒ¯å…¥')}catch(e){console.error('åŒ¯å…¥åˆå§‹åŒ–è¨­å®šå¤±æ•—:',e),toastr.error('åŒ¯å…¥å¤±æ•—ï¼šæª”æ¡ˆæ ¼å¼éŒ¯èª¤')}},a.readAsText(t)};return(t,B)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',Oo,[B[35]||(B[35]=(0,e.createElementVNode)('h3',null,'é–‹å§‹è¨­å®š',-1)),(0,e.createElementVNode)('div',Ao,[(0,e.createElementVNode)('div',Ro,[B[18]||(B[18]=(0,e.createElementVNode)('label',null,'èµ·å§‹æ™‚é–“',-1)),(0,e.createElementVNode)('div',Ko,[(0,e.createElementVNode)('div',Uo,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':B[0]||(B[0]=e=>a.value=e),type:'number',class:'form-input',placeholder:'å¹´',min:'1900',max:'2100'},null,512),[[e.vModelText,a.value]]),B[12]||(B[12]=(0,e.createElementVNode)('span',{class:'unit'},'å¹´',-1))]),(0,e.createElementVNode)('div',Lo,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':B[1]||(B[1]=e=>n.value=e),type:'number',class:'form-input',placeholder:'æœˆ',min:'1',max:'12'},null,512),[[e.vModelText,n.value]]),B[13]||(B[13]=(0,e.createElementVNode)('span',{class:'unit'},'æœˆ',-1))]),(0,e.createElementVNode)('div',Fo,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':B[2]||(B[2]=e=>o.value=e),type:'number',class:'form-input',placeholder:'æ—¥',min:'1',max:'31'},null,512),[[e.vModelText,o.value]]),B[14]||(B[14]=(0,e.createElementVNode)('span',{class:'unit'},'æ—¥',-1))]),(0,e.createElementVNode)('div',jo,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':B[3]||(B[3]=e=>r.value=e),type:'number',class:'form-input',placeholder:'æ™‚',min:'0',max:'23'},null,512),[[e.vModelText,r.value]]),B[15]||(B[15]=(0,e.createElementVNode)('span',{class:'unit'},'æ™‚',-1))]),(0,e.createElementVNode)('div',Ho,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':B[4]||(B[4]=e=>l.value=e),type:'number',class:'form-input',placeholder:'åˆ†',min:'0',max:'59'},null,512),[[e.vModelText,l.value]]),B[16]||(B[16]=(0,e.createElementVNode)('span',{class:'unit'},'åˆ†',-1))])]),p.value||m.value||v.value||g.value||b.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Po,[B[17]||(B[17]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',qo,(0,e.toDisplayString)(p.value?`å¹´ï¼š${p.value}\n`:'')+(0,e.toDisplayString)(m.value?`æœˆï¼š${m.value}\n`:'')+(0,e.toDisplayString)(v.value?`æ—¥ï¼š${v.value}\n`:'')+(0,e.toDisplayString)(g.value?`æ™‚ï¼š${g.value}\n`:'')+(0,e.toDisplayString)(b.value?`åˆ†ï¼š${b.value}`:''),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:O},'ä½¿ç”¨')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Go,[B[21]||(B[21]=(0,e.createElementVNode)('label',null,'èµ·å§‹åœ°é»ž',-1)),(0,e.withDirectives)((0,e.createElementVNode)('select',{'onUpdate:modelValue':B[5]||(B[5]=e=>i.value=e),class:'form-input'},[B[19]||(B[19]=(0,e.createElementVNode)('option',{value:''},'è«‹é¸æ“‡èµ·å§‹åœ°é»ž',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)((0,e.unref)(E),([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t,value:t},(0,e.toDisplayString)(a.name)+' ('+(0,e.toDisplayString)(t)+') ',9,Wo))),128))],512),[[e.vModelSelect,i.value]]),f.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Xo,[B[20]||(B[20]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Jo,(0,e.toDisplayString)(f.value),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:B[6]||(B[6]=e=>{i.value=f.value,f.value=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Zo,[B[23]||(B[23]=(0,e.createElementVNode)('label',null,'å¤©æ°£',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':B[7]||(B[7]=e=>d.value=e),type:'text',class:'form-input',placeholder:'è¼¸å…¥å¤©æ°£'},null,512),[[e.vModelText,d.value]]),h.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Qo,[B[22]||(B[22]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',er,(0,e.toDisplayString)(h.value),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:B[8]||(B[8]=e=>{d.value=h.value,h.value=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',tr,[B[25]||(B[25]=(0,e.createElementVNode)('label',null,'èµ·å§‹è³‡è¨Š',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':B[9]||(B[9]=e=>s.value=e),class:'form-textarea',placeholder:'è¼¸å…¥èµ·å§‹è³‡è¨Š',rows:'3'},null,512),[[e.vModelText,s.value]]),x.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',ar,[B[24]||(B[24]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',nr,(0,e.toDisplayString)(x.value),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:B[10]||(B[10]=e=>{s.value=x.value,x.value=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',or,[B[26]||(B[26]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆè¦æ±‚',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':B[11]||(B[11]=e=>c.value=e),class:'form-textarea',placeholder:'è¼¸å…¥ç”Ÿæˆé€™äº›é …ç›®çš„è¦æ±‚',rows:'3'},null,512),[[e.vModelText,c.value]])]),(0,e.createElementVNode)('div',rr,[(0,e.createElementVNode)('button',{class:'action-btn generate',disabled:!(0,e.unref)(y)||u.value,onClick:w},[u.value?((0,e.openBlock)(),(0,e.createElementBlock)('span',ir)):(0,e.createCommentVNode)('v-if',!0),(0,e.createTextVNode)(' '+(0,e.toDisplayString)(u.value?'ç”Ÿæˆä¸­...':(0,e.unref)(y)?'ç”Ÿæˆå…§å®¹':'è«‹å…ˆå®Œæˆä¸–ç•ŒèƒŒæ™¯è¨­å®š'),1)],8,lr),(0,e.createElementVNode)('button',{class:'action-btn apply-all',disabled:!(0,e.unref)(k),onClick:A},' æ‡‰ç”¨å…¨éƒ¨ ',8,dr)])]),(0,e.createCommentVNode)(' æ¨™ç±¤é å®Œæˆç‹€æ…‹æŒ‡ç¤ºå™¨ '),(0,e.createElementVNode)('div',sr,[(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['status-item',{completed:K()}])},[B[27]||(B[27]=(0,e.createElementVNode)('span',{class:'status-label'},'ä¸–ç•Œè³‡è¨Šï¼š',-1)),(0,e.createElementVNode)('span',cr,(0,e.toDisplayString)(K()?'å·²å®Œæˆ':'æœªå®Œæˆ'),1)],2),(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['status-item',{completed:U()}])},[B[28]||(B[28]=(0,e.createElementVNode)('span',{class:'status-label'},'ç”¨æˆ¶è¨­å®šï¼š',-1)),(0,e.createElementVNode)('span',ur,(0,e.toDisplayString)(U()?'å·²å®Œæˆ':'æœªå®Œæˆ'),1)],2),(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['status-item',{completed:L()}])},[B[29]||(B[29]=(0,e.createElementVNode)('span',{class:'status-label'},'è§’è‰²è¨­å®šï¼š',-1)),(0,e.createElementVNode)('span',pr,(0,e.toDisplayString)(L()?'å·²å®Œæˆ':'æœªå®Œæˆ'),1)],2),(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['status-item',{completed:F()}])},[B[30]||(B[30]=(0,e.createElementVNode)('span',{class:'status-label'},'ç‰©å“è¨­å®šï¼š',-1)),(0,e.createElementVNode)('span',mr,(0,e.toDisplayString)(F()?'å·²å®Œæˆ':'æœªå®Œæˆ'),1)],2),(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['status-item',{completed:j()}])},[B[31]||(B[31]=(0,e.createElementVNode)('span',{class:'status-label'},'é¡å¤–è¨­å®šï¼š',-1)),(0,e.createElementVNode)('span',vr,(0,e.toDisplayString)(j()?'å·²å®Œæˆ':'æœªå®Œæˆ'),1)],2),(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['status-item',{completed:H()}])},[B[32]||(B[32]=(0,e.createElementVNode)('span',{class:'status-label'},'åœ°é»žè¨­å®šï¼š',-1)),(0,e.createElementVNode)('span',gr,(0,e.toDisplayString)(H()?'å·²å®Œæˆ':'æœªå®Œæˆ'),1)],2),(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['status-item',{completed:(0,e.unref)(V)}])},[B[33]||(B[33]=(0,e.createElementVNode)('span',{class:'status-label'},'é–‹å§‹è¨­å®šï¼š',-1)),(0,e.createElementVNode)('span',br,(0,e.toDisplayString)((0,e.unref)(V)?'å·²å®Œæˆ':'æœªå®Œæˆ'),1)],2)]),(0,e.createCommentVNode)(' è¨­å®šåŒ¯å‡º/åŒ¯å…¥æŒ‰éˆ• '),(0,e.createElementVNode)('div',fr,[(0,e.createElementVNode)('button',{class:'action-btn export',onClick:q},'åŒ¯å‡ºåˆå§‹åŒ–è¨­å®š'),(0,e.createElementVNode)('label',hr,[B[34]||(B[34]=(0,e.createTextVNode)(' åŒ¯å…¥åˆå§‹åŒ–è¨­å®š ',-1)),(0,e.createElementVNode)('input',{type:'file',accept:'.json',style:{display:'none'},onChange:G},null,32)])]),(0,e.createCommentVNode)(' é–‹å§‹æŒ‰éˆ• '),(0,e.createElementVNode)('div',xr,[(0,e.createElementVNode)('button',{class:'action-btn start',disabled:!(0,e.unref)(N),onClick:P},'é–‹å§‹',8,yr)])]))}});i(7807);const Er=(0,d.A)(_r,[['__scopeId','data-v-ef5b3c42']]),kr={class:'user-profile-container'},Vr={class:'section'},Nr={class:'form-grid'},wr={class:'input-group'},Br={key:0,class:'generated-result'},Cr={class:'generated-text'},$r={class:'input-group'},Sr={key:0,class:'generated-result'},Ir={class:'generated-text'},zr={class:'input-group'},Dr={key:0,class:'generated-result'},Tr={class:'generated-text'},Mr={class:'input-group'},Yr={key:0,class:'generated-result'},Or={class:'generated-text'},Ar={class:'input-group'},Rr={key:0,class:'generated-result'},Kr={class:'generated-text'},Ur={class:'input-group'},Lr={class:'birthday-inputs'},Fr={key:0,class:'generated-result'},jr={class:'generated-text'},Hr={class:'section'},Pr={class:'form-grid'},qr={class:'input-group'},Gr={key:0,class:'generated-result'},Wr={class:'generated-text'},Xr={class:'input-group'},Jr={key:0,class:'generated-result'},Zr={class:'generated-text'},Qr={class:'input-group'},el={key:0,class:'generated-result'},tl={class:'generated-text'},al={class:'input-group'},nl={key:0,class:'generated-result'},ol={class:'generated-text'},rl={class:'input-group'},ll={key:0,class:'generated-result'},il={class:'generated-text'},dl={class:'input-group'},sl={key:0,class:'generated-result'},cl={class:'generated-text'},ul={class:'section'},pl={class:'form-grid'},ml={class:'input-group full-width'},vl={key:0,class:'generated-result'},gl={class:'generated-text'},bl={class:'input-group full-width'},fl={key:0,class:'generated-result'},hl={class:'generated-text'},xl={class:'input-group full-width'},yl={key:0,class:'generated-result'},_l={class:'generated-text'},El={class:'section'},kl={class:'form-grid'},Vl={class:'input-group full-width'},Nl={key:0,class:'generated-result'},wl={class:'generated-text'},Bl={class:'input-group full-width'},Cl={key:0,class:'generated-result'},$l={class:'generated-text'},Sl={class:'input-group full-width'},Il={key:0,class:'generated-result'},zl={class:'generated-text'},Dl={class:'section'},Tl={class:'form-grid'},Ml={class:'input-group'},Yl={key:0,class:'generated-result'},Ol={class:'generated-text'},Al={class:'input-group full-width'},Rl={key:0,class:'generated-result'},Kl={class:'generated-text'},Ul={class:'input-group full-width'},Ll={class:'relations-list'},Fl={class:'relation-target'},jl=['value','onInput'],Hl=['onClick'],Pl={class:'add-relation'},ql=['value'],Gl=['disabled'],Wl={key:0,class:'generated-result'},Xl={class:'generated-text'},Jl={class:'input-group full-width'},Zl={class:'inventory-list'},Ql={class:'inventory-target'},ei=['value','onInput'],ti=['onClick'],ai={class:'add-inventory'},ni=['value'],oi=['disabled'],ri=['disabled'],li={key:0,class:'generated-result'},ii={class:'generated-text'},di={class:'section'},si={class:'form-grid'},ci={class:'input-group full-width'},ui={class:'action-section'},pi=['disabled'],mi={key:0,class:'loading-spinner'},vi=['disabled'],gi=(0,e.defineComponent)({__name:'user_tab',setup(t){const a=(0,e.ref)({surname:'',name:'',age:null,gender:'',identity:'',introduction:'',personality:'',height:null,weight:null,chest_size:null,cup_size:'',waist_size:null,hips_size:null,hairstyle:'',appearance:'',clothes:'',birthday_month:null,birthday_day:null,favourite:'',extra_information:'',money:null,generation_requirement:'',é—œä¿‚:new Map,selected_relation_target:'',æ‰€æŒç‰©:new Map,selected_inventory_item:'',selected_inventory_quantity:1,generated_surname:'',generated_name:'',generated_age:'',generated_gender:'',generated_identity:'',generated_introduction:'',generated_personality:'',generated_height:'',generated_weight:'',generated_chest_size:'',generated_cup_size:'',generated_waist_size:'',generated_hips_size:'',generated_hairstyle:'',generated_appearance:'',generated_clothes:'',generated_birthday_month:'',generated_birthday_day:'',generated_favourite:'',generated_extra_information:'',generated_money:'',generated_relationship:'',generated_inventory:''}),n=(0,e.ref)(!1),o=()=>{const t=new Map,a=getVariables({type:'chat'});if(a?.items)for(const[n,o]of Object.entries(a.items))t.set(n,(0,e.reactive)(o));return Array.from(t.entries())},r=e=>{if('c1'===e){const e=getVariables({type:'chat'}),t=e.characters?.c1;if(t){return`${t.å§“æ°||''}${t.åå­—||''}`.trim()||'æœªçŸ¥ç”¨æˆ¶'}return'æœªçŸ¥ç”¨æˆ¶'}{const t=getVariables({type:'chat'}),a=t.characters?.[e];if(a){return`${a.å§“æ°||''}${a.åå­—||''}`.trim()||'æœªçŸ¥è§’è‰²'}return'æœªçŸ¥è§’è‰²'}},l=e=>{const t=getVariables({type:'chat'}),a=t.items?.[e];return a&&a.name||'æœªçŸ¥ç‰©å“'},i=(0,e.computed)(()=>a.value.generated_surname||a.value.generated_name||a.value.generated_age||a.value.generated_gender||a.value.generated_identity||a.value.generated_introduction||a.value.generated_personality||a.value.generated_height||a.value.generated_weight||a.value.generated_chest_size||a.value.generated_cup_size||a.value.generated_waist_size||a.value.generated_hips_size||a.value.generated_hairstyle||a.value.generated_appearance||a.value.generated_clothes||a.value.generated_birthday_month||a.value.generated_birthday_day||a.value.generated_favourite||a.value.generated_extra_information||a.value.generated_money||a.value.generated_relationship||a.value.generated_inventory),d=()=>{const t=new Map,a=getVariables({type:'chat'});if(a?.characters)for(const[n,o]of Object.entries(a.characters))'c1'!==n&&t.set(n,(0,e.reactive)(o));return Array.from(t.entries())},s=(0,e.computed)(()=>{try{const e=getVariables({type:'chat'});return e?.world_info?.trim()}catch{return!1}}),c=()=>{try{const e=getVariables({type:'chat'}),t=e.characters||{},n={å§“æ°:a.value.surname,åå­—:a.value.name,å¹´é½¡:a.value.age,æ€§åˆ¥:a.value.gender,èº«ä»½:a.value.identity,ç°¡ä»‹:a.value.introduction,æ€§æ ¼:a.value.personality,èº«é«˜:a.value.height,é«”é‡:a.value.weight,èƒ¸åœ:a.value.chest_size,ç½©æ¯:a.value.cup_size,è…°åœ:a.value.waist_size,è‡€åœ:a.value.hips_size,é«®åž‹:a.value.hairstyle,æ¨£è²Œ:a.value.appearance,è¡£è‘—:a.value.clothes,ç”Ÿæ—¥æœˆä»½:a.value.birthday_month,ç”Ÿæ—¥æ—¥æœŸ:a.value.birthday_day,æ„›å¥½:a.value.favourite,å…¶ä»–é‡è¦è³‡è¨Š:a.value.extra_information,é‡‘éŒ¢:a.value.money,å¿ƒæƒ…:50,æ€§æ…¾:0,é—œä¿‚:Object.fromEntries(a.value.é—œä¿‚||new Map),å‹å¥½åº¦:{},æ„›æƒ…åº¦:{},æ‰€æŒç‰©:Object.fromEntries(a.value.æ‰€æŒç‰©||new Map)};t.c1=n,e.characters=t,replaceVariables(e,{type:'chat'})}catch(e){console.error('Failed to save user data to chat variables:',e)}},u=e=>'['+Object.entries(e).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']',p=()=>{let e='\n</ä¸–ç•ŒèƒŒæ™¯>\n';return e+='\n',e+=`${(()=>{const e=getVariables({type:'chat'}).characters;if(void 0===e)return'';let t='<CharacterStatus>\n';for(const[a,n]of Object.entries(e))'c1'!==a&&(t+=`idï¼š${a}\n`,t+=`  å§“æ°ï¼š${n.å§“æ°||''}\n`,t+=`  åå­—ï¼š${n.åå­—||''}\n`,t+=`  å¹´é½¡ï¼š${n.å¹´é½¡||''}\n`,t+=`  æ€§åˆ¥ï¼š${n.æ€§åˆ¥||''}\n`,t+=`  èº«ä»½ï¼š${n.èº«ä»½||''}\n`,t+=`  èº«é«˜ï¼š${n.èº«é«˜||''}\n`,t+=`  é«”é‡ï¼š${n.é«”é‡||''}\n`,t+=`  èƒ¸åœï¼š${n.èƒ¸åœ||''}\n`,t+=`  ç½©æ¯ï¼š${n.ç½©æ¯||''}\n`,t+=`  è…°åœï¼š${n.è…°åœ||''}\n`,t+=`  è‡€åœï¼š${n.è‡€åœ||''}\n`,t+=`  é«®åž‹ï¼š${n.é«®åž‹||''}\n`,t+=`  æ¨£è²Œï¼š${n.æ¨£è²Œ||''}\n`,t+=`  è¡£è‘—ï¼š${n.è¡£è‘—||''}\n`,t+=`  ç°¡ä»‹ï¼š${n.ç°¡ä»‹||''}\n`,t+=`  æ€§æ ¼ï¼š${n.æ€§æ ¼||''}\n`,t+=`  æ„›å¥½ï¼š${n.æ„›å¥½||''}\n`,t+=`  é‡‘éŒ¢ï¼š${n.é‡‘éŒ¢||''}\n`,t+=`  å¿ƒæƒ…ï¼š${n.å¿ƒæƒ…||''}\n`,t+=`  æ€§æ…¾ï¼š${n.æ€§æ…¾||''}\n`,t+=`  ç”Ÿæ—¥æœˆä»½ï¼š${n.ç”Ÿæ—¥æœˆä»½||''}\n`,t+=`  ç”Ÿæ—¥æ—¥æœŸï¼š${n.ç”Ÿæ—¥æ—¥æœŸ||''}\n`,t+=`  å…¶ä»–é‡è¦è³‡è¨Šï¼š${n.å…¶ä»–é‡è¦è³‡è¨Š||''}\n`,t+=`  é—œä¿‚ï¼š${u(n.é—œä¿‚)}\n`,t+=`  å‹å¥½åº¦ï¼š${u(n.å‹å¥½åº¦)}\n`,t+=`  æ„›æƒ…åº¦ï¼š${u(n.æ„›æƒ…åº¦)}\n\n`);return t+='</CharacterStatus>',t})()}\n`,e+='\n',e+=`${(()=>{let e='<ItemTable>\n';e+='|id|åç¨±|æè¿°|åƒ¹å€¼|\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).items;if(void 0===t)return'';for(const[a,n]of Object.entries(t))e+=`|${a}|${n.name}|${n.description}|${n.value}|\n`;return e+='</ItemTable>',e})()}\n`,e+='\n',e+=`${(()=>{let e='<LocationTable>\n';e+='|id|åœ°é»ž|ä½ç½®|æè¿°|å­åœ°é»ž|\n',e+='|---|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.location||''}|${n.description}|${t}|\n`}return e+='</LocationTable>',e})()}\n`,e+='\n',e+=`${(()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e})()}\n`,e+='\n',e+='<ç”Ÿæˆè¦æ±‚>\n',e+=`${a.value.generation_requirement}\n`,e+='</ç”Ÿæˆè¦æ±‚>\n',e+='\n',e+='<example>\n',e+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output. Output anything other than this format is prohibited.\n',e+='å§“æ°ï¼šstring\n',e+='åå­—ï¼šstring\n',e+='å¹´é½¡ï¼šnumber\n',e+='æ€§åˆ¥ï¼š\'ç”·\' | \'å¥³\' | \'ä¸æ˜Ž\'\n',e+='èº«ä»½ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',e+='ç°¡ä»‹ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',e+='æ€§æ ¼ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',e+='èº«é«˜ï¼šnumber\n',e+='é«”é‡ï¼šnumber\n',e+='èƒ¸åœï¼šnumber\n',e+='ç½©æ¯ï¼š\'Capital Letter\' | \'ä¸é©ç”¨\'\n',e+='è…°åœï¼šnumber\n',e+='è‡€åœï¼šnumber\n',e+='é«®åž‹ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',e+='æ¨£è²Œï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',e+='è¡£è‘—ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°ç•¶å‰èº«ä¸Šæœè£\'\n',e+='ç”Ÿæ—¥(æœˆ)ï¼šnumber\n',e+='ç”Ÿæ—¥(æ—¥)ï¼šnumber\n',e+='å–œå¥½ï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',e+='å…¶ä»–é‡è¦è³‡è¨Šï¼š\'ä»¥ç¬¬ä¸‰äººç¨±å®¢è§€åœ°æè¿°\'\n',e+='é‡‘éŒ¢ï¼šnumber\n',e+='é—œä¿‚ï¼š[\'character_id\':\'å°æ­¤è§’è‰²çš„é—œä¿‚\', ...]\n',e+='æ‰€æŒç‰©ï¼š[\'item_id\':quantity, ...]\n',e+='</example>',e},m=async()=>{n.value=!0;try{const e=(()=>{let e='è«‹æ ¹æ“šä¸–ç•ŒèƒŒæ™¯è³‡è¨Šã€ç”Ÿæˆè¦æ±‚åŠå·²æœ‰è§’è‰²è³‡æ–™ï¼Œç‚ºç”¨æˆ¶å®Œå–„ä»¥ä¸‹çš„è§’è‰²è³‡æ–™è¨­å®šï¼š\n';return e+='\n',e+=`å§“æ°ï¼š${a.value.surname}\n`,e+=`åå­—ï¼š${a.value.name}\n`,e+=`å¹´é½¡ï¼š${a.value.age}\n`,e+=`æ€§åˆ¥ï¼š${a.value.gender}\n`,e+=`èº«ä»½ï¼š${a.value.identity}\n`,e+=`ç°¡ä»‹ï¼š${a.value.introduction}\n`,e+=`æ€§æ ¼ï¼š${a.value.personality}\n`,e+=`èº«é«˜ï¼š${a.value.height}\n`,e+=`é«”é‡ï¼š${a.value.weight}\n`,e+=`èƒ¸åœï¼š${a.value.chest_size}\n`,e+=`ç½©æ¯ï¼š${a.value.cup_size}\n`,e+=`è…°åœï¼š${a.value.waist_size}\n`,e+=`è‡€åœï¼š${a.value.hips_size}\n`,e+=`é«®åž‹ï¼š${a.value.hairstyle}\n`,e+=`æ¨£è²Œï¼š${a.value.appearance}\n`,e+=`è¡£è‘—ï¼š${a.value.clothes}\n`,e+=`ç”Ÿæ—¥(æœˆ)ï¼š${a.value.birthday_month}\n`,e+=`ç”Ÿæ—¥(æ—¥)ï¼š${a.value.birthday_day}\n`,e+=`å–œå¥½ï¼š${a.value.favourite}\n`,e+=`å…¶ä»–é‡è¦è³‡è¨Šï¼š${a.value.extra_information}\n`,e+=`é‡‘éŒ¢ï¼š${a.value.money}\n`,e+=`é—œä¿‚ï¼š${u(Object.fromEntries(a.value.é—œä¿‚||new Map))}\n`,e+=`æ‰€æŒç‰©ï¼š${u(Object.fromEntries(a.value.æ‰€æŒç‰©||new Map))}\n`,e})(),t=(()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„è§’è‰²è¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ è±å¯Œå¤šå½©çš„è§’è‰²è¨­å®šã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºç”¨æˆ¶å®Œå–„è§’è‰²è³‡æ–™ã€‚\n';return a+='\n',a+='<ä¸–ç•ŒèƒŒæ™¯>\n','ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„è§’è‰²è¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ è±å¯Œå¤šå½©çš„è§’è‰²è¨­å®šã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºç”¨æˆ¶å®Œå–„è§’è‰²è³‡æ–™ã€‚\n\n<ä¸–ç•ŒèƒŒæ™¯>\n'})(),n=p(),o=await generateRaw({user_input:e,ordered_prompts:[{role:'system',content:t},'char_description',{role:'system',content:n},'user_input']});v(o);try{localStorage.setItem('user_profile_generated',JSON.stringify({generation_requirement:a.value.generation_requirement,generated_surname:a.value.generated_surname,generated_name:a.value.generated_name,generated_age:a.value.generated_age,generated_gender:a.value.generated_gender,generated_identity:a.value.generated_identity,generated_introduction:a.value.generated_introduction,generated_personality:a.value.generated_personality,generated_height:a.value.generated_height,generated_weight:a.value.generated_weight,generated_chest_size:a.value.generated_chest_size,generated_cup_size:a.value.generated_cup_size,generated_waist_size:a.value.generated_waist_size,generated_hips_size:a.value.generated_hips_size,generated_hairstyle:a.value.generated_hairstyle,generated_appearance:a.value.generated_appearance,generated_clothes:a.value.generated_clothes,generated_birthday_month:a.value.generated_birthday_month,generated_birthday_day:a.value.generated_birthday_day,generated_favourite:a.value.generated_favourite,generated_extra_information:a.value.generated_extra_information,generated_money:a.value.generated_money,generated_relationship:a.value.generated_relationship,generated_inventory:a.value.generated_inventory}))}catch(e){console.error('Failed to save generated user profile to localStorage:',e)}}catch(e){console.error('ç”Ÿæˆç”¨æˆ¶è³‡æ–™å¤±æ•—:',e),a.value.generated_age='ç”Ÿæˆå¤±æ•—ï¼Œè«‹é‡è©¦ã€‚'}finally{n.value=!1}},v=e=>{const t=e.split('\n'),n={};for(const e of t){const t=e.indexOf('ï¼š');if(t>0){const a=e.substring(0,t).trim(),o=e.substring(t+1).trim();switch(a){case'å§“æ°':n.generated_surname=o.replace(/^["']|["']$/g,'');break;case'åå­—':n.generated_name=o.replace(/^["']|["']$/g,'');break;case'å¹´é½¡':n.generated_age=o.replace(/[^\d]/g,'');break;case'æ€§åˆ¥':n.generated_gender=o.replace(/^["']|["']$/g,'');break;case'èº«ä»½':n.generated_identity=o.replace(/^["']|["']$/g,'');break;case'ç°¡ä»‹':n.generated_introduction=o.replace(/^["']|["']$/g,'');break;case'æ€§æ ¼':n.generated_personality=o.replace(/^["']|["']$/g,'');break;case'èº«é«˜':n.generated_height=o.replace(/[^\d]/g,'');break;case'é«”é‡':n.generated_weight=o.replace(/[^\d]/g,'');break;case'èƒ¸åœ':n.generated_chest_size=o.replace(/[^\d]/g,'');break;case'ç½©æ¯':n.generated_cup_size=o.replace(/^["']|["']$/g,'');break;case'è…°åœ':n.generated_waist_size=o.replace(/[^\d]/g,'');break;case'è‡€åœ':n.generated_hips_size=o.replace(/[^\d]/g,'');break;case'é«®åž‹':n.generated_hairstyle=o.replace(/^["']|["']$/g,'');break;case'æ¨£è²Œ':n.generated_appearance=o.replace(/^["']|["']$/g,'');break;case'è¡£è‘—':n.generated_clothes=o.replace(/^["']|["']$/g,'');break;case'ç”Ÿæ—¥(æœˆ)':n.generated_birthday_month=o.replace(/[^\d]/g,'');break;case'ç”Ÿæ—¥(æ—¥)':n.generated_birthday_day=o.replace(/[^\d]/g,'');break;case'å–œå¥½':n.generated_favourite=o.replace(/^["']|["']$/g,'');break;case'å…¶ä»–é‡è¦è³‡è¨Š':n.generated_extra_information=o.replace(/^["']|["']$/g,'');break;case'é‡‘éŒ¢':n.generated_money=o.replace(/[^\d]/g,'');break;case'é—œä¿‚':n.generated_relationship=o.replace(/^["']|["']$/g,'');break;case'æ‰€æŒç‰©':n.generated_inventory=o.replace(/^["']|["']$/g,'')}}}Object.assign(a.value,n)},g=()=>{if(a.value.generated_surname&&(a.value.surname=a.value.generated_surname),a.value.generated_name&&(a.value.name=a.value.generated_name),a.value.generated_age&&(a.value.age=parseInt(a.value.generated_age)||null),a.value.generated_gender&&(a.value.gender=a.value.generated_gender),a.value.generated_identity&&(a.value.identity=a.value.generated_identity),a.value.generated_introduction&&(a.value.introduction=a.value.generated_introduction),a.value.generated_personality&&(a.value.personality=a.value.generated_personality),a.value.generated_height&&(a.value.height=parseInt(a.value.generated_height)||null),a.value.generated_weight&&(a.value.weight=parseInt(a.value.generated_weight)||null),a.value.generated_chest_size&&(a.value.chest_size=parseInt(a.value.generated_chest_size)||null),a.value.generated_cup_size&&(a.value.cup_size=a.value.generated_cup_size),a.value.generated_waist_size&&(a.value.waist_size=parseInt(a.value.generated_waist_size)||null),a.value.generated_hips_size&&(a.value.hips_size=parseInt(a.value.generated_hips_size)||null),a.value.generated_hairstyle&&(a.value.hairstyle=a.value.generated_hairstyle),a.value.generated_appearance&&(a.value.appearance=a.value.generated_appearance),a.value.generated_clothes&&(a.value.clothes=a.value.generated_clothes),a.value.generated_birthday_month&&(a.value.birthday_month=parseInt(a.value.generated_birthday_month)||null),a.value.generated_birthday_day&&(a.value.birthday_day=parseInt(a.value.generated_birthday_day)||null),a.value.generated_favourite&&(a.value.favourite=a.value.generated_favourite),a.value.generated_extra_information&&(a.value.extra_information=a.value.generated_extra_information),a.value.generated_money&&(a.value.money=parseInt(a.value.generated_money)||null),a.value.generated_relationship){a.value.é—œä¿‚||(a.value.é—œä¿‚=new Map);const e=a.value.generated_relationship.replace(/^["']|["']$/g,'');if(e.startsWith('[')&&e.endsWith(']')){const t=e.slice(1,-1).split(',').map(e=>e.trim());for(const e of t){const t=e.indexOf(':');if(t>0){const n=e.substring(0,t).replace(/^["']|["']$/g,'').trim(),o=e.substring(t+1).replace(/^["']|["']$/g,'').trim();n&&o&&a.value.é—œä¿‚.set(n,o)}}}a.value.generated_relationship=''}if(a.value.generated_inventory){a.value.æ‰€æŒç‰©||(a.value.æ‰€æŒç‰©=new Map);const e=a.value.generated_inventory.replace(/^["']|["']$/g,'');if(e.startsWith('[')&&e.endsWith(']')){const t=e.slice(1,-1).split(',').map(e=>e.trim());for(const e of t){const t=e.indexOf(':');if(t>0){const n=e.substring(0,t).replace(/^["']|["']$/g,'').trim(),o=parseInt(e.substring(t+1).replace(/^["']|["']$/g,'').trim());n&&!isNaN(o)&&o>0&&a.value.æ‰€æŒç‰©.set(n,o)}}}a.value.generated_inventory=''}a.value.generated_surname='',a.value.generated_name='',a.value.generated_age='',a.value.generated_gender='',a.value.generated_identity='',a.value.generated_introduction='',a.value.generated_personality='',a.value.generated_height='',a.value.generated_weight='',a.value.generated_chest_size='',a.value.generated_cup_size='',a.value.generated_waist_size='',a.value.generated_hips_size='',a.value.generated_hairstyle='',a.value.generated_appearance='',a.value.generated_clothes='',a.value.generated_birthday_month='',a.value.generated_birthday_day='',a.value.generated_favourite='',a.value.generated_extra_information='',a.value.generated_money='',a.value.generated_relationship='',a.value.generated_inventory=''},b=()=>{a.value.selected_relation_target&&(a.value.é—œä¿‚||(a.value.é—œä¿‚=new Map),a.value.é—œä¿‚.set(a.value.selected_relation_target,''),a.value.selected_relation_target='',c())},f=()=>{if(!a.value.selected_inventory_item||!a.value.selected_inventory_quantity)return;a.value.æ‰€æŒç‰©||(a.value.æ‰€æŒç‰©=new Map);const e=a.value.æ‰€æŒç‰©.get(a.value.selected_inventory_item)||0;a.value.æ‰€æŒç‰©.set(a.value.selected_inventory_item,e+a.value.selected_inventory_quantity),a.value.selected_inventory_item='',a.value.selected_inventory_quantity=1,c()},h=(e,t)=>{switch(e){case'å§“æ°':a.value.surname=t,a.value.generated_surname='';break;case'åå­—':a.value.name=t,a.value.generated_name='';break;case'å¹´é½¡':a.value.age=parseInt(t)||null,a.value.generated_age='';break;case'æ€§åˆ¥':a.value.gender=t,a.value.generated_gender='';break;case'èº«ä»½':a.value.identity=t,a.value.generated_identity='';break;case'èº«é«˜':a.value.height=parseInt(t)||null,a.value.generated_height='';break;case'é«”é‡':a.value.weight=parseInt(t)||null,a.value.generated_weight='';break;case'èƒ¸åœ':a.value.chest_size=parseInt(t)||null,a.value.generated_chest_size='';break;case'ç½©æ¯':a.value.cup_size=t,a.value.generated_cup_size='';break;case'è…°åœ':a.value.waist_size=parseInt(t)||null,a.value.generated_waist_size='';break;case'è‡€åœ':a.value.hips_size=parseInt(t)||null,a.value.generated_hips_size='';break;case'é«®åž‹':a.value.hairstyle=t,a.value.generated_hairstyle='';break;case'æ¨£è²Œ':a.value.appearance=t,a.value.generated_appearance='';break;case'è¡£è‘—':a.value.clothes=t,a.value.generated_clothes='';break;case'ç°¡ä»‹':a.value.introduction=t,a.value.generated_introduction='';break;case'æ€§æ ¼':a.value.personality=t,a.value.generated_personality='';break;case'å–œå¥½':a.value.favourite=t,a.value.generated_favourite='';break;case'é‡‘éŒ¢':a.value.money=parseInt(t)||null,a.value.generated_money='';break;case'å…¶ä»–é‡è¦è³‡è¨Š':a.value.extra_information=t,a.value.generated_extra_information='';break;case'é—œä¿‚':{a.value.é—œä¿‚||(a.value.é—œä¿‚=new Map);const e=t.replace(/^["']|["']$/g,'');if(e.startsWith('[')&&e.endsWith(']')){const t=e.slice(1,-1).split(',').map(e=>e.trim());for(const e of t){const t=e.indexOf(':');if(t>0){const n=e.substring(0,t).replace(/^["']|["']$/g,'').trim(),o=e.substring(t+1).replace(/^["']|["']$/g,'').trim();n&&o&&a.value.é—œä¿‚.set(n,o)}}}a.value.generated_relationship='';break}case'æ‰€æŒç‰©':{a.value.æ‰€æŒç‰©||(a.value.æ‰€æŒç‰©=new Map);const e=t.replace(/^["']|["']$/g,'');if(e.startsWith('[')&&e.endsWith(']')){const t=e.slice(1,-1).split(',').map(e=>e.trim());for(const e of t){const t=e.indexOf(':');if(t>0){const n=e.substring(0,t).replace(/^["']|["']$/g,'').trim(),o=parseInt(e.substring(t+1).replace(/^["']|["']$/g,'').trim());n&&!isNaN(o)&&o>0&&a.value.æ‰€æŒç‰©.set(n,o)}}}a.value.generated_inventory='';break}}c()};return(0,e.watch)(a,()=>{c()},{deep:!0}),(0,e.watch)(()=>a.value.generation_requirement,e=>{try{const t=localStorage.getItem('user_profile_generated'),a=t?JSON.parse(t):{};a.generation_requirement=e,localStorage.setItem('user_profile_generated',JSON.stringify(a))}catch(e){console.error('Failed to save generation_requirement to localStorage:',e)}},{immediate:!1}),(0,e.onMounted)(()=>{(()=>{try{const e=(getVariables({type:'chat'}).characters||{}).c1;e&&(a.value.surname=e['å§“æ°']||'',a.value.name=e['åå­—']||'',a.value.age=e['å¹´é½¡'],a.value.gender=e['æ€§åˆ¥']||'',a.value.identity=e['èº«ä»½']||'',a.value.introduction=e['ç°¡ä»‹']||'',a.value.personality=e['æ€§æ ¼']||'',a.value.height=e['èº«é«˜'],a.value.weight=e['é«”é‡'],a.value.chest_size=e['èƒ¸åœ'],a.value.cup_size=e['ç½©æ¯']||'',a.value.waist_size=e['è…°åœ'],a.value.hips_size=e['è‡€åœ'],a.value.hairstyle=e['é«®åž‹']||'',a.value.appearance=e['æ¨£è²Œ']||'',a.value.clothes=e['è¡£è‘—']||'',a.value.favourite=e['æ„›å¥½']||'',a.value.extra_information=e['å…¶ä»–é‡è¦è³‡è¨Š']||'',a.value.money=e['é‡‘éŒ¢'],a.value.birthday_month=e['ç”Ÿæ—¥æœˆä»½'],a.value.birthday_day=e['ç”Ÿæ—¥æ—¥æœŸ'],e.é—œä¿‚?a.value.é—œä¿‚=new Map(Object.entries(e.é—œä¿‚)):a.value.é—œä¿‚=new Map,e.æ‰€æŒç‰©?a.value.æ‰€æŒç‰©=new Map(Object.entries(e.æ‰€æŒç‰©)):a.value.æ‰€æŒç‰©=new Map)}catch(e){console.error('Failed to load user data from chat variables:',e)}try{const e=localStorage.getItem('user_profile_generated');if(e){const t=JSON.parse(e);Object.assign(a.value,t)}}catch(e){console.error('Failed to load generated user profile from localStorage:',e)}})()}),(0,e.onBeforeUnmount)(()=>{c()}),(t,u)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',kr,[u[103]||(u[103]=(0,e.createElementVNode)('h3',null,'ç”¨æˆ¶è³‡æ–™è¨­å®š',-1)),(0,e.createCommentVNode)(' åŸºæœ¬è³‡è¨Š '),(0,e.createElementVNode)('div',Vr,[u[60]||(u[60]=(0,e.createElementVNode)('h4',null,'åŸºæœ¬è³‡è¨Š',-1)),(0,e.createElementVNode)('div',Nr,[u[59]||(u[59]=(0,e.createElementVNode)('div',{class:'input-group'},[(0,e.createElementVNode)('label',null,'è§’è‰²ID'),(0,e.createElementVNode)('div',{class:'display-text'},'c1')],-1)),(0,e.createElementVNode)('div',wr,[u[48]||(u[48]=(0,e.createElementVNode)('label',{for:'surname-input'},'å§“æ°',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'surname-input','onUpdate:modelValue':u[0]||(u[0]=e=>a.value.surname=e),type:'text',placeholder:'ä¾‹å¦‚ï¼šå¼µ',class:'text-input'},null,512),[[e.vModelText,a.value.surname]]),a.value.generated_surname?((0,e.openBlock)(),(0,e.createElementBlock)('div',Br,[u[47]||(u[47]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Cr,(0,e.toDisplayString)(a.value.generated_surname),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[1]||(u[1]=e=>{a.value.surname=a.value.generated_surname,a.value.generated_surname=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',$r,[u[50]||(u[50]=(0,e.createElementVNode)('label',{for:'name-input'},'åå­—',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'name-input','onUpdate:modelValue':u[2]||(u[2]=e=>a.value.name=e),type:'text',placeholder:'ä¾‹å¦‚ï¼šå°æ˜Ž',class:'text-input'},null,512),[[e.vModelText,a.value.name]]),a.value.generated_name?((0,e.openBlock)(),(0,e.createElementBlock)('div',Sr,[u[49]||(u[49]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Ir,(0,e.toDisplayString)(a.value.generated_name),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[3]||(u[3]=e=>{a.value.name=a.value.generated_name,a.value.generated_name=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',zr,[u[52]||(u[52]=(0,e.createElementVNode)('label',{for:'age-input'},'å¹´é½¡',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'age-input','onUpdate:modelValue':u[4]||(u[4]=e=>a.value.age=e),type:'number',placeholder:'ä¾‹å¦‚ï¼š18',class:'text-input',min:'0',max:'200'},null,512),[[e.vModelText,a.value.age,void 0,{number:!0}]]),a.value.generated_age?((0,e.openBlock)(),(0,e.createElementBlock)('div',Dr,[u[51]||(u[51]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Tr,(0,e.toDisplayString)(a.value.generated_age),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[5]||(u[5]=e=>{a.value.age=parseInt(a.value.generated_age)||null,a.value.generated_age=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Mr,[u[54]||(u[54]=(0,e.createElementVNode)('label',{for:'gender-input'},'æ€§åˆ¥',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'gender-input','onUpdate:modelValue':u[6]||(u[6]=e=>a.value.gender=e),type:'text',placeholder:'ä¾‹å¦‚ï¼šå¥³',class:'text-input'},null,512),[[e.vModelText,a.value.gender]]),a.value.generated_gender?((0,e.openBlock)(),(0,e.createElementBlock)('div',Yr,[u[53]||(u[53]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Or,(0,e.toDisplayString)(a.value.generated_gender),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[7]||(u[7]=e=>{a.value.gender=a.value.generated_gender,a.value.generated_gender=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Ar,[u[56]||(u[56]=(0,e.createElementVNode)('label',{for:'identity-input'},'èº«ä»½',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'identity-input','onUpdate:modelValue':u[8]||(u[8]=e=>a.value.identity=e),type:'text',placeholder:'ä¾‹å¦‚ï¼šé«˜ä¸­ç”Ÿ',class:'text-input'},null,512),[[e.vModelText,a.value.identity]]),a.value.generated_identity?((0,e.openBlock)(),(0,e.createElementBlock)('div',Rr,[u[55]||(u[55]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Kr,(0,e.toDisplayString)(a.value.generated_identity),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[9]||(u[9]=e=>{a.value.identity=a.value.generated_identity,a.value.generated_identity=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Ur,[u[58]||(u[58]=(0,e.createElementVNode)('label',{for:'birthday-input'},'ç”Ÿæ—¥',-1)),(0,e.createElementVNode)('div',Lr,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':u[10]||(u[10]=e=>a.value.birthday_month=e),type:'number',placeholder:'æœˆ',class:'birthday-input',min:'1',max:'12'},null,512),[[e.vModelText,a.value.birthday_month,void 0,{number:!0}]]),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':u[11]||(u[11]=e=>a.value.birthday_day=e),type:'number',placeholder:'æ—¥',class:'birthday-input',min:'1',max:'31'},null,512),[[e.vModelText,a.value.birthday_day,void 0,{number:!0}]])]),a.value.generated_birthday_month||a.value.generated_birthday_day?((0,e.openBlock)(),(0,e.createElementBlock)('div',Fr,[u[57]||(u[57]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',jr,(0,e.toDisplayString)(a.value.generated_birthday_month)+'æœˆ '+(0,e.toDisplayString)(a.value.generated_birthday_day)+'æ—¥ ',1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[12]||(u[12]=e=>{a.value.birthday_month=parseInt(a.value.generated_birthday_month)||null,a.value.birthday_day=parseInt(a.value.generated_birthday_day)||null,a.value.generated_birthday_month='',a.value.generated_birthday_day=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)])])]),(0,e.createCommentVNode)(' å¤–è²Œç‰¹å¾µ '),(0,e.createElementVNode)('div',Hr,[u[73]||(u[73]=(0,e.createElementVNode)('h4',null,'å¤–è²Œç‰¹å¾µ',-1)),(0,e.createElementVNode)('div',Pr,[(0,e.createElementVNode)('div',qr,[u[62]||(u[62]=(0,e.createElementVNode)('label',{for:'height-input'},'èº«é«˜ (cm)',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'height-input','onUpdate:modelValue':u[13]||(u[13]=e=>a.value.height=e),type:'number',placeholder:'ä¾‹å¦‚ï¼š165',class:'text-input',min:'0',max:'300'},null,512),[[e.vModelText,a.value.height,void 0,{number:!0}]]),a.value.generated_height?((0,e.openBlock)(),(0,e.createElementBlock)('div',Gr,[u[61]||(u[61]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Wr,(0,e.toDisplayString)(a.value.generated_height),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[14]||(u[14]=e=>{a.value.height=parseInt(a.value.generated_height)||null,a.value.generated_height=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Xr,[u[64]||(u[64]=(0,e.createElementVNode)('label',{for:'weight-input'},'é«”é‡ (kg)',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'weight-input','onUpdate:modelValue':u[15]||(u[15]=e=>a.value.weight=e),type:'number',placeholder:'ä¾‹å¦‚ï¼š50',class:'text-input',min:'0',max:'500'},null,512),[[e.vModelText,a.value.weight,void 0,{number:!0}]]),a.value.generated_weight?((0,e.openBlock)(),(0,e.createElementBlock)('div',Jr,[u[63]||(u[63]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Zr,(0,e.toDisplayString)(a.value.generated_weight),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[16]||(u[16]=e=>{a.value.weight=parseInt(a.value.generated_weight)||null,a.value.generated_weight=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Qr,[u[66]||(u[66]=(0,e.createElementVNode)('label',{for:'chest-size-input'},'èƒ¸åœ (cm)',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'chest-size-input','onUpdate:modelValue':u[17]||(u[17]=e=>a.value.chest_size=e),type:'number',placeholder:'ä¾‹å¦‚ï¼š85',class:'text-input',min:'0',max:'200'},null,512),[[e.vModelText,a.value.chest_size,void 0,{number:!0}]]),a.value.generated_chest_size?((0,e.openBlock)(),(0,e.createElementBlock)('div',el,[u[65]||(u[65]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',tl,(0,e.toDisplayString)(a.value.generated_chest_size),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[18]||(u[18]=e=>{a.value.chest_size=parseInt(a.value.generated_chest_size)||null,a.value.generated_chest_size=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',al,[u[68]||(u[68]=(0,e.createElementVNode)('label',{for:'cup-size-input'},'ç½©æ¯',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'cup-size-input','onUpdate:modelValue':u[19]||(u[19]=e=>a.value.cup_size=e),type:'text',placeholder:'ä¾‹å¦‚ï¼šC',class:'text-input'},null,512),[[e.vModelText,a.value.cup_size]]),a.value.generated_cup_size?((0,e.openBlock)(),(0,e.createElementBlock)('div',nl,[u[67]||(u[67]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',ol,(0,e.toDisplayString)(a.value.generated_cup_size),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[20]||(u[20]=e=>{a.value.cup_size=a.value.generated_cup_size,a.value.generated_cup_size=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',rl,[u[70]||(u[70]=(0,e.createElementVNode)('label',{for:'waist-size-input'},'è…°åœ (cm)',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'waist-size-input','onUpdate:modelValue':u[21]||(u[21]=e=>a.value.waist_size=e),type:'number',placeholder:'ä¾‹å¦‚ï¼š60',class:'text-input',min:'0',max:'200'},null,512),[[e.vModelText,a.value.waist_size,void 0,{number:!0}]]),a.value.generated_waist_size?((0,e.openBlock)(),(0,e.createElementBlock)('div',ll,[u[69]||(u[69]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',il,(0,e.toDisplayString)(a.value.generated_waist_size),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[22]||(u[22]=e=>{a.value.waist_size=parseInt(a.value.generated_waist_size)||null,a.value.generated_waist_size=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',dl,[u[72]||(u[72]=(0,e.createElementVNode)('label',{for:'hips-size-input'},'è‡€åœ (cm)',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'hips-size-input','onUpdate:modelValue':u[23]||(u[23]=e=>a.value.hips_size=e),type:'number',placeholder:'ä¾‹å¦‚ï¼š88',class:'text-input',min:'0',max:'200'},null,512),[[e.vModelText,a.value.hips_size,void 0,{number:!0}]]),a.value.generated_hips_size?((0,e.openBlock)(),(0,e.createElementBlock)('div',sl,[u[71]||(u[71]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',cl,(0,e.toDisplayString)(a.value.generated_hips_size),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[24]||(u[24]=e=>{a.value.hips_size=parseInt(a.value.generated_hips_size)||null,a.value.generated_hips_size=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)])])]),(0,e.createCommentVNode)(' å¤–è§€æè¿° '),(0,e.createElementVNode)('div',ul,[u[80]||(u[80]=(0,e.createElementVNode)('h4',null,'å¤–è§€æè¿°',-1)),(0,e.createElementVNode)('div',pl,[(0,e.createElementVNode)('div',ml,[u[75]||(u[75]=(0,e.createElementVNode)('label',{for:'hairstyle-input'},'é«®åž‹',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'hairstyle-input','onUpdate:modelValue':u[25]||(u[25]=e=>a.value.hairstyle=e),type:'text',placeholder:'ä¾‹å¦‚ï¼šé»‘è‰²é•·ç›´é«®',class:'text-input'},null,512),[[e.vModelText,a.value.hairstyle]]),a.value.generated_hairstyle?((0,e.openBlock)(),(0,e.createElementBlock)('div',vl,[u[74]||(u[74]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',gl,(0,e.toDisplayString)(a.value.generated_hairstyle),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[26]||(u[26]=e=>{a.value.hairstyle=a.value.generated_hairstyle,a.value.generated_hairstyle=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',bl,[u[77]||(u[77]=(0,e.createElementVNode)('label',{for:'appearance-input'},'å¤–è²Œ',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{id:'appearance-input','onUpdate:modelValue':u[27]||(u[27]=e=>a.value.appearance=e),placeholder:'æè¿°å¤–è²Œç‰¹å¾µ...',class:'text-area',rows:'3'},null,512),[[e.vModelText,a.value.appearance]]),a.value.generated_appearance?((0,e.openBlock)(),(0,e.createElementBlock)('div',fl,[u[76]||(u[76]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',hl,(0,e.toDisplayString)(a.value.generated_appearance),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[28]||(u[28]=e=>{a.value.appearance=a.value.generated_appearance,a.value.generated_appearance=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',xl,[u[79]||(u[79]=(0,e.createElementVNode)('label',{for:'clothes-input'},'æœè£',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{id:'clothes-input','onUpdate:modelValue':u[29]||(u[29]=e=>a.value.clothes=e),placeholder:'æè¿°å¸¸ç©¿çš„æœè£...',class:'text-area',rows:'3'},null,512),[[e.vModelText,a.value.clothes]]),a.value.generated_clothes?((0,e.openBlock)(),(0,e.createElementBlock)('div',yl,[u[78]||(u[78]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',_l,(0,e.toDisplayString)(a.value.generated_clothes),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[30]||(u[30]=e=>{a.value.clothes=a.value.generated_clothes,a.value.generated_clothes=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)])])]),(0,e.createCommentVNode)(' å€‹æ€§èˆ‡å–œå¥½ '),(0,e.createElementVNode)('div',El,[u[87]||(u[87]=(0,e.createElementVNode)('h4',null,'å€‹æ€§èˆ‡å–œå¥½',-1)),(0,e.createElementVNode)('div',kl,[(0,e.createElementVNode)('div',Vl,[u[82]||(u[82]=(0,e.createElementVNode)('label',{for:'introduction-input'},'è§’è‰²ç°¡ä»‹',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{id:'introduction-input','onUpdate:modelValue':u[31]||(u[31]=e=>a.value.introduction=e),placeholder:'ç°¡å–®ä»‹ç´¹è‡ªå·±...',class:'text-area',rows:'3'},null,512),[[e.vModelText,a.value.introduction]]),a.value.generated_introduction?((0,e.openBlock)(),(0,e.createElementBlock)('div',Nl,[u[81]||(u[81]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',wl,(0,e.toDisplayString)(a.value.generated_introduction),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[32]||(u[32]=e=>{a.value.introduction=a.value.generated_introduction,a.value.generated_introduction=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Bl,[u[84]||(u[84]=(0,e.createElementVNode)('label',{for:'personality-input'},'å€‹æ€§',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{id:'personality-input','onUpdate:modelValue':u[33]||(u[33]=e=>a.value.personality=e),placeholder:'æè¿°æ€§æ ¼ç‰¹é»ž...',class:'text-area',rows:'3'},null,512),[[e.vModelText,a.value.personality]]),a.value.generated_personality?((0,e.openBlock)(),(0,e.createElementBlock)('div',Cl,[u[83]||(u[83]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',$l,(0,e.toDisplayString)(a.value.generated_personality),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[34]||(u[34]=e=>{a.value.personality=a.value.generated_personality,a.value.generated_personality=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Sl,[u[86]||(u[86]=(0,e.createElementVNode)('label',{for:'favourite-input'},'å–œå¥½',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{id:'favourite-input','onUpdate:modelValue':u[35]||(u[35]=e=>a.value.favourite=e),placeholder:'æè¿°å–œæ­¡çš„äº‹ç‰©...',class:'text-area',rows:'3'},null,512),[[e.vModelText,a.value.favourite]]),a.value.generated_favourite?((0,e.openBlock)(),(0,e.createElementBlock)('div',Il,[u[85]||(u[85]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',zl,(0,e.toDisplayString)(a.value.generated_favourite),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[36]||(u[36]=e=>{a.value.favourite=a.value.generated_favourite,a.value.generated_favourite=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)])])]),(0,e.createCommentVNode)(' å…¶ä»–è³‡è¨Š '),(0,e.createElementVNode)('div',Dl,[u[100]||(u[100]=(0,e.createElementVNode)('h4',null,'å…¶ä»–è³‡è¨Š',-1)),(0,e.createElementVNode)('div',Tl,[(0,e.createElementVNode)('div',Ml,[u[89]||(u[89]=(0,e.createElementVNode)('label',{for:'money-input'},'é‡‘éŒ¢',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'money-input','onUpdate:modelValue':u[37]||(u[37]=e=>a.value.money=e),type:'number',placeholder:'ä¾‹å¦‚ï¼š10000',class:'text-input',min:'0'},null,512),[[e.vModelText,a.value.money,void 0,{number:!0}]]),a.value.generated_money?((0,e.openBlock)(),(0,e.createElementBlock)('div',Yl,[u[88]||(u[88]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Ol,(0,e.toDisplayString)(a.value.generated_money),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[38]||(u[38]=e=>{a.value.money=parseInt(a.value.generated_money)||null,a.value.generated_money=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Al,[u[91]||(u[91]=(0,e.createElementVNode)('label',{for:'extra-info-input'},'å…¶ä»–é‡è¦è³‡è¨Š',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{id:'extra-info-input','onUpdate:modelValue':u[39]||(u[39]=e=>a.value.extra_information=e),placeholder:'å…¶ä»–éœ€è¦æè¿°çš„è³‡è¨Š...',class:'text-area',rows:'3'},null,512),[[e.vModelText,a.value.extra_information]]),a.value.generated_extra_information?((0,e.openBlock)(),(0,e.createElementBlock)('div',Rl,[u[90]||(u[90]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Kl,(0,e.toDisplayString)(a.value.generated_extra_information),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[40]||(u[40]=e=>{a.value.extra_information=a.value.generated_extra_information,a.value.generated_extra_information=''})},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Ul,[u[95]||(u[95]=(0,e.createElementVNode)('label',null,'é—œä¿‚',-1)),(0,e.createElementVNode)('div',Ll,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(Array.from(a.value.é—œä¿‚||new Map),([t,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'relation-item'},[(0,e.createElementVNode)('span',Fl,'['+(0,e.toDisplayString)(t)+'] '+(0,e.toDisplayString)(r(t)),1),u[92]||(u[92]=(0,e.createTextVNode)(' æ˜¯æ­¤è§’è‰²çš„ ',-1)),(0,e.createElementVNode)('input',{value:n,type:'text',placeholder:'è¼¸å…¥é—œä¿‚æè¿°',class:'relation-input',onInput:e=>((e,t)=>{a.value.é—œä¿‚||(a.value.é—œä¿‚=new Map);const n=new Map(a.value.é—œä¿‚);n.set(e,t),a.value.é—œä¿‚=n,c()})(t,e.target.value)},null,40,jl),(0,e.createElementVNode)('button',{class:'remove-relation-btn',onClick:e=>(e=>{if(!a.value.é—œä¿‚)return;const t=new Map(a.value.é—œä¿‚);t.delete(e),a.value.é—œä¿‚=t,c()})(t)},'Ã—',8,Hl)]))),128)),(0,e.createElementVNode)('div',Pl,[(0,e.withDirectives)((0,e.createElementVNode)('select',{'onUpdate:modelValue':u[41]||(u[41]=e=>a.value.selected_relation_target=e),class:'relation-select'},[u[93]||(u[93]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡ç›®æ¨™è§’è‰²',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(d(),([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t,value:t},(0,e.toDisplayString)(`${t}: ${a.å§“æ°||''}${a.åå­—||''}`),9,ql))),128))],512),[[e.vModelSelect,a.value.selected_relation_target]]),(0,e.createElementVNode)('button',{class:'add-relation-btn',disabled:!a.value.selected_relation_target,onClick:b},' æ·»åŠ é—œä¿‚ ',8,Gl)])]),a.value.generated_relationship?((0,e.openBlock)(),(0,e.createElementBlock)('div',Wl,[u[94]||(u[94]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Xl,(0,e.toDisplayString)(a.value.generated_relationship),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[42]||(u[42]=e=>h('é—œä¿‚',a.value.generated_relationship))},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',Jl,[u[99]||(u[99]=(0,e.createElementVNode)('label',null,'æ‰€æŒç‰©',-1)),(0,e.createElementVNode)('div',Zl,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(Array.from(a.value.æ‰€æŒç‰©||new Map),([t,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'inventory-item'},[(0,e.createElementVNode)('span',Ql,'['+(0,e.toDisplayString)(t)+'] '+(0,e.toDisplayString)(l(t)),1),u[96]||(u[96]=(0,e.createTextVNode)(' : ',-1)),(0,e.createElementVNode)('input',{value:n,type:'number',placeholder:'æ•¸é‡',class:'inventory-input',min:'1',onInput:e=>((e,t)=>{a.value.æ‰€æŒç‰©||(a.value.æ‰€æŒç‰©=new Map);const n=new Map(a.value.æ‰€æŒç‰©);t>0?n.set(e,t):n.delete(e),a.value.æ‰€æŒç‰©=n,c()})(t,parseInt(e.target.value)||1)},null,40,ei),(0,e.createElementVNode)('button',{class:'remove-inventory-btn',onClick:e=>(e=>{if(!a.value.æ‰€æŒç‰©)return;const t=new Map(a.value.æ‰€æŒç‰©);t.delete(e),a.value.æ‰€æŒç‰©=t,c()})(t)},'Ã—',8,ti)]))),128)),(0,e.createElementVNode)('div',ai,[(0,e.withDirectives)((0,e.createElementVNode)('select',{'onUpdate:modelValue':u[43]||(u[43]=e=>a.value.selected_inventory_item=e),class:'inventory-select'},[u[97]||(u[97]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡ç‰©å“',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(o(),([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t,value:t},(0,e.toDisplayString)(`${t}: ${a.name||'æœªçŸ¥ç‰©å“'}`),9,ni))),128))],512),[[e.vModelSelect,a.value.selected_inventory_item]]),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':u[44]||(u[44]=e=>a.value.selected_inventory_quantity=e),type:'number',placeholder:'æ•¸é‡',class:'quantity-input',min:'1',disabled:!a.value.selected_inventory_item},null,8,oi),[[e.vModelText,a.value.selected_inventory_quantity,void 0,{number:!0}]]),(0,e.createElementVNode)('button',{class:'add-inventory-btn',disabled:!a.value.selected_inventory_item||!a.value.selected_inventory_quantity,onClick:f},' æ·»åŠ ç‰©å“ ',8,ri)])]),a.value.generated_inventory?((0,e.openBlock)(),(0,e.createElementBlock)('div',li,[u[98]||(u[98]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',ii,(0,e.toDisplayString)(a.value.generated_inventory),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:u[45]||(u[45]=e=>h('æ‰€æŒç‰©',a.value.generated_inventory))},' ä½¿ç”¨ ')])):(0,e.createCommentVNode)('v-if',!0)])])]),(0,e.createCommentVNode)(' ç”Ÿæˆè¦æ±‚ '),(0,e.createElementVNode)('div',di,[u[102]||(u[102]=(0,e.createElementVNode)('h4',null,'ç”Ÿæˆè¦æ±‚',-1)),(0,e.createElementVNode)('div',si,[(0,e.createElementVNode)('div',ci,[u[101]||(u[101]=(0,e.createElementVNode)('label',{for:'generation-requirement-input'},'å°AIç”Ÿæˆçš„è¦æ±‚',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{id:'generation-requirement-input','onUpdate:modelValue':u[46]||(u[46]=e=>a.value.generation_requirement=e),placeholder:'å°AIç”Ÿæˆçš„è¦æ±‚...',class:'text-area',rows:'3'},null,512),[[e.vModelText,a.value.generation_requirement]])])])]),(0,e.createCommentVNode)(' ç”ŸæˆæŒ‰éˆ• '),(0,e.createElementVNode)('div',ui,[(0,e.createElementVNode)('button',{class:'generate-btn',disabled:!(0,e.unref)(s)||n.value,onClick:m},[n.value?((0,e.openBlock)(),(0,e.createElementBlock)('span',mi)):(0,e.createCommentVNode)('v-if',!0),(0,e.createTextVNode)(' '+(0,e.toDisplayString)(n.value?'ç”Ÿæˆä¸­...':(0,e.unref)(s)?'ç”Ÿæˆæœªå¡«å¯«çš„å­—æ®µ':'è«‹å…ˆå®Œæˆä¸–ç•ŒèƒŒæ™¯è¨­å®š'),1)],8,pi),(0,e.createElementVNode)('button',{class:'apply-all-btn',disabled:!(0,e.unref)(i),onClick:g},'æ‡‰ç”¨å…¨éƒ¨',8,vi)])]))}});i(280);const bi=(0,d.A)(gi,[['__scopeId','data-v-76149319']]),fi={class:'world-background-container'},hi={class:'input-group'},xi={class:'input-group'},yi={class:'input-group'},_i={class:'input-group'},Ei=['disabled'],ki={key:0,class:'loading-spinner'},Vi={class:'info-section'},Ni={class:'input-group'},wi={class:'input-group'},Bi=['disabled'],Ci=(0,e.defineComponent)({__name:'world_info_tab',setup(t){const a=(0,e.ref)(''),n=(0,e.ref)(''),o=(0,e.ref)(''),r=(0,e.ref)(''),l=(0,e.ref)(!1),i=(0,e.ref)(''),d=(0,e.ref)(''),s=(0,e.computed)(()=>a.value.trim()||n.value.trim()||o.value.trim()||r.value.trim()),c=()=>{try{const e={place:a.value,era:n.value,style:o.value,additional_conditions:r.value};localStorage.setItem('world_info_input_fields',JSON.stringify(e))}catch(e){console.error('Failed to save input fields to localStorage:',e)}};(0,e.watch)([a,n,o,r],()=>{c()}),(0,e.watch)(i,e=>{try{insertOrAssignVariables({world_info:e},{type:'chat'})}catch(e){console.error('Failed to save world info:',e)}}),(0,e.onMounted)(()=>{(()=>{try{const e=localStorage.getItem('world_info_input_fields');if(e){const t=JSON.parse(e);a.value=t.place||'',n.value=t.era||'',o.value=t.style||'',r.value=t.additional_conditions||''}}catch(e){console.error('Failed to load input fields from localStorage:',e)}try{const e=localStorage.getItem('world_info_generated');e&&(d.value=e)}catch(e){console.error('Failed to load generated world info from localStorage:',e)}})(),(()=>{try{const e=getVariables({type:'chat'});e?.world_info&&(i.value=e.world_info)}catch(e){console.error('Failed to load world info:',e)}})()}),(0,e.onBeforeUnmount)(()=>{c()});const u=(e,t,a,n)=>{let o='è«‹æ ¹æ“šä»¥ä¸‹è³‡è¨Šç”Ÿæˆä¸€å€‹è©³ç´°çš„ä¸–ç•ŒèƒŒæ™¯è¨­å®šï¼š\n';return o+='\n',o+=`åœ°é»žï¼š${e||'æœªæŒ‡å®š'}\n`,o+=`æ™‚ä»£ï¼š${t||'æœªæŒ‡å®š'}\n`,o+=`é¢¨æ ¼ï¼š${a||'æœªæŒ‡å®š'}\n`,o+=`é¡å¤–æ¢ä»¶ï¼š${n||'ç„¡'}\n`,o+='\n',o+='è«‹ç”Ÿæˆä¸€å€‹å®Œæ•´ä¸”è©³ç´°çš„ä¸–ç•ŒèƒŒæ™¯æè¿°ï¼ŒåŒ…æ‹¬ç’°å¢ƒã€åœ°åœ–ã€ç¤¾æœƒçµæ§‹ã€æ–‡åŒ–ç‰¹è‰²ç­‰å…ƒç´ ã€‚',o},p=async()=>{l.value=!0;try{const e=u(a.value,n.value,o.value,r.value),t='ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„ä¸–ç•Œæ§‹ç¯‰åŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ è±å¯Œå¤šå½©çš„å¥‡å¹»ä¸–ç•Œã€‚è«‹æ ¹æ“šç”¨æˆ¶æä¾›çš„è³‡è¨Šï¼Œåš´æ ¼éµå®ˆä»¥ä¸‹ä¾‹å­çš„æ ¼å¼ï¼Œç”Ÿæˆä¸–ç•ŒèƒŒæ™¯è¨­å®šã€‚';let l='<example>\n';l+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output.\n',l+='<UserInput>\n',l+=`${u('æ«»å¦»å¸‚','ç¾ä»£','é’æ˜¥ï¼Œæ—¥å¸¸ï¼Œæ ¡åœ’ï¼Œæˆ€æ„›å–œåŠ‡','ç„¡')}\n`,l+='</UserInput>\n',l+='\n',l+='<GeneratedOutput>\n  - <char> is a virtual interactive novel engine designed specifically for <user>, vividly role-playing every school character except <user>, creating an immersive Japanese anime-style high school romance experience.\n  - allows vivid portrayals of various scenarios, including innocent, subtly romantic scenes and youth-focused situations with mature elements, free from the limitations of real-world moral scales.\n  - World setting: The story happens in a Japanese coastal fictional city: "æ«»å¦»å¸‚", featuring the city\'s only high school, "æ«»å¦»å¸‚åœ‹ç«‹ä¸­å­¸". The world logic has high flexibility, centered purely upon internal consistency of school setting without real-world rules.\n  - Environment & atmosphere setup: Most events prominently take place within the vivid daytime campus environment of "æ«»å¦»å¸‚åœ‹ç«‹ä¸­å­¸", a beautifully stylized coastal school campus with rich and authentic Japanese anime-style youth atmosphere.\n  - Exceptional immersion in youth atmosphere: Offer subtle, detailed, vividly realized scenarios in a genuine Japanese-school youths\' daily experiences, allowing great freedom for subtle interactions and tastes ranging from pure, simple school life to delicate adolescent romance and relationships.\n',l+='</GeneratedOutput>\n',l+='</example>';let i=await generateRaw({user_input:e,ordered_prompts:[{role:'system',content:t},{role:'system',content:l},'user_input']});const s=SillyTavern.name1,c=SillyTavern.name2;i=i.replace(/<user>/g,s),i=i.replace(/<char>/g,c),d.value=i;try{localStorage.setItem('world_info_generated',i)}catch(e){console.error('Failed to save generated world info to localStorage:',e)}}catch(e){console.error('ç”Ÿæˆä¸–ç•ŒèƒŒæ™¯å¤±æ•—:',e),d.value='ç”Ÿæˆå¤±æ•—ï¼Œè«‹é‡è©¦ã€‚'}finally{l.value=!1}},m=()=>{if(d.value.trim()){i.value=d.value;try{insertOrAssignVariables({world_info:d.value},{type:'chat'})}catch(e){console.error('Failed to save world info:',e)}}};return(t,c)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',fi,[c[12]||(c[12]=(0,e.createElementVNode)('h3',null,'ä¸–ç•ŒèƒŒæ™¯è¨­å®š',-1)),(0,e.createElementVNode)('div',hi,[c[6]||(c[6]=(0,e.createElementVNode)('label',{for:'place-input'},'åœ°é»ž',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'place-input','onUpdate:modelValue':c[0]||(c[0]=e=>a.value=e),type:'text',placeholder:'ä¾‹å¦‚ï¼šæ±äº¬ã€é­”æ³•æ£®æž—ã€å¤ªç©ºç«™...',class:'text-input'},null,512),[[e.vModelText,a.value]])]),(0,e.createElementVNode)('div',xi,[c[7]||(c[7]=(0,e.createElementVNode)('label',{for:'era-input'},'æ™‚ä»£',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'era-input','onUpdate:modelValue':c[1]||(c[1]=e=>n.value=e),type:'text',placeholder:'ä¾‹å¦‚ï¼šä¸­ä¸–ç´€ã€ç¾ä»£ã€æœªä¾†...',class:'text-input'},null,512),[[e.vModelText,n.value]])]),(0,e.createElementVNode)('div',yi,[c[8]||(c[8]=(0,e.createElementVNode)('label',{for:'style-input'},'é¢¨æ ¼',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{id:'style-input','onUpdate:modelValue':c[2]||(c[2]=e=>o.value=e),type:'text',placeholder:'ä¾‹å¦‚ï¼šå¥‡å¹»ã€ç§‘å¹»ã€ç¾å¯¦ä¸»ç¾©...',class:'text-input'},null,512),[[e.vModelText,o.value]])]),(0,e.createElementVNode)('div',_i,[c[9]||(c[9]=(0,e.createElementVNode)('label',{for:'additional-conditions-input'},'å…¶ä»–é¡å¤–æ¢ä»¶',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{id:'additional-conditions-input','onUpdate:modelValue':c[3]||(c[3]=e=>r.value=e),placeholder:'ä¾‹å¦‚ï¼šé­”æ³•ç³»çµ±ã€ç‰¹æ®Šè¦å‰‡ã€é‡è¦äº‹ä»¶...',class:'text-area',rows:'4'},null,512),[[e.vModelText,r.value]])]),(0,e.createElementVNode)('button',{class:'generate-btn',disabled:l.value||!s.value,onClick:p},[l.value?((0,e.openBlock)(),(0,e.createElementBlock)('span',ki)):(0,e.createCommentVNode)('v-if',!0),(0,e.createTextVNode)(' '+(0,e.toDisplayString)(l.value?'ç”Ÿæˆä¸­...':'ç”Ÿæˆ'),1)],8,Ei),(0,e.createElementVNode)('div',Vi,[(0,e.createElementVNode)('div',Ni,[c[10]||(c[10]=(0,e.createElementVNode)('label',{for:'current-world-info'},'ç•¶å‰ä¸–ç•Œè³‡è¨Š',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{id:'current-world-info','onUpdate:modelValue':c[4]||(c[4]=e=>i.value=e),placeholder:'ç•¶å‰ä¸–ç•Œè³‡è¨Šå°‡é¡¯ç¤ºåœ¨é€™è£¡...',class:'text-area',rows:'6'},null,512),[[e.vModelText,i.value]])]),(0,e.createElementVNode)('div',wi,[c[11]||(c[11]=(0,e.createElementVNode)('label',{for:'generated-world-info'},'ç”Ÿæˆçš„ä¸–ç•Œè³‡è¨Š',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{id:'generated-world-info','onUpdate:modelValue':c[5]||(c[5]=e=>d.value=e),placeholder:'é»žæ“Šç”ŸæˆæŒ‰éˆ•å¾Œï¼Œç”Ÿæˆçš„ä¸–ç•Œè³‡è¨Šå°‡é¡¯ç¤ºåœ¨é€™è£¡...',class:'text-area',rows:'6',readonly:''},null,512),[[e.vModelText,d.value]])]),(0,e.createElementVNode)('button',{class:'replace-btn',disabled:!d.value.trim(),onClick:m},' æ›¿æ›ç‚ºç”Ÿæˆçš„ä¸–ç•Œè³‡è¨Š ',8,Bi)])]))}});i(6224);const $i=(0,d.A)(Ci,[['__scopeId','data-v-6467ee74']]),Si={class:'initializations-container'},Ii={class:'tab-navigation top first-row'},zi={class:'tab-navigation top second-row'},Di={class:'main-content'},Ti={key:0,class:'initialization-area'},Mi={key:1,class:'initialization-area'},Yi={key:2,class:'initialization-area'},Oi={key:3,class:'initialization-area'},Ai={key:4,class:'initialization-area'},Ri={key:5,class:'initialization-area'},Ki={key:6,class:'initialization-area'},Ui=(0,e.defineComponent)({__name:'initialization_interface',setup(t){const a=(0,e.ref)('world_info'),n=e=>{a.value=e};return(t,o)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',Si,[(0,e.createCommentVNode)(' ç¬¬ä¸€è¡Œæ¨™ç±¤ '),(0,e.createElementVNode)('div',Ii,[(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'world_info'===a.value}]),onClick:o[0]||(o[0]=e=>n('world_info'))},' ä¸–ç•ŒèƒŒæ™¯ ',2),(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'user'===a.value}]),onClick:o[1]||(o[1]=e=>n('user'))},'ç”¨æˆ¶',2),(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'character'===a.value}]),onClick:o[2]||(o[2]=e=>n('character'))},' è§’è‰² ',2),(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'item'===a.value}]),onClick:o[3]||(o[3]=e=>n('item'))},'ç‰©å“',2)]),(0,e.createCommentVNode)(' ç¬¬äºŒè¡Œæ¨™ç±¤ '),(0,e.createElementVNode)('div',zi,[(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'location'===a.value}]),onClick:o[4]||(o[4]=e=>n('location'))},'åœ°é»ž',2),(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'extra'===a.value}]),onClick:o[5]||(o[5]=e=>n('extra'))},'å…¶ä»–',2),(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'start'===a.value}]),onClick:o[6]||(o[6]=e=>n('start'))},'é–‹å§‹',2)]),(0,e.createElementVNode)('div',Di,['start'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ti,[(0,e.createVNode)(Er)])):'world_info'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Mi,[(0,e.createVNode)($i)])):'user'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Yi,[(0,e.createVNode)(bi)])):'character'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Oi,[(0,e.createVNode)(za)])):'item'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ai,[(0,e.createVNode)(zn)])):'location'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ri,[(0,e.createVNode)(Co)])):'extra'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ki,[(0,e.createVNode)(tn)])):(0,e.createCommentVNode)('v-if',!0)])]))}});i(1034);const Li=(0,d.A)(Ui,[['__scopeId','data-v-252c6a8b']]),Fi={class:'confirm-dialog-header'},ji={class:'confirm-dialog-body'},Hi={class:'confirm-dialog-footer'},Pi=['data-confirm-text'],qi=(0,e.defineComponent)({__name:'confirmation_window',props:{confirmDialog:{}},emits:['update:confirm_dialog','confirm-dialog-confirm','confirm-dialog-cancel'],setup(t,{expose:a,emit:n}){const o=n,r=()=>{o('confirm-dialog-confirm')},l=()=>{o('confirm-dialog-cancel')},i=()=>{l()};return a({}),(a,n)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',null,[(0,e.createCommentVNode)(' ConfirmDialog çµ„ä»¶ '),t.confirmDialog.visible?((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:0,class:'confirm-dialog-overlay',onClick:i},[(0,e.createElementVNode)('div',{class:'confirm-dialog',onClick:n[0]||(n[0]=(0,e.withModifiers)(()=>{},['stop']))},[(0,e.createElementVNode)('div',Fi,[(0,e.createElementVNode)('h3',null,(0,e.toDisplayString)(t.confirmDialog.title),1)]),(0,e.createElementVNode)('div',ji,[(0,e.createElementVNode)('p',null,(0,e.toDisplayString)(t.confirmDialog.message),1)]),(0,e.createElementVNode)('div',Hi,[(0,e.createElementVNode)('button',{class:'confirm-btn cancel-btn',onClick:l},(0,e.toDisplayString)(t.confirmDialog.cancelText),1),(0,e.createElementVNode)('button',{class:'confirm-btn confirm-action-btn','data-confirm-text':t.confirmDialog.confirmText,onClick:r},(0,e.toDisplayString)(t.confirmDialog.confirmText),9,Pi)])])])):(0,e.createCommentVNode)('v-if',!0)]))}});i(3645);const Gi=qi,Wi={class:'progress-bar-container'},Xi={class:'progress-bar-label'},Ji={class:'progress-bar-wrapper'},Zi={class:'progress-bar-value'},Qi=(0,e.defineComponent)({__name:'progress_bar',props:{label:{},value:{},min:{default:0},max:{default:100},unit:{default:''},color:{default:'#007acc'},attributeType:{default:''}},setup(t){const a=t,n=(0,e.computed)(()=>{const{attributeType:e,value:t}=a;switch(e){case'mood':return t>=0?{color:'#ffdd44',min:0,max:100,isReverse:!1}:{color:'#007acc',min:0,max:100,isReverse:!1};case'horny':return{color:'#ff44aa',min:0,max:100,isReverse:!1};case'friendship':return t>=0?{color:'#44ff44',min:0,max:1e3,isReverse:!1}:{color:'#888888',min:0,max:1e3,isReverse:!1};case'love':return{color:'#ff4444',min:0,max:1e3,isReverse:!1};default:return{color:a.color,min:a.min,max:a.max,isReverse:!1}}}),o=(0,e.computed)(()=>{const e=n.value,t=Math.abs(a.value),o=Math.max(e.min,Math.min(e.max,t)),r=e.max-e.min;return(o-e.min)/r*100}),r=(0,e.computed)(()=>{const e=n.value;return`linear-gradient(90deg, ${e.color} 0%, ${e.color}dd 100%)`});return(a,n)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',Wi,[(0,e.createElementVNode)('div',Xi,(0,e.toDisplayString)(t.label),1),(0,e.createElementVNode)('div',Ji,[(0,e.createElementVNode)('div',{class:'progress-bar-fill',style:(0,e.normalizeStyle)({width:`${(0,e.unref)(o)}%`,background:(0,e.unref)(r)})},null,4),(0,e.createElementVNode)('div',Zi,(0,e.toDisplayString)(t.value)+(0,e.toDisplayString)(t.unit),1)])]))}});i(4248);const ed=(0,d.A)(Qi,[['__scopeId','data-v-be0274c0']]),td={class:'character-tab-container'},ad={key:0,class:'character-content'},nd={class:'character-section'},od={class:'character-list'},rd=['onClick'],ld=['onClick'],id={key:1,class:'character-progress-bars'},dd={key:0,class:'no-characters-message'},sd={class:'character-section'},cd={class:'character-list'},ud=['onClick'],pd=['onClick'],md={key:1,class:'character-progress-bars'},vd={key:0,class:'no-characters-message'},gd={class:'character-detail-content'},bd={class:'character-header'},fd={class:'header-buttons'},hd={class:'character-detail-name'},xd={class:'attributes-grid'},yd={class:'attribute-item horizontal'},_d={key:0,class:'attribute-value'},Ed={class:'attribute-item horizontal'},kd={key:0,class:'attribute-value'},Vd={class:'attribute-item horizontal'},Nd={key:0,class:'attribute-value'},wd={class:'attribute-item horizontal'},Bd={key:0,class:'attribute-value'},Cd={class:'attribute-item horizontal'},$d={key:0,class:'attribute-value'},Sd={class:'attribute-item horizontal'},Id={key:0,class:'attribute-value'},zd={class:'attribute-item horizontal'},Dd={key:0,class:'attribute-value'},Td={class:'attribute-item horizontal'},Md={key:0,class:'attribute-value'},Yd={class:'attribute-item horizontal'},Od={key:0,class:'attribute-value'},Ad={class:'attribute-item horizontal'},Rd={key:0,class:'attribute-value'},Kd={class:'attribute-item full-width horizontal'},Ud={key:0,class:'attribute-value money'},Ld={class:'attribute-item full-width birthday-fullwidth'},Fd={key:0,class:'attribute-value'},jd={key:1,class:'birthday-edit-container'},Hd={class:'birthday-input-group'},Pd={key:0,class:'attribute-item full-width'},qd={key:1,class:'progress-edit-container'},Gd={key:1,class:'attribute-item full-width'},Wd={key:1,class:'progress-edit-container'},Xd={class:'attribute-item full-width'},Jd={key:0,class:'attribute-value no-bold'},Zd={class:'attribute-item full-width'},Qd={key:0,class:'attribute-value no-bold'},es={class:'attribute-item full-width'},ts={key:0,class:'attribute-value no-bold'},as={class:'attribute-item full-width'},ns={key:0,class:'attribute-value no-bold'},os={class:'attribute-item full-width'},rs={key:0,class:'attribute-value no-bold'},ls={class:'attribute-item full-width'},is={key:0,class:'attribute-value no-bold'},ds={class:'attribute-item full-width'},ss={key:0,class:'attribute-value no-bold'},cs={key:2,class:'attribute-item full-width'},us={key:0,class:'attribute-value no-bold'},ps={class:'relations-section'},ms={key:0,class:'relations-list'},vs={class:'relation-highlight'},gs={class:'relation-highlight'},bs={key:0,class:'no-message'},fs={key:1,class:'relations-edit-list'},hs=['value','onChange'],xs=['value'],ys=['onUpdate:modelValue'],_s=['onClick'],Es={key:0,class:'friendships-section'},ks={key:0,class:'friendships-list'},Vs={key:0,class:'no-message'},Ns={key:1,class:'friendships-edit-list'},ws=['value','onChange'],Bs=['value'],Cs=['onUpdate:modelValue','onInput','onBlur'],$s=['onClick'],Ss={key:1,class:'loves-section'},Is={key:0,class:'loves-list'},zs={key:0,class:'no-message'},Ds={key:1,class:'loves-edit-list'},Ts=['value','onChange'],Ms=['value'],Ys=['onUpdate:modelValue','onInput','onBlur'],Os=['onClick'],As={class:'inventory-section'},Rs={key:0,class:'inventory-list'},Ks={class:'inventory-first-row'},Us={class:'item-name-id'},Ls={key:0,class:'item-quantity'},Fs={key:1,class:'storage-indicator'},js={class:'inventory-second-row'},Hs={key:0,class:'inventory-third-row'},Ps={key:0,class:'no-inventory'},qs={key:1,class:'inventory-items'},Gs={key:0,class:'no-message'},Ws={key:1,class:'inventory-edit-list'},Xs=['value','onChange'],Js={label:'ç‰©å“'},Zs=['value'],Qs={label:'è²¯å­˜é»ž'},ec=['value'],tc={key:0,class:'inventory-edit-connector'},ac=['onUpdate:modelValue'],nc=['onClick'],oc={key:2,class:'edit-buttons'},rc=['disabled'],lc=(0,e.defineComponent)({__name:'character_tab',setup(t,{expose:a}){(0,e.useCssVars)(e=>({v1299b277:c.value}));const n=(0,e.ref)(!1),o=(0,e.ref)(!1),r=(0,e.ref)(null),l=(0,e.ref)(''),i=(0,e.ref)({visible:!1,title:'',message:'',confirmText:'',cancelText:''}),d=(0,e.ref)(0),s=(0,e.ref)(null),c=(0,e.computed)(()=>`calc(100vh - ${d.value}px)`);a({handleTabClick:()=>{b.value?(n.value&&G(),b.value=null):o.value&&G()}});const u=(0,e.computed)(()=>{if(!o.value||!r.value)return!1;return['åç¨±','æ€§åˆ¥','å¹´é½¡','èº«é«˜','é«”é‡','èƒ¸åœ','ç½©æ¯','è…°åœ','è‡€åœ','èº«ä»½','é«®åž‹','æ¨£è²Œ','è¡£è‘—','æ„›å¥½','ç°¡ä»‹','æ€§æ ¼','å…¶ä»–é‡è¦è³‡è¨Š'].some(e=>{const t=r.value[e];return null==t||''===t||'string'==typeof t&&''===t.trim()})}),p=(0,e.computed)({get:()=>r.value?.[So.RELATIONS_KEY]||{},set:e=>{r.value&&(r.value[So.RELATIONS_KEY]=e)}}),m=(0,e.computed)({get:()=>r.value?.[So.INVENTORY_KEY]||{},set:e=>{r.value&&(r.value[So.INVENTORY_KEY]=e)}}),v=(0,e.computed)({get:()=>r.value?.[So.FRIENDSHIPS_KEY]||{},set:e=>{r.value&&(r.value[So.FRIENDSHIPS_KEY]=e)}}),g=(0,e.computed)({get:()=>r.value?.[So.LOVES_KEY]||{},set:e=>{r.value&&(r.value[So.LOVES_KEY]=e)}}),b=(0,e.ref)(null),f=(0,e.ref)(null),h=()=>{try{const e=getLastMessageId();f.value=Yo.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),f.value=null}};h(),(0,e.onMounted)(()=>{(0,e.nextTick)(()=>{W()})}),(0,e.onUnmounted)(()=>{X()});const x=(0,e.computed)(()=>f.value?.active_characters||new Map),y=(0,e.computed)(()=>f.value?.deactive_characters||new Map),E=(0,e.computed)(()=>b.value&&f.value?f.value.getCharacter(b.value):null),k=(0,e.computed)(()=>{if(!f.value)return[];const e=[];for(const[t,a]of f.value.active_characters)t!==b.value&&e.push({id:t,name:a.name});for(const[t,a]of f.value.deactive_characters)t!==b.value&&e.push({id:t,name:a.name});return e}),V=(0,e.computed)(()=>{if(!f.value)return[];const e=[];for(const[t,a]of f.value.items)e.push({id:t,name:a.name,type:'item'});for(const[t,a]of f.value.storages)e.push({id:t,name:a.name,type:'storage'});return e}),N=e=>{if(!f.value)return'æœªçŸ¥';const t=f.value.items.get(e);if(t)return t.name;const a=f.value.storages.get(e);return a?a.name:'æœªçŸ¥'},w=e=>f.value?.storages.has(e)||!1,B=e=>{const t=f.value?.storages.get(e);return t?.inventory.size||0},C=e=>{const t=f.value?.storages.get(e);return t?.inventory||new Map},S=e=>{if(!f.value)return'ç„¡æè¿°';const t=f.value.items.get(e);if(t)return t.description;const a=f.value.storages.get(e);return a?a.description:'ç„¡æè¿°'},I=e=>{b.value=e},D=e=>{if(!f.value||'c1'===e)return;const t=f.value.getCharacter(e);if(!t)return;f.value.active_characters.has(e)?(f.value.active_characters.delete(e),f.value.deactive_characters.set(e,t)):(f.value.deactive_characters.delete(e),f.value.active_characters.set(e,t)),f.value.saveAsVariable(getLastMessageId()),h()},T=()=>{n.value&&G(),b.value=null},M=()=>{E.value&&'c1'!==b.value&&(i.value={visible:!0,title:'ç¢ºèªåˆªé™¤è§’è‰²',message:`ç¢ºå®šè¦åˆªé™¤è§’è‰² "${E.value.name}" å—Žï¼Ÿæ­¤æ“ä½œç„¡æ³•æ’¤éŠ·ã€‚`,confirmText:'åˆªé™¤',cancelText:'å–æ¶ˆ'})},Y=()=>{f.value&&b.value&&'c1'!==b.value&&(f.value.active_characters.delete(b.value),f.value.deactive_characters.delete(b.value),f.value.saveAsVariable(getLastMessageId()),b.value=null,h()),i.value.visible=!1},O=()=>{i.value.visible=!1},A=()=>{r.value?.é—œä¿‚&&(r.value.é—œä¿‚['']='')},R=()=>{r.value?.æ‰€æŒç‰©&&(r.value.æ‰€æŒç‰©['']=1)},K=()=>{r.value?.å‹å¥½åº¦&&(r.value.å‹å¥½åº¦['']=0)},U=()=>{r.value?.æ„›æƒ…åº¦&&(r.value.æ„›æƒ…åº¦['']=0)},L=()=>{r.value&&void 0!==r.value.å¿ƒæƒ…&&(r.value.å¿ƒæƒ…<-100?r.value.å¿ƒæƒ…=-100:r.value.å¿ƒæƒ…>100&&(r.value.å¿ƒæƒ…=100))},F=()=>{r.value&&void 0!==r.value.æ€§æ…¾&&(r.value.æ€§æ…¾<0?r.value.æ€§æ…¾=0:r.value.æ€§æ…¾>100&&(r.value.æ€§æ…¾=100))},j=e=>{v.value&&void 0!==v.value[e]&&(v.value[e]<-1e3?v.value[e]=-1e3:v.value[e]>1e3&&(v.value[e]=1e3))},H=e=>{g.value&&void 0!==g.value[e]&&(g.value[e]<0?g.value[e]=0:g.value[e]>1e3&&(g.value[e]=1e3))},P=()=>{if(E.value){const e=E.value.toRecord();r.value={[So.NAME_KEY]:e[So.NAME_KEY],[So.GENDER_KEY]:e[So.GENDER_KEY],[So.AGE_KEY]:e[So.AGE_KEY].toString(),[So.HEIGHT_KEY]:e[So.HEIGHT_KEY].toString(),[So.WEIGHT_KEY]:e[So.WEIGHT_KEY].toString(),[So.CHEST_SIZE_KEY]:e[So.CHEST_SIZE_KEY].toString(),[So.CUP_SIZE_KEY]:e[So.CUP_SIZE_KEY]||'',[So.WAIST_SIZE_KEY]:e[So.WAIST_SIZE_KEY].toString(),[So.HIPS_SIZE_KEY]:e[So.HIPS_SIZE_KEY].toString(),[So.IDENTITY_KEY]:e[So.IDENTITY_KEY],[So.HAIRSTYLE_KEY]:e[So.HAIRSTYLE_KEY],[So.APPEARANCE_KEY]:e[So.APPEARANCE_KEY],[So.CLOTHES_KEY]:e[So.CLOTHES_KEY],[So.FAVOURITE_KEY]:e[So.FAVOURITE_KEY],[So.INTRODUCTION_KEY]:e[So.INTRODUCTION_KEY],[So.PERSONALITY_KEY]:e[So.PERSONALITY_KEY],[So.EXTRA_INFORMATION_KEY]:e[So.EXTRA_INFORMATION_KEY],[So.MONEY_KEY]:e[So.MONEY_KEY],[So.MOOD_KEY]:e[So.MOOD_KEY],[So.HORNY_KEY]:e[So.HORNY_KEY],[So.RELATIONS_KEY]:e[So.RELATIONS_KEY],[So.FRIENDSHIPS_KEY]:e[So.FRIENDSHIPS_KEY],[So.LOVES_KEY]:e[So.LOVES_KEY],[So.INVENTORY_KEY]:e[So.INVENTORY_KEY],[So.BIRTHDAY_KEY]:e[So.BIRTHDAY_KEY]},l.value=b.value||'',n.value=!0,o.value=!1}},q=()=>{const e=(()=>{if(!f.value)return'c2';const e=new Set;for(const t of f.value.active_characters.keys())e.add(t);for(const t of f.value.deactive_characters.keys())e.add(t);let t=2;for(;e.has(`c${t}`);)t++;return`c${t}`})();l.value=e,r.value={[So.NAME_KEY]:'',[So.AGE_KEY]:null,[So.GENDER_KEY]:'',[So.IDENTITY_KEY]:'',[So.INTRODUCTION_KEY]:'',[So.PERSONALITY_KEY]:'',[So.HEIGHT_KEY]:0,[So.WEIGHT_KEY]:0,[So.CHEST_SIZE_KEY]:0,[So.CUP_SIZE_KEY]:'',[So.WAIST_SIZE_KEY]:0,[So.HIPS_SIZE_KEY]:0,[So.HAIRSTYLE_KEY]:'',[So.APPEARANCE_KEY]:'',[So.CLOTHES_KEY]:'',[So.BIRTHDAY_KEY]:{month:1,date:1},[So.FAVOURITE_KEY]:'',[So.EXTRA_INFORMATION_KEY]:'',[So.MONEY_KEY]:0,[So.MOOD_KEY]:0,[So.HORNY_KEY]:0,[So.RELATIONS_KEY]:{},[So.INVENTORY_KEY]:{},[So.FRIENDSHIPS_KEY]:{},[So.LOVES_KEY]:{}},n.value=!0,o.value=!0,b.value=null},G=()=>{n.value=!1,o.value=!1,r.value=null,l.value=''},W=()=>{if('undefined'==typeof ResizeObserver)return void(d.value=74);s.value=new ResizeObserver(e=>{for(const t of e){const e=t.target;e.classList.contains('tab-navigation')&&(d.value=e.offsetHeight)}});const e=document.querySelector('.tab-navigation.top');e&&(s.value.observe(e),d.value=e.offsetHeight)},X=()=>{s.value&&(s.value.disconnect(),s.value=null)},J=()=>{if(f.value&&r.value){const e=l.value.trim();if(o.value){const t=f.value.active_characters.has(e),a=f.value.deactive_characters.has(e);if(t||a)return void toastr.error(`è§’è‰²ID "${e}" å·²ç¶“å­˜åœ¨ï¼Œè«‹é¸æ“‡å…¶ä»–ID`)}else if(b.value&&e!==b.value){const t=f.value.active_characters.has(e),a=f.value.deactive_characters.has(e);if(t||a)return void toastr.error(`è§’è‰²ID "${e}" å·²ç¶“å­˜åœ¨ï¼Œè«‹é¸æ“‡å…¶ä»–ID`)}if(r.value.ç”Ÿæ—¥&&r.value.ç”Ÿæ—¥.month&&r.value.ç”Ÿæ—¥.date){const e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate(),o=r.value.ç”Ÿæ—¥.month,l=r.value.ç”Ÿæ—¥.date;let i=t-(r.value.å¹´é½¡||0);(o>a||o===a&&l>n)&&(i-=1),r.value.ç”Ÿæ—¥=new Date(i,r.value.ç”Ÿæ—¥.month-1,r.value.ç”Ÿæ—¥.date).toString()}if(r.value.é—œä¿‚){const e={};for(const[t,a]of Object.entries(r.value.é—œä¿‚))t&&a&&'string'==typeof a&&''!==a.trim()&&(e[t]=a);r.value.é—œä¿‚=e}if(r.value.æ‰€æŒç‰©){const e={};for(const[t,a]of Object.entries(r.value.æ‰€æŒç‰©))if(t&&a&&'number'==typeof a&&a>0){const n=w(t)?1:a;e[t]=n}r.value.æ‰€æŒç‰©=e}if(r.value.å‹å¥½åº¦){const e={};for(const[t,a]of Object.entries(r.value.å‹å¥½åº¦))t&&void 0!==a&&'number'==typeof a&&a>=-1e3&&a<=1e3&&(e[t]=a);r.value.å‹å¥½åº¦=e}if(r.value.æ„›æƒ…åº¦){const e={};for(const[t,a]of Object.entries(r.value.æ„›æƒ…åº¦))t&&void 0!==a&&'number'==typeof a&&a>0&&a<=1e3&&(e[t]=a);r.value.æ„›æƒ…åº¦=e}const t=e,a={[So.NAME_KEY]:r.value.åç¨±,[So.GENDER_KEY]:r.value.æ€§åˆ¥,[So.AGE_KEY]:parseInt(r.value.å¹´é½¡),[So.HEIGHT_KEY]:parseInt(r.value.èº«é«˜),[So.WEIGHT_KEY]:parseInt(r.value.é«”é‡),[So.CHEST_SIZE_KEY]:parseInt(r.value.èƒ¸åœ),[So.CUP_SIZE_KEY]:r.value.ç½©æ¯||void 0,[So.WAIST_SIZE_KEY]:parseInt(r.value.è…°åœ),[So.HIPS_SIZE_KEY]:parseInt(r.value.è‡€åœ),[So.IDENTITY_KEY]:r.value.èº«ä»½,[So.HAIRSTYLE_KEY]:r.value.é«®åž‹,[So.APPEARANCE_KEY]:r.value.æ¨£è²Œ,[So.CLOTHES_KEY]:r.value.è¡£è‘—,[So.FAVOURITE_KEY]:r.value.æ„›å¥½,[So.INTRODUCTION_KEY]:r.value.ç°¡ä»‹,[So.PERSONALITY_KEY]:r.value.æ€§æ ¼,[So.EXTRA_INFORMATION_KEY]:r.value.å…¶ä»–é‡è¦è³‡è¨Š,[So.BIRTHDAY_KEY]:r.value.ç”Ÿæ—¥,[So.MONEY_KEY]:r.value.é‡‘éŒ¢??0,[So.MOOD_KEY]:r.value.å¿ƒæƒ…??50,[So.HORNY_KEY]:r.value.æ€§æ…¾??0,[So.RELATIONS_KEY]:r.value.é—œä¿‚??{},[So.FRIENDSHIPS_KEY]:r.value.å‹å¥½åº¦??{},[So.LOVES_KEY]:r.value.æ„›æƒ…åº¦??{},[So.INVENTORY_KEY]:r.value.æ‰€æŒç‰©??{}};if(o.value)f.value.active_characters.set(t,So.fromRecord(a)),f.value.saveAsVariable(getLastMessageId()),h(),b.value=t;else if(b.value){const e=f.value.active_characters.has(b.value);t!==b.value?(e?(f.value.active_characters.delete(b.value),f.value.active_characters.set(t,So.fromRecord(a))):(f.value.deactive_characters.delete(b.value),f.value.deactive_characters.set(t,So.fromRecord(a))),b.value=t):e?f.value.active_characters.set(b.value,So.fromRecord(a)):f.value.deactive_characters.set(b.value,So.fromRecord(a)),f.value.saveAsVariable(getLastMessageId()),h()}}n.value=!1,o.value=!1,r.value=null,l.value=''};return(t,a)=>{return(0,e.openBlock)(),(0,e.createElementBlock)('div',td,[(0,e.createCommentVNode)(' è§’è‰²åˆ—è¡¨è¦–åœ– '),b.value||o.value?((0,e.openBlock)(),(0,e.createElementBlock)(e.Fragment,{key:1},[(0,e.createCommentVNode)(' è§’è‰²è©³ç´°ä¿¡æ¯è¦–åœ– '),(0,e.createElementVNode)('div',gd,[(0,e.createCommentVNode)(' è§’è‰²åç¨±æ¨™é¡Œ '),(0,e.createElementVNode)('div',bd,[(0,e.createElementVNode)('div',fd,[n.value||o.value?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:0,class:'edit-button',onClick:P},'ç·¨è¼¯')),n.value||o.value||'c1'===b.value?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:1,class:'delete-button',onClick:M},' åˆªé™¤ '))]),(0,e.createElementVNode)('h1',hd,(0,e.toDisplayString)(o.value?'æ–°å¢žè§’è‰²':E.value?.name||'N/A'),1),(0,e.createElementVNode)('button',{class:'back-button',onClick:T},'â†')]),(0,e.createCommentVNode)(' æ‰€æœ‰å±¬æ€§çµ±ä¸€é¡¯ç¤º '),(0,e.createElementVNode)('div',xd,[(0,e.createCommentVNode)(' åŸºæœ¬ä¿¡æ¯ '),(0,e.createElementVNode)('div',yd,[a[25]||(a[25]=(0,e.createElementVNode)('span',{class:'attribute-label'},'ID',-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[0]||(a[0]=e=>l.value=e),class:'attribute-input'},null,512)),[[e.vModelText,l.value]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',_d,(0,e.toDisplayString)(b.value),1))]),(0,e.createElementVNode)('div',Ed,[a[26]||(a[26]=(0,e.createElementVNode)('span',{class:'attribute-label'},[(0,e.createTextVNode)('åç¨±'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[1]||(a[1]=e=>r.value.åç¨±=e),class:'attribute-input'},null,512)),[[e.vModelText,r.value.åç¨±]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',kd,(0,e.toDisplayString)(E.value?.name||'N/A'),1))]),(0,e.createElementVNode)('div',Vd,[a[27]||(a[27]=(0,e.createElementVNode)('span',{class:'attribute-label'},[(0,e.createTextVNode)('æ€§åˆ¥'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[2]||(a[2]=e=>r.value.æ€§åˆ¥=e),class:'attribute-input'},null,512)),[[e.vModelText,r.value.æ€§åˆ¥]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Nd,(0,e.toDisplayString)(E.value?.gender||'N/A'),1))]),(0,e.createElementVNode)('div',wd,[a[28]||(a[28]=(0,e.createElementVNode)('span',{class:'attribute-label'},[(0,e.createTextVNode)('å¹´é½¡'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[3]||(a[3]=e=>r.value.å¹´é½¡=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,r.value.å¹´é½¡,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Bd,(0,e.toDisplayString)(E.value?.age||'N/A'),1))]),(0,e.createCommentVNode)(' èº«é«”æ¸¬é‡ '),(0,e.createElementVNode)('div',Cd,[a[29]||(a[29]=(0,e.createElementVNode)('span',{class:'attribute-label unit-label'},[(0,e.createTextVNode)('èº«é«˜ (cm)'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[4]||(a[4]=e=>r.value.èº«é«˜=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,r.value.èº«é«˜,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',$d,(0,e.toDisplayString)(E.value?.height||'N/A'),1))]),(0,e.createElementVNode)('div',Sd,[a[30]||(a[30]=(0,e.createElementVNode)('span',{class:'attribute-label unit-label'},[(0,e.createTextVNode)('é«”é‡ (kg)'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[5]||(a[5]=e=>r.value.é«”é‡=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,r.value.é«”é‡,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Id,(0,e.toDisplayString)(E.value?.weight||'N/A'),1))]),(0,e.createElementVNode)('div',zd,[a[31]||(a[31]=(0,e.createElementVNode)('span',{class:'attribute-label unit-label'},[(0,e.createTextVNode)('èƒ¸åœ (cm)'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[6]||(a[6]=e=>r.value.èƒ¸åœ=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,r.value.èƒ¸åœ,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Dd,(0,e.toDisplayString)(E.value?.chest_size||'N/A'),1))]),(0,e.createElementVNode)('div',Td,[a[32]||(a[32]=(0,e.createElementVNode)('span',{class:'attribute-label'},[(0,e.createTextVNode)('ç½©æ¯'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[7]||(a[7]=e=>r.value.ç½©æ¯=e),class:'attribute-input'},null,512)),[[e.vModelText,r.value.ç½©æ¯]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Md,(0,e.toDisplayString)(E.value?.cup_size||'ä¸é©ç”¨'),1))]),(0,e.createElementVNode)('div',Yd,[a[33]||(a[33]=(0,e.createElementVNode)('span',{class:'attribute-label unit-label'},[(0,e.createTextVNode)('è…°åœ (cm)'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[8]||(a[8]=e=>r.value.è…°åœ=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,r.value.è…°åœ,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Od,(0,e.toDisplayString)(E.value?.waist_size||'N/A'),1))]),(0,e.createElementVNode)('div',Ad,[a[34]||(a[34]=(0,e.createElementVNode)('span',{class:'attribute-label unit-label'},[(0,e.createTextVNode)('è‡€åœ (cm)'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[9]||(a[9]=e=>r.value.è‡€åœ=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,r.value.è‡€åœ,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Rd,(0,e.toDisplayString)(E.value?.hips_size||'N/A'),1))]),(0,e.createCommentVNode)(' é‡‘éŒ¢ '),(0,e.createElementVNode)('div',Kd,[a[35]||(a[35]=(0,e.createElementVNode)('span',{class:'attribute-label'},'é‡‘éŒ¢',-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[10]||(a[10]=e=>r.value.é‡‘éŒ¢=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,r.value.é‡‘éŒ¢,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Ud,(0,e.toDisplayString)((s=E.value?.money,void 0===s?'N/A':`$${s.toLocaleString()}`)),1))]),(0,e.createCommentVNode)(' ç”Ÿæ—¥ '),(0,e.createElementVNode)('div',Ld,[a[38]||(a[38]=(0,e.createElementVNode)('span',{class:'attribute-label'},'ç”Ÿæ—¥',-1)),n.value||o.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',jd,[(0,e.createElementVNode)('div',Hd,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[11]||(a[11]=e=>r.value.ç”Ÿæ—¥.month=e),class:'attribute-input birthday-month',type:'number',placeholder:'æœˆ',min:'1',max:'12'},null,512),[[e.vModelText,r.value.ç”Ÿæ—¥.month,void 0,{number:!0}]]),a[36]||(a[36]=(0,e.createElementVNode)('span',{class:'birthday-separator'},'æœˆ',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[12]||(a[12]=e=>r.value.ç”Ÿæ—¥.date=e),class:'attribute-input birthday-date',type:'number',placeholder:'æ—¥',min:'1',max:'31'},null,512),[[e.vModelText,r.value.ç”Ÿæ—¥.date,void 0,{number:!0}]]),a[37]||(a[37]=(0,e.createElementVNode)('span',{class:'birthday-separator'},'æ—¥',-1))])])):((0,e.openBlock)(),(0,e.createElementBlock)('span',Fd,(0,e.toDisplayString)((d=E.value?.birthday,d?`${d.month}æœˆ${d.date}æ—¥`:'N/A')),1))]),(0,e.createCommentVNode)(' å¿ƒæƒ…å’Œæ€§æ…¾ (åƒ…éžç”¨æˆ¶è§’è‰²é¡¯ç¤º) '),'c1'!==b.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Pd,[n.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',qd,[a[39]||(a[39]=(0,e.createElementVNode)('span',{class:'attribute-label'},'å¿ƒæƒ…',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[13]||(a[13]=e=>r.value.å¿ƒæƒ…=e),class:'attribute-input',type:'number',min:'-100',max:'100',onInput:L,onBlur:L},null,544),[[e.vModelText,r.value.å¿ƒæƒ…,void 0,{number:!0}]])])):((0,e.openBlock)(),(0,e.createBlock)(ed,{key:0,label:'å¿ƒæƒ…',value:E.value?.mood||0,attributeType:'mood'},null,8,['value']))])):(0,e.createCommentVNode)('v-if',!0),'c1'!==b.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Gd,[n.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Wd,[a[40]||(a[40]=(0,e.createElementVNode)('span',{class:'attribute-label'},'æ€§æ…¾',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[14]||(a[14]=e=>r.value.æ€§æ…¾=e),class:'attribute-input',type:'number',min:'0',max:'100',onInput:F,onBlur:F},null,544),[[e.vModelText,r.value.æ€§æ…¾,void 0,{number:!0}]])])):((0,e.openBlock)(),(0,e.createBlock)(ed,{key:0,label:'æ€§æ…¾',value:E.value?.horny||0,attributeType:'horny'},null,8,['value']))])):(0,e.createCommentVNode)('v-if',!0),(0,e.createCommentVNode)(' å¤–è²Œç‰¹å¾µ '),(0,e.createElementVNode)('div',Xd,[a[41]||(a[41]=(0,e.createElementVNode)('span',{class:'attribute-label'},[(0,e.createTextVNode)('èº«ä»½'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[15]||(a[15]=e=>r.value.èº«ä»½=e),class:'attribute-textarea'},null,512)),[[e.vModelText,r.value.èº«ä»½]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Jd,(0,e.toDisplayString)(E.value?.identity||'N/A'),1))]),(0,e.createElementVNode)('div',Zd,[a[42]||(a[42]=(0,e.createElementVNode)('span',{class:'attribute-label'},[(0,e.createTextVNode)('é«®åž‹'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[16]||(a[16]=e=>r.value.é«®åž‹=e),class:'attribute-textarea'},null,512)),[[e.vModelText,r.value.é«®åž‹]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Qd,(0,e.toDisplayString)(E.value?.hairstyle||'N/A'),1))]),(0,e.createElementVNode)('div',es,[a[43]||(a[43]=(0,e.createElementVNode)('span',{class:'attribute-label'},[(0,e.createTextVNode)('æ¨£è²Œ'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[17]||(a[17]=e=>r.value.æ¨£è²Œ=e),class:'attribute-textarea'},null,512)),[[e.vModelText,r.value.æ¨£è²Œ]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',ts,(0,e.toDisplayString)(E.value?.appearance||'N/A'),1))]),(0,e.createElementVNode)('div',as,[a[44]||(a[44]=(0,e.createElementVNode)('span',{class:'attribute-label'},[(0,e.createTextVNode)('è¡£è‘—'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[18]||(a[18]=e=>r.value.è¡£è‘—=e),class:'attribute-textarea'},null,512)),[[e.vModelText,r.value.è¡£è‘—]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',ns,(0,e.toDisplayString)(E.value?.clothes||'N/A'),1))]),(0,e.createElementVNode)('div',os,[a[45]||(a[45]=(0,e.createElementVNode)('span',{class:'attribute-label'},[(0,e.createTextVNode)('æ„›å¥½'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[19]||(a[19]=e=>r.value.æ„›å¥½=e),class:'attribute-textarea'},null,512)),[[e.vModelText,r.value.æ„›å¥½]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',rs,(0,e.toDisplayString)(E.value?.favourite||'N/A'),1))]),(0,e.createElementVNode)('div',ls,[a[46]||(a[46]=(0,e.createElementVNode)('span',{class:'attribute-label'},[(0,e.createTextVNode)('ç°¡ä»‹'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[20]||(a[20]=e=>r.value.ç°¡ä»‹=e),class:'attribute-textarea'},null,512)),[[e.vModelText,r.value.ç°¡ä»‹]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',is,(0,e.toDisplayString)(E.value?.introduction||'N/A'),1))]),(0,e.createElementVNode)('div',ds,[a[47]||(a[47]=(0,e.createElementVNode)('span',{class:'attribute-label'},[(0,e.createTextVNode)('æ€§æ ¼'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[21]||(a[21]=e=>r.value.æ€§æ ¼=e),class:'attribute-textarea'},null,512)),[[e.vModelText,r.value.æ€§æ ¼]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',ss,(0,e.toDisplayString)(E.value?.personality||'N/A'),1))]),E.value?.extra_information&&!o.value||n.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',cs,[a[48]||(a[48]=(0,e.createElementVNode)('span',{class:'attribute-label'},[(0,e.createTextVNode)('å…¶ä»–é‡è¦è³‡è¨Š'),(0,e.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||o.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[22]||(a[22]=e=>r.value.å…¶ä»–é‡è¦è³‡è¨Š=e),class:'attribute-textarea'},null,512)),[[e.vModelText,r.value.å…¶ä»–é‡è¦è³‡è¨Š]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',us,(0,e.toDisplayString)(E.value?.extra_information||'N/A'),1))])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createCommentVNode)(' é—œä¿‚ '),(0,e.createElementVNode)('div',ps,[a[52]||(a[52]=(0,e.createElementVNode)('h3',{class:'section-title'},'é—œä¿‚',-1)),n.value||o.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',fs,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(p.value,(_,t)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'edit-item'},[(0,e.createElementVNode)('select',{value:t,class:'relation-select',onChange:e=>((e,t)=>{if(r.value?.é—œä¿‚&&e!==t){const a=r.value.é—œä¿‚[e];delete r.value.é—œä¿‚[e],t&&(r.value.é—œä¿‚[t]=a)}})(String(t),e.target.value)},[a[50]||(a[50]=(0,e.createElementVNode)('option',{value:'',disabled:''},'é¸æ“‡è§’è‰²',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(k.value,t=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t.id,value:t.id},(0,e.toDisplayString)(t.name)+' ('+(0,e.toDisplayString)(t.id)+') ',9,xs))),128))],40,hs),a[51]||(a[51]=(0,e.createElementVNode)('span',{class:'edit-connector'},' æ˜¯æ­¤è§’è‰²çš„ ',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>p.value[t]=e,class:'input-field',placeholder:'é—œä¿‚'},null,8,ys),[[e.vModelText,p.value[t]]]),(0,e.createElementVNode)('button',{class:'relation-remove-btn',onClick:e=>(e=>{r.value?.é—œä¿‚&&delete r.value.é—œä¿‚[e]})(String(t))},'Ã—',8,_s)]))),128)),(0,e.createElementVNode)('button',{class:'add-relation-btn',onClick:A},'+ æ·»åŠ é—œä¿‚')])):((0,e.openBlock)(),(0,e.createElementBlock)('div',ms,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(E.value?.relations||[],([t,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'relation-item'},[(0,e.createElementVNode)('span',vs,(0,e.toDisplayString)(f.value?.getCharacter(t)?.name||'æœªçŸ¥')+' ('+(0,e.toDisplayString)(t)+')',1),a[49]||(a[49]=(0,e.createElementVNode)('span',{class:'connector'},' æ˜¯æ­¤è§’è‰²çš„ ',-1)),(0,e.createElementVNode)('span',gs,(0,e.toDisplayString)(n),1)]))),128)),E.value?.relations&&0!==E.value.relations.size?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('div',bs,' æ²’æœ‰ä»»ä½•é—œä¿‚ '))]))]),(0,e.createCommentVNode)(' å‹å¥½åº¦å’Œæ„›æƒ…åº¦ (åƒ…éžç”¨æˆ¶è§’è‰²é¡¯ç¤º) '),'c1'!==b.value||o.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Es,[a[55]||(a[55]=(0,e.createElementVNode)('h3',{class:'section-title'},'å‹å¥½åº¦',-1)),n.value||o.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ns,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(v.value,(_,t)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'edit-item'},[(0,e.createElementVNode)('select',{value:t,class:'relation-select',onChange:e=>((e,t)=>{if(r.value?.å‹å¥½åº¦&&e!==t){const a=r.value.å‹å¥½åº¦[e];delete r.value.å‹å¥½åº¦[e],t&&(r.value.å‹å¥½åº¦[t]=a)}})(String(t),e.target.value)},[a[53]||(a[53]=(0,e.createElementVNode)('option',{value:'',disabled:''},'é¸æ“‡è§’è‰²',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(k.value,t=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t.id,value:t.id},(0,e.toDisplayString)(t.name)+' ('+(0,e.toDisplayString)(t.id)+') ',9,Bs))),128))],40,ws),a[54]||(a[54]=(0,e.createElementVNode)('span',{class:'edit-connector'},' : ',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>v.value[t]=e,class:'input-field',type:'number',min:'-1000',max:'1000',placeholder:'å‹å¥½åº¦',onInput:e=>j(String(t)),onBlur:e=>j(String(t))},null,40,Cs),[[e.vModelText,v.value[t],void 0,{number:!0}]]),(0,e.createElementVNode)('button',{class:'friendship-remove-btn',onClick:e=>(e=>{r.value?.å‹å¥½åº¦&&delete r.value.å‹å¥½åº¦[e]})(String(t))},'Ã—',8,$s)]))),128)),(0,e.createElementVNode)('button',{class:'add-friendship-btn',onClick:K},'+ æ·»åŠ å‹å¥½åº¦')])):((0,e.openBlock)(),(0,e.createElementBlock)('div',ks,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(E.value?.friendships||[],([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'friendship-item'},[(0,e.createVNode)(ed,{label:`${f.value?.getCharacter(t)?.name||'æœªçŸ¥'} (${t})`,value:a,attributeType:'friendship'},null,8,['label','value'])]))),128)),E.value?.friendships&&0!==E.value.friendships.size?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('div',Vs,' æ²’æœ‰ä»»ä½•å‹å¥½åº¦ '))]))])):(0,e.createCommentVNode)('v-if',!0),'c1'!==b.value||o.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ss,[a[58]||(a[58]=(0,e.createElementVNode)('h3',{class:'section-title'},'æ„›æƒ…åº¦',-1)),n.value||o.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ds,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(g.value,(_,t)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'edit-item'},[(0,e.createElementVNode)('select',{value:t,class:'relation-select',onChange:e=>((e,t)=>{if(r.value?.æ„›æƒ…åº¦&&e!==t){const a=r.value.æ„›æƒ…åº¦[e];delete r.value.æ„›æƒ…åº¦[e],t&&(r.value.æ„›æƒ…åº¦[t]=a)}})(String(t),e.target.value)},[a[56]||(a[56]=(0,e.createElementVNode)('option',{value:'',disabled:''},'é¸æ“‡è§’è‰²',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(k.value,t=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t.id,value:t.id},(0,e.toDisplayString)(t.name)+' ('+(0,e.toDisplayString)(t.id)+') ',9,Ms))),128))],40,Ts),a[57]||(a[57]=(0,e.createElementVNode)('span',{class:'edit-connector'},' : ',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>g.value[t]=e,class:'input-field',type:'number',min:'0',max:'1000',placeholder:'æ„›æƒ…åº¦',onInput:e=>H(String(t)),onBlur:e=>H(String(t))},null,40,Ys),[[e.vModelText,g.value[t],void 0,{number:!0}]]),(0,e.createElementVNode)('button',{class:'love-remove-btn',onClick:e=>(e=>{r.value?.æ„›æƒ…åº¦&&delete r.value.æ„›æƒ…åº¦[e]})(String(t))},'Ã—',8,Os)]))),128)),(0,e.createElementVNode)('button',{class:'add-love-btn',onClick:U},'+ æ·»åŠ æ„›æƒ…åº¦')])):((0,e.openBlock)(),(0,e.createElementBlock)('div',Is,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(E.value?.loves||[],([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'love-item'},[(0,e.createVNode)(ed,{label:`${f.value?.getCharacter(t)?.name||'æœªçŸ¥'} (${t})`,value:a,attributeType:'love'},null,8,['label','value'])]))),128)),E.value?.loves&&0!==E.value.loves.size?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('div',zs,' æ²’æœ‰ä»»ä½•æ„›æƒ…åº¦ '))]))])):(0,e.createCommentVNode)('v-if',!0),(0,e.createElementVNode)('div',As,[a[60]||(a[60]=(0,e.createElementVNode)('h3',{class:'section-title'},'æ‰€æŒç‰©',-1)),n.value||o.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ws,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(m.value,(_,t)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'inventory-edit-item'},[(0,e.createElementVNode)('select',{value:t,class:'inventory-select',onChange:e=>((e,t)=>{if(r.value?.æ‰€æŒç‰©&&e!==t){const a=r.value.æ‰€æŒç‰©[e];delete r.value.æ‰€æŒç‰©[e],t&&(r.value.æ‰€æŒç‰©[t]=a)}})(String(t),e.target.value)},[a[59]||(a[59]=(0,e.createElementVNode)('option',{value:'',disabled:''},'é¸æ“‡ç‰©å“æˆ–è²¯å­˜é»ž...',-1)),(0,e.createElementVNode)('optgroup',Js,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(V.value.filter(e=>'item'===e.type),t=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t.id,value:t.id},(0,e.toDisplayString)(t.name)+' ('+(0,e.toDisplayString)(t.id)+') ',9,Zs))),128))]),(0,e.createElementVNode)('optgroup',Qs,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(V.value.filter(e=>'storage'===e.type),t=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t.id,value:t.id},(0,e.toDisplayString)(t.name)+' ('+(0,e.toDisplayString)(t.id)+') ',9,ec))),128))])],40,Xs),w(String(t))?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('span',tc,'Ã—')),w(String(t))?(0,e.createCommentVNode)('v-if',!0):(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':e=>m.value[t]=e,class:'inventory-quantity-input',type:'number',min:'0',placeholder:'æ•¸é‡'},null,8,ac)),[[e.vModelText,m.value[t],void 0,{number:!0}]]),(0,e.createElementVNode)('button',{class:'inventory-remove-btn',onClick:e=>(e=>{r.value?.æ‰€æŒç‰©&&delete r.value.æ‰€æŒç‰©[e]})(String(t))},'Ã—',8,nc)]))),128)),(0,e.createElementVNode)('button',{class:'add-inventory-btn',onClick:R},'+ æ·»åŠ ç‰©å“æˆ–è²¯å­˜é»ž')])):((0,e.openBlock)(),(0,e.createElementBlock)('div',Rs,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(E.value?.inventory||[],([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:(0,e.normalizeClass)(['inventory-item',{'storage-item':w(t)}])},[(0,e.createElementVNode)('div',Ks,[(0,e.createElementVNode)('span',Us,(0,e.toDisplayString)(N(t))+' ('+(0,e.toDisplayString)(t)+')',1),w(t)?((0,e.openBlock)(),(0,e.createElementBlock)('span',Fs,'è²¯å­˜é»ž')):((0,e.openBlock)(),(0,e.createElementBlock)('span',Ls,'Ã— '+(0,e.toDisplayString)(a),1))]),(0,e.createElementVNode)('div',js,(0,e.toDisplayString)(S(t)),1),w(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',Hs,[0===B(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ps,'ç„¡ç‰©å“')):((0,e.openBlock)(),(0,e.createElementBlock)('div',qs,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(C(t),([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:t,class:(0,e.normalizeClass)(f.value?.storages.has(t)?'storage-item-tag':'inventory-item-tag')},(0,e.toDisplayString)(N(t))+' ('+(0,e.toDisplayString)(t)+')'+(0,e.toDisplayString)(f.value?.storages.has(t)?'':` Ã— ${a}`),3))),128))]))])):(0,e.createCommentVNode)('v-if',!0)],2))),128)),E.value?.inventory&&0!==E.value.inventory.size?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('div',Gs,' æ²’æœ‰ä»»ä½•ç‰©å“ '))]))]),(0,e.createCommentVNode)(' ç·¨è¼¯æŒ‰éˆ• '),n.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',oc,[(0,e.createElementVNode)('button',{class:'confirm-button',disabled:u.value,onClick:J},'ç¢ºèª',8,rc),(0,e.createElementVNode)('button',{class:'cancel-button',onClick:G},'å–æ¶ˆ')])):(0,e.createCommentVNode)('v-if',!0)])],2112)):((0,e.openBlock)(),(0,e.createElementBlock)('div',ad,[(0,e.createCommentVNode)(' æ´»èºè§’è‰²éƒ¨åˆ† '),(0,e.createElementVNode)('div',nd,[a[23]||(a[23]=(0,e.createElementVNode)('h3',{class:'section-title'},'æ´»èºè§’è‰²',-1)),(0,e.createElementVNode)('div',od,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(x.value,([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'character-item clickable',onClick:e=>I(t)},[(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['character-info',{'user-character-info':'c1'===t}])},[(0,e.createElementVNode)('span',{class:(0,e.normalizeClass)('c1'===t?'user-id':'character-id')},(0,e.toDisplayString)(t),3),(0,e.createElementVNode)('span',{class:(0,e.normalizeClass)('c1'===t?'user-name':'character-name')},(0,e.toDisplayString)(a.name),3)],2),'c1'!==t?((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:0,class:'toggle-status-button',title:'è¨­ç‚ºéžæ´»èº',onClick:(0,e.withModifiers)(e=>D(t),['stop'])},' â†“ ',8,ld)):(0,e.createCommentVNode)('v-if',!0),'c1'!==t?((0,e.openBlock)(),(0,e.createElementBlock)('div',id,[(0,e.createVNode)(ed,{label:'å¿ƒæƒ…',value:a.mood||0,attributeType:'mood'},null,8,['value']),(0,e.createVNode)(ed,{label:'æ€§æ…¾',value:a.horny||0,attributeType:'horny'},null,8,['value']),(0,e.createVNode)(ed,{label:'å‹å¥½åº¦',value:a.friendships?.get('c1')||0,attributeType:'friendship'},null,8,['value']),(0,e.createVNode)(ed,{label:'æ„›æƒ…åº¦',value:a.loves?.get('c1')||0,attributeType:'love'},null,8,['value'])])):(0,e.createCommentVNode)('v-if',!0)],8,rd))),128)),0===x.value.size?((0,e.openBlock)(),(0,e.createElementBlock)('div',dd,'æ²’æœ‰æ´»èºè§’è‰²')):(0,e.createCommentVNode)('v-if',!0)])]),(0,e.createCommentVNode)(' éžæ´»èºè§’è‰²éƒ¨åˆ† '),(0,e.createElementVNode)('div',sd,[a[24]||(a[24]=(0,e.createElementVNode)('h3',{class:'section-title'},'éžæ´»èºè§’è‰²',-1)),(0,e.createElementVNode)('div',cd,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(y.value,([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'character-item clickable',onClick:e=>I(t)},[(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['character-info',{'user-character-info':'c1'===t}])},[(0,e.createElementVNode)('span',{class:(0,e.normalizeClass)('c1'===t?'user-id':'character-id')},(0,e.toDisplayString)(t),3),(0,e.createElementVNode)('span',{class:(0,e.normalizeClass)('c1'===t?'user-name':'character-name')},(0,e.toDisplayString)(a.name),3)],2),'c1'!==t?((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:0,class:'toggle-status-button',title:'è¨­ç‚ºæ´»èº',onClick:(0,e.withModifiers)(e=>D(t),['stop'])},' â†‘ ',8,pd)):(0,e.createCommentVNode)('v-if',!0),'c1'!==t?((0,e.openBlock)(),(0,e.createElementBlock)('div',md,[(0,e.createVNode)(ed,{label:'å¿ƒæƒ…',value:a.mood||0,attributeType:'mood'},null,8,['value']),(0,e.createVNode)(ed,{label:'æ€§æ…¾',value:a.horny||0,attributeType:'horny'},null,8,['value']),(0,e.createVNode)(ed,{label:'å‹å¥½åº¦',value:a.friendships?.get('c1')||0,attributeType:'friendship'},null,8,['value']),(0,e.createVNode)(ed,{label:'æ„›æƒ…åº¦',value:a.loves?.get('c1')||0,attributeType:'love'},null,8,['value'])])):(0,e.createCommentVNode)('v-if',!0)],8,ud))),128)),0===y.value.size?((0,e.openBlock)(),(0,e.createElementBlock)('div',vd,'æ²’æœ‰éžæ´»èºè§’è‰²')):(0,e.createCommentVNode)('v-if',!0)])]),(0,e.createCommentVNode)(' æ–°å¢žè§’è‰²æŒ‰éˆ• '),o.value?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:0,class:'add-character-button',onClick:q},'+ æ·»åŠ è§’è‰²'))])),(0,e.createCommentVNode)(' ç¢ºèªçª—å£ '),(0,e.createVNode)(Gi,{'confirm-dialog':i.value,onConfirmDialogConfirm:Y,onConfirmDialogCancel:O},null,8,['confirm-dialog'])]);var d,s}}});i(5168);const ic=(0,d.A)(lc,[['__scopeId','data-v-684d53c6']]);class dc{static instance;state=(0,e.ref)({is_generating:!1,is_generating_new_swipe:!1,current_generation_id:null,last_user_message_id:null,last_user_message_text:'',swipe_generation_message_id:null});constructor(){eventOn(iframe_events.GENERATION_ENDED,(e,t)=>{this.handleGenerationEnd(e,t)})}static getInstance(){return dc.instance||(dc.instance=new dc),dc.instance}getState(){return this.state}startGeneration(e,t){this.state.value.is_generating=!0,this.state.value.last_user_message_id=t,this.state.value.last_user_message_text=e;const a=`generation_${Date.now()}`;this.state.value.current_generation_id=a,eventEmit('MESSAGE_SENT',t),this.hideSummarizedMessages(),this.addEventStartTag(),generate({generation_id:a})}startSwipeGeneration(e){this.state.value.is_generating_new_swipe=!0,this.state.value.swipe_generation_message_id=e,this.hideSummarizedMessages(),this.addEventStartTag(),setChatMessages([{message_id:e,is_hidden:!0}],{refresh:'none'});const t=`swipe_generation_${Date.now()}`;this.state.value.current_generation_id=t,generate({generation_id:t})}async stopGeneration(){if(this.state.value.current_generation_id)try{await stopGenerationById(this.state.value.current_generation_id),this.state.value.is_generating_new_swipe?(this.state.value.is_generating_new_swipe=!1,this.state.value.swipe_generation_message_id=null):null!==this.state.value.last_user_message_id&&this.restoreUserInput(),this.resetState()}catch(e){console.error('Failed to stop generation:',e),this.resetState()}}restoreUserInput(){eventEmit('RESTORE_USER_INPUT',this.state.value.last_user_message_text)}async handleGenerationEnd(e,t){try{if(!t||!t.startsWith('generation_')&&!t.startsWith('swipe_generation_'))return;if(this.state.value.is_generating_new_swipe&&null!==this.state.value.swipe_generation_message_id){const t=this.state.value.swipe_generation_message_id,a=getChatMessages(t,{include_swipes:!0})[0];if(a&&a.swipes){const n=[...a.swipes,e],o=n.length-1;await setChatMessages([{message_id:t,swipes:n,swipe_id:o,is_hidden:!1}],{refresh:'none'})}}else await createChatMessages([{role:'assistant',message:e}],{refresh:'none'});this.removeEventStartTag(),eventEmit('MESSAGE_RECEIVED',getLastMessageId())}catch(e){console.error('Failed to handle generation end:',e)}finally{this.resetState()}}resetState(){this.state.value.is_generating=!1,this.state.value.is_generating_new_swipe=!1,this.state.value.current_generation_id=null,this.state.value.swipe_generation_message_id=null,this.state.value.last_user_message_id=null,this.state.value.last_user_message_text=''}isGenerating(){return this.state.value.is_generating||this.state.value.is_generating_new_swipe}getCurrentGenerationId(){return this.state.value.current_generation_id}hideSummarizedMessages(){try{if(0===getLastMessageId())return;const e=Yo.loadFromVariable(getLastMessageId()-1).getLatestSummaryLastMessageId(),t=getLastMessageId()+1,a=[];if(e>=0)for(let t=0;t<=e;t++)a.push({message_id:t,is_hidden:!0});for(let n=e+1;n<t;n++)a.push({message_id:n,is_hidden:!1});a.length>0&&setChatMessages(a,{refresh:'none'})}catch(e){console.error('Failed to hide summarized messages:',e)}}addEventStartTag(){if(0===getLastMessageId())return;const e=Yo.loadFromVariable(getLastMessageId()-1),t=0===e.summaries.length?0:e.summaries[e.summaries.length-1].last_message_id+1,a=getChatMessages(t)[0].message,n=`\x3c!--${Yo.CURRENT_EVENT_KEY}é–‹å§‹--\x3e\n`;setChatMessages([{message_id:t,message:`${n}${a}`}])}removeEventStartTag(){if(0===getLastMessageId())return;const e=Yo.loadFromVariable(getLastMessageId()-1),t=0===e.summaries.length?0:e.summaries[e.summaries.length-1].last_message_id+1,a=getChatMessages(t)[0].message,n=`\x3c!--${Yo.CURRENT_EVENT_KEY}é–‹å§‹--\x3e\n`;setChatMessages([{message_id:t,message:a.replaceAll(n,'')}])}}const sc=dc.getInstance(),cc={class:'conversation-tab-container'},uc={class:'main-content'},pc={class:'dialogue-fullscreen'},mc={key:0,class:'load-more-container'},vc={key:0,class:'edit-mode'},gc={class:'edit-controls'},bc=['onClick'],fc={class:'message-header'},hc={class:'message-header-row'},xc={class:'message-id'},yc={class:'message-actions'},_c=['onClick'],Ec=['onClick'],kc={class:'message-status-row'},Vc={class:'status-info'},Nc={class:'status-datetime'},wc={class:'status-location'},Bc={class:'message-content'},Cc=['innerHTML'],$c=['innerHTML'],Sc={key:0,class:'swipe-controls'},Ic=['disabled','onClick'],zc={class:'swipe-indicator'},Dc=['disabled','onClick'],Tc=['disabled','onClick'],Mc={class:'input-container'},Yc={key:0,class:'loading-spinner'},Oc='conversation_user_input',Ac=(0,e.defineComponent)({__name:'conversation_tab',emits:['renderSizeChanged'],setup(t,{expose:a,emit:n}){(0,e.useCssVars)(e=>({v14702539:k.value}));const o=(0,e.ref)(''),r=(0,e.ref)([]),l=sc.getState(),i=(0,e.computed)(()=>l.value.is_generating),d=(0,e.computed)(()=>l.value.is_generating_new_swipe),c=(0,e.ref)(null),u=(0,e.ref)(null),p=(0,e.ref)(null),m=(0,e.ref)(null),v=(0,e.ref)(''),g=(0,e.ref)({visible:!1,title:'',message:'',confirmText:'ç¢ºå®š',cancelText:'å–æ¶ˆ'}),b=(0,e.ref)(10),f=(0,e.ref)(0),h=(0,e.ref)(!1),x=(0,e.ref)(0),y=(0,e.ref)(0),E=(0,e.ref)(null),k=(0,e.computed)(()=>`calc(100vh - ${x.value+y.value}px)`),V=(0,e.ref)(0),N=e=>{try{const t=Yo.loadFromVariable(e),a=t.datetime,n=a.year,o=a.month,r=a.date,l=a.hours,i=a.minutes,d=['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'][a.toDate().getDay()],s=`${n}å¹´${o}æœˆ${r}æ—¥ (${d}) ${`${l.toString().padStart(2,'0')}:${i.toString().padStart(2,'0')}`} ${t.weather}`,c=t.getCurrentLocations();return{datetimeLine:s,locationString:c.map(e=>e.name).join('-')}}catch(e){return console.error('Failed to load message status:',e),{datetimeLine:'è¼‰å…¥ç‹€æ…‹ä¸­...',locationString:''}}},w=(0,e.ref)(new Map),B=(0,e.ref)(new Set),C=async(e,t)=>{if(!w.value.has(e)&&!B.value.has(e)){B.value.add(e);try{const a=await SillyTavern.getTokenCountAsync(t);w.value.set(e,a)}catch(t){console.error('Failed to get token count:',t),w.value.set(e,0)}finally{B.value.delete(e)}}},S=()=>{if(u.value){const t=u.value.scrollHeight,a=u.value.scrollTop;f.value+=b.value,G(),(0,e.nextTick)(()=>{(0,e.nextTick)(()=>{if(u.value){const e=u.value.scrollHeight-t;u.value.scrollTop=a+e}})})}else f.value+=b.value,G()},I=()=>{f.value=b.value},D=e=>{'Enter'===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),H())},T=()=>{(()=>{if(c.value){c.value.style.height='auto';const e=Math.min(c.value.scrollHeight,120);c.value.style.height=`${e}px`}})(),(()=>{try{localStorage.setItem(Oc,o.value)}catch(e){console.error('Failed to save user input to localStorage:',e)}})()},M=()=>{m.value=null,v.value=''},Y=e=>{},O=async(t,a)=>{try{const t=getLastMessageId(),n=[];for(let e=a+1;e<r.value.length;e++){const a=t-(r.value.length-1-e);n.push(a)}n.length>0&&await deleteChatMessages(n,{refresh:'none'});let l='';for(let e=a+1;e<r.value.length;e++)if('user'===r.value[e].role){l=r.value[e].content;break}o.value=l,I(),G(),(0,e.nextTick)(()=>{K()})}catch(e){console.error('Failed to rewind conversation:',e)}},A=e=>{let t=[{type:'plain_text',message:e}];const a=(()=>{try{const e=getVariables({type:'chat'});return e?.settings?.tag_rules||[]}catch(e){return console.error('Failed to load folding rules:',e),[]}})();for(const e of a)t=R(e,t);for(const e of t)'plain_text'===e.type&&(e.message=e.message.replace(/ã€Œ([^ã€]*)ã€/g,'<span class="dialogue-text">ã€Œ$1ã€</span>'));return t},R=(e,t)=>{const a=[];for(const n of t){if('plain_text'!==n.type){a.push(n);continue}const t=n.message,o=`<${e.tag_name}>`,r=`</${e.tag_name}>`;if('both'===e.match_mode&&'first'===e.match_strategy){let n=t;for(;;){const t=n.indexOf(o),l=n.indexOf(r);if(t<0||l<0||l<=t){''!==n&&a.push({type:'plain_text',message:n});break}const i=n.substring(0,t);''!==i&&a.push({type:'plain_text',message:i});const d=n.substring(t+o.length,l);'invisible'===e.display_mode||'fold_bar'===e.display_mode&&a.push({type:'fold_bar',message:d,fold_bar_title:e.title_name||e.tag_name}),n=n.substring(l+r.length)}}else{const l='both'===e.match_mode?t.indexOf(o):-1,i='first'===e.match_strategy?t.indexOf(r):t.lastIndexOf(r);if(i<0||'both'===e.match_mode&&l<0){a.push(n);continue}const d='both'===e.match_mode?l+o.length:0,s=l<0?'':t.substring(0,l),c=t.substring(d,i),u=t.substring(i+r.length);'invisible'===e.display_mode?a.push({type:'plain_text',message:s+u}):'fold_bar'===e.display_mode&&(''!==s&&a.push({type:'plain_text',message:s}),a.push({type:'fold_bar',message:c,fold_bar_title:e.title_name||e.tag_name}),''!==u&&a.push({type:'plain_text',message:u}))}}return a},K=()=>{u.value&&(u.value.scrollTop=u.value.scrollHeight)},U=(e,t,a)=>{g.value={visible:!0,title:e,message:t,confirmText:'ç¢ºå®š',cancelText:'å–æ¶ˆ'},a&&(g.value._callback=a)},L=()=>{const e=g.value._callback;e&&e(),g.value.visible=!1,delete g.value._callback},F=()=>{g.value.visible=!1},j=e=>{const t=-1===e;Yo.loadFromVariable(e).injectPrompt(t)},H=async e=>{if(void 0===e&&(e=!1),e||o.value.trim()){const e=o.value.trim();o.value='',c.value&&(c.value.style.height='auto');try{localStorage.removeItem(Oc)}catch(e){console.error('Failed to clear user input from localStorage:',e)}try{await createChatMessages([{role:'user',message:e}],{refresh:'none'});const t=getLastMessageId();I(),G(),j(getLastMessageId()-1),sc.startGeneration(e,t)}catch(e){console.error('Failed to send message:',e),sc.stopGeneration()}}},P=async e=>{const t=e.swipe_id||0;if(t<e.swipes.length-1){const e=t+1;await setChatMessages([{message_id:getLastMessageId(),swipe_id:e}],{refresh:'none'}),G(),K()}else await(async()=>{const e=getLastMessageId();await setChatMessages([{message_id:e,is_hidden:!0}],{refresh:'none'}),j(getLastMessageId()-1),sc.startSwipeGeneration(e)})()},q=async(e,t,a,n,o)=>{const r=a.filter((_,e)=>e!==t),l=n.filter((_,e)=>e!==t),i=o.filter((_,e)=>e!==t);let d=t;d>=r.length&&(d=r.length-1),await setChatMessages([{message_id:getLastMessageId(),swipes:r,swipes_data:l,swipes_info:i,swipe_id:d}],{refresh:'none'}),G(),K()},G=()=>{try{w.value.clear();const t=getLastMessageId();if(V.value=t,t>=0){const a=f.value,n=Math.max(0,t-a+1),o=getChatMessages(`${n}-${t}`,{include_swipes:!0});r.value=o.map((e,t)=>{const a='assistant'===e.role&&t===o.length-1,n=e;return{content:n.swipes?n.swipes[n.swipe_id||0]:e.message,role:e.role,swipe_id:n.swipe_id,swipes:n.swipes,swipes_data:n.swipes_data,swipes_info:n.swipes_info,is_latest_assistant:a}}),h.value=n>0,f.value===b.value&&(0,e.nextTick)(()=>{K()})}}catch(e){console.error('Failed to load messages:',e),r.value=[],h.value=!1}};return a({handleRenderSizeChanged:e=>{console.log('Render size changed to:',e),b.value=e,I(),G()},getScrollPosition:()=>u.value?.scrollTop||0,setScrollPosition:e=>{u.value&&(u.value.scrollTop=e)}}),(0,e.onMounted)(()=>{(()=>{try{const e=getVariables({type:'chat'});e?.settings?.render_size&&(b.value=e.settings.render_size)}catch(e){console.error('Failed to load chat settings:',e)}})(),f.value=b.value,V.value=getLastMessageId(),G(),(()=>{try{const e=localStorage.getItem(Oc);e&&(o.value=e)}catch(e){console.error('Failed to restore user input from localStorage:',e)}})(),(0,e.nextTick)(()=>{(()=>{if('undefined'==typeof ResizeObserver)return x.value=80,void(y.value=68);E.value=new ResizeObserver(e=>{for(const t of e){const e=t.target;e.classList.contains('tab-navigation')?x.value=e.offsetHeight:e.classList.contains('input-area')&&(y.value=e.offsetHeight)}});const e=document.querySelector('.tab-navigation.top');e&&(E.value.observe(e),x.value=e.offsetHeight),p.value&&(E.value.observe(p.value),y.value=p.value.offsetHeight)})()}),sc.getState(),eventOn('initialization_completed',()=>{H(!0)}),eventOn('MESSAGE_RECEIVED_PROCESSED',()=>{G(),(0,e.nextTick)(()=>{(()=>{if(u.value){const e=u.value.querySelectorAll('.message');e.length>0&&e[e.length-1].scrollIntoView({behavior:'smooth',block:'start'})}})()})}),eventOn(tavern_events.GENERATION_ENDED,e=>{sc.stopGeneration()}),eventOn('RESTORE_USER_INPUT',e=>{o.value=e})}),(0,e.onUnmounted)(()=>{E.value&&(E.value.disconnect(),E.value=null)}),(t,a)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',cc,[(0,e.createElementVNode)('div',uc,[(0,e.createElementVNode)('div',pc,[(0,e.createElementVNode)('div',{ref_key:'messages_container_ref',ref:u,class:'messages-container'},[(0,e.createCommentVNode)(' è¼‰å…¥æ›´å¤šæ¶ˆæ¯æŒ‰éˆ• '),h.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',mc,[(0,e.createElementVNode)('button',{class:'load-more-btn',onClick:S},'è¼‰å…¥æ›´å¤šæ¶ˆæ¯')])):(0,e.createCommentVNode)('v-if',!0),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(r.value,(t,n)=>{return(0,e.openBlock)(),(0,e.createElementBlock)('div',{key:n,class:(0,e.normalizeClass)(['message',t.role])},[m.value===n?((0,e.openBlock)(),(0,e.createElementBlock)('div',vc,[(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':a[0]||(a[0]=e=>v.value=e),class:'edit-textarea',rows:'3',onKeydown:Y},null,544),[[e.vModelText,v.value]]),(0,e.createElementVNode)('div',gc,[(0,e.createElementVNode)('button',{class:'edit-btn confirm-btn',onClick:e=>(async(e,t)=>{if(v.value.trim()&&v.value!==e.content)try{if('user'===e.role)await setChatMessages([{message_id:getLastMessageId()-(r.value.length-1-t),message:v.value.trim()}],{refresh:'none'});else if('assistant'===e.role)if(e.swipes){const a=e.swipe_id||0,n=[...e.swipes];n[a]=v.value.trim(),await setChatMessages([{message_id:getLastMessageId()-(r.value.length-1-t),swipes:n}],{refresh:'none'})}else await setChatMessages([{message_id:getLastMessageId()-(r.value.length-1-t),message:v.value.trim()}],{refresh:'none'});G()}catch(e){console.error('Failed to save edit:',e)}M()})(t,n)},'âœ“',8,bc),(0,e.createElementVNode)('button',{class:'edit-btn cancel-btn',onClick:M},'âœ•')])])):((0,e.openBlock)(),(0,e.createElementBlock)(e.Fragment,{key:1},[(0,e.createElementVNode)('div',fc,[(0,e.createElementVNode)('div',hc,[(0,e.createElementVNode)('span',xc,'#'+(0,e.toDisplayString)(V.value-(r.value.length-1-n))+' ('+(0,e.toDisplayString)((o=V.value-(r.value.length-1-n),l=t.content,w.value.has(o)?`${w.value.get(o)}`:(B.value.has(o)||C(o,l),'...')))+' tokens)',1),(0,e.createElementVNode)('div',yc,['assistant'!==t.role||t.is_latest_assistant?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:0,class:'rewind-message-btn',title:'å¾žæ­¤é»žå›žé€€å°è©±',onClick:e=>((e,t)=>{U('å›žé€€å°è©±','ç¢ºå®šè¦å¾žæ­¤é»žå›žé€€å°è©±å—Žï¼Ÿé€™å°‡åˆªé™¤æ­¤é»žä¹‹å¾Œçš„æ‰€æœ‰æ¶ˆæ¯ã€‚',()=>O(e,t))})(t,n)},' âª ',8,_c)),(0,e.createElementVNode)('button',{class:'edit-message-btn',title:'ç·¨è¼¯æ¶ˆæ¯',onClick:e=>((e,t)=>{m.value=t,v.value=e.content})(t,n)},'âœï¸',8,Ec)])]),(0,e.createElementVNode)('div',kc,[(0,e.createElementVNode)('div',Vc,[(0,e.createElementVNode)('div',Nc,(0,e.toDisplayString)(N(V.value-(r.value.length-1-n)).datetimeLine),1),(0,e.createElementVNode)('div',wc,(0,e.toDisplayString)(N(V.value-(r.value.length-1-n)).locationString),1)])])]),(0,e.createElementVNode)('div',Bc,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(A(t.content),(t,a)=>((0,e.openBlock)(),(0,e.createElementBlock)(e.Fragment,{key:a},[(0,e.createCommentVNode)(' æ™®é€šæ–‡æœ¬ '),(0,e.createCommentVNode)(' eslint-disable-next-line vue/no-v-html '),'plain_text'===t.type?((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:0,innerHTML:t.message},null,8,Cc)):(0,e.createCommentVNode)('v-if',!0),(0,e.createCommentVNode)(' æ‘ºç–Šæ¬„ '),'fold_bar'===t.type?((0,e.openBlock)(),(0,e.createBlock)(s,{key:1,title:t.fold_bar_title||'å…§å®¹','is-open':t.is_open||!1},{default:(0,e.withCtx)(()=>[(0,e.createCommentVNode)(' eslint-disable-next-line vue/no-v-html '),(0,e.createElementVNode)('span',{innerHTML:t.message},null,8,$c)]),_:2},1032,['title','is-open'])):(0,e.createCommentVNode)('v-if',!0)],64))),128))]),t.is_latest_assistant&&t.swipes?((0,e.openBlock)(),(0,e.createElementBlock)('div',Sc,[(0,e.createElementVNode)('button',{class:'swipe-btn',disabled:(t.swipe_id||0)<=0,onClick:e=>(async e=>{if(e.swipe_id>0){const t=e.swipe_id-1;await setChatMessages([{message_id:getLastMessageId(),swipe_id:t}],{refresh:'none'}),G(),K()}})(t)},' â€¹ ',8,Ic),(0,e.createElementVNode)('span',zc,(0,e.toDisplayString)((t.swipe_id||0)+1)+'/'+(0,e.toDisplayString)(t.swipes.length),1),(0,e.createElementVNode)('button',{class:'swipe-btn',disabled:d.value,onClick:e=>P(t)},'â€º',8,Dc),(0,e.createElementVNode)('button',{class:'swipe-btn delete-btn',disabled:t.swipes.length<=1,title:'åˆªé™¤ç•¶å‰swipe',onClick:e=>(async e=>{const t=e.swipe_id||0,a=e.swipes,n=e.swipes_data,o=e.swipes_info;a.length<=1||U('åˆªé™¤å›žæ‡‰è®Šé«”',`ç¢ºå®šè¦åˆªé™¤ç¬¬ ${t+1} å€‹å›žæ‡‰è®Šé«”å—Žï¼Ÿ\n\né€™å°‡æ°¸ä¹…åˆªé™¤è©²å›žæ‡‰è®Šé«”ã€‚`,()=>q(e,t,a,n,o))})(t)},' Ã— ',8,Tc)])):(0,e.createCommentVNode)('v-if',!0)],64))],2);var o,l}),128))],512)]),(0,e.createElementVNode)('div',{ref_key:'input_area_ref',ref:p,class:'input-area'},[(0,e.createElementVNode)('div',Mc,[(0,e.withDirectives)((0,e.createElementVNode)('textarea',{ref_key:'message_input_ref',ref:c,'onUpdate:modelValue':a[1]||(a[1]=e=>o.value=e),class:'message-input',placeholder:'è¼¸å…¥æ‚¨çš„è¨Šæ¯...',rows:'1',onKeydown:D,onInput:T},null,544),[[e.vModelText,o.value]]),i.value||d.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Yc)):(0,e.createCommentVNode)('v-if',!0),(0,e.createElementVNode)('button',{class:'send-button',onClick:a[2]||(a[2]=e=>i.value||d.value?(async()=>{await sc.stopGeneration()})():H())},(0,e.toDisplayString)(i.value||d.value?'åœæ­¢':'ç™¼é€'),1)])],512),(0,e.createCommentVNode)(' é€šç”¨çµ„ä»¶ '),(0,e.createVNode)(Gi,{'confirm-dialog':g.value,onConfirmDialogConfirm:L,onConfirmDialogCancel:F},null,8,['confirm-dialog'])])]))}});i(1937);const Rc=(0,d.A)(Ac,[['__scopeId','data-v-18297b7b']]),Kc={class:'item-tab-container'},Uc={class:'item-content'},Lc={class:'item-list'},Fc={class:'item-info'},jc={class:'item-id-name-row'},Hc={key:0,class:'item-id'},Pc=['onUpdate:modelValue'],qc={key:2,class:'item-name'},Gc=['onUpdate:modelValue'],Wc={key:0,class:'item-description'},Xc=['onUpdate:modelValue'],Jc={class:'item-value-actions-row'},Zc={key:0,class:'item-value'},Qc={key:1,class:'item-value-input-wrapper'},eu=['onUpdate:modelValue'],tu={class:'item-actions'},au=['onClick'],nu=['onClick'],ou=['onClick'],ru=['onClick'],lu={key:0,class:'item-row new-item-row'},iu={class:'item-info'},du={class:'item-id-name-row'},su={class:'item-value-actions-row'},cu={class:'item-value-input-wrapper'},uu={key:1,class:'no-items-message'},pu=(0,e.defineComponent)({__name:'item_tab',setup(t){(0,e.useCssVars)(e=>({f33397ea:o.value}));const a=(0,e.ref)(0),n=(0,e.ref)(null),o=(0,e.computed)(()=>`calc(100vh - ${a.value}px)`);(0,e.onMounted)(()=>{(async()=>{await(0,e.nextTick)();const t=document.querySelector('.tab-navigation');t&&window.ResizeObserver?(n.value=new ResizeObserver(e=>{for(const t of e)a.value=t.contentRect.height}),n.value.observe(t)):a.value=74})()}),(0,e.onUnmounted)(()=>{n.value&&(n.value.disconnect(),n.value=null)});const r=(0,e.ref)(!1),l=(0,e.ref)(new Set),i=(0,e.ref)({id:'',name:'',description:'',value:0}),d=(0,e.ref)({}),s=(0,e.ref)({visible:!1,title:'',message:'',confirmText:'ç¢ºèª',cancelText:'å–æ¶ˆ'}),c=(0,e.ref)(null),u=(0,e.ref)(null),p=()=>{u.value&&(u.value.saveAsVariable(getLastMessageId()),m())},m=()=>{try{const e=getLastMessageId();u.value=Yo.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),u.value=null}};m();const v=(0,e.computed)(()=>u.value?.items||new Map),g=()=>{r.value=!0,i.value={id:'',name:'',description:'',value:0}},b=()=>{if(!u.value||!i.value.id||!i.value.name)return;if(u.value.items.has(i.value.id))return void f();const e=new Io(i.value.name,i.value.description,i.value.value);u.value.items.set(i.value.id,e),p(),f()},f=()=>{r.value=!1,i.value={id:'',name:'',description:'',value:0}},h=e=>{l.value.delete(e),delete d.value[e]},x=()=>{c.value&&u.value&&(u.value.items.delete(c.value),p()),s.value.visible=!1,c.value=null},y=()=>{s.value.visible=!1,c.value=null};return(t,a)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',Kc,[(0,e.createElementVNode)('div',Uc,[(0,e.createCommentVNode)(' ç‰©å“åˆ—è¡¨æ¨™é¡Œ '),a[7]||(a[7]=(0,e.createElementVNode)('div',{class:'item-section'},[(0,e.createElementVNode)('h3',{class:'section-title'},'ç‰©å“åˆ—è¡¨')],-1)),(0,e.createCommentVNode)(' ç‰©å“åˆ—è¡¨ '),(0,e.createElementVNode)('div',Lc,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(v.value,([t,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'item-row'},[(0,e.createCommentVNode)(' ç‰©å“ä¿¡æ¯ '),(0,e.createElementVNode)('div',Fc,[(0,e.createElementVNode)('div',jc,[l.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':e=>d.value[t].id=e,class:'item-id-input',placeholder:'ç‰©å“ID'},null,8,Pc)),[[e.vModelText,d.value[t].id]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',Hc,(0,e.toDisplayString)(t),1)),l.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:3,'onUpdate:modelValue':e=>d.value[t].name=e,class:'item-name-input',placeholder:'ç‰©å“åç¨±'},null,8,Gc)),[[e.vModelText,d.value[t].name]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',qc,(0,e.toDisplayString)(n.name),1))]),l.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':e=>d.value[t].description=e,class:'item-description-input',placeholder:'ç‰©å“æè¿°'},null,8,Xc)),[[e.vModelText,d.value[t].description]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',Wc,(0,e.toDisplayString)(n.description),1))]),(0,e.createCommentVNode)(' åƒ¹å€¼å’Œæ“ä½œæŒ‰éˆ• '),(0,e.createElementVNode)('div',Jc,[l.value.has(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',Qc,[a[5]||(a[5]=(0,e.createElementVNode)('span',{class:'dollar-sign'},'$',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>d.value[t].value=e,class:'item-value-input',type:'number',placeholder:'åƒ¹å€¼'},null,8,eu),[[e.vModelText,d.value[t].value,void 0,{number:!0}]])])):((0,e.openBlock)(),(0,e.createElementBlock)('div',Zc,'$'+(0,e.toDisplayString)(n.value.toLocaleString()),1)),(0,e.createElementVNode)('div',tu,[l.value.has(t)?((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:1,class:'confirm-button',onClick:e=>(e=>{if(!u.value||!d.value[e])return;const t=d.value[e];if(t.id!==e&&u.value.items.has(t.id))return void h(e);const a=u.value.items.get(e);a&&(t.id!==e&&(u.value.items.delete(e),u.value.items.set(t.id,a)),a.name=t.name,a.description=t.description,a.value=t.value,p()),h(e)})(t)},'ä¿å­˜',8,nu)):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:0,class:'edit-item-button',onClick:e=>(e=>{const t=v.value.get(e);t&&(l.value.add(e),d.value[e]={id:e,name:t.name,description:t.description,value:t.value})})(t)},' ç·¨è¼¯ ',8,au)),l.value.has(t)?((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:3,class:'cancel-button',onClick:e=>h(t)},'å–æ¶ˆ',8,ru)):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:2,class:'delete-item-button',onClick:e=>(e=>{const t=v.value.get(e);t&&(c.value=e,s.value={visible:!0,title:'ç¢ºèªåˆªé™¤ç‰©å“',message:`ç¢ºå®šè¦åˆªé™¤ç‰©å“ "${t.name}" å—Žï¼Ÿæ­¤æ“ä½œç„¡æ³•æ’¤éŠ·ã€‚`,confirmText:'åˆªé™¤',cancelText:'å–æ¶ˆ'})})(t)},' åˆªé™¤ ',8,ou))])])]))),128)),(0,e.createCommentVNode)(' æ–°ç‰©å“ç·¨è¼¯è¡Œ '),r.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',lu,[(0,e.createCommentVNode)(' ç‰©å“ä¿¡æ¯ '),(0,e.createElementVNode)('div',iu,[(0,e.createElementVNode)('div',du,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>i.value.id=e),class:'item-id-input',placeholder:'ç‰©å“ID'},null,512),[[e.vModelText,i.value.id]]),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>i.value.name=e),class:'item-name-input',placeholder:'ç‰©å“åç¨±'},null,512),[[e.vModelText,i.value.name]])]),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':a[2]||(a[2]=e=>i.value.description=e),class:'item-description-input',placeholder:'ç‰©å“æè¿°'},null,512),[[e.vModelText,i.value.description]])]),(0,e.createCommentVNode)(' åƒ¹å€¼å’Œæ“ä½œæŒ‰éˆ• '),(0,e.createElementVNode)('div',su,[(0,e.createElementVNode)('div',cu,[a[6]||(a[6]=(0,e.createElementVNode)('span',{class:'dollar-sign'},'$',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[3]||(a[3]=e=>i.value.value=e),class:'item-value-input',type:'number',placeholder:'åƒ¹å€¼'},null,512),[[e.vModelText,i.value.value,void 0,{number:!0}]])]),(0,e.createElementVNode)('div',{class:'item-actions'},[(0,e.createElementVNode)('button',{class:'confirm-button',onClick:b},'æ·»åŠ '),(0,e.createElementVNode)('button',{class:'cancel-button',onClick:f},'å–æ¶ˆ')])])])):(0,e.createCommentVNode)('v-if',!0),0!==v.value.size||r.value?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('div',uu,'æ²’æœ‰ä»»ä½•ç‰©å“')),r.value?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:2,class:'add-item-button',onClick:g},'+ æ·»åŠ ç‰©å“'))]),(0,e.createCommentVNode)(' ç¢ºèªçª—å£ '),(0,e.createVNode)(Gi,{'confirm-dialog':s.value,'onUpdate:confirmDialog':a[4]||(a[4]=e=>s.value=e),onConfirmDialogConfirm:x,onConfirmDialogCancel:y},null,8,['confirm-dialog'])])]))}});i(9458);const mu=(0,d.A)(pu,[['__scopeId','data-v-b32ed7ea']]),vu={class:'location-tab-container'},gu={class:'location-content'},bu={class:'location-list'},fu=['id'],hu={class:'location-first-row'},xu={class:'location-id-name-group'},yu={key:0,class:'location-id'},_u=['onUpdate:modelValue'],Eu={key:2,class:'location-name'},ku=['onUpdate:modelValue'],Vu={class:'location-actions'},Nu=['onClick'],wu=['onClick'],Bu={class:'location-location-row'},Cu={class:'location-location-group'},$u={key:0,class:'location-location'},Su=['onUpdate:modelValue'],Iu={key:0,class:'location-edit-actions'},zu=['onClick'],Du=['onClick'],Tu={key:0,class:'location-parent-display'},Mu=['onClick'],Yu={key:1,class:'location-parent-tag'},Ou={key:1,class:'location-parent-input-group'},Au=['onUpdate:modelValue'],Ru=['value','disabled'],Ku={key:2,class:'location-children-display'},Uu=['onClick'],Lu={key:3,class:'location-children-input-group'},Fu={class:'selected-children'},ju=['onClick'],Hu=['onChange'],Pu=['value','disabled'],qu={key:4,class:'location-storages-display'},Gu={key:5,class:'location-storages-input-group'},Wu={class:'selected-storages'},Xu=['onClick'],Ju=['onChange'],Zu=['value','disabled'],Qu={key:6,class:'location-description'},ep=['onUpdate:modelValue'],tp={key:0,class:'location-row new-location-row'},ap={class:'location-first-row'},np={class:'location-id-name-group'},op={class:'location-location-row'},rp={class:'location-location-group'},lp={class:'location-parent-input-group'},ip=['value'],dp={class:'location-children-input-group'},sp={class:'selected-children'},cp=['onClick'],up=['value','disabled'],pp={class:'location-storages-input-group'},mp={class:'selected-storages'},vp=['onClick'],gp=['value','disabled'],bp={key:1,class:'no-locations-message'},fp=(0,e.defineComponent)({__name:'location_tab',setup(t){(0,e.useCssVars)(e=>({v77958077:o.value}));const a=(0,e.ref)(0),n=(0,e.ref)(null),o=(0,e.computed)(()=>`calc(100vh - ${a.value}px)`);(0,e.onMounted)(()=>{(async()=>{await(0,e.nextTick)();const t=document.querySelector('.tab-navigation');t&&window.ResizeObserver?(n.value=new ResizeObserver(e=>{for(const t of e)a.value=t.contentRect.height}),n.value.observe(t)):a.value=74})()}),(0,e.onUnmounted)(()=>{n.value&&(n.value.disconnect(),n.value=null)});const r=(0,e.ref)(!1),l=(0,e.ref)(new Set),i=(0,e.ref)({id:'',name:'',location:'',description:'',parent_location_id:null,sub_location_ids:[],storage_ids:[]}),d=(0,e.ref)({}),s=(0,e.ref)({visible:!1,title:'',message:'',confirmText:'ç¢ºèª',cancelText:'å–æ¶ˆ'}),c=(0,e.ref)(null),u=(0,e.ref)(null),p=()=>{u.value&&(u.value.saveAsVariable(getLastMessageId()),m())},m=()=>{try{const e=getLastMessageId();u.value=Yo.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),u.value=null}};m();const v=(0,e.computed)(()=>u.value?.locations||new Map),g=(0,e.computed)(()=>u.value?.storages||new Map),b=(e,t)=>{let a=t;const n=new Set;for(;a;){if(n.has(a))return!0;if(a===e)return!0;n.add(a);const t=v.value.get(a);a=t?.parent_location_id||null}return!1},f=()=>{r.value=!0,i.value={id:'',name:'',location:'',description:'',parent_location_id:null,sub_location_ids:[],storage_ids:[]},i.value.id=(()=>{const e=Array.from(v.value.keys());let t=1;for(;e.includes(`l${t}`);)t++;return`l${t}`})()},h=e=>{if(!(e.id&&e.name&&e.location&&e.description))return null;try{return new zo(e.id,e.name,e.location,e.description,e.parent_location_id,e.sub_location_ids,e.storage_ids)}catch(e){return console.error('Failed to create location:',e),null}},x=()=>{if(!u.value)return;if(u.value.locations.has(i.value.id))return void y();const e=h(i.value);e?(u.value.locations.set(i.value.id,e),p(),y()):y()},y=()=>{r.value=!1,i.value={id:'',name:'',location:'',description:'',parent_location_id:null,sub_location_ids:[],storage_ids:[]}},E=e=>{l.value.delete(e),delete d.value[e]},k=()=>{c.value&&u.value&&(u.value.locations.delete(c.value),p()),s.value.visible=!1,c.value=null},V=()=>{s.value.visible=!1,c.value=null},N=(e,t)=>{e.sub_location_ids.includes(t)||e.sub_location_ids.push(t)},w=(e,t)=>{const a=e.sub_location_ids.indexOf(t);a>-1&&e.sub_location_ids.splice(a,1)},B=(e,t)=>{e.storage_ids.includes(t)||e.storage_ids.push(t)},C=(e,t)=>{const a=e.storage_ids.indexOf(t);a>-1&&e.storage_ids.splice(a,1)},S=e=>{const t=document.getElementById(`location-${e}`);t&&t.scrollIntoView({behavior:'smooth',block:'start'})};return(t,a)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',vu,[(0,e.createElementVNode)('div',gu,[(0,e.createCommentVNode)(' åœ°é»žåˆ—è¡¨æ¨™é¡Œ '),a[16]||(a[16]=(0,e.createElementVNode)('div',{class:'location-section'},[(0,e.createElementVNode)('h3',{class:'section-title'},'åœ°é»žåˆ—è¡¨')],-1)),(0,e.createCommentVNode)(' åœ°é»žåˆ—è¡¨ '),(0,e.createElementVNode)('div',bu,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(v.value,([t,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{id:`location-${t}`,key:t,class:'location-row'},[(0,e.createCommentVNode)(' ç¬¬ä¸€è¡Œï¼šIDã€åç¨±ã€æ“ä½œæŒ‰éˆ• '),(0,e.createElementVNode)('div',hu,[(0,e.createElementVNode)('div',xu,[l.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':e=>d.value[t].id=e,class:'location-id-input',placeholder:'åœ°é»žID'},null,8,_u)),[[e.vModelText,d.value[t].id]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',yu,(0,e.toDisplayString)(t),1)),l.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:3,'onUpdate:modelValue':e=>d.value[t].name=e,class:'location-name-input',placeholder:'åœ°é»žåç¨±'},null,8,ku)),[[e.vModelText,d.value[t].name]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',Eu,(0,e.toDisplayString)(n.name),1))]),(0,e.createElementVNode)('div',Vu,[l.value.has(t)?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:0,class:'edit-location-button',onClick:e=>(e=>{const t=v.value.get(e);t&&(l.value.add(e),d.value[e]={id:e,name:t.name,location:t.location,description:t.description,parent_location_id:t.parent_location_id,sub_location_ids:[...t.sub_location_ids],storage_ids:[...t.storage_ids]})})(t)},' ç·¨è¼¯ ',8,Nu)),l.value.has(t)?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:1,class:'delete-location-button',onClick:e=>(e=>{const t=v.value.get(e);t&&(c.value=e,s.value={visible:!0,title:'ç¢ºèªåˆªé™¤åœ°é»ž',message:`ç¢ºå®šè¦åˆªé™¤åœ°é»ž "${t.name}" å—Žï¼Ÿæ­¤æ“ä½œç„¡æ³•æ’¤éŠ·ã€‚`,confirmText:'åˆªé™¤',cancelText:'å–æ¶ˆ'})})(t)},' åˆªé™¤ ',8,wu))])]),(0,e.createCommentVNode)(' ç¬¬äºŒè¡Œï¼šä½ç½® + ç·¨è¼¯æŒ‰éˆ• '),(0,e.createElementVNode)('div',Bu,[(0,e.createElementVNode)('div',Cu,[a[8]||(a[8]=(0,e.createElementVNode)('span',{class:'location-location-label'},'ä½ç½®ï¼š',-1)),l.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':e=>d.value[t].location=e,class:'location-location-input location-location-input-edit',placeholder:'åœ°é»žä½ç½®'},null,8,Su)),[[e.vModelText,d.value[t].location]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',$u,(0,e.toDisplayString)(n.location),1))]),l.value.has(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',Iu,[(0,e.createElementVNode)('button',{class:'confirm-button',onClick:e=>(e=>{if(!u.value||!d.value[e])return;const t=d.value[e];if(t.id!==e&&u.value.locations.has(t.id))return void E(e);const a=h(t);if(a){const n=u.value.locations.get(e);n&&(t.id!==e?(u.value.locations.delete(e),u.value.locations.set(t.id,a)):(n.name=a.name,n.location=a.location,n.description=a.description,n.parent_location_id=a.parent_location_id,n.sub_location_ids=a.sub_location_ids,n.storage_ids=a.storage_ids),p()),E(e)}else E(e)})(t)},'ä¿å­˜',8,zu),(0,e.createElementVNode)('button',{class:'cancel-button',onClick:e=>E(t)},'å–æ¶ˆ',8,Du)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createCommentVNode)(' ç¬¬ä¸‰è¡Œï¼šçˆ¶åœ°é»ž '),l.value.has(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ou,[(0,e.withDirectives)((0,e.createElementVNode)('select',{'onUpdate:modelValue':e=>d.value[t].parent_location_id=e,class:'parent-location-select'},[a[9]||(a[9]=(0,e.createElementVNode)('option',{value:null},'æ ¹åœ°é»ž',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(v.value,([a,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:a,value:a,disabled:a===t||b(t,a)},(0,e.toDisplayString)(n.name)+' ('+(0,e.toDisplayString)(a)+') ',9,Ru))),128))],8,Au),[[e.vModelSelect,d.value[t].parent_location_id]])])):((0,e.openBlock)(),(0,e.createElementBlock)('div',Tu,[n.parent_location_id?((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:0,class:'location-parent-tag',onClick:e=>S(n.parent_location_id)},' çˆ¶: '+(0,e.toDisplayString)(n.parent_location_id)+' '+(0,e.toDisplayString)(v.value.get(n.parent_location_id)?.name||n.parent_location_id),9,Mu)):((0,e.openBlock)(),(0,e.createElementBlock)('span',Yu,'æ ¹åœ°é»ž'))])),(0,e.createCommentVNode)(' ç¬¬å››è¡Œï¼šå­åœ°é»ž '),l.value.has(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',Lu,[(0,e.createElementVNode)('div',Fu,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(d.value[t].sub_location_ids,a=>((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:a,class:'selected-child-tag'},[(0,e.createTextVNode)((0,e.toDisplayString)(v.value.get(a)?.name||a)+' ',1),(0,e.createElementVNode)('button',{class:'remove-child-btn',onClick:e=>w(d.value[t],a)},' Ã— ',8,ju)]))),128))]),(0,e.createElementVNode)('select',{class:'child-location-select',onChange:e=>{N(d.value[t],e.target.value),e.target.value=''}},[a[10]||(a[10]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡å­åœ°é»ž...',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(v.value,([a,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:a,value:a,disabled:d.value[t].sub_location_ids.includes(a)||a===t||b(a,t)},(0,e.toDisplayString)(n.name)+' ('+(0,e.toDisplayString)(a)+') ',9,Pu))),128))],40,Hu)])):((0,e.openBlock)(),(0,e.createElementBlock)('div',Ku,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(n.sub_location_ids,t=>((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:t,class:'location-child-tag',onClick:e=>S(t)},' å­: '+(0,e.toDisplayString)(t)+' '+(0,e.toDisplayString)(v.value.get(t)?.name||t),9,Uu))),128))])),(0,e.createCommentVNode)(' ç¬¬äº”è¡Œï¼šè²¯å­˜é»ž '),l.value.has(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',Gu,[(0,e.createElementVNode)('div',Wu,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(d.value[t].storage_ids,a=>((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:a,class:'selected-storage-tag'},[(0,e.createTextVNode)((0,e.toDisplayString)(g.value.get(a)?.name||a)+' ',1),(0,e.createElementVNode)('button',{class:'remove-storage-btn',onClick:e=>C(d.value[t],a)},' Ã— ',8,Xu)]))),128))]),(0,e.createElementVNode)('select',{class:'storage-location-select',onChange:e=>{B(d.value[t],e.target.value),e.target.value=''}},[a[11]||(a[11]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡è²¯å­˜é»ž...',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(g.value,([a,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:a,value:a,disabled:d.value[t].storage_ids.includes(a)},(0,e.toDisplayString)(n.name)+' ('+(0,e.toDisplayString)(a)+') ',9,Zu))),128))],40,Ju)])):((0,e.openBlock)(),(0,e.createElementBlock)('div',qu,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(n.storage_ids,t=>((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:t,class:'location-storage-tag'},' è²¯: '+(0,e.toDisplayString)(t)+' '+(0,e.toDisplayString)(g.value.get(t)?.name||t),1))),128))])),(0,e.createCommentVNode)(' ç¬¬äº”è¡Œï¼šæè¿° '),l.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:7,'onUpdate:modelValue':e=>d.value[t].description=e,class:'location-description-input',placeholder:'åœ°é»žæè¿°'},null,8,ep)),[[e.vModelText,d.value[t].description]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',Qu,(0,e.toDisplayString)(n.description),1))],8,fu))),128)),(0,e.createCommentVNode)(' æ–°åœ°é»žç·¨è¼¯è¡Œ '),r.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',tp,[(0,e.createCommentVNode)(' ç¬¬ä¸€è¡Œï¼šIDã€åç¨± '),(0,e.createElementVNode)('div',ap,[(0,e.createElementVNode)('div',np,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>i.value.id=e),class:'location-id-input',placeholder:'åœ°é»žID'},null,512),[[e.vModelText,i.value.id]]),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>i.value.name=e),class:'location-name-input',placeholder:'åœ°é»žåç¨±'},null,512),[[e.vModelText,i.value.name]])])]),(0,e.createCommentVNode)(' ç¬¬äºŒè¡Œï¼šä½ç½® + æ·»åŠ æŒ‰éˆ• '),(0,e.createElementVNode)('div',op,[(0,e.createElementVNode)('div',rp,[a[12]||(a[12]=(0,e.createElementVNode)('span',{class:'location-location-label'},'ä½ç½®ï¼š',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>i.value.location=e),class:'location-location-input location-location-input-edit',placeholder:'åœ°é»žä½ç½®'},null,512),[[e.vModelText,i.value.location]])]),(0,e.createElementVNode)('div',{class:'location-edit-actions'},[(0,e.createElementVNode)('button',{class:'confirm-button',onClick:x},'æ·»åŠ '),(0,e.createElementVNode)('button',{class:'cancel-button',onClick:y},'å–æ¶ˆ')])]),(0,e.createCommentVNode)(' ç¬¬ä¸‰è¡Œï¼šçˆ¶åœ°é»ž '),(0,e.createElementVNode)('div',lp,[(0,e.withDirectives)((0,e.createElementVNode)('select',{'onUpdate:modelValue':a[3]||(a[3]=e=>i.value.parent_location_id=e),class:'parent-location-select'},[a[13]||(a[13]=(0,e.createElementVNode)('option',{value:null},'æ ¹åœ°é»ž',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(v.value,([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t,value:t},(0,e.toDisplayString)(a.name)+' ('+(0,e.toDisplayString)(t)+') ',9,ip))),128))],512),[[e.vModelSelect,i.value.parent_location_id]])]),(0,e.createCommentVNode)(' ç¬¬å››è¡Œï¼šå­åœ°é»ž '),(0,e.createElementVNode)('div',dp,[(0,e.createElementVNode)('div',sp,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(i.value.sub_location_ids,t=>((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:t,class:'selected-child-tag'},[(0,e.createTextVNode)((0,e.toDisplayString)(v.value.get(t)?.name||t)+' ',1),(0,e.createElementVNode)('button',{class:'remove-child-btn',onClick:e=>w(i.value,t)},'Ã—',8,cp)]))),128))]),(0,e.createElementVNode)('select',{class:'child-location-select',onChange:a[4]||(a[4]=e=>{N(i.value,e.target.value),e.target.value=''})},[a[14]||(a[14]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡å­åœ°é»ž...',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(v.value,([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t,value:t,disabled:i.value.sub_location_ids.includes(t)||t===i.value.id},(0,e.toDisplayString)(a.name)+' ('+(0,e.toDisplayString)(t)+') ',9,up))),128))],32)]),(0,e.createCommentVNode)(' ç¬¬äº”è¡Œï¼šè²¯å­˜é»ž '),(0,e.createElementVNode)('div',pp,[(0,e.createElementVNode)('div',mp,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(i.value.storage_ids,t=>((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:t,class:'selected-storage-tag'},[(0,e.createTextVNode)((0,e.toDisplayString)(g.value.get(t)?.name||t)+' ',1),(0,e.createElementVNode)('button',{class:'remove-storage-btn',onClick:e=>C(i.value,t)},'Ã—',8,vp)]))),128))]),(0,e.createElementVNode)('select',{class:'storage-location-select',onChange:a[5]||(a[5]=e=>{B(i.value,e.target.value),e.target.value=''})},[a[15]||(a[15]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡è²¯å­˜é»ž...',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(g.value,([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t,value:t,disabled:i.value.storage_ids.includes(t)},(0,e.toDisplayString)(a.name)+' ('+(0,e.toDisplayString)(t)+') ',9,gp))),128))],32)]),(0,e.createCommentVNode)(' ç¬¬å…­è¡Œï¼šæè¿° '),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':a[6]||(a[6]=e=>i.value.description=e),class:'location-description-input',placeholder:'åœ°é»žæè¿°'},null,512),[[e.vModelText,i.value.description]])])):(0,e.createCommentVNode)('v-if',!0),0!==v.value.size||r.value?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('div',bp,'æ²’æœ‰ä»»ä½•åœ°é»ž')),r.value?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:2,class:'add-location-button',onClick:f},'+ æ·»åŠ åœ°é»ž'))]),(0,e.createCommentVNode)(' ç¢ºèªçª—å£ '),(0,e.createVNode)(Gi,{'confirm-dialog':s.value,'onUpdate:confirmDialog':a[7]||(a[7]=e=>s.value=e),onConfirmDialogConfirm:k,onConfirmDialogCancel:V},null,8,['confirm-dialog'])])]))}});i(1500);const hp=(0,d.A)(fp,[['__scopeId','data-v-bd354e5e']]),xp={class:'storage-tab-container'},yp={class:'storage-content'},_p={class:'storage-list'},Ep=['id'],kp={class:'storage-first-row'},Vp={class:'storage-id-name-group'},Np={key:0,class:'storage-id'},wp=['onUpdate:modelValue'],Bp={key:2,class:'storage-name'},Cp=['onUpdate:modelValue'],$p={class:'storage-actions'},Sp=['onClick'],Ip=['onClick'],zp={class:'storage-money-row'},Dp={class:'storage-money-group'},Tp={key:0,class:'storage-money'},Mp=['onUpdate:modelValue','onInput'],Yp={key:0,class:'storage-edit-actions'},Op=['disabled','onClick'],Ap=['onClick'],Rp={key:0,class:'storage-parent-display'},Kp={class:'storage-parent-tag'},Up={key:1,class:'storage-parent-input-group'},Lp=['onUpdate:modelValue'],Fp={label:'è§’è‰²'},jp=['value'],Hp={label:'åœ°é»ž'},Pp=['value'],qp={label:'è²¯å­˜é»ž'},Gp=['value','disabled'],Wp={key:2,class:'storage-inventory-display'},Xp={key:0,class:'no-inventory'},Jp={key:1,class:'inventory-items'},Zp={key:3,class:'storage-inventory-input-group'},Qp={class:'selected-inventory'},em={class:'item-name'},tm={key:0,class:'storage-indicator'},am={key:1,class:'inventory-edit-connector'},nm=['onUpdate:modelValue','onInput'],om=['onClick'],rm=['onChange'],lm={label:'ç‰©å“'},im=['value','disabled'],dm={label:'è²¯å­˜é»ž'},sm=['value','disabled'],cm={key:4,class:'storage-description'},um=['onUpdate:modelValue'],pm={key:0,class:'storage-row new-storage-row'},mm={class:'storage-first-row'},vm={class:'storage-id-name-group'},gm={class:'storage-money-row'},bm={class:'storage-money-group'},fm={class:'storage-edit-actions'},hm=['disabled'],xm={class:'storage-parent-input-group'},ym={label:'è§’è‰²'},_m=['value'],Em={label:'åœ°é»ž'},km=['value'],Vm={label:'è²¯å­˜é»ž'},Nm=['value'],wm={class:'storage-inventory-input-group'},Bm={class:'selected-inventory'},Cm={class:'item-name'},$m={key:0,class:'storage-indicator'},Sm={key:1,class:'inventory-edit-connector'},Im=['onUpdate:modelValue','onInput'],zm=['onClick'],Dm={label:'ç‰©å“'},Tm=['value','disabled'],Mm={label:'è²¯å­˜é»ž'},Ym=['value','disabled'],Om={key:1,class:'no-storages-message'},Am=(0,e.defineComponent)({__name:'storage_tab',setup(t){(0,e.useCssVars)(e=>({v4efc9d77:o.value}));const a=(0,e.ref)(0),n=(0,e.ref)(null),o=(0,e.computed)(()=>`calc(100vh - ${a.value}px)`);(0,e.onMounted)(()=>{(async()=>{await(0,e.nextTick)();const t=document.querySelector('.tab-navigation');t&&window.ResizeObserver?(n.value=new ResizeObserver(e=>{for(const t of e)a.value=t.contentRect.height}),n.value.observe(t)):a.value=74})()}),(0,e.onUnmounted)(()=>{n.value&&(n.value.disconnect(),n.value=null)});const r=(0,e.ref)(!1),l=(0,e.ref)(new Set),i=(0,e.ref)({id:'',name:'',description:'',parent_id:'',money:0,inventory:{}}),d=(0,e.ref)({}),s=(0,e.ref)({visible:!1,title:'',message:'',confirmText:'ç¢ºèª',cancelText:'å–æ¶ˆ'}),c=(0,e.ref)(null),u=e=>p.value?.storages.has(e)||!1,p=(0,e.ref)(null),m=()=>{p.value&&(p.value.saveAsVariable(getLastMessageId()),v())},v=()=>{try{const e=getLastMessageId();p.value=Yo.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),p.value=null}};v();const g=(0,e.computed)(()=>p.value?.storages||new Map),b=(0,e.computed)(()=>p.value?.active_characters||new Map),f=(0,e.computed)(()=>p.value?.locations||new Map),h=(0,e.computed)(()=>p.value?.items||new Map),x=()=>{r.value=!0,i.value={id:'',name:'',description:'',parent_id:'',money:0,inventory:{}}},y=e=>{if(!e.id||!e.name||!e.description||e.money<0)return null;if(!(b.value.has(e.parent_id)||f.value.has(e.parent_id)||g.value.has(e.parent_id)))return null;for(const t in e.inventory){const a=h.value.has(t)||g.value.has(t),n=g.value.has(t)?1:e.inventory[t];if(!a||n<1)return null}try{const t=new Map;for(const[a,n]of Object.entries(e.inventory)){const e=g.value.has(a)?1:n;t.set(a,e)}return new To(e.name,e.description,e.parent_id,e.money,t)}catch(e){return console.error('Failed to create storage:',e),null}},E=()=>{if(!p.value)return;if(p.value.storages.has(i.value.id))return void k();const e=y(i.value);e?(p.value.storages.set(i.value.id,e),m(),k()):k()},k=()=>{r.value=!1,i.value={id:'',name:'',description:'',parent_id:'',money:0,inventory:{}}},V=e=>{l.value.delete(e),delete d.value[e]},N=()=>{c.value&&p.value&&(p.value.storages.delete(c.value),m()),s.value.visible=!1,c.value=null},w=()=>{s.value.visible=!1,c.value=null},B=(e,t)=>{t in e.inventory||(e.inventory[t]=1)},C=(e,t)=>{delete e.inventory[t]};return(t,a)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',xp,[(0,e.createElementVNode)('div',yp,[(0,e.createCommentVNode)(' è²¯å­˜é»žåˆ—è¡¨æ¨™é¡Œ '),a[14]||(a[14]=(0,e.createElementVNode)('div',{class:'storage-section'},[(0,e.createElementVNode)('h3',{class:'section-title'},'è²¯å­˜é»žåˆ—è¡¨')],-1)),(0,e.createCommentVNode)(' è²¯å­˜é»žåˆ—è¡¨ '),(0,e.createElementVNode)('div',_p,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(g.value,([t,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{id:`storage-${t}`,key:t,class:'storage-row'},[(0,e.createCommentVNode)(' ç¬¬ä¸€è¡Œï¼šIDã€åç¨±ã€æ“ä½œæŒ‰éˆ• '),(0,e.createElementVNode)('div',kp,[(0,e.createElementVNode)('div',Vp,[l.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':e=>d.value[t].id=e,class:'storage-id-input',placeholder:'è²¯å­˜é»žID'},null,8,wp)),[[e.vModelText,d.value[t].id]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',Np,(0,e.toDisplayString)(t),1)),l.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:3,'onUpdate:modelValue':e=>d.value[t].name=e,class:'storage-name-input',placeholder:'è²¯å­˜é»žåç¨±'},null,8,Cp)),[[e.vModelText,d.value[t].name]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',Bp,(0,e.toDisplayString)(n.name),1))]),(0,e.createElementVNode)('div',$p,[l.value.has(t)?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:0,class:'edit-storage-button',onClick:e=>(e=>{const t=g.value.get(e);t&&(l.value.add(e),d.value[e]={id:e,name:t.name,description:t.description,parent_id:t.parent_id,money:t.money,inventory:Object.fromEntries(t.inventory)})})(t)},' ç·¨è¼¯ ',8,Sp)),l.value.has(t)?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:1,class:'delete-storage-button',onClick:e=>(e=>{const t=g.value.get(e);t&&(c.value=e,s.value={visible:!0,title:'ç¢ºèªåˆªé™¤è²¯å­˜é»ž',message:`ç¢ºå®šè¦åˆªé™¤è²¯å­˜é»ž "${t.name}" å—Žï¼Ÿæ­¤æ“ä½œç„¡æ³•æ’¤éŠ·ã€‚`,confirmText:'åˆªé™¤',cancelText:'å–æ¶ˆ'})})(t)},' åˆªé™¤ ',8,Ip))])]),(0,e.createCommentVNode)(' ç¬¬äºŒè¡Œï¼šé‡‘éŒ¢ + ç·¨è¼¯æŒ‰éˆ• '),(0,e.createElementVNode)('div',zp,[(0,e.createElementVNode)('div',Dp,[a[8]||(a[8]=(0,e.createElementVNode)('span',{class:'storage-money-label'},'è²¯å­˜é‡‘é¡ï¼š',-1)),l.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':e=>d.value[t].money=e,type:'number',class:'storage-money-input storage-money-input-edit',placeholder:'é‡‘éŒ¢æ•¸é‡',min:'0',onInput:e=>d.value[t].money=Math.max(0,parseInt(e.target.value)||0)},null,40,Mp)),[[e.vModelText,d.value[t].money,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',Tp,'$'+(0,e.toDisplayString)(n.money),1))]),l.value.has(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',Yp,[(0,e.createElementVNode)('button',{class:'confirm-button',disabled:!d.value[t].id||!d.value[t].name||!d.value[t].parent_id,onClick:e=>(e=>{if(!p.value||!d.value[e])return;const t=d.value[e];if(t.id!==e&&p.value.storages.has(t.id))return void V(e);const a=y(t);if(a){const n=p.value.storages.get(e);n&&(t.id!==e?(p.value.storages.delete(e),p.value.storages.set(t.id,a)):(n.name=a.name,n.description=a.description,n.parent_id=a.parent_id,n.money=a.money,n.inventory=a.inventory),m()),V(e)}else V(e)})(t)},' ä¿å­˜ ',8,Op),(0,e.createElementVNode)('button',{class:'cancel-button',onClick:e=>V(t)},'å–æ¶ˆ',8,Ap)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createCommentVNode)(' ç¬¬ä¸‰è¡Œï¼šçˆ¶ç´š '),l.value.has(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',Up,[(0,e.withDirectives)((0,e.createElementVNode)('select',{'onUpdate:modelValue':e=>d.value[t].parent_id=e,class:'parent-select'},[a[9]||(a[9]=(0,e.createElementVNode)('option',{value:'',disabled:''},'é¸æ“‡çˆ¶ç´š (è§’è‰²ã€åœ°é»žæˆ–è²¯å­˜é»ž)...',-1)),(0,e.createElementVNode)('optgroup',Fp,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(b.value,([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:`char-${t}`,value:t},(0,e.toDisplayString)(a.name)+' ('+(0,e.toDisplayString)(t)+') ',9,jp))),128))]),(0,e.createElementVNode)('optgroup',Hp,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(f.value,([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:`loc-${t}`,value:t},(0,e.toDisplayString)(a.name)+' ('+(0,e.toDisplayString)(t)+') ',9,Pp))),128))]),(0,e.createElementVNode)('optgroup',qp,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(g.value,([a,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:`storage-${a}`,value:a,disabled:a===t},(0,e.toDisplayString)(n.name)+' ('+(0,e.toDisplayString)(a)+') ',9,Gp))),128))])],8,Lp),[[e.vModelSelect,d.value[t].parent_id]])])):((0,e.openBlock)(),(0,e.createElementBlock)('div',Rp,[(0,e.createElementVNode)('span',Kp,(0,e.toDisplayString)(n.parent_id)+' '+(0,e.toDisplayString)(b.value.get(n.parent_id)?.name||f.value.get(n.parent_id)?.name||g.value.get(n.parent_id)?.name||n.parent_id),1)])),(0,e.createCommentVNode)(' ç¬¬å››è¡Œï¼šåº«å­˜ '),l.value.has(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',Zp,[(0,e.createElementVNode)('div',Qp,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(Object.keys(d.value[t].inventory),a=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:a,class:'selected-inventory-item'},[(0,e.createElementVNode)('span',em,(0,e.toDisplayString)(h.value.get(a)?.name||g.value.get(a)?.name||a),1),u(a)?((0,e.openBlock)(),(0,e.createElementBlock)('span',tm,'è²¯å­˜é»ž')):(0,e.createCommentVNode)('v-if',!0),u(a)?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('span',am,'Ã—')),u(a)?(0,e.createCommentVNode)('v-if',!0):(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:2,'onUpdate:modelValue':e=>d.value[t].inventory[a]=e,type:'number',class:'item-quantity-input',placeholder:'æ•¸é‡',min:'1',step:'1',onInput:e=>d.value[t].inventory[a]=Math.max(1,parseInt(e.target.value)||1)},null,40,nm)),[[e.vModelText,d.value[t].inventory[a],void 0,{number:!0}]]),(0,e.createElementVNode)('button',{class:'remove-item-btn',onClick:e=>C(d.value[t],a)},'Ã—',8,om)]))),128))]),(0,e.createElementVNode)('select',{class:'item-select',onChange:e=>{B(d.value[t],e.target.value),e.target.value=''}},[a[10]||(a[10]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡ç‰©å“æˆ–è²¯å­˜é»ž...',-1)),(0,e.createElementVNode)('optgroup',lm,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(h.value,([a,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:a,value:a,disabled:d.value[t].inventory.hasOwnProperty(a)},(0,e.toDisplayString)(n.name)+' ('+(0,e.toDisplayString)(a)+') ',9,im))),128))]),(0,e.createElementVNode)('optgroup',dm,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(g.value,([a,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:a,value:a,disabled:d.value[t].inventory.hasOwnProperty(a)||a===t},(0,e.toDisplayString)(n.name)+' ('+(0,e.toDisplayString)(a)+') ',9,sm))),128))])],40,rm)])):((0,e.openBlock)(),(0,e.createElementBlock)('div',Wp,[0===n.inventory.size?((0,e.openBlock)(),(0,e.createElementBlock)('div',Xp,'ç„¡ç‰©å“')):((0,e.openBlock)(),(0,e.createElementBlock)('div',Jp,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(n.inventory,([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:t,class:(0,e.normalizeClass)(g.value.has(t)?'storage-item-tag':'inventory-item-tag')},(0,e.toDisplayString)(h.value.get(t)?.name||g.value.get(t)?.name||t)+' ('+(0,e.toDisplayString)(t)+')'+(0,e.toDisplayString)(g.value.has(t)?'':` Ã— ${a}`),3))),128))]))])),(0,e.createCommentVNode)(' ç¬¬äº”è¡Œï¼šæè¿° '),l.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:5,'onUpdate:modelValue':e=>d.value[t].description=e,class:'storage-description-input',placeholder:'è²¯å­˜é»žæè¿°'},null,8,um)),[[e.vModelText,d.value[t].description]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',cm,(0,e.toDisplayString)(n.description),1))],8,Ep))),128)),(0,e.createCommentVNode)(' æ–°è²¯å­˜é»žç·¨è¼¯è¡Œ '),r.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',pm,[(0,e.createCommentVNode)(' ç¬¬ä¸€è¡Œï¼šIDã€åç¨± '),(0,e.createElementVNode)('div',mm,[(0,e.createElementVNode)('div',vm,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>i.value.id=e),class:'storage-id-input',placeholder:'è²¯å­˜é»žID'},null,512),[[e.vModelText,i.value.id]]),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>i.value.name=e),class:'storage-name-input',placeholder:'è²¯å­˜é»žåç¨±'},null,512),[[e.vModelText,i.value.name]])])]),(0,e.createCommentVNode)(' ç¬¬äºŒè¡Œï¼šé‡‘éŒ¢ + æ·»åŠ æŒ‰éˆ• '),(0,e.createElementVNode)('div',gm,[(0,e.createElementVNode)('div',bm,[a[11]||(a[11]=(0,e.createElementVNode)('span',{class:'storage-money-label'},'è²¯å­˜é‡‘é¡ï¼š',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>i.value.money=e),type:'number',class:'storage-money-input storage-money-input-edit',placeholder:'é‡‘éŒ¢æ•¸é‡',min:'0',onInput:a[3]||(a[3]=e=>i.value.money=Math.max(0,parseInt(e.target.value)||0))},null,544),[[e.vModelText,i.value.money,void 0,{number:!0}]])]),(0,e.createElementVNode)('div',fm,[(0,e.createElementVNode)('button',{class:'confirm-button',disabled:!i.value.id||!i.value.name||!i.value.parent_id,onClick:E},' æ·»åŠ  ',8,hm),(0,e.createElementVNode)('button',{class:'cancel-button',onClick:k},'å–æ¶ˆ')])]),(0,e.createCommentVNode)(' ç¬¬ä¸‰è¡Œï¼šçˆ¶ç´š '),(0,e.createElementVNode)('div',xm,[(0,e.withDirectives)((0,e.createElementVNode)('select',{'onUpdate:modelValue':a[4]||(a[4]=e=>i.value.parent_id=e),class:'parent-select'},[a[12]||(a[12]=(0,e.createElementVNode)('option',{value:'',disabled:''},'é¸æ“‡çˆ¶ç´š (è§’è‰²ã€åœ°é»žæˆ–è²¯å­˜é»ž)...',-1)),(0,e.createElementVNode)('optgroup',ym,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(b.value,([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:`char-${t}`,value:t},(0,e.toDisplayString)(a.name)+' ('+(0,e.toDisplayString)(t)+') ',9,_m))),128))]),(0,e.createElementVNode)('optgroup',Em,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(f.value,([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:`loc-${t}`,value:t},(0,e.toDisplayString)(a.name)+' ('+(0,e.toDisplayString)(t)+') ',9,km))),128))]),(0,e.createElementVNode)('optgroup',Vm,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(g.value,([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:`storage-${t}`,value:t},(0,e.toDisplayString)(a.name)+' ('+(0,e.toDisplayString)(t)+') ',9,Nm))),128))])],512),[[e.vModelSelect,i.value.parent_id]])]),(0,e.createCommentVNode)(' ç¬¬å››è¡Œï¼šåº«å­˜ '),(0,e.createElementVNode)('div',wm,[(0,e.createElementVNode)('div',Bm,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(Object.keys(i.value.inventory),t=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'selected-inventory-item'},[(0,e.createElementVNode)('span',Cm,(0,e.toDisplayString)(h.value.get(t)?.name||g.value.get(t)?.name||t),1),u(t)?((0,e.openBlock)(),(0,e.createElementBlock)('span',$m,'è²¯å­˜é»ž')):(0,e.createCommentVNode)('v-if',!0),u(t)?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('span',Sm,'Ã—')),u(t)?(0,e.createCommentVNode)('v-if',!0):(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:2,'onUpdate:modelValue':e=>i.value.inventory[t]=e,type:'number',class:'item-quantity-input',placeholder:'æ•¸é‡',min:'1',step:'1',onInput:e=>i.value.inventory[t]=Math.max(1,parseInt(e.target.value)||1)},null,40,Im)),[[e.vModelText,i.value.inventory[t],void 0,{number:!0}]]),(0,e.createElementVNode)('button',{class:'remove-item-btn',onClick:e=>C(i.value,t)},'Ã—',8,zm)]))),128))]),(0,e.createElementVNode)('select',{class:'item-select',onChange:a[5]||(a[5]=e=>{B(i.value,e.target.value),e.target.value=''})},[a[13]||(a[13]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡ç‰©å“æˆ–è²¯å­˜é»ž...',-1)),(0,e.createElementVNode)('optgroup',Dm,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(h.value,([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t,value:t,disabled:i.value.inventory.hasOwnProperty(t)},(0,e.toDisplayString)(a.name)+' ('+(0,e.toDisplayString)(t)+') ',9,Tm))),128))]),(0,e.createElementVNode)('optgroup',Mm,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(g.value,([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t,value:t,disabled:i.value.inventory.hasOwnProperty(t)},(0,e.toDisplayString)(a.name)+' ('+(0,e.toDisplayString)(t)+') ',9,Ym))),128))])],32)]),(0,e.createCommentVNode)(' ç¬¬äº”è¡Œï¼šæè¿° '),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':a[6]||(a[6]=e=>i.value.description=e),class:'storage-description-input',placeholder:'è²¯å­˜é»žæè¿°'},null,512),[[e.vModelText,i.value.description]])])):(0,e.createCommentVNode)('v-if',!0),0!==g.value.size||r.value?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('div',Om,'æ²’æœ‰ä»»ä½•è²¯å­˜é»ž')),r.value?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:2,class:'add-storage-button',onClick:x},'+ æ·»åŠ è²¯å­˜é»ž'))]),(0,e.createCommentVNode)(' ç¢ºèªçª—å£ '),(0,e.createVNode)(Gi,{'confirm-dialog':s.value,'onUpdate:confirmDialog':a[7]||(a[7]=e=>s.value=e),onConfirmDialogConfirm:N,onConfirmDialogCancel:w},null,8,['confirm-dialog'])])]))}});i(6482);const Rm=(0,d.A)(Am,[['__scopeId','data-v-62b84623']]),Km={class:'promise-tab-container'},Um={class:'promise-content'},Lm={class:'promise-list'},Fm={class:'promise-first-row'},jm={class:'promise-id-name-group'},Hm={key:0,class:'promise-id'},Pm=['onUpdate:modelValue'],qm={key:2,class:'promise-deadline'},Gm={key:3,class:'promise-deadline-input-group'},Wm=['onUpdate:modelValue','onInput'],Xm=['onUpdate:modelValue','onInput'],Jm=['onUpdate:modelValue','onInput'],Zm=['onUpdate:modelValue','onInput'],Qm=['onUpdate:modelValue','onInput'],ev={class:'promise-actions'},tv=['onClick'],av=['onClick'],nv={class:'promise-location-row'},ov={class:'promise-location-group'},rv={key:0,class:'promise-location'},lv=['onUpdate:modelValue'],iv=['value'],dv={key:0,class:'promise-edit-actions'},sv=['onClick'],cv=['onClick'],uv={key:0,class:'promise-character-ids-display'},pv={key:1,class:'promise-character-ids-input-group'},mv={class:'selected-characters'},vv=['onClick'],gv=['onChange'],bv=['value','disabled'],fv={key:2,class:'promise-description'},hv=['onUpdate:modelValue'],xv={key:0,class:'promise-row new-promise-row'},yv={class:'promise-first-row'},_v={class:'promise-id-name-group'},Ev={class:'promise-deadline-input-group'},kv={class:'promise-location-row'},Vv={class:'promise-location-group'},Nv=['value'],wv={class:'promise-character-ids-input-group'},Bv={class:'selected-characters'},Cv=['onClick'],$v=['value','disabled'],Sv={key:1,class:'no-promises-message'},Iv=(0,e.defineComponent)({__name:'promise_tab',setup(t){(0,e.useCssVars)(e=>({v592213a0:o.value}));const a=(0,e.ref)(0),n=(0,e.ref)(null),o=(0,e.computed)(()=>`calc(100vh - ${a.value}px)`);(0,e.onMounted)(()=>{(async()=>{await(0,e.nextTick)();const t=document.querySelector('.tab-navigation');t&&window.ResizeObserver?(n.value=new ResizeObserver(e=>{for(const t of e)a.value=t.contentRect.height}),n.value.observe(t)):a.value=74})()}),(0,e.onUnmounted)(()=>{n.value&&(n.value.disconnect(),n.value=null)});const r=e=>{const t=e.toDate();return{year:t.getFullYear().toString(),month:(t.getMonth()+1).toString(),day:t.getDate().toString(),hour:t.getHours().toString(),minute:t.getMinutes().toString()}},l=(0,e.ref)(!1),i=(0,e.ref)(new Set),d=(0,e.ref)({id:'',deadline:{year:'',month:'',day:'',hour:'',minute:''},location_id:'',character_ids:[],description:''}),s=(0,e.ref)({}),c=(0,e.ref)({visible:!1,title:'',message:'',confirmText:'ç¢ºèª',cancelText:'å–æ¶ˆ'}),u=(0,e.ref)(null),p=(0,e.ref)(null),m=()=>{p.value&&(p.value.saveAsVariable(getLastMessageId()),v())},v=()=>{try{const e=getLastMessageId();p.value=Yo.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),p.value=null}};v();const g=(0,e.computed)(()=>p.value?.promises||new Map),b=(0,e.computed)(()=>{if(!p.value)return[];const e=new Map;for(const[t,a]of p.value.active_characters)e.set(t,a.name);for(const[t,a]of p.value.deactive_characters)e.set(t,a.name);return Array.from(e.entries()).map(([e,t])=>({id:e,name:t}))}),f=(0,e.computed)(()=>p.value?Array.from(p.value.locations.values()):[]),h=()=>{l.value=!0,d.value={id:'',deadline:{year:'',month:'',day:'',hour:'',minute:''},location_id:'',character_ids:[],description:''},d.value.id=(()=>{const e=Array.from(g.value.keys());let t=1;for(;e.includes(`p${t}`);)t++;return`p${t}`})()},x=e=>{if(!e.id||!e.deadline||!e.description)return null;try{const t=(e=>{const t=parseInt(e.year)||(new Date).getFullYear(),a=parseInt(e.month)||1,n=parseInt(e.day)||1,o=parseInt(e.hour)||0,r=parseInt(e.minute)||0;return new $o(new Date(t,a-1,n,o,r,0))})(e.deadline),a=e.character_ids.filter(e=>e),n=e.location_id||null;return new Do(t,a,n,e.description)}catch(e){return console.error('Failed to create promise:',e),null}},y=()=>{if(!p.value)return;if(p.value.promises.has(d.value.id))return void E();const e=x(d.value);e?(p.value.promises.set(d.value.id,e),m(),E()):E()},E=()=>{l.value=!1,d.value={id:'',deadline:{year:'',month:'',day:'',hour:'',minute:''},location_id:'',character_ids:[],description:''}},k=e=>{i.value.delete(e),delete s.value[e]},V=()=>{u.value&&p.value&&(p.value.promises.delete(u.value),m()),c.value.visible=!1,u.value=null},N=()=>{c.value.visible=!1,u.value=null},w=(e,t)=>{e.character_ids.includes(t)||e.character_ids.push(t)},B=(e,t)=>{const a=e.character_ids.indexOf(t);a>-1&&e.character_ids.splice(a,1)},C=(e,t,a)=>{const n=parseInt(e);return isNaN(n)?'':Math.min(Math.max(n,t),a).toString()},S=e=>{const t=e.toDate();return`${t.getFullYear()}å¹´${t.getMonth()+1}æœˆ${t.getDate()}æ—¥ ${t.getHours().toString().padStart(2,'0')}:${t.getMinutes().toString().padStart(2,'0')}`};return(t,a)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',Km,[(0,e.createElementVNode)('div',Um,[(0,e.createCommentVNode)(' ç´„å®šåˆ—è¡¨æ¨™é¡Œ '),a[31]||(a[31]=(0,e.createElementVNode)('div',{class:'promise-section'},[(0,e.createElementVNode)('h3',{class:'section-title'},'ç´„å®šåˆ—è¡¨')],-1)),(0,e.createCommentVNode)(' ç´„å®šåˆ—è¡¨ '),(0,e.createElementVNode)('div',Lm,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(g.value,([t,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'promise-row'},[(0,e.createCommentVNode)(' ç¬¬ä¸€è¡Œï¼šIDã€æˆªæ­¢æ—¥æœŸã€æ“ä½œæŒ‰éˆ• '),(0,e.createElementVNode)('div',Fm,[(0,e.createElementVNode)('div',jm,[i.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':e=>s.value[t].id=e,class:'promise-id-input',placeholder:'ç´„å®šID'},null,8,Pm)),[[e.vModelText,s.value[t].id]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',Hm,(0,e.toDisplayString)(t),1)),i.value.has(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',Gm,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>s.value[t].deadline.year=e,type:'number',placeholder:'å¹´',class:'promise-deadline-input promise-deadline-year-input',onInput:e=>s.value[t].deadline.year=C(s.value[t].deadline.year.toString(),0,Number.MAX_SAFE_INTEGER)},null,40,Wm),[[e.vModelText,s.value[t].deadline.year,void 0,{number:!0}]]),a[15]||(a[15]=(0,e.createElementVNode)('span',null,'å¹´',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>s.value[t].deadline.month=e,type:'number',placeholder:'æœˆ',class:'promise-deadline-input',onInput:e=>s.value[t].deadline.month=C(s.value[t].deadline.month.toString(),1,12)},null,40,Xm),[[e.vModelText,s.value[t].deadline.month,void 0,{number:!0}]]),a[16]||(a[16]=(0,e.createElementVNode)('span',null,'æœˆ',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>s.value[t].deadline.day=e,type:'number',placeholder:'æ—¥',class:'promise-deadline-input',onInput:e=>s.value[t].deadline.day=C(s.value[t].deadline.day.toString(),1,31)},null,40,Jm),[[e.vModelText,s.value[t].deadline.day,void 0,{number:!0}]]),a[17]||(a[17]=(0,e.createElementVNode)('span',null,'æ—¥',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>s.value[t].deadline.hour=e,type:'number',placeholder:'æ™‚',class:'promise-deadline-input',onInput:e=>s.value[t].deadline.hour=C(s.value[t].deadline.hour.toString(),0,23)},null,40,Zm),[[e.vModelText,s.value[t].deadline.hour,void 0,{number:!0}]]),a[18]||(a[18]=(0,e.createElementVNode)('span',null,':',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>s.value[t].deadline.minute=e,type:'number',placeholder:'åˆ†',class:'promise-deadline-input',onInput:e=>s.value[t].deadline.minute=C(s.value[t].deadline.minute.toString(),0,59)},null,40,Qm),[[e.vModelText,s.value[t].deadline.minute,void 0,{number:!0}]])])):((0,e.openBlock)(),(0,e.createElementBlock)('div',qm,(0,e.toDisplayString)(S(n.deadline)),1))]),(0,e.createElementVNode)('div',ev,[i.value.has(t)?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:0,class:'edit-promise-button',onClick:e=>(e=>{const t=g.value.get(e);t&&(i.value.add(e),s.value[e]={id:e,deadline:r(t.deadline),location_id:t.location_id||'',character_ids:[...t.character_ids],description:t.description})})(t)},' ç·¨è¼¯ ',8,tv)),i.value.has(t)?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:1,class:'delete-promise-button',onClick:e=>(e=>{const t=g.value.get(e);t&&(u.value=e,c.value={visible:!0,title:'ç¢ºèªåˆªé™¤ç´„å®š',message:`ç¢ºå®šè¦åˆªé™¤ç´„å®š "${t.description}" å—Žï¼Ÿæ­¤æ“ä½œç„¡æ³•æ’¤éŠ·ã€‚`,confirmText:'åˆªé™¤',cancelText:'å–æ¶ˆ'})})(t)},' åˆªé™¤ ',8,av))])]),(0,e.createCommentVNode)(' ç¬¬äºŒè¡Œï¼šåœ°é»ž + ç·¨è¼¯æŒ‰éˆ• '),(0,e.createElementVNode)('div',nv,[(0,e.createElementVNode)('div',ov,[a[21]||(a[21]=(0,e.createElementVNode)('span',{class:'promise-location-label'},'åœ°é»žï¼š',-1)),i.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('select',{key:1,'onUpdate:modelValue':e=>s.value[t].location_id=e,class:'promise-location-input promise-location-input-edit'},[a[19]||(a[19]=(0,e.createElementVNode)('option',{value:'',disabled:''},'é¸æ“‡åœ°é»ž...',-1)),a[20]||(a[20]=(0,e.createElementVNode)('option',{value:''},'ç„¡',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(f.value,t=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t.id,value:t.id},(0,e.toDisplayString)(t.name)+' ('+(0,e.toDisplayString)(t.id)+') ',9,iv))),128))],8,lv)),[[e.vModelSelect,s.value[t].location_id]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',rv,(0,e.toDisplayString)(n.location_id?f.value.find(e=>e.id===n.location_id)?.name||n.location_id:'ç„¡'),1))]),i.value.has(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',dv,[(0,e.createElementVNode)('button',{class:'confirm-button',onClick:e=>(e=>{if(!p.value||!s.value[e])return;const t=s.value[e];if(t.id!==e&&p.value.promises.has(t.id))return void k(e);const a=x(t);if(a){const n=p.value.promises.get(e);n&&(t.id!==e?(p.value.promises.delete(e),p.value.promises.set(t.id,a)):(n.deadline=a.deadline,n.location_id=a.location_id,n.character_ids=a.character_ids,n.description=a.description),m()),k(e)}else k(e)})(t)},'ä¿å­˜',8,sv),(0,e.createElementVNode)('button',{class:'cancel-button',onClick:e=>k(t)},'å–æ¶ˆ',8,cv)])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createCommentVNode)(' ç¬¬ä¸‰è¡Œï¼šè§’è‰²ID '),i.value.has(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',pv,[(0,e.createElementVNode)('div',mv,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(s.value[t].character_ids,a=>((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:a,class:'selected-character-tag'},[(0,e.createTextVNode)((0,e.toDisplayString)(b.value.find(e=>e.id===a)?.name||a)+' ',1),(0,e.createElementVNode)('button',{class:'remove-character-btn',onClick:e=>B(s.value[t],a)},' Ã— ',8,vv)]))),128))]),(0,e.createElementVNode)('select',{class:'character-select',onChange:e=>{w(s.value[t],e.target.value),e.target.value=''}},[a[22]||(a[22]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡è§’è‰²...',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(b.value,a=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:a.id,value:a.id,disabled:s.value[t].character_ids.includes(a.id)},(0,e.toDisplayString)(a.name)+' ('+(0,e.toDisplayString)(a.id)+') ',9,bv))),128))],40,gv)])):((0,e.openBlock)(),(0,e.createElementBlock)('div',uv,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(n.character_ids,t=>((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:t,class:'promise-character-id-tag'},(0,e.toDisplayString)(b.value.find(e=>e.id===t)?.name||t),1))),128))])),(0,e.createCommentVNode)(' ç¬¬å››è¡Œï¼šæè¿° '),i.value.has(t)?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:3,'onUpdate:modelValue':e=>s.value[t].description=e,class:'promise-description-input',placeholder:'ç´„å®šå…§å®¹'},null,8,hv)),[[e.vModelText,s.value[t].description]]):((0,e.openBlock)(),(0,e.createElementBlock)('div',fv,(0,e.toDisplayString)(n.description),1))]))),128)),(0,e.createCommentVNode)(' æ–°ç´„å®šç·¨è¼¯è¡Œ '),l.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',xv,[(0,e.createCommentVNode)(' ç¬¬ä¸€è¡Œï¼šIDã€æˆªæ­¢æ—¥æœŸ '),(0,e.createElementVNode)('div',yv,[(0,e.createElementVNode)('div',_v,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>d.value.id=e),class:'promise-id-input',placeholder:'ç´„å®šID'},null,512),[[e.vModelText,d.value.id]]),(0,e.createElementVNode)('div',Ev,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>d.value.deadline.year=e),type:'number',placeholder:'å¹´',class:'promise-deadline-input promise-deadline-year-input',onInput:a[2]||(a[2]=e=>d.value.deadline.year=C(d.value.deadline.year.toString(),0,Number.MAX_SAFE_INTEGER))},null,544),[[e.vModelText,d.value.deadline.year,void 0,{number:!0}]]),a[23]||(a[23]=(0,e.createElementVNode)('span',null,'å¹´',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[3]||(a[3]=e=>d.value.deadline.month=e),type:'number',placeholder:'æœˆ',class:'promise-deadline-input',onInput:a[4]||(a[4]=e=>d.value.deadline.month=C(d.value.deadline.month.toString(),1,12))},null,544),[[e.vModelText,d.value.deadline.month,void 0,{number:!0}]]),a[24]||(a[24]=(0,e.createElementVNode)('span',null,'æœˆ',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[5]||(a[5]=e=>d.value.deadline.day=e),type:'number',placeholder:'æ—¥',class:'promise-deadline-input',onInput:a[6]||(a[6]=e=>d.value.deadline.day=C(d.value.deadline.day.toString(),1,31))},null,544),[[e.vModelText,d.value.deadline.day,void 0,{number:!0}]]),a[25]||(a[25]=(0,e.createElementVNode)('span',null,'æ—¥',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[7]||(a[7]=e=>d.value.deadline.hour=e),type:'number',placeholder:'æ™‚',class:'promise-deadline-input',onInput:a[8]||(a[8]=e=>d.value.deadline.hour=C(d.value.deadline.hour.toString(),0,23))},null,544),[[e.vModelText,d.value.deadline.hour,void 0,{number:!0}]]),a[26]||(a[26]=(0,e.createElementVNode)('span',null,':',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[9]||(a[9]=e=>d.value.deadline.minute=e),type:'number',placeholder:'åˆ†',class:'promise-deadline-input',onInput:a[10]||(a[10]=e=>d.value.deadline.minute=C(d.value.deadline.minute.toString(),0,59))},null,544),[[e.vModelText,d.value.deadline.minute,void 0,{number:!0}]])])])]),(0,e.createCommentVNode)(' ç¬¬äºŒè¡Œï¼šåœ°é»ž + æ·»åŠ æŒ‰éˆ• '),(0,e.createElementVNode)('div',kv,[(0,e.createElementVNode)('div',Vv,[a[29]||(a[29]=(0,e.createElementVNode)('span',{class:'promise-location-label'},'åœ°é»žï¼š',-1)),(0,e.withDirectives)((0,e.createElementVNode)('select',{'onUpdate:modelValue':a[11]||(a[11]=e=>d.value.location_id=e),class:'promise-location-input promise-location-input-edit'},[a[27]||(a[27]=(0,e.createElementVNode)('option',{value:'',disabled:''},'é¸æ“‡åœ°é»ž...',-1)),a[28]||(a[28]=(0,e.createElementVNode)('option',{value:''},'ç„¡',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(f.value,t=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t.id,value:t.id},(0,e.toDisplayString)(t.name)+' ('+(0,e.toDisplayString)(t.id)+') ',9,Nv))),128))],512),[[e.vModelSelect,d.value.location_id]])]),(0,e.createElementVNode)('div',{class:'promise-edit-actions'},[(0,e.createElementVNode)('button',{class:'confirm-button',onClick:y},'æ·»åŠ '),(0,e.createElementVNode)('button',{class:'cancel-button',onClick:E},'å–æ¶ˆ')])]),(0,e.createCommentVNode)(' ç¬¬ä¸‰è¡Œï¼šè§’è‰²ID '),(0,e.createElementVNode)('div',wv,[(0,e.createElementVNode)('div',Bv,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(d.value.character_ids,t=>((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:t,class:'selected-character-tag'},[(0,e.createTextVNode)((0,e.toDisplayString)(b.value.find(e=>e.id===t)?.name||t)+' ',1),(0,e.createElementVNode)('button',{class:'remove-character-btn',onClick:e=>B(d.value,t)},'Ã—',8,Cv)]))),128))]),(0,e.createElementVNode)('select',{class:'character-select',onChange:a[12]||(a[12]=e=>{w(d.value,e.target.value),e.target.value=''})},[a[30]||(a[30]=(0,e.createElementVNode)('option',{value:''},'é¸æ“‡è§’è‰²...',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(b.value,t=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t.id,value:t.id,disabled:d.value.character_ids.includes(t.id)},(0,e.toDisplayString)(t.name)+' ('+(0,e.toDisplayString)(t.id)+') ',9,$v))),128))],32)]),(0,e.createCommentVNode)(' ç¬¬å››è¡Œï¼šæè¿° '),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':a[13]||(a[13]=e=>d.value.description=e),class:'promise-description-input',placeholder:'ç´„å®šå…§å®¹'},null,512),[[e.vModelText,d.value.description]])])):(0,e.createCommentVNode)('v-if',!0),0!==g.value.size||l.value?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('div',Sv,'æ²’æœ‰ä»»ä½•ç´„å®š')),l.value?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:2,class:'add-promise-button',onClick:h},'+ æ·»åŠ ç´„å®š'))]),(0,e.createCommentVNode)(' ç¢ºèªçª—å£ '),(0,e.createVNode)(Gi,{'confirm-dialog':c.value,'onUpdate:confirmDialog':a[14]||(a[14]=e=>c.value=e),onConfirmDialogConfirm:V,onConfirmDialogCancel:N},null,8,['confirm-dialog'])])]))}});i(8131);const zv=(0,d.A)(Iv,[['__scopeId','data-v-25ffb8d9']]),Dv={class:'settings-container'},Tv={class:'settings-list'},Mv={class:'setting-item version-item'},Yv={class:'setting-control'},Ov={class:'version-number'},Av={class:'setting-item'},Rv={class:'setting-control'},Kv={class:'switch'},Uv={class:'setting-item'},Lv={class:'setting-control'},Fv={class:'setting-item'},jv={class:'setting-control'},Hv={class:'folding-rules-fullwidth'},Pv={class:'folding-rules-container'},qv={class:'rule-cell'},Gv=['onUpdate:modelValue','onInput'],Wv={class:'rule-cell'},Xv=['onUpdate:modelValue','onInput'],Jv={class:'rule-cell'},Zv=['onUpdate:modelValue','onChange'],Qv={class:'rule-cell'},eg={class:'radio-group compact'},tg={class:'radio-option compact'},ag=['onUpdate:modelValue','onChange'],ng={class:'radio-option compact'},og=['onUpdate:modelValue','onChange'],rg={class:'rule-cell'},lg={class:'radio-group compact'},ig={class:'radio-option compact'},dg=['onUpdate:modelValue','onChange'],sg={class:'radio-option compact'},cg=['onUpdate:modelValue','onChange'],ug={class:'rule-cell'},pg=['onClick'],mg=(0,e.defineComponent)({__name:'setting_tab',emits:['renderSizeChanged'],setup(t,{expose:a,emit:n}){(0,e.useCssVars)(e=>({v50c01ddd:p.value}));const o=n,r=(0,e.ref)('0.4.2'),l=(0,e.ref)(!1),i=(0,e.ref)(10),d=(0,e.ref)(1),s=(0,e.ref)([]),c=(0,e.ref)(0),u=(0,e.ref)(null),p=(0,e.computed)(()=>`calc(100vh - ${c.value}px)`),m=()=>{try{const e=getVariables({type:'chat'});e&&e.settings?(l.value=e.settings.fullscreen_enabled||!1,i.value=e.settings.render_size||10,d.value=e.settings.exclude_latest_summaries||1,s.value=e.settings.tag_rules||[]):v()}catch(e){console.error('Failed to load settings:',e)}},v=()=>{try{const e={fullscreen_enabled:l.value,render_size:i.value,exclude_latest_summaries:d.value,tag_rules:s.value};insertOrAssignVariables({settings:e},{type:'chat'})}catch(e){console.error('Failed to save settings:',e)}},g=async()=>{l.value?await(async()=>{try{document.documentElement.requestFullscreen?await document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen?await document.documentElement.webkitRequestFullscreen():document.documentElement.mozRequestFullScreen?await document.documentElement.mozRequestFullScreen():document.documentElement.msRequestFullscreen&&await document.documentElement.msRequestFullscreen()}catch(e){console.error('Failed to enter fullscreen:',e)}})():await(async()=>{try{document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.msExitFullscreen&&await document.msExitFullscreen()}catch(e){console.error('Failed to exit fullscreen:',e)}})(),v()},b=()=>{let e=Math.floor(Number(i.value));(isNaN(e)||e<1)&&(e=10),i.value=e,v(),o('renderSizeChanged',i.value)},f=()=>{let e=Math.floor(Number(d.value));(isNaN(e)||e<0)&&(e=1),d.value=e,v()},h=()=>{s.value.push({tag_name:'',match_mode:'both',match_strategy:'first',display_mode:'invisible',title_name:''}),v()},x=(e,t)=>{e>=0&&e<s.value.length&&(s.value[e]={...s.value[e],...t},v())},y=()=>{const e=!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement);l.value=e,v()};return m(),document.addEventListener('fullscreenchange',y),document.addEventListener('webkitfullscreenchange',y),document.addEventListener('mozfullscreenchange',y),document.addEventListener('MSFullscreenChange',y),(0,e.onMounted)(()=>{(0,e.nextTick)(()=>{(()=>{if('undefined'==typeof ResizeObserver)return void(c.value=74);u.value=new ResizeObserver(e=>{for(const t of e){const e=t.target;e.classList.contains('tab-navigation')&&(c.value=e.offsetHeight)}});const e=document.querySelector('.tab-navigation.top');e&&(u.value.observe(e),c.value=e.offsetHeight)})()})}),(0,e.onUnmounted)(()=>{u.value&&(u.value.disconnect(),u.value=null)}),eventOn(tavern_events.APP_READY,()=>{y()}),(0,e.onUnmounted)(()=>{document.removeEventListener('fullscreenchange',y),document.removeEventListener('webkitfullscreenchange',y),document.removeEventListener('mozfullscreenchange',y),document.removeEventListener('MSFullscreenChange',y)}),a({reloadSettings:m}),(t,a)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',Dv,[a[15]||(a[15]=(0,e.createElementVNode)('div',{class:'settings-header'},[(0,e.createElementVNode)('h2',null,'è¨­ç½®')],-1)),(0,e.createElementVNode)('div',Tv,[(0,e.createCommentVNode)(' ç‰ˆæœ¬è™Ÿ '),(0,e.createElementVNode)('div',Mv,[a[3]||(a[3]=(0,e.createElementVNode)('div',{class:'setting-label'},[(0,e.createElementVNode)('span',{class:'setting-title'},'ç‰ˆæœ¬è™Ÿ'),(0,e.createElementVNode)('span',{class:'setting-description'},'ç•¶å‰æ‡‰ç”¨ç‰ˆæœ¬')],-1)),(0,e.createElementVNode)('div',Yv,[(0,e.createElementVNode)('span',Ov,(0,e.toDisplayString)(r.value),1)])]),(0,e.createCommentVNode)(' å…¨å±é–‹é—œ '),(0,e.createElementVNode)('div',Av,[a[5]||(a[5]=(0,e.createElementVNode)('div',{class:'setting-label'},[(0,e.createElementVNode)('span',{class:'setting-title'},'å…¨å±æ¨¡å¼'),(0,e.createElementVNode)('span',{class:'setting-description'},'å•Ÿç”¨å…¨å±é¡¯ç¤ºæ¨¡å¼')],-1)),(0,e.createElementVNode)('div',Rv,[(0,e.createElementVNode)('label',Kv,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>l.value=e),type:'checkbox',onChange:g},null,544),[[e.vModelCheckbox,l.value]]),a[4]||(a[4]=(0,e.createElementVNode)('span',{class:'slider'},null,-1))])])]),(0,e.createCommentVNode)(' æ¸²æŸ“å¤§å° '),(0,e.createElementVNode)('div',Uv,[a[6]||(a[6]=(0,e.createElementVNode)('div',{class:'setting-label'},[(0,e.createElementVNode)('span',{class:'setting-title'},'è¼‰å…¥æ¨“å±¤æ•¸ç›®'),(0,e.createElementVNode)('span',{class:'setting-description'},'è¨­ç½®æ¯æ¬¡è¼‰å…¥æ¨“å±¤çš„æ•¸ç›®')],-1)),(0,e.createElementVNode)('div',Lv,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>i.value=e),type:'number',class:'number-input',min:'1',onInput:b},null,544),[[e.vModelText,i.value,void 0,{number:!0}]])])]),(0,e.createCommentVNode)(' æŽ’é™¤æœ€æ–°ç¸½çµæ•¸é‡ '),(0,e.createElementVNode)('div',Fv,[a[7]||(a[7]=(0,e.createElementVNode)('div',{class:'setting-label'},[(0,e.createElementVNode)('span',{class:'setting-title'},'æŽ’é™¤æœ€æ–°ç¸½çµæ•¸é‡'),(0,e.createElementVNode)('span',{class:'setting-description'},'è¨­ç½®ä¸ä½¿ç”¨æœ€æ–°nå€‹ç¸½çµçš„æ•¸é‡')],-1)),(0,e.createElementVNode)('div',jv,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>d.value=e),type:'number',class:'number-input',min:'0',onInput:f},null,544),[[e.vModelText,d.value,void 0,{number:!0}]])])]),(0,e.createCommentVNode)(' XMLå…§å®¹æ‘ºç–Šè¦å‰‡ '),a[14]||(a[14]=(0,e.createElementVNode)('div',{class:'setting-item xml-rules-item'},[(0,e.createElementVNode)('div',{class:'setting-label'},[(0,e.createElementVNode)('span',{class:'setting-title'},'XMLå…§å®¹æ‘ºç–Šè¦å‰‡'),(0,e.createElementVNode)('span',{class:'setting-description'},'è¨­ç½®XMLæ¨™ç±¤å…§å®¹çš„é¡¯ç¤ºæ–¹å¼')])],-1)),(0,e.createCommentVNode)(' XMLå…§å®¹æ‘ºç–Šè¦å‰‡è¡¨æ ¼ '),(0,e.createElementVNode)('div',Hv,[(0,e.createElementVNode)('div',Pv,[(0,e.createCommentVNode)(' è¡¨é ­ '),a[13]||(a[13]=(0,e.createStaticVNode)('<div class="rules-header" data-v-d8917884><div class="header-cell" data-v-d8917884>æ¨™ç±¤åç¨±</div><div class="header-cell" data-v-d8917884>æ¨™é¡Œåç¨±</div><div class="header-cell" data-v-d8917884>é¡¯ç¤ºæ¨¡å¼</div><div class="header-cell" data-v-d8917884>åŒ¹é…æ¨¡å¼</div><div class="header-cell" data-v-d8917884>åŒ¹é…çµæŸæ¨™ç±¤ç­–ç•¥</div><div class="header-cell" data-v-d8917884>æ“ä½œ</div></div>',1)),(0,e.createCommentVNode)(' è¦å‰‡è¡Œ '),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(s.value,(t,n)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:n,class:'folding-rule-row'},[(0,e.createCommentVNode)(' æ¨™ç±¤åç¨± '),(0,e.createElementVNode)('div',qv,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>t.tag_name=e,type:'text',class:'text-input compact',placeholder:'ä¾‹å¦‚: think',onInput:e=>x(n,{tag_name:t.tag_name})},null,40,Gv),[[e.vModelText,t.tag_name]])]),(0,e.createCommentVNode)(' æ¨™é¡Œåç¨± '),(0,e.createElementVNode)('div',Wv,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>t.title_name=e,type:'text',class:'text-input compact',placeholder:'ä¾‹å¦‚: æ€è€ƒå…§å®¹',onInput:e=>x(n,{title_name:t.title_name})},null,40,Xv),[[e.vModelText,t.title_name]])]),(0,e.createCommentVNode)(' é¡¯ç¤ºæ¨¡å¼ '),(0,e.createElementVNode)('div',Jv,[(0,e.withDirectives)((0,e.createElementVNode)('select',{'onUpdate:modelValue':e=>t.display_mode=e,class:'select-input compact',onChange:e=>x(n,{display_mode:t.display_mode})},[...a[8]||(a[8]=[(0,e.createElementVNode)('option',{value:'invisible'},'éš±è—',-1),(0,e.createElementVNode)('option',{value:'fold_bar'},'æ‘ºç–Šæ¬„',-1)])],40,Zv),[[e.vModelSelect,t.display_mode]])]),(0,e.createCommentVNode)(' åŒ¹é…æ¨¡å¼ '),(0,e.createElementVNode)('div',Qv,[(0,e.createElementVNode)('div',eg,[(0,e.createElementVNode)('label',tg,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>t.match_mode=e,type:'radio',value:'both',onChange:e=>x(n,{match_mode:t.match_mode})},null,40,ag),[[e.vModelRadio,t.match_mode]]),a[9]||(a[9]=(0,e.createElementVNode)('span',{class:'radio-label'},'é–‹å§‹åŠçµæŸ',-1))]),(0,e.createElementVNode)('label',ng,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>t.match_mode=e,type:'radio',value:'end_only',onChange:e=>x(n,{match_mode:t.match_mode})},null,40,og),[[e.vModelRadio,t.match_mode]]),a[10]||(a[10]=(0,e.createElementVNode)('span',{class:'radio-label'},'åªçµæŸ',-1))])])]),(0,e.createCommentVNode)(' åŒ¹é…çµæŸæ¨™ç±¤ç­–ç•¥ '),(0,e.createElementVNode)('div',rg,[(0,e.createElementVNode)('div',lg,[(0,e.createElementVNode)('label',ig,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>t.match_strategy=e,type:'radio',value:'first',onChange:e=>x(n,{match_strategy:t.match_strategy})},null,40,dg),[[e.vModelRadio,t.match_strategy]]),a[11]||(a[11]=(0,e.createElementVNode)('span',{class:'radio-label'},'ç¬¬ä¸€å€‹',-1))]),(0,e.createElementVNode)('label',sg,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>t.match_strategy=e,type:'radio',value:'last',onChange:e=>x(n,{match_strategy:t.match_strategy})},null,40,cg),[[e.vModelRadio,t.match_strategy]]),a[12]||(a[12]=(0,e.createElementVNode)('span',{class:'radio-label'},'æœ€å¾Œä¸€å€‹',-1))])])]),(0,e.createCommentVNode)(' åˆªé™¤æŒ‰éˆ• '),(0,e.createElementVNode)('div',ug,[(0,e.createElementVNode)('button',{class:'delete-rule-btn compact',onClick:e=>{var t;(t=n)>=0&&t<s.value.length&&(s.value.splice(t,1),v())}},'åˆªé™¤',8,pg)])]))),128)),(0,e.createCommentVNode)(' æ·»åŠ è¦å‰‡æŒ‰éˆ• '),(0,e.createElementVNode)('div',{class:'add-rule-row'},[(0,e.createElementVNode)('button',{class:'add-rule-btn',onClick:h},'+ æ·»åŠ æ‘ºç–Šè¦å‰‡')])])])])]))}});i(6129);const vg=(0,d.A)(mg,[['__scopeId','data-v-d8917884']]),gg={class:'summary-tab-container'},bg={class:'summary-content'},fg={key:0,class:'summary-row new-summary-row'},hg={class:'summary-edit-mode'},xg={class:'summary-edit-first-row'},yg={class:'summary-weighting-last-message-input-group'},_g={class:'summary-last-message-id-input-group'},Eg=['value'],kg={class:'summary-weighting-input-group'},Vg=['value'],Ng={class:'summary-edit-actions'},wg=['disabled'],Bg={class:'summary-edit-datetime-row'},Cg={class:'summary-datetime-input-group'},$g=['value'],Sg=['value'],Ig=['value'],zg=['value'],Dg=['value'],Tg=['value'],Mg={class:'summary-list'},Yg={key:0,class:'summary-edit-mode'},Og={class:'summary-edit-first-row'},Ag={class:'summary-weighting-last-message-input-group'},Rg={class:'summary-last-message-id-input-group'},Kg=['value'],Ug={class:'summary-weighting-input-group'},Lg=['value'],Fg={class:'summary-edit-actions'},jg=['disabled'],Hg={class:'summary-edit-datetime-row'},Pg={class:'summary-datetime-input-group'},qg=['value'],Gg=['value'],Wg=['value'],Xg=['value'],Jg=['value'],Zg=['value'],Qg={class:'summary-first-row'},eb={class:'summary-weighting-last-message-group'},tb={class:'summary-last-message-id'},ab={class:'summary-weighting'},nb={class:'summary-actions'},ob=['onClick'],rb=['onClick'],lb={class:'summary-datetime-row'},ib={class:'summary-datetime'},db={class:'summary-content-display'},sb={key:0,class:'no-summaries-message'},cb=(0,e.defineComponent)({__name:'summary_tab',setup(t){(0,e.useCssVars)(e=>({v70237b32:o.value}));const a=(0,e.ref)(0),n=(0,e.ref)(null),o=(0,e.computed)(()=>`calc(100vh - ${a.value}px)`);(0,e.onMounted)(()=>{(async()=>{await(0,e.nextTick)();const t=document.querySelector('.tab-navigation');t&&window.ResizeObserver?(n.value=new ResizeObserver(e=>{for(const t of e)a.value=t.contentRect.height}),n.value.observe(t)):a.value=74})()}),(0,e.onUnmounted)(()=>{n.value&&(n.value.disconnect(),n.value=null)});const r=(0,e.ref)({visible:!1,title:'',message:'',confirmText:'ç¢ºèª',cancelText:'å–æ¶ˆ'}),l=(0,e.ref)(null),i=(0,e.ref)(null),d=(0,e.ref)(!1),s=(0,e.ref)({year:0,month:0,day:0,hour:0,minute:0}),c=(0,e.ref)(0),u=(0,e.ref)(0),p=(0,e.ref)(''),m=(0,e.ref)(null),v=()=>{m.value&&(m.value.saveAsVariable(getLastMessageId()),g())},g=()=>{try{const e=getLastMessageId();m.value=Yo.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),m.value=null}};g();const b=(0,e.computed)(()=>m.value?.summaries?[...m.value.summaries].sort((e,t)=>t.last_message_id-e.last_message_id):[]),f=e=>{if(!m.value)return'unused';const t=(getVariables({type:'chat'}).settings||{}).exclude_latest_summaries||1,a=[...m.value.summaries].sort((e,t)=>e.last_message_id-t.last_message_id);return a.findIndex(t=>t.last_message_id===e.last_message_id)>=a.length-t?'unused':'used'},h=()=>{if(null!==l.value&&m.value){const e=b.value[l.value],t=m.value.summaries.indexOf(e);-1!==t&&(m.value.summaries.splice(t,1),v())}r.value.visible=!1,l.value=null},x=()=>{r.value.visible=!1,l.value=null},y=()=>{if(d.value=!0,m.value){const e=m.value.datetime.toDate();s.value={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes()}}u.value=(()=>{const e=getChatMessages(-1,{role:'assistant'});return e.length>0?e[0].message_id:getLastMessageId()})(),c.value=.5,p.value=''},E=()=>{if(m.value)try{const e=new Date(s.value.year,s.value.month-1,s.value.day,s.value.hour,s.value.minute,0),t=new $o(e),a=new Mo(t,p.value.trim(),c.value,u.value);if(null!==i.value){const e=b.value[i.value],t=m.value.summaries.indexOf(e);-1!==t&&(m.value.summaries[t]=a,v(),i.value=null)}else d.value&&(m.value.summaries.push(a),m.value.summaries.sort((e,t)=>e.last_message_id-t.last_message_id),v(),d.value=!1)}catch(e){console.error('Failed to save summary:',e)}},k=()=>{i.value=null,d.value=!1},V=(0,e.computed)(()=>{if(u.value<0||!Number.isInteger(u.value))return!1;if(c.value<0||c.value>1)return!1;if(s.value.year<0||!Number.isInteger(s.value.year))return!1;if(!p.value.trim())return!1;try{const e=new Date(s.value.year,s.value.month-1,s.value.day,s.value.hour,s.value.minute,0);if(e.getFullYear()!==s.value.year||e.getMonth()!==s.value.month-1||e.getDate()!==s.value.day)return!1}catch{return!1}return!0}),N=(e,t,a,n=!1)=>{const o=n?parseFloat(e):parseInt(e);return isNaN(o)?'':Math.min(Math.max(o,t),a).toString()},w=e=>{const t=e.target,a=parseInt(N(t.value,0,Number.MAX_SAFE_INTEGER));u.value=a},B=e=>{const t=e.target,a=parseFloat(N(t.value,0,1,!0));c.value=a},C=(e,t)=>{const a=t.target;let n;switch(e){case'year':n=parseInt(N(a.value,0,Number.MAX_SAFE_INTEGER));break;case'month':n=parseInt(N(a.value,1,12));break;case'day':n=parseInt(N(a.value,1,31));break;case'hour':n=parseInt(N(a.value,0,23));break;case'minute':n=parseInt(N(a.value,0,59));break;default:return}s.value={...s.value,[e]:n}},S=e=>{const t=e.toDate();return`${t.getFullYear()}å¹´${t.getMonth()+1}æœˆ${t.getDate()}æ—¥ ${t.getHours().toString().padStart(2,'0')}:${t.getMinutes().toString().padStart(2,'0')}`};return(t,a)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',gg,[(0,e.createElementVNode)('div',bg,[(0,e.createCommentVNode)(' ç¸½çµåˆ—è¡¨æ¨™é¡Œ '),(0,e.createElementVNode)('div',{class:'summary-section'},[a[17]||(a[17]=(0,e.createElementVNode)('h3',{class:'section-title'},'ç¸½çµåˆ—è¡¨',-1)),(0,e.createElementVNode)('button',{class:'add-summary-button',onClick:y},'+ æ·»åŠ ç¸½çµ')]),(0,e.createCommentVNode)(' æ·»åŠ æ–°ç¸½çµç·¨è¼¯å€åŸŸ '),d.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',fg,[(0,e.createElementVNode)('div',hg,[(0,e.createCommentVNode)(' ç¬¬ä¸€è¡Œï¼šæœ€å¾Œæ¨“å±¤ã€æ¬Šé‡ã€æ“ä½œæŒ‰éˆ• '),(0,e.createElementVNode)('div',xg,[(0,e.createElementVNode)('div',yg,[(0,e.createElementVNode)('div',_g,[a[18]||(a[18]=(0,e.createTextVNode)(' æœ€å¾Œæ¨“å±¤: ',-1)),(0,e.createElementVNode)('input',{value:u.value,type:'number',class:'summary-last-message-id-input',min:'0',step:'1',onInput:a[0]||(a[0]=e=>w(e))},null,40,Eg)]),(0,e.createElementVNode)('div',kg,[a[19]||(a[19]=(0,e.createTextVNode)(' æ¬Šé‡: ',-1)),(0,e.createElementVNode)('input',{value:c.value,type:'number',class:'summary-weighting-input',step:'0.1',min:'0',max:'1',onInput:a[1]||(a[1]=e=>B(e))},null,40,Vg)])]),(0,e.createElementVNode)('div',Ng,[(0,e.createElementVNode)('button',{class:'confirm-button',disabled:!V.value,onClick:E},'ä¿å­˜',8,wg),(0,e.createElementVNode)('button',{class:'cancel-button',onClick:k},'å–æ¶ˆ')])]),(0,e.createCommentVNode)(' ç¬¬äºŒè¡Œï¼šæ™‚é–“è¼¸å…¥ '),(0,e.createElementVNode)('div',Bg,[(0,e.createElementVNode)('div',Cg,[(0,e.createElementVNode)('input',{value:s.value.year,type:'number',class:'summary-datetime-input summary-datetime-year-input',placeholder:'å¹´',onInput:a[2]||(a[2]=e=>C('year',e))},null,40,$g),a[20]||(a[20]=(0,e.createTextVNode)('å¹´ ',-1)),(0,e.createElementVNode)('input',{value:s.value.month,type:'number',class:'summary-datetime-input',placeholder:'æœˆ',min:'1',max:'12',onInput:a[3]||(a[3]=e=>C('month',e))},null,40,Sg),a[21]||(a[21]=(0,e.createTextVNode)('æœˆ ',-1)),(0,e.createElementVNode)('input',{value:s.value.day,type:'number',class:'summary-datetime-input',placeholder:'æ—¥',min:'1',max:'31',onInput:a[4]||(a[4]=e=>C('day',e))},null,40,Ig),a[22]||(a[22]=(0,e.createTextVNode)('æ—¥ ',-1)),(0,e.createElementVNode)('input',{value:s.value.hour,type:'number',class:'summary-datetime-input',placeholder:'æ™‚',min:'0',max:'23',onInput:a[5]||(a[5]=e=>C('hour',e))},null,40,zg),a[23]||(a[23]=(0,e.createTextVNode)(': ',-1)),(0,e.createElementVNode)('input',{value:s.value.minute,type:'number',class:'summary-datetime-input',placeholder:'åˆ†',min:'0',max:'59',onInput:a[6]||(a[6]=e=>C('minute',e))},null,40,Dg)])]),(0,e.createCommentVNode)(' ç¬¬ä¸‰è¡Œï¼šç¸½çµå…§å®¹è¼¸å…¥ '),(0,e.createElementVNode)('textarea',{value:p.value,class:'summary-content-input',placeholder:'è¼¸å…¥ç¸½çµå…§å®¹...',onInput:a[7]||(a[7]=e=>p.value=e.target.value)},null,40,Tg)])])):(0,e.createCommentVNode)('v-if',!0),(0,e.createCommentVNode)(' ç¸½çµåˆ—è¡¨ '),(0,e.createElementVNode)('div',Mg,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(b.value,(t,n)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:n,class:(0,e.normalizeClass)(['summary-row',{'new-summary-row':i.value===n}])},[(0,e.createCommentVNode)(' ç·¨è¼¯æ¨¡å¼ '),i.value===n?((0,e.openBlock)(),(0,e.createElementBlock)('div',Yg,[(0,e.createCommentVNode)(' ç¬¬ä¸€è¡Œï¼šæœ€å¾Œæ¨“å±¤ã€æ¬Šé‡ã€æ“ä½œæŒ‰éˆ• '),(0,e.createElementVNode)('div',Og,[(0,e.createElementVNode)('div',Ag,[(0,e.createElementVNode)('div',Rg,[a[24]||(a[24]=(0,e.createTextVNode)(' æœ€å¾Œæ¨“å±¤: ',-1)),(0,e.createElementVNode)('input',{value:u.value,type:'number',class:'summary-last-message-id-input',min:'0',step:'1',onInput:a[8]||(a[8]=e=>w(e))},null,40,Kg)]),(0,e.createElementVNode)('div',Ug,[a[25]||(a[25]=(0,e.createTextVNode)(' æ¬Šé‡: ',-1)),(0,e.createElementVNode)('input',{value:c.value,type:'number',class:'summary-weighting-input',step:'0.1',min:'0',max:'1',onInput:a[9]||(a[9]=e=>B(e))},null,40,Lg)])]),(0,e.createElementVNode)('div',Fg,[(0,e.createElementVNode)('button',{class:'confirm-button',disabled:!V.value,onClick:E},'ä¿å­˜',8,jg),(0,e.createElementVNode)('button',{class:'cancel-button',onClick:k},'å–æ¶ˆ')])]),(0,e.createCommentVNode)(' ç¬¬äºŒè¡Œï¼šæ™‚é–“è¼¸å…¥ '),(0,e.createElementVNode)('div',Hg,[(0,e.createElementVNode)('div',Pg,[(0,e.createElementVNode)('input',{value:s.value.year,type:'number',class:'summary-datetime-input summary-datetime-year-input',placeholder:'å¹´',onInput:a[10]||(a[10]=e=>C('year',e))},null,40,qg),a[26]||(a[26]=(0,e.createTextVNode)('å¹´ ',-1)),(0,e.createElementVNode)('input',{value:s.value.month,type:'number',class:'summary-datetime-input',placeholder:'æœˆ',min:'1',max:'12',onInput:a[11]||(a[11]=e=>C('month',e))},null,40,Gg),a[27]||(a[27]=(0,e.createTextVNode)('æœˆ ',-1)),(0,e.createElementVNode)('input',{value:s.value.day,type:'number',class:'summary-datetime-input',placeholder:'æ—¥',min:'1',max:'31',onInput:a[12]||(a[12]=e=>C('day',e))},null,40,Wg),a[28]||(a[28]=(0,e.createTextVNode)('æ—¥ ',-1)),(0,e.createElementVNode)('input',{value:s.value.hour,type:'number',class:'summary-datetime-input',placeholder:'æ™‚',min:'0',max:'23',onInput:a[13]||(a[13]=e=>C('hour',e))},null,40,Xg),a[29]||(a[29]=(0,e.createTextVNode)(': ',-1)),(0,e.createElementVNode)('input',{value:s.value.minute,type:'number',class:'summary-datetime-input',placeholder:'åˆ†',min:'0',max:'59',onInput:a[14]||(a[14]=e=>C('minute',e))},null,40,Jg)])]),(0,e.createCommentVNode)(' ç¬¬ä¸‰è¡Œï¼šç¸½çµå…§å®¹è¼¸å…¥ '),(0,e.createElementVNode)('textarea',{value:p.value,class:'summary-content-input',placeholder:'è¼¸å…¥ç¸½çµå…§å®¹...',onInput:a[15]||(a[15]=e=>p.value=e.target.value)},null,40,Zg)])):((0,e.openBlock)(),(0,e.createElementBlock)(e.Fragment,{key:1},[(0,e.createCommentVNode)(' é¡¯ç¤ºæ¨¡å¼ '),(0,e.createElementVNode)('div',null,[(0,e.createCommentVNode)(' ç¬¬ä¸€è¡Œï¼šæ¶ˆæ¯IDã€æ¬Šé‡ã€æ“ä½œæŒ‰éˆ• '),(0,e.createElementVNode)('div',Qg,[(0,e.createElementVNode)('div',eb,[(0,e.createElementVNode)('div',tb,'æœ€å¾Œæ¨“å±¤: '+(0,e.toDisplayString)(t.last_message_id),1),(0,e.createElementVNode)('div',ab,'æ¬Šé‡: '+(0,e.toDisplayString)(t.weighting),1),(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['summary-status',`status-${f(t)}`])},(0,e.toDisplayString)('used'===f(t)?'ä½¿ç”¨ä¸­':'æœªä½¿ç”¨'),3)]),(0,e.createElementVNode)('div',nb,[(0,e.createElementVNode)('button',{class:'edit-summary-button',onClick:e=>(e=>{if(m.value&&b.value[e]){i.value=e;const t=b.value[e],a=t.datetime.toDate();s.value={year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate(),hour:a.getHours(),minute:a.getMinutes()},c.value=t.weighting,u.value=t.last_message_id,p.value=t.summary}})(n)},'ç·¨è¼¯',8,ob),(0,e.createElementVNode)('button',{class:'delete-summary-button',onClick:e=>(e=>{if(m.value&&b.value[e]){const t=b.value[e];l.value=e,r.value={visible:!0,title:'ç¢ºèªåˆªé™¤ç¸½çµ',message:`ç¢ºå®šè¦åˆªé™¤ç¸½çµ "${t.summary.substring(0,50)}${t.summary.length>50?'...':''}" å—Žï¼Ÿæ­¤æ“ä½œç„¡æ³•æ’¤éŠ·ã€‚`,confirmText:'åˆªé™¤',cancelText:'å–æ¶ˆ'}}})(n)},'åˆªé™¤',8,rb)])]),(0,e.createCommentVNode)(' ç¬¬äºŒè¡Œï¼šæ™‚é–“ '),(0,e.createElementVNode)('div',lb,[(0,e.createElementVNode)('div',ib,(0,e.toDisplayString)(S(t.datetime)),1)]),(0,e.createCommentVNode)(' ç¬¬ä¸‰è¡Œï¼šç¸½çµå…§å®¹ '),(0,e.createElementVNode)('div',db,(0,e.toDisplayString)(t.summary),1)])],2112))],2))),128)),0===b.value.length?((0,e.openBlock)(),(0,e.createElementBlock)('div',sb,'æ²’æœ‰ä»»ä½•ç¸½çµ')):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createCommentVNode)(' ç¢ºèªçª—å£ '),(0,e.createVNode)(Gi,{'confirm-dialog':r.value,'onUpdate:confirmDialog':a[16]||(a[16]=e=>r.value=e),onConfirmDialogConfirm:h,onConfirmDialogCancel:x},null,8,['confirm-dialog'])])]))}});i(5784);const ub=(0,d.A)(cb,[['__scopeId','data-v-3de5c4ec']]);var pb=i(4015);const mb={class:'user-tab-container'},vb={ref:'userContentRef',class:'user-content'},gb={class:'user-header'},bb={class:'user-name'},fb={class:'attributes-grid'},hb={class:'attribute-item horizontal'},xb={class:'attribute-value'},yb={class:'attribute-item horizontal'},_b={key:0,class:'attribute-value'},Eb={class:'attribute-item horizontal'},kb={key:0,class:'attribute-value'},Vb={class:'attribute-item horizontal'},Nb={key:0,class:'attribute-value'},wb={class:'attribute-item horizontal'},Bb={key:0,class:'attribute-value'},Cb={class:'attribute-item horizontal'},$b={key:0,class:'attribute-value'},Sb={class:'attribute-item horizontal'},Ib={key:0,class:'attribute-value'},zb={class:'attribute-item horizontal'},Db={key:0,class:'attribute-value'},Tb={class:'attribute-item horizontal'},Mb={key:0,class:'attribute-value'},Yb={class:'attribute-item full-width horizontal'},Ob={key:0,class:'attribute-value money'},Ab={class:'attribute-item full-width birthday-fullwidth'},Rb={key:0,class:'attribute-value'},Kb={key:1,class:'birthday-edit-container'},Ub={class:'birthday-input-group'},Lb={class:'attribute-item full-width'},Fb={key:0,class:'attribute-value no-bold'},jb={class:'attribute-item full-width'},Hb={key:0,class:'attribute-value no-bold'},Pb={class:'attribute-item full-width'},qb={key:0,class:'attribute-value no-bold'},Gb={class:'attribute-item full-width'},Wb={key:0,class:'attribute-value no-bold'},Xb={class:'attribute-item full-width'},Jb={key:0,class:'attribute-value no-bold'},Zb={class:'attribute-item full-width'},Qb={key:0,class:'attribute-value no-bold'},ef={class:'attribute-item full-width'},tf={key:0,class:'attribute-value no-bold'},af={key:0,class:'attribute-item full-width'},nf={key:0,class:'attribute-value no-bold'},of={class:'relations-section'},rf={key:0,class:'relations-list'},lf={class:'relation-highlight'},df={class:'relation-highlight'},sf={key:0,class:'no-relations-message'},cf={key:1,class:'relations-edit-list'},uf=['value','onChange'],pf=['value'],mf=['onUpdate:modelValue'],vf=['onClick'],gf={class:'inventory-section'},bf={key:0,class:'inventory-list'},ff={class:'inventory-first-row'},hf={class:'item-name-id'},xf={key:0,class:'item-quantity'},yf={key:1,class:'storage-indicator'},_f={class:'inventory-second-row'},Ef={key:0,class:'inventory-third-row'},kf={key:0,class:'no-inventory'},Vf={key:1,class:'inventory-items'},Nf={key:0,class:'no-inventory-message'},wf={key:1,class:'inventory-edit-list'},Bf=['value','onChange'],Cf={label:'ç‰©å“'},$f=['value'],Sf={label:'è²¯å­˜é»ž'},If=['value'],zf={key:0,class:'inventory-edit-connector'},Df=['onUpdate:modelValue'],Tf=['onClick'],Mf={key:0,class:'edit-buttons'},Yf=(0,e.defineComponent)({__name:'user_tab',setup(t,{expose:a}){(0,e.useCssVars)(e=>({v68dcf940:i.value}));const n=(0,e.ref)(!1),o=(0,e.ref)(null),r=(0,e.ref)(0),l=(0,e.ref)(null),i=(0,e.computed)(()=>`calc(100vh - ${r.value}px)`),d=(0,e.computed)({get:()=>o.value?.é—œä¿‚||{},set:e=>{o.value&&(o.value.é—œä¿‚=e)}}),s=(0,e.computed)({get:()=>o.value?.æ‰€æŒç‰©||{},set:e=>{o.value&&(o.value.æ‰€æŒç‰©=e)}}),c=(0,e.computed)(()=>{if(!x.value)return[];const e=[];for(const[t,a]of x.value.active_characters)'c1'!==t&&e.push({id:t,name:a.name});for(const[t,a]of x.value.deactive_characters)e.push({id:t,name:a.name});return e}),u=(0,e.computed)(()=>{if(!x.value)return[];const e=[];for(const[t,a]of x.value.items)e.push({id:t,name:a.name,type:'item'});for(const[t,a]of x.value.storages)e.push({id:t,name:a.name,type:'storage'});return e}),p=e=>{if(!x.value)return'æœªçŸ¥';const t=x.value.items.get(e);if(t)return t.name;const a=x.value.storages.get(e);return a?a.name:'æœªçŸ¥'},m=e=>x.value?.storages.has(e)||!1,v=e=>{const t=x.value?.storages.get(e);return t?.inventory.size||0},g=e=>{const t=x.value?.storages.get(e);return t?.inventory||new Map},b=e=>{if(!x.value)return'ç„¡æè¿°';const t=x.value.items.get(e);if(t)return t.description;const a=x.value.storages.get(e);return a?a.description:'ç„¡æè¿°'},f=()=>{o.value?.é—œä¿‚&&(o.value.é—œä¿‚['']='')},h=()=>{o.value?.æ‰€æŒç‰©&&(o.value.æ‰€æŒç‰©['']=1)},x=(0,e.ref)(null),y=()=>{try{const e=getLastMessageId();x.value=Yo.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),x.value=null}};y();const E=(0,e.computed)(()=>x.value?.getCharacter('c1')||null),k=()=>{E.value&&(o.value=(0,pb.klona)(E.value.toRecord()),o.value.é—œä¿‚=Object.fromEntries(E.value.relations),o.value.æ‰€æŒç‰©=Object.fromEntries(E.value.inventory),o.value.ç”Ÿæ—¥={month:E.value.birthday.month,date:E.value.birthday.date},n.value=!0)},V=()=>{n.value=!1,o.value=null},N=()=>{if(x.value&&o.value){if(o.value.ç”Ÿæ—¥&&o.value.ç”Ÿæ—¥.month&&o.value.ç”Ÿæ—¥.date){const e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate(),r=o.value.ç”Ÿæ—¥.month,l=o.value.ç”Ÿæ—¥.date;let i=t-(o.value.å¹´é½¡||0);(r>a||r===a&&l>n)&&(i-=1),o.value.ç”Ÿæ—¥=new Date(i,o.value.ç”Ÿæ—¥.month-1,o.value.ç”Ÿæ—¥.date).toString()}if(o.value.é—œä¿‚){const e={};for(const[t,a]of Object.entries(o.value.é—œä¿‚))t&&a&&'string'==typeof a&&''!==a.trim()&&(e[t]=a);o.value.é—œä¿‚=e}if(o.value.æ‰€æŒç‰©){const e={};for(const[t,a]of Object.entries(o.value.æ‰€æŒç‰©))if(t&&a&&'number'==typeof a&&a>0){const n=m(t)?1:a;e[t]=n}o.value.æ‰€æŒç‰©=e}x.value.active_characters.set('c1',So.fromRecord(o.value)),x.value.saveAsVariable(getLastMessageId()),y()}n.value=!1,o.value=null};a({handleTabClick:()=>{n.value&&V()}});return(0,e.onMounted)(()=>{(0,e.nextTick)(()=>{(()=>{if('undefined'==typeof ResizeObserver)return void(r.value=74);l.value=new ResizeObserver(e=>{for(const t of e){const e=t.target;e.classList.contains('tab-navigation')&&(r.value=e.offsetHeight)}});const e=document.querySelector('.tab-navigation.top');e&&(l.value.observe(e),r.value=e.offsetHeight)})()})}),(0,e.onUnmounted)(()=>{l.value&&(l.value.disconnect(),l.value=null)}),(t,a)=>{return(0,e.openBlock)(),(0,e.createElementBlock)('div',mb,[(0,e.createElementVNode)('div',vb,[(0,e.createCommentVNode)(' ç”¨æˆ¶åç¨±æ¨™é¡Œ '),(0,e.createElementVNode)('div',gb,[(0,e.createElementVNode)('h1',bb,(0,e.toDisplayString)(E.value?.name||'N/A'),1),n.value?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('button',{key:0,class:'edit-button',onClick:k},'ç·¨è¼¯'))]),(0,e.createCommentVNode)(' æ‰€æœ‰å±¬æ€§çµ±ä¸€é¡¯ç¤º '),(0,e.createElementVNode)('div',fb,[(0,e.createCommentVNode)(' åŸºæœ¬ä¿¡æ¯ '),(0,e.createElementVNode)('div',hb,[a[19]||(a[19]=(0,e.createElementVNode)('span',{class:'attribute-label'},'ID',-1)),(0,e.createElementVNode)('span',xb,(0,e.toDisplayString)(E.value?'c1':'N/A'),1)]),(0,e.createElementVNode)('div',yb,[a[20]||(a[20]=(0,e.createElementVNode)('span',{class:'attribute-label'},'æ€§åˆ¥',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[0]||(a[0]=e=>o.value.æ€§åˆ¥=e),class:'attribute-input'},null,512)),[[e.vModelText,o.value.æ€§åˆ¥]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',_b,(0,e.toDisplayString)(E.value?.gender||'N/A'),1))]),(0,e.createElementVNode)('div',Eb,[a[21]||(a[21]=(0,e.createElementVNode)('span',{class:'attribute-label'},'å¹´é½¡',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[1]||(a[1]=e=>o.value.å¹´é½¡=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,o.value.å¹´é½¡,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',kb,(0,e.toDisplayString)(E.value?.age||'N/A'),1))]),(0,e.createCommentVNode)(' èº«é«”æ¸¬é‡ '),(0,e.createElementVNode)('div',Vb,[a[22]||(a[22]=(0,e.createElementVNode)('span',{class:'attribute-label unit-label'},'èº«é«˜ (cm)',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[2]||(a[2]=e=>o.value.èº«é«˜=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,o.value.èº«é«˜,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Nb,(0,e.toDisplayString)(E.value?.height||'N/A'),1))]),(0,e.createElementVNode)('div',wb,[a[23]||(a[23]=(0,e.createElementVNode)('span',{class:'attribute-label unit-label'},'é«”é‡ (kg)',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[3]||(a[3]=e=>o.value.é«”é‡=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,o.value.é«”é‡,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Bb,(0,e.toDisplayString)(E.value?.weight||'N/A'),1))]),(0,e.createElementVNode)('div',Cb,[a[24]||(a[24]=(0,e.createElementVNode)('span',{class:'attribute-label unit-label'},'èƒ¸åœ (cm)',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[4]||(a[4]=e=>o.value.èƒ¸åœ=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,o.value.èƒ¸åœ,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',$b,(0,e.toDisplayString)(E.value?.chest_size||'N/A'),1))]),(0,e.createElementVNode)('div',Sb,[a[25]||(a[25]=(0,e.createElementVNode)('span',{class:'attribute-label'},'ç½©æ¯',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[5]||(a[5]=e=>o.value.ç½©æ¯=e),class:'attribute-input'},null,512)),[[e.vModelText,o.value.ç½©æ¯]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Ib,(0,e.toDisplayString)(E.value?.cup_size||'ä¸é©ç”¨'),1))]),(0,e.createElementVNode)('div',zb,[a[26]||(a[26]=(0,e.createElementVNode)('span',{class:'attribute-label unit-label'},'è…°åœ (cm)',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[6]||(a[6]=e=>o.value.è…°åœ=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,o.value.è…°åœ,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Db,(0,e.toDisplayString)(E.value?.waist_size||'N/A'),1))]),(0,e.createElementVNode)('div',Tb,[a[27]||(a[27]=(0,e.createElementVNode)('span',{class:'attribute-label unit-label'},'è‡€åœ (cm)',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[7]||(a[7]=e=>o.value.è‡€åœ=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,o.value.è‡€åœ,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Mb,(0,e.toDisplayString)(E.value?.hips_size||'N/A'),1))]),(0,e.createCommentVNode)(' é‡‘éŒ¢ '),(0,e.createElementVNode)('div',Yb,[a[28]||(a[28]=(0,e.createElementVNode)('span',{class:'attribute-label'},'é‡‘éŒ¢',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[8]||(a[8]=e=>o.value.é‡‘éŒ¢=e),class:'attribute-input',type:'number'},null,512)),[[e.vModelText,o.value.é‡‘éŒ¢,void 0,{number:!0}]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Ob,(0,e.toDisplayString)((l=E.value?.money,void 0===l?'N/A':`$${l.toLocaleString()}`)),1))]),(0,e.createCommentVNode)(' ç”Ÿæ—¥ '),(0,e.createElementVNode)('div',Ab,[a[31]||(a[31]=(0,e.createElementVNode)('span',{class:'attribute-label'},'ç”Ÿæ—¥',-1)),n.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Kb,[(0,e.createElementVNode)('div',Ub,[(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[9]||(a[9]=e=>o.value.ç”Ÿæ—¥.month=e),class:'attribute-input birthday-month',type:'number',placeholder:'æœˆ',min:'1',max:'12'},null,512),[[e.vModelText,o.value.ç”Ÿæ—¥.month,void 0,{number:!0}]]),a[29]||(a[29]=(0,e.createElementVNode)('span',{class:'birthday-separator'},'æœˆ',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':a[10]||(a[10]=e=>o.value.ç”Ÿæ—¥.date=e),class:'attribute-input birthday-date',type:'number',placeholder:'æ—¥',min:'1',max:'31'},null,512),[[e.vModelText,o.value.ç”Ÿæ—¥.date,void 0,{number:!0}]]),a[30]||(a[30]=(0,e.createElementVNode)('span',{class:'birthday-separator'},'æ—¥',-1))])])):((0,e.openBlock)(),(0,e.createElementBlock)('span',Rb,(0,e.toDisplayString)((r=E.value?.birthday,r?`${r.month}æœˆ${r.date}æ—¥`:'N/A')),1))]),(0,e.createCommentVNode)(' å¤–è²Œç‰¹å¾µ '),(0,e.createElementVNode)('div',Lb,[a[32]||(a[32]=(0,e.createElementVNode)('span',{class:'attribute-label'},'èº«ä»½',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[11]||(a[11]=e=>o.value.èº«ä»½=e),class:'attribute-textarea'},null,512)),[[e.vModelText,o.value.èº«ä»½]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Fb,(0,e.toDisplayString)(E.value?.identity||'N/A'),1))]),(0,e.createElementVNode)('div',jb,[a[33]||(a[33]=(0,e.createElementVNode)('span',{class:'attribute-label'},'é«®åž‹',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[12]||(a[12]=e=>o.value.é«®åž‹=e),class:'attribute-textarea'},null,512)),[[e.vModelText,o.value.é«®åž‹]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Hb,(0,e.toDisplayString)(E.value?.hairstyle||'N/A'),1))]),(0,e.createElementVNode)('div',Pb,[a[34]||(a[34]=(0,e.createElementVNode)('span',{class:'attribute-label'},'æ¨£è²Œ',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[13]||(a[13]=e=>o.value.æ¨£è²Œ=e),class:'attribute-textarea'},null,512)),[[e.vModelText,o.value.æ¨£è²Œ]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',qb,(0,e.toDisplayString)(E.value?.appearance||'N/A'),1))]),(0,e.createElementVNode)('div',Gb,[a[35]||(a[35]=(0,e.createElementVNode)('span',{class:'attribute-label'},'è¡£è‘—',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[14]||(a[14]=e=>o.value.è¡£è‘—=e),class:'attribute-textarea'},null,512)),[[e.vModelText,o.value.è¡£è‘—]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Wb,(0,e.toDisplayString)(E.value?.clothes||'N/A'),1))]),(0,e.createElementVNode)('div',Xb,[a[36]||(a[36]=(0,e.createElementVNode)('span',{class:'attribute-label'},'æ„›å¥½',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[15]||(a[15]=e=>o.value.æ„›å¥½=e),class:'attribute-textarea'},null,512)),[[e.vModelText,o.value.æ„›å¥½]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Jb,(0,e.toDisplayString)(E.value?.favourite||'N/A'),1))]),(0,e.createElementVNode)('div',Zb,[a[37]||(a[37]=(0,e.createElementVNode)('span',{class:'attribute-label'},'ç°¡ä»‹',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[16]||(a[16]=e=>o.value.ç°¡ä»‹=e),class:'attribute-textarea'},null,512)),[[e.vModelText,o.value.ç°¡ä»‹]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',Qb,(0,e.toDisplayString)(E.value?.introduction||'N/A'),1))]),(0,e.createElementVNode)('div',ef,[a[38]||(a[38]=(0,e.createElementVNode)('span',{class:'attribute-label'},'æ€§æ ¼',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[17]||(a[17]=e=>o.value.æ€§æ ¼=e),class:'attribute-textarea'},null,512)),[[e.vModelText,o.value.æ€§æ ¼]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',tf,(0,e.toDisplayString)(E.value?.personality||'N/A'),1))]),E.value?.extra_information||n.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',af,[a[39]||(a[39]=(0,e.createElementVNode)('span',{class:'attribute-label'},'å…¶ä»–é‡è¦è³‡è¨Š',-1)),n.value?(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[18]||(a[18]=e=>o.value.å…¶ä»–é‡è¦è³‡è¨Š=e),class:'attribute-textarea'},null,512)),[[e.vModelText,o.value.å…¶ä»–é‡è¦è³‡è¨Š]]):((0,e.openBlock)(),(0,e.createElementBlock)('span',nf,(0,e.toDisplayString)(E.value?.extra_information||'N/A'),1))])):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createCommentVNode)(' é—œä¿‚å’Œç‰©å“ '),(0,e.createElementVNode)('div',of,[a[43]||(a[43]=(0,e.createElementVNode)('h3',{class:'section-title'},'é—œä¿‚',-1)),n.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',cf,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(d.value,(_,t)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'relation-edit-item'},[(0,e.createElementVNode)('select',{value:t,class:'relation-select',onChange:e=>((e,t)=>{if(o.value?.é—œä¿‚&&e!==t){const a=o.value.é—œä¿‚[e];delete o.value.é—œä¿‚[e],t&&(o.value.é—œä¿‚[t]=a)}})(String(t),e.target.value)},[a[41]||(a[41]=(0,e.createElementVNode)('option',{value:'',disabled:''},'é¸æ“‡è§’è‰²',-1)),((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(c.value,t=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t.id,value:t.id},(0,e.toDisplayString)(t.name)+' ('+(0,e.toDisplayString)(t.id)+') ',9,pf))),128))],40,uf),a[42]||(a[42]=(0,e.createElementVNode)('span',{class:'relation-edit-connector'},' æ˜¯æ­¤è§’è‰²çš„ ',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>d.value[t]=e,class:'relation-input',placeholder:'é—œä¿‚'},null,8,mf),[[e.vModelText,d.value[t]]]),(0,e.createElementVNode)('button',{class:'relation-remove-btn',onClick:e=>(e=>{o.value?.é—œä¿‚&&delete o.value.é—œä¿‚[e]})(String(t))},'Ã—',8,vf)]))),128)),(0,e.createElementVNode)('button',{class:'add-relation-btn',onClick:f},'+ æ·»åŠ é—œä¿‚')])):((0,e.openBlock)(),(0,e.createElementBlock)('div',rf,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(E.value?.relations||[],([t,n])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'relation-item'},[(0,e.createElementVNode)('span',lf,(0,e.toDisplayString)(x.value?.getCharacter(t)?.name||'æœªçŸ¥')+' ('+(0,e.toDisplayString)(t)+')',1),a[40]||(a[40]=(0,e.createElementVNode)('span',{class:'relation-connector'},' æ˜¯æ­¤è§’è‰²çš„ ',-1)),(0,e.createElementVNode)('span',df,(0,e.toDisplayString)(n),1)]))),128)),E.value?.relations&&0!==E.value.relations.size?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('div',sf,' æ²’æœ‰ä»»ä½•é—œä¿‚ '))]))]),(0,e.createElementVNode)('div',gf,[a[45]||(a[45]=(0,e.createElementVNode)('h3',{class:'section-title'},'æ‰€æŒç‰©',-1)),n.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',wf,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(s.value,(_,t)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:'inventory-edit-item'},[(0,e.createElementVNode)('select',{value:t,class:'inventory-select',onChange:e=>((e,t)=>{if(o.value?.æ‰€æŒç‰©&&e!==t){const a=o.value.æ‰€æŒç‰©[e];delete o.value.æ‰€æŒç‰©[e],t&&(o.value.æ‰€æŒç‰©[t]=a)}})(String(t),e.target.value)},[a[44]||(a[44]=(0,e.createElementVNode)('option',{value:'',disabled:''},'é¸æ“‡ç‰©å“æˆ–è²¯å­˜é»ž...',-1)),(0,e.createElementVNode)('optgroup',Cf,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(u.value.filter(e=>'item'===e.type),t=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t.id,value:t.id},(0,e.toDisplayString)(t.name)+' ('+(0,e.toDisplayString)(t.id)+') ',9,$f))),128))]),(0,e.createElementVNode)('optgroup',Sf,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(u.value.filter(e=>'storage'===e.type),t=>((0,e.openBlock)(),(0,e.createElementBlock)('option',{key:t.id,value:t.id},(0,e.toDisplayString)(t.name)+' ('+(0,e.toDisplayString)(t.id)+') ',9,If))),128))])],40,Bf),m(String(t))?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('span',zf,'Ã—')),m(String(t))?(0,e.createCommentVNode)('v-if',!0):(0,e.withDirectives)(((0,e.openBlock)(),(0,e.createElementBlock)('input',{key:1,'onUpdate:modelValue':e=>s.value[t]=e,class:'inventory-quantity-input',type:'number',min:'0',placeholder:'æ•¸é‡'},null,8,Df)),[[e.vModelText,s.value[t],void 0,{number:!0}]]),(0,e.createElementVNode)('button',{class:'inventory-remove-btn',onClick:e=>(e=>{o.value?.æ‰€æŒç‰©&&delete o.value.æ‰€æŒç‰©[e]})(String(t))},'Ã—',8,Tf)]))),128)),(0,e.createElementVNode)('button',{class:'add-inventory-btn',onClick:h},'+ æ·»åŠ ç‰©å“æˆ–è²¯å­˜é»ž')])):((0,e.openBlock)(),(0,e.createElementBlock)('div',bf,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(E.value?.inventory||[],([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:t,class:(0,e.normalizeClass)(['inventory-item',{'storage-item':m(t)}])},[(0,e.createElementVNode)('div',ff,[(0,e.createElementVNode)('span',hf,(0,e.toDisplayString)(p(t))+' ('+(0,e.toDisplayString)(t)+')',1),m(t)?((0,e.openBlock)(),(0,e.createElementBlock)('span',yf,'è²¯å­˜é»ž')):((0,e.openBlock)(),(0,e.createElementBlock)('span',xf,'Ã— '+(0,e.toDisplayString)(a),1))]),(0,e.createElementVNode)('div',_f,(0,e.toDisplayString)(b(t)),1),m(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',Ef,[0===v(t)?((0,e.openBlock)(),(0,e.createElementBlock)('div',kf,'ç„¡ç‰©å“')):((0,e.openBlock)(),(0,e.createElementBlock)('div',Vf,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(g(t),([t,a])=>((0,e.openBlock)(),(0,e.createElementBlock)('span',{key:t,class:(0,e.normalizeClass)(x.value?.storages.has(t)?'storage-item-tag':'inventory-item-tag')},(0,e.toDisplayString)(p(t))+' ('+(0,e.toDisplayString)(t)+')'+(0,e.toDisplayString)(x.value?.storages.has(t)?'':` Ã— ${a}`),3))),128))]))])):(0,e.createCommentVNode)('v-if',!0)],2))),128)),E.value?.inventory&&0!==E.value.inventory.size?(0,e.createCommentVNode)('v-if',!0):((0,e.openBlock)(),(0,e.createElementBlock)('div',Nf,' æ²’æœ‰ä»»ä½•ç‰©å“ '))]))]),(0,e.createCommentVNode)(' ç·¨è¼¯æŒ‰éˆ• '),n.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Mf,[(0,e.createElementVNode)('button',{class:'confirm-button',onClick:N},'ç¢ºèª'),(0,e.createElementVNode)('button',{class:'cancel-button',onClick:V},'å–æ¶ˆ')])):(0,e.createCommentVNode)('v-if',!0)],512)]);var r,l}}});i(9627);const Of=(0,d.A)(Yf,[['__scopeId','data-v-ada46c14']]),Af={class:'world-info-container'},Rf={class:'world-info-content'},Kf={class:'section'},Uf={class:'sortable-container'},Lf={key:0,class:'drop-indicator'},Ff=['data-id','onDragstart','onDragover','onDrop'],jf=['onClick'],Hf={class:'fold-content'},Pf={class:'input-group'},qf=['onUpdate:modelValue'],Gf={class:'input-group'},Wf=['onUpdate:modelValue'],Xf={class:'input-group'},Jf=['onUpdate:modelValue'],Zf={key:0,class:'generated-result'},Qf={class:'generated-text'},eh=['onClick'],th={class:'item-actions'},ah=['disabled','onClick'],nh={key:0,class:'loading-spinner'},oh=['disabled','onClick'],rh={key:0,class:'drop-indicator'},lh=(0,e.defineComponent)({__name:'world_info_tab',setup(t){(0,e.useCssVars)(t=>({ae590e90:(0,e.unref)(o)}));const a=(0,e.ref)(0),n=(0,e.ref)(null),o=(0,e.computed)(()=>`calc(100vh - ${a.value}px)`);(0,e.onMounted)(()=>{v(),f(),(async()=>{await(0,e.nextTick)();const t=document.querySelector('.tab-navigation');t&&window.ResizeObserver?(n.value=new ResizeObserver(e=>{for(const t of e)a.value=t.contentRect.height}),n.value.observe(t)):a.value=74})()}),(0,e.onUnmounted)(()=>{n.value&&(n.value.disconnect(),n.value=null)});const r=(0,e.ref)([]),l=(0,e.ref)(new Map),i=(0,e.computed)(()=>{try{const e=getVariables({type:'chat'});return!!e?.world_info?.trim()}catch{return!1}}),d=(0,e.ref)(null),c=(0,e.ref)(null),u=e=>{const t=r.value[e];if(t&&t.generated_content){t.content=t.generated_content,t.generated_content='',r.value[e]={...t};try{t.name&&t.name.trim()&&localStorage.removeItem(`world_info_item_generated_${t.name.trim()}`)}catch(e){console.error(`Failed to remove generated world info item for ${t.name} from localStorage:`,e)}}},p=()=>{const e={id:Date.now().toString(),name:'',content:'',generation_requirement:'',is_open:!1,generated_content:''};r.value.push(e)},m=()=>{try{const e=getVariables({type:'chat'}),t=r.value.map(e=>({name:e.name,content:e.content}));e.extra_world_info=t,replaceVariables(e,{type:'chat'}),(()=>{const e=getVariables({type:'chat'});let t='';for(const a of Array.from(e.extra_world_info))''!==a.name.trim()&&''!==a.content.trim()&&(t+=`<${a.name}>\n`,t+=`${a.content}\n`,t+=`</${a.name}>\n`,t+='\n');e.extra_world_info_prompt=t,replaceVariables(e,{type:'chat'})})()}catch(e){console.error('ä¿å­˜ extra_world_info å¤±æ•—:',e)}},v=()=>{try{const e=getVariables({type:'chat'});if(e?.extra_world_info&&Array.isArray(e.extra_world_info)){const t=e.extra_world_info.map((e,t)=>({id:`loaded_${t}_${Date.now()}`,name:e.name||'æœªå‘½åé …ç›®',content:e.content||'',generation_requirement:'',is_open:!1,generated_content:''}));r.value=t}}catch(e){console.error('åŠ è¼‰ extra_world_info å¤±æ•—:',e)}},g=()=>{c.value=null},b=()=>{d.value=null,c.value=null},f=()=>{try{const e=localStorage.getItem('world_info_tab_generation_requirements');if(e){const t=JSON.parse(e);r.value.forEach(e=>{e.name&&e.name.trim()&&t[e.name.trim()]&&(e.generation_requirement=t[e.name.trim()])})}r.value.forEach(e=>{if(e.name&&e.name.trim()){const t=localStorage.getItem(`world_info_item_generated_${e.name.trim()}`);if(t)try{const a=JSON.parse(t);a[e.name.trim()]&&(e.generated_content=a[e.name.trim()])}catch(t){console.error(`Failed to parse generated content for ${e.name}:`,t)}}})}catch(e){console.error('å¾ž localStorage åŠ è¼‰ç”Ÿæˆè¦æ±‚å¤±æ•—:',e)}};(0,e.watch)(r,()=>{m(),(()=>{try{const e={};r.value.forEach(t=>{t.name&&t.name.trim()&&(e[t.name.trim()]=t.generation_requirement)}),localStorage.setItem('world_info_tab_generation_requirements',JSON.stringify(e))}catch(e){console.error('ä¿å­˜ç”Ÿæˆè¦æ±‚åˆ° localStorage å¤±æ•—:',e)}})()},{deep:!0}),(0,e.watch)(()=>getVariables({type:'chat'}),e=>{e?.extra_world_info&&v()},{deep:!0});const h=e=>{let t='è«‹æ ¹æ“šä¸–ç•ŒèƒŒæ™¯è³‡è¨Šã€ç”Ÿæˆè¦æ±‚åŠå·²æœ‰é …ç›®è³‡æ–™ï¼Œç‚ºä»¥ä¸‹é …ç›®å®Œå–„å…§å®¹è¨­å®šï¼š\n\n';return t+=`åç¨±ï¼š${e.name||''}\n`,t+=`å…§å®¹ï¼š${e.content||''}\n`,t},x=()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„é …ç›®å…§å®¹è¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ è±å¯Œå¤šå½©çš„é …ç›®è¨­å®šã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºé …ç›®å®Œå–„å…§å®¹ã€‚\n';return a+='\n',a+='<ä¸–ç•ŒèƒŒæ™¯>\n','ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„é …ç›®å…§å®¹è¨­è¨ˆåŠ©æ‰‹ï¼Œæ“…é•·å‰µé€ è±å¯Œå¤šå½©çš„é …ç›®è¨­å®šã€‚è«‹æ ¹æ“šæä¾›çš„ä¸–ç•ŒèƒŒæ™¯åŠç”Ÿæˆè¦æ±‚ï¼Œç‚ºé …ç›®å®Œå–„å…§å®¹ã€‚\n\n<ä¸–ç•ŒèƒŒæ™¯>\n'},y=e=>{let t='\n</ä¸–ç•ŒèƒŒæ™¯>\n';return t+='\n',t+=`${(()=>{const e=getVariables({type:'chat'}).characters.c1,t=`${e.å§“æ°}${e.åå­—}`;let a=`<${t}Status>\n`;return a+='idï¼šc1\n',a+=`  å§“æ°ï¼š${e.å§“æ°||''}\n`,a+=`  åå­—ï¼š${e.åå­—||''}\n`,a+=`  å¹´é½¡ï¼š${e.å¹´é½¡||''}\n`,a+=`  æ€§åˆ¥ï¼š${e.æ€§åˆ¥||''}\n`,a+=`  èº«ä»½ï¼š${e.èº«ä»½||''}\n`,a+=`  èº«é«˜ï¼š${e.èº«é«˜||''}\n`,a+=`  é«”é‡ï¼š${e.é«”é‡||''}\n`,a+=`  èƒ¸åœï¼š${e.èƒ¸åœ||''}\n`,a+=`  ç½©æ¯ï¼š${e.ç½©æ¯||''}\n`,a+=`  è…°åœï¼š${e.è…°åœ||''}\n`,a+=`  è‡€åœï¼š${e.è‡€åœ||''}\n`,a+=`  é«®åž‹ï¼š${e.é«®åž‹||''}\n`,a+=`  æ¨£è²Œï¼š${e.æ¨£è²Œ||''}\n`,a+=`  è¡£è‘—ï¼š${e.è¡£è‘—||''}\n`,a+=`  ç°¡ä»‹ï¼š${e.ç°¡ä»‹||''}\n`,a+=`  æ€§æ ¼ï¼š${e.æ€§æ ¼||''}\n`,a+=`  æ„›å¥½ï¼š${e.æ„›å¥½||''}\n`,a+=`  é‡‘éŒ¢ï¼š${e.é‡‘éŒ¢||''}\n`,a+=`  ç”Ÿæ—¥æœˆä»½ï¼š${e.ç”Ÿæ—¥æœˆä»½||''}\n`,a+=`  ç”Ÿæ—¥æ—¥æœŸï¼š${e.ç”Ÿæ—¥æ—¥æœŸ||''}\n`,a+=`  å…¶ä»–é‡è¦è³‡è¨Šï¼š${e.å…¶ä»–é‡è¦è³‡è¨Š||''}\n`,a+=`  é—œä¿‚ï¼š${E(e.é—œä¿‚)}\n`,a+=`  å‹å¥½åº¦ï¼š${E(e.å‹å¥½åº¦)}\n`,a+=`  æ„›æƒ…åº¦ï¼š${E(e.æ„›æƒ…åº¦)}\n`,a+=`</${t}Status>`,a})()}\n`,t+='\n',t+=`${(()=>{const e=getVariables({type:'chat'}).characters;if(void 0===e)return'';let t='<CharacterStatus>\n';for(const[a,n]of Object.entries(e))'c1'!==a&&(t+=`idï¼š${a}\n`,t+=`  å§“æ°ï¼š${n.å§“æ°||''}\n`,t+=`  åå­—ï¼š${n.åå­—||''}\n`,t+=`  å¹´é½¡ï¼š${n.å¹´é½¡||''}\n`,t+=`  æ€§åˆ¥ï¼š${n.æ€§åˆ¥||''}\n`,t+=`  èº«ä»½ï¼š${n.èº«ä»½||''}\n`,t+=`  èº«é«˜ï¼š${n.èº«é«˜||''}\n`,t+=`  é«”é‡ï¼š${n.é«”é‡||''}\n`,t+=`  èƒ¸åœï¼š${n.èƒ¸åœ||''}\n`,t+=`  ç½©æ¯ï¼š${n.ç½©æ¯||''}\n`,t+=`  è…°åœï¼š${n.è…°åœ||''}\n`,t+=`  è‡€åœï¼š${n.è‡€åœ||''}\n`,t+=`  é«®åž‹ï¼š${n.é«®åž‹||''}\n`,t+=`  æ¨£è²Œï¼š${n.æ¨£è²Œ||''}\n`,t+=`  è¡£è‘—ï¼š${n.è¡£è‘—||''}\n`,t+=`  ç°¡ä»‹ï¼š${n.ç°¡ä»‹||''}\n`,t+=`  æ€§æ ¼ï¼š${n.æ€§æ ¼||''}\n`,t+=`  æ„›å¥½ï¼š${n.æ„›å¥½||''}\n`,t+=`  é‡‘éŒ¢ï¼š${n.é‡‘éŒ¢||''}\n`,t+=`  å¿ƒæƒ…ï¼š${n.å¿ƒæƒ…||''}\n`,t+=`  æ€§æ…¾ï¼š${n.æ€§æ…¾||''}\n`,t+=`  ç”Ÿæ—¥æœˆä»½ï¼š${n.ç”Ÿæ—¥æœˆä»½||''}\n`,t+=`  ç”Ÿæ—¥æ—¥æœŸï¼š${n.ç”Ÿæ—¥æ—¥æœŸ||''}\n`,t+=`  å…¶ä»–é‡è¦è³‡è¨Šï¼š${n.å…¶ä»–é‡è¦è³‡è¨Š||''}\n`,t+=`  é—œä¿‚ï¼š${E(n.é—œä¿‚)}\n`,t+=`  å‹å¥½åº¦ï¼š${E(n.å‹å¥½åº¦)}\n`,t+=`  æ„›æƒ…åº¦ï¼š${E(n.æ„›æƒ…åº¦)}\n\n`);return t+='</CharacterStatus>',t})()}\n`,t+='\n',t+=`${(()=>{let e='<ItemTable>\n';e+='|id|åç¨±|æè¿°|åƒ¹å€¼|\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).items;if(void 0===t)return'';for(const[a,n]of Object.entries(t))e+=`|${a}|${n.name}|${n.description}|${n.value}|\n`;return e+='</ItemTable>',e})()}\n`,t+='\n',t+=`${(()=>{let e='<LocationTable>\n';e+='|id|åœ°é»ž|ä½ç½®|æè¿°|å­åœ°é»ž|\n',e+='|---|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.location||''}|${n.description}|${t}|\n`}return e+='</LocationTable>',e})()}\n`,t+='\n',t+=`${(()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e})()}\n`,t+='\n',t+='<ç”Ÿæˆè¦æ±‚>\n',t+=`${e.generation_requirement||'ç„¡ç‰¹æ®Šè¦æ±‚'}\n`,t+='</ç”Ÿæˆè¦æ±‚>\n',t},E=e=>'['+Object.entries(e).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']',k=(e,t)=>{t.generated_content=e};return(t,a)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',Af,[(0,e.createElementVNode)('div',Rf,[a[5]||(a[5]=(0,e.createElementVNode)('h3',null,'ä¸–ç•Œè³‡è¨Š',-1)),(0,e.createElementVNode)('div',Kf,[(0,e.createElementVNode)('div',Uf,[((0,e.openBlock)(!0),(0,e.createElementBlock)(e.Fragment,null,(0,e.renderList)(r.value,(t,n)=>((0,e.openBlock)(),(0,e.createElementBlock)(e.Fragment,{key:t.id},[c.value===n&&null!==d.value&&d.value!==n?((0,e.openBlock)(),(0,e.createElementBlock)('div',Lf)):(0,e.createCommentVNode)('v-if',!0),(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['sortable-item',{dragging:d.value===n}]),'data-id':t.id,draggable:'true',onDragstart:e=>((e,t)=>{d.value=t,e.dataTransfer&&(e.dataTransfer.effectAllowed='move')})(e,n),onDragover:(0,e.withModifiers)(e=>((e,t)=>{e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect='move');const a=e.target.getBoundingClientRect(),n=e.clientY-a.top,o=a.height;c.value=n<o/2?t:t+1})(e,n),['prevent']),onDrop:e=>((e,t)=>{e.preventDefault();const a=d.value;if(null!==a&&a!==t){const e=[...r.value],[n]=e.splice(a,1);e.splice(t,0,n),r.value=e}d.value=null})(e,n),onDragend:b,onDragleave:g},[(0,e.createVNode)(s,{title:t.name||'æœªè¨­å®š','is-open':t.is_open,class:(0,e.normalizeClass)(['draggable-fold-bar',{incomplete:!t.name||!t.content}]),onToggle:e=>(e=>{r.value[e].is_open=!r.value[e].is_open})(n)},{'title-actions':(0,e.withCtx)(()=>[(0,e.createElementVNode)('button',{class:'remove-btn',title:'ç§»é™¤æ­¤é …ç›®',onClick:(0,e.withModifiers)(e=>(e=>{r.value.splice(e,1)})(n),['stop'])},[...a[0]||(a[0]=[(0,e.createElementVNode)('span',null,'Ã—',-1)])],8,jf)]),default:(0,e.withCtx)(()=>[(0,e.createElementVNode)('div',Hf,[(0,e.createElementVNode)('div',Pf,[a[1]||(a[1]=(0,e.createElementVNode)('label',null,'åç¨±',-1)),(0,e.withDirectives)((0,e.createElementVNode)('input',{'onUpdate:modelValue':e=>t.name=e,type:'text',class:'form-input',placeholder:'è¼¸å…¥é …ç›®åç¨±'},null,8,qf),[[e.vModelText,t.name]])]),(0,e.createElementVNode)('div',Gf,[a[2]||(a[2]=(0,e.createElementVNode)('label',null,'å…§å®¹',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>t.content=e,class:'form-textarea',placeholder:'è¼¸å…¥é …ç›®å…§å®¹',rows:'3'},null,8,Wf),[[e.vModelText,t.content]])]),(0,e.createElementVNode)('div',Xf,[a[3]||(a[3]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆè¦æ±‚',-1)),(0,e.withDirectives)((0,e.createElementVNode)('textarea',{'onUpdate:modelValue':e=>t.generation_requirement=e,class:'form-textarea',placeholder:'è¼¸å…¥ç”Ÿæˆæ­¤é …ç›®çš„è¦æ±‚',rows:'2'},null,8,Jf),[[e.vModelText,t.generation_requirement]])]),t.generated_content?((0,e.openBlock)(),(0,e.createElementBlock)('div',Zf,[a[4]||(a[4]=(0,e.createElementVNode)('label',null,'ç”Ÿæˆçµæžœï¼š',-1)),(0,e.createElementVNode)('div',Qf,(0,e.toDisplayString)(t.generated_content),1),(0,e.createElementVNode)('button',{class:'replace-btn',onClick:e=>u(n)},'ä½¿ç”¨',8,eh)])):(0,e.createCommentVNode)('v-if',!0),(0,e.createElementVNode)('div',th,[(0,e.createElementVNode)('button',{class:'action-btn generate',disabled:!(0,e.unref)(i)||l.value.get(t.id),onClick:e=>(async e=>{const t=r.value[e];if(t){l.value.set(t.id,!0);try{const a=h(t),n=x(),o=y(t),l=await generateRaw({user_input:a,ordered_prompts:[{role:'system',content:n},'char_description',{role:'system',content:o},'user_input']});k(l,t);try{if(t.name&&t.name.trim()){const e={};e[t.name.trim()]=t.generated_content||'',localStorage.setItem(`world_info_item_generated_${t.name.trim()}`,JSON.stringify(e))}}catch(e){console.error(`Failed to save generated world info item for ${t.name} to localStorage:`,e)}r.value[e]={...t}}catch(e){console.error(`ç”Ÿæˆé …ç›® ${t.name} å…§å®¹å¤±æ•—:`,e)}finally{l.value.set(t.id,!1)}}})(n)},[l.value.get(t.id)?((0,e.openBlock)(),(0,e.createElementBlock)('span',nh)):(0,e.createCommentVNode)('v-if',!0),(0,e.createTextVNode)(' '+(0,e.toDisplayString)(l.value.get(t.id)?'ç”Ÿæˆä¸­...':(0,e.unref)(i)?'ç”Ÿæˆå…§å®¹':'è«‹å…ˆå®Œæˆä¸–ç•ŒèƒŒæ™¯è¨­å®š'),1)],8,ah),(0,e.createElementVNode)('button',{class:'action-btn apply',disabled:!t.generated_content,onClick:e=>u(n)},' æ‡‰ç”¨çµæžœ ',8,oh)])])]),_:2},1032,['title','is-open','class','onToggle'])],42,Ff)],64))),128)),c.value===r.value.length&&null!==d.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',rh)):(0,e.createCommentVNode)('v-if',!0)]),(0,e.createElementVNode)('div',{class:'add-item-section'},[(0,e.createElementVNode)('button',{class:'add-btn',onClick:p},'+ æ·»åŠ æ–°é …ç›®')])])])]))}});i(5067);const ih=(0,d.A)(lh,[['__scopeId','data-v-ee3aed0a']]),dh={class:'main-interface-container'},sh={class:'tab-navigation top'},ch={class:'time-row'},uh={class:'current-time'},ph={class:'tab-row'},mh={class:'tab-row'},vh={key:'conversation',class:'conversation-area'},gh={key:'user',class:'user-area'},bh={key:'character',class:'character-area'},fh={key:'item',class:'item-area'},hh={key:'storage',class:'storage-area'},xh={key:'location',class:'location-area'},yh={key:'promise',class:'promise-area'},_h={key:'summary',class:'summary-area'},Eh={key:'world_info',class:'world-info-area'},kh={key:'settings',class:'settings-area'},Vh=(0,e.defineComponent)({__name:'main_interface',setup(t){const a=(0,e.ref)('conversation'),n=(0,e.ref)(null),o=(0,e.ref)(null),r=(0,e.ref)(null),l=(0,e.ref)(0),i=(0,e.ref)(''),d=['conversation','user','character','item','storage','location','promise','summary','world_info','settings'],s=(0,e.ref)(0),c=(0,e.ref)(0),u=(0,e.ref)(0),p=(0,e.ref)(!1),m=(0,e.ref)(!1),v=(0,e.ref)('right'),g=()=>{const e=new Date,t=e.getHours().toString().padStart(2,'0'),a=e.getMinutes().toString().padStart(2,'0');i.value=`${t}:${a}`};let b=null;(0,e.onMounted)(()=>{g(),b=window.setInterval(g,6e4)}),(0,e.onUnmounted)(()=>{null!==b&&clearInterval(b)});const f=(e,t=!1)=>{e!==a.value?(m.value=t,'conversation'===a.value&&n.value&&(l.value=n.value.getScrollPosition()),a.value=e,'conversation'===e&&setTimeout(()=>{n.value&&n.value.setScrollPosition(l.value)},0)):'character'===e&&o.value?o.value.handleTabClick():'user'===e&&r.value&&r.value.handleTabClick()},h=e=>{const t=d.indexOf(e);return-1===t||t===d.length-1?e:d[t+1]},x=e=>{const t=d.indexOf(e);return-1===t||0===t?e:d[t-1]},y=e=>{n.value&&n.value.handleRenderSizeChanged&&n.value.handleRenderSizeChanged(e)},E=e=>{const t=e.touches[0];s.value=t.clientX,c.value=t.clientY,u.value=Date.now()},k=e=>{},V=e=>{const t=e.changedTouches[0],n=t.clientX-s.value,o=t.clientY-c.value,r=Date.now()-u.value;if(Math.abs(n)>20&&r<1e3&&Math.abs(n)>Math.abs(o))if(n<0){v.value='left';const e=h(a.value);f(e,!0)}else{v.value='right';const e=x(a.value);f(e,!0)}},N=e=>{p.value=!0,s.value=e.clientX,c.value=e.clientY,u.value=Date.now()},w=e=>{},B=e=>{if(!p.value)return;p.value=!1;const t=e.clientX-s.value,n=e.clientY-c.value,o=Date.now()-u.value;if(Math.abs(t)>20&&o<1e3&&Math.abs(t)>Math.abs(n))if(t<0){v.value='left';const e=h(a.value);f(e,!0)}else{v.value='right';const e=x(a.value);f(e,!0)}};return(t,l)=>((0,e.openBlock)(),(0,e.createElementBlock)('div',dh,[(0,e.createElementVNode)('div',sh,[(0,e.createCommentVNode)(' æ™‚é–“é¡¯ç¤ºè¡Œ '),(0,e.createElementVNode)('div',ch,[(0,e.createElementVNode)('div',uh,(0,e.toDisplayString)(i.value),1)]),(0,e.createCommentVNode)(' ç¬¬ä¸€è¡Œæ¨™ç±¤ '),(0,e.createElementVNode)('div',ph,[(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'conversation'===a.value}]),onClick:l[0]||(l[0]=e=>f('conversation'))},' å°è©± ',2),(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'user'===a.value}]),onClick:l[1]||(l[1]=e=>f('user'))},'ç”¨æˆ¶',2),(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'character'===a.value}]),onClick:l[2]||(l[2]=e=>f('character'))},' è§’è‰² ',2),(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'item'===a.value}]),onClick:l[3]||(l[3]=e=>f('item'))},'ç‰©å“',2),(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'storage'===a.value}]),onClick:l[4]||(l[4]=e=>f('storage'))},'è²¯å­˜',2)]),(0,e.createCommentVNode)(' ç¬¬äºŒè¡Œæ¨™ç±¤ '),(0,e.createElementVNode)('div',mh,[(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'location'===a.value}]),onClick:l[5]||(l[5]=e=>f('location'))},' åœ°é»ž ',2),(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'promise'===a.value}]),onClick:l[6]||(l[6]=e=>f('promise'))},' ç´„å®š ',2),(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'summary'===a.value}]),onClick:l[7]||(l[7]=e=>f('summary'))},' ç¸½çµ ',2),(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'world_info'===a.value}]),onClick:l[8]||(l[8]=e=>f('world_info'))},' ä¸–ç•Œ ',2),(0,e.createElementVNode)('button',{class:(0,e.normalizeClass)(['tab-button',{active:'settings'===a.value}]),onClick:l[9]||(l[9]=e=>f('settings'))},' è¨­ç½® ',2)])]),(0,e.createElementVNode)('div',{class:'main-content',onTouchstart:E,onTouchmove:k,onTouchend:V,onMousedown:N,onMousemove:w,onMouseup:B},[(0,e.createVNode)(e.Transition,{name:m.value?`slide-${v.value}`:'no-transition',mode:'out-in'},{default:(0,e.withCtx)(()=>['conversation'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',vh,[(0,e.createVNode)(Rc,{ref_key:'conversation_tab_ref',ref:n},null,512)])):'user'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',gh,[(0,e.createVNode)(Of,{ref_key:'user_tab_ref',ref:r},null,512)])):'character'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',bh,[(0,e.createVNode)(ic,{ref_key:'character_tab_ref',ref:o},null,512)])):'item'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',fh,[(0,e.createVNode)(mu)])):'storage'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',hh,[(0,e.createVNode)(Rm)])):'location'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',xh,[(0,e.createVNode)(hp)])):'promise'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',yh,[(0,e.createVNode)(zv)])):'summary'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',_h,[(0,e.createVNode)(ub)])):'world_info'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',Eh,[(0,e.createVNode)(ih)])):'settings'===a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',kh,[(0,e.createVNode)(vg,{onRenderSizeChanged:y})])):(0,e.createCommentVNode)('v-if',!0)]),_:1},8,['name'])],32)]))}});i(7502);const Nh=(0,d.A)(Vh,[['__scopeId','data-v-9fb68f82']]),wh={key:0,class:'initialization-wrapper'},Bh=(0,e.defineComponent)({__name:'app',setup(t){const a=(0,e.ref)(!1),n=(0,e.ref)(!1),o=(0,e.ref)('100vh'),r=()=>{if(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)o.value='100vh';else try{window.parent&&window.parent.innerHeight&&(o.value=.8*window.parent.innerHeight+'px')}catch(e){console.warn('Unable to access parent window height:',e)}},l=()=>{r()},i=()=>{try{const e=getVariables({type:'chat'});void 0===e?.is_initialized?(n.value=!1,insertOrAssignVariables({is_initialized:!1},{type:'chat'})):n.value=e.is_initialized}catch(e){console.error('Failed to load chat settings:',e)}};return(0,e.onMounted)(()=>{a.value=!0,i(),eventOn(tavern_events.CHAT_CHANGED,e=>{console.log('Chat changed to:',e),i()}),eventOn('initialization_completed',()=>{console.log('Initialization completed, switching to main interface'),n.value=!0}),(0,e.watch)(()=>getVariables({type:'chat'}),e=>{void 0!==e?.is_initialized&&(n.value=e.is_initialized)},{deep:!0}),r(),document.addEventListener('fullscreenchange',l),document.addEventListener('webkitfullscreenchange',l),document.addEventListener('mozfullscreenchange',l),document.addEventListener('MSFullscreenChange',l)}),(0,e.onUnmounted)(()=>{document.removeEventListener('fullscreenchange',l),document.removeEventListener('webkitfullscreenchange',l),document.removeEventListener('mozfullscreenchange',l),document.removeEventListener('MSFullscreenChange',l)}),(t,r)=>a.value?((0,e.openBlock)(),(0,e.createElementBlock)('div',{key:0,class:'app-container',style:(0,e.normalizeStyle)({height:o.value})},[(0,e.createCommentVNode)(' åˆå§‹åŒ–UI '),n.value?((0,e.openBlock)(),(0,e.createElementBlock)(e.Fragment,{key:1},[(0,e.createCommentVNode)(' ä¸»è¦UI '),(0,e.createElementVNode)('div',null,[(0,e.createVNode)(Nh)])],2112)):((0,e.openBlock)(),(0,e.createElementBlock)('div',wh,[(0,e.createVNode)(Li)]))],4)):(0,e.createCommentVNode)('v-if',!0)}});i(9645),i(4939);const Ch=(0,d.A)(Bh,[['__scopeId','data-v-e8f6a8aa']]);class $h{registry=new Map;register(e){return t=>(e||(e=t.name),this.registry.set(e,t),t)}get(e){return this.registry.get(e)}getAll(){return this.registry}has(e){return this.registry.has(e)}}var Sh,Ih,zh,Dh,Th,Mh,Yh,Oh,Ah,Rh,Kh,Uh,Lh,Fh,jh,Hh,Ph,qh,Gh,Wh,Xh,Jh,Zh,Qh,ex,tx=function(e,t,a,n){var o,r=arguments.length,l=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(l=(r<3?o(l):r>3?o(t,a,l):o(t,a))||l);return r>3&&l&&Object.defineProperty(t,a,l),l},ax=function(e,t){if('object'==typeof Reflect&&'function'==typeof Reflect.metadata)return Reflect.metadata(e,t)};class nx{static registry=new $h;constructor(...e){}static parseString(e){if(void 0===e)return[];return[...e.matchAll(this.prototype.REGEX)].map(e=>({command:this.prototype.create(e.slice(1).map(e=>e.trim())),index:e.index})).filter(({command:e})=>e.isValid())}}let ox=Sh=class extends nx{delta_minutes;constructor(e){super(),this.delta_minutes=e}get REGEX(){return/deltaMinutes\(\s*([^,()]+)\s*\)/g}create(e){const t=Number(e[0]);return new Sh(t)}isValid(){return!isNaN(this.delta_minutes)}execute(e,t){return e.datetime.deltaMinutes(this.delta_minutes),e}};ox=Sh=tx([nx.registry.register(),ax('design:paramtypes',[Number])],ox);let rx=Ih=class extends nx{current_location_id;constructor(e){super(),this.current_location_id=e}get REGEX(){return/setCurrentLocation\(\s*"([^"]+?)"\s*\s*\)/g}create(e){const t=e[0];return new Ih(t)}isValid(){return!0}execute(e,t){return e.locations.has(this.current_location_id)?(e.current_location_id=this.current_location_id,e):e}};rx=Ih=tx([nx.registry.register(),ax('design:paramtypes',[String])],rx);let lx=zh=class extends nx{weather;constructor(e){super(),this.weather=e}get REGEX(){return/setWeather\(\s*"([^"]+?)"\s*\s*\)/g}create(e){const t=e[0];return new zh(t)}isValid(){return!0}execute(e,t){return e.weather=this.weather,e}};lx=zh=tx([nx.registry.register(),ax('design:paramtypes',[String])],lx);let ix=Dh=class extends nx{id;name;age;gender;identity;introduction;personality;height;weight;chest_size;cup_size;waist_size;hips_size;hairstyle;appearance;clothes;birthday_month;birthday_date;favourite;extra_information;money;mood;horny;constructor(e,t,a,n,o,r,l,i,d,s,c,u,p,m,v,g,b,f,h,x,y,E,k){super(),this.id=e,this.name=t,this.age=a,this.gender=n,this.identity=o,this.introduction=r,this.personality=l,this.height=i,this.weight=d,this.chest_size=s,this.cup_size=c,this.waist_size=u,this.hips_size=p,this.hairstyle=m,this.appearance=v,this.clothes=g,this.birthday_month=b,this.birthday_date=f,this.favourite=h,this.extra_information=x,this.money=y,this.mood=E,this.horny=k}get REGEX(){return/createCharacter\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^"]+?)\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^"]+?)\s*,\s*([^"]+?)\s*,\s*([^"]+?)\s*,\s*"([^"]+?)"\s*,\s*([^"]+?)\s*,\s*([^"]+?)\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^"]+?)\s*,\s*([^"]+?)\s*,\s*"([^"]+?)"\s*,\s*"([^"]*?)"\s*,\s*([^"]+?)\s*,\s*([^"]+?)\s*,\s*([^"]+?)\s*\)/g}create(e){const t=e[0],a=e[1],n=Number(e[2]),o=e[3],r=e[4],l=e[5],i=e[6],d=Number(e[7]),s=Number(e[8]),c=Number(e[9]),u=e[10],p=Number(e[11]),m=Number(e[12]),v=e[13],g=e[14],b=e[15],f=Number(e[16]),h=Number(e[17]),x=e[18],y=e[19],E=Number(e[20]),k=Number(e[21]),V=Number(e[22]);return new Dh(t,a,n,o,r,l,i,d,s,c,u,p,m,v,g,b,f,h,x,y,E,k,V)}isValid(){return!isNaN(this.age)&&(!isNaN(this.height)&&(!isNaN(this.weight)&&(!isNaN(this.chest_size)&&(!isNaN(this.waist_size)&&(!isNaN(this.hips_size)&&(!isNaN(this.birthday_month)&&(!isNaN(this.birthday_date)&&(!isNaN(this.money)&&(!isNaN(this.mood)&&!isNaN(this.horny))))))))))}execute(e,t){if(e.hasCharacter(this.id))return e;let a=e.datetime.year-this.age;(e.datetime.month<this.birthday_month||e.datetime.month===this.birthday_month&&e.datetime.date<this.birthday_date)&&(a-=1);const n=new $o(new Date(a,this.birthday_month,this.birthday_date)),o=new So(this.name,this.age,this.gender,this.identity,this.introduction,this.personality,this.height,this.weight,this.chest_size,this.cup_size,this.waist_size,this.hips_size,this.hairstyle,this.appearance,this.clothes,n,this.favourite,this.extra_information,this.money,this.mood,this.horny,new Map,new Map,new Map,new Map);return e.active_characters.set(this.id,o),e}};ix=Dh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,Number,String,String,String,String,Number,Number,Number,String,Number,Number,String,String,String,Number,Number,String,String,Number,Number,Number])],ix);let dx=Th=class extends nx{id;delta;constructor(e,t){super(),this.id=e,this.delta=t}get REGEX(){return/deltaMoney\(\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=Number(e[1]);return new Th(t,a)}isValid(){return!isNaN(this.delta)}execute(e,t){const a=e.getCharacter(this.id),n=e.storages.get(this.id);return a||n?(a?a.money+=this.delta:n.money+=this.delta,e):e}};dx=Th=tx([nx.registry.register(),ax('design:paramtypes',[String,Number])],dx);let sx=Mh=class extends nx{from_id;to_id;delta;constructor(e,t,a){super(),this.from_id=e,this.to_id=t,this.delta=a}get REGEX(){return/deltaFriendship\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=e[1],n=Number(e[2]);return new Mh(t,a,n)}isValid(){return!isNaN(this.delta)}execute(e,t){if(!e.hasCharacter(this.from_id))return e;if(!e.hasCharacter(this.to_id))return e;const a=e.getCharacter(this.from_id);return a?(a.deltaFriendship(this.to_id,this.delta),e):e}};sx=Mh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,Number])],sx);let cx=Yh=class extends nx{from_id;to_id;delta;constructor(e,t,a){super(),this.from_id=e,this.to_id=t,this.delta=a}get REGEX(){return/deltaLove\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=e[1],n=Number(e[2]);return new Yh(t,a,n)}isValid(){return!isNaN(this.delta)}execute(e,t){if(!e.hasCharacter(this.from_id))return e;if(!e.hasCharacter(this.to_id))return e;const a=e.getCharacter(this.from_id);return a?(a.deltaLove(this.to_id,this.delta),e):e}};cx=Yh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,Number])],cx);let ux=Oh=class extends nx{id;delta;constructor(e,t){super(),this.id=e,this.delta=t}get REGEX(){return/deltaMood\(\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=Number(e[1]);return new Oh(t,a)}isValid(){return!isNaN(this.delta)}execute(e,t){const a=e.getCharacter(this.id);return a?(a.deltaMood(this.delta),e):e}};ux=Oh=tx([nx.registry.register(),ax('design:paramtypes',[String,Number])],ux);let px=Ah=class extends nx{id;delta;constructor(e,t){super(),this.id=e,this.delta=t}get REGEX(){return/deltaHorny\(\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=Number(e[1]);return new Ah(t,a)}isValid(){return!isNaN(this.delta)}execute(e,t){const a=e.getCharacter(this.id);return a?(a.deltaHorny(this.delta),e):e}};px=Ah=tx([nx.registry.register(),ax('design:paramtypes',[String,Number])],px);let mx=Rh=class extends nx{from_id;to_id;relation;constructor(e,t,a){super(),this.from_id=e,this.to_id=t,this.relation=a}get REGEX(){return/setRelation\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1],n=e[2];return new Rh(t,a,n)}isValid(){return!0}execute(e,t){if(!e.hasCharacter(this.from_id))return e;if(!e.hasCharacter(this.to_id))return e;const a=e.getCharacter(this.from_id);return a?(a.relations.set(this.to_id,this.relation),e):e}};mx=Rh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,String])],mx);let vx=Kh=class extends nx{id;key;value;constructor(e,t,a){super(),this.id=e,this.key=t,this.value=a}get REGEX(){return/setCharacterProperty\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1],n=e[2];return new Kh(t,a,n)}isValid(){return[So.IDENTITY_KEY,So.INTRODUCTION_KEY,So.PERSONALITY_KEY,So.HAIRSTYLE_KEY,So.APPEARANCE_KEY,So.CLOTHES_KEY,So.FAVOURITE_KEY,So.EXTRA_INFORMATION_KEY].includes(this.key)}execute(e,t){const a=e.getCharacter(this.id);if(!a)return e;switch(this.key){case So.IDENTITY_KEY:a.identity=this.value;break;case So.INTRODUCTION_KEY:a.introduction=this.value;break;case So.PERSONALITY_KEY:a.personality=this.value;break;case So.HAIRSTYLE_KEY:a.hairstyle=this.value;break;case So.APPEARANCE_KEY:a.appearance=this.value;break;case So.CLOTHES_KEY:a.clothes=this.value;break;case So.FAVOURITE_KEY:a.favourite=this.value;break;case So.EXTRA_INFORMATION_KEY:a.extra_information=this.value}return e}};vx=Kh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,String])],vx);let gx=Uh=class extends nx{id;name;description;value;constructor(e,t,a,n){super(),this.id=e,this.name=t,this.description=a,this.value=n}get REGEX(){return/createItem\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=e[1],n=e[2],o=Number(e[3]);return new Uh(t,a,n,o)}isValid(){return!isNaN(this.value)}execute(e,t){if(e.items.has(this.id))return e;const a=new Io(this.name,this.description,this.value);return e.items.set(this.id,a),e}};gx=Uh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,String,Number])],gx);let bx=Lh=class extends nx{id;item_id;delta;constructor(e,t,a){super(),this.id=e,this.item_id=t,this.delta=a}get REGEX(){return/deltaInventory\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=e[1],n=Number(e[2]);return new Lh(t,a,n)}isValid(){return!isNaN(this.delta)}execute(e,t){if(!e.items.has(this.item_id))return e;const a=e.getCharacter(this.id),n=e.storages.get(this.id);if(!a&&!n)return e;const o=a?a.inventory:n.inventory;let r=o.get(this.item_id)||0;return r+=this.delta,r<=0?o.delete(this.item_id):o.set(this.item_id,r),e}};bx=Lh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,Number])],bx);let fx=Fh=class extends nx{id;name;description;parent_id;constructor(e,t,a,n){super(),this.id=e,this.name=t,this.description=a,this.parent_id=n}get REGEX(){return/createStorage\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1],n=e[2],o=e[3];return new Fh(t,a,n,o)}isValid(){return''!==this.id.trim()&&(''!==this.name.trim()&&(''!==this.description.trim()&&''!==this.parent_id.trim()))}execute(e,t){return e.addStorage(this.id,this.name,this.description,this.parent_id),e}};fx=Fh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,String,String])],fx);let hx=jh=class extends nx{id;constructor(e){super(),this.id=e}get REGEX(){return/removeStorage\(\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0];return new jh(t)}isValid(){return''!==this.id.trim()}execute(e,t){return e.removeStorage(this.id),e}};hx=jh=tx([nx.registry.register(),ax('design:paramtypes',[String])],hx);let xx=Hh=class extends nx{storage_id;parent_id;constructor(e,t){super(),this.storage_id=e,this.parent_id=t}get REGEX(){return/setStorageParent\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1];return new Hh(t,a)}isValid(){return''!==this.storage_id.trim()&&''!==this.parent_id.trim()}execute(e,t){return e.setStorageParent(this.storage_id,this.parent_id),e}};xx=Hh=tx([nx.registry.register(),ax('design:paramtypes',[String,String])],xx);let yx=Ph=class extends nx{id;name;location;description;constructor(e,t,a,n){super(),this.id=e,this.name=t,this.location=a,this.description=n}get REGEX(){return/createLocation\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1],n=e[2],o=e[3];return new Ph(t,a,n,o)}isValid(){return''!==this.id.trim()&&(''!==this.name.trim()&&(''!==this.location.trim()&&''!==this.description.trim()))}execute(e,t){if(e.locations.has(this.id))return e;const a=new zo(this.id,this.name,this.location,this.description,null,[],[]);return e.locations.set(this.id,a),e}};yx=Ph=tx([nx.registry.register(),ax('design:paramtypes',[String,String,String,String])],yx);let _x=qh=class extends nx{parent_location_id;sub_location_id;constructor(e,t){super(),this.parent_location_id=e,this.sub_location_id=t}get REGEX(){return/addSubLocation\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1];return new qh(t,a)}isValid(){return''!==this.parent_location_id.trim()&&''!==this.sub_location_id.trim()}execute(e,t){const a=e.locations.get(this.parent_location_id);if(!a)return e;const n=e.locations.get(this.sub_location_id);return n?(null!==n.parent_location_id||a.sub_location_ids.includes(this.sub_location_id)||(a.sub_location_ids.push(this.sub_location_id),n.parent_location_id=this.parent_location_id),e):e}};_x=qh=tx([nx.registry.register(),ax('design:paramtypes',[String,String])],_x);let Ex=Gh=class extends nx{id;description;constructor(e,t){super(),this.id=e,this.description=t}get REGEX(){return/setLocationDescription\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1];return new Gh(t,a)}isValid(){return''!==this.id.trim()}execute(e,t){const a=e.locations.get(this.id);return a?(a.description=this.description,e):e}};Ex=Gh=tx([nx.registry.register(),ax('design:paramtypes',[String,String])],Ex);let kx=Wh=class extends nx{deadline_year;deadline_month;deadline_date;deadline_hours;deadline_minutes;character_ids;location_id;description;constructor(e,t,a,n,o,r,l,i){super(),this.deadline_year=e,this.deadline_month=t,this.deadline_date=a,this.deadline_hours=n,this.deadline_minutes=o,this.character_ids=r,this.location_id=l,this.description=i}get REGEX(){return/createPromise\(\s*([^,()]+)\s*,\s*([^,()]+)\s*,\s*([^,()]+)\s*,\s*([^,()]+)\s*,\s*([^,()]+)\s*,\s*"([^"]+?)"\s*,\s*"([^"]*?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=Number(e[0]),a=Number(e[1]),n=Number(e[2]),o=Number(e[3]),r=Number(e[4]),l=e[5],i=e[6],d=e[7],s=l.split(',').map(e=>e.trim());return new Wh(t,a,n,o,r,s,i,d)}isValid(){return!isNaN(this.deadline_year)&&(!isNaN(this.deadline_month)&&(!isNaN(this.deadline_date)&&(!isNaN(this.deadline_hours)&&!isNaN(this.deadline_minutes))))}execute(e,t){if(''!==this.location_id&&!e.locations.has(this.location_id))return e;for(const t of this.character_ids)if(!e.hasCharacter(t))return e;const a=new $o(new Date(this.deadline_year,this.deadline_month-1,this.deadline_date,this.deadline_hours,this.deadline_minutes)),n=''===this.location_id?null:this.location_id;return e.addPromise(a,this.character_ids,n,this.description),e}};kx=Wh=tx([nx.registry.register(),ax('design:paramtypes',[Number,Number,Number,Number,Number,Array,String,String])],kx);let Vx=Xh=class extends nx{id;constructor(e){super(),this.id=e}get REGEX(){return/removePromise\(\s*"([^,()]+)"\s*\)/g}create(e){const t=e[0];return new Xh(t)}isValid(){return''!==this.id.trim()}execute(e,t){return e.promises.has(this.id)?(e.promises.delete(this.id),e):e}};Vx=Xh=tx([nx.registry.register(),ax('design:paramtypes',[String])],Vx);let Nx=Jh=class extends nx{event;constructor(e){super(),this.event=e}get REGEX(){return/startEvent\(\s*"([^"]+)"\s*\)/g}create(e){const t=e[0];return new Jh(t)}isValid(){return''!==this.event.trim()}execute(e,t){return e.current_event=this.event,e}};Nx=Jh=tx([nx.registry.register(),ax('design:paramtypes',[String])],Nx);let wx=Zh=class extends nx{summary;weighting;constructor(e,t){super(),this.summary=e,this.weighting=t}get REGEX(){return/finishEvent\(\s*"([^"]+)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=Number(e[1]);return new Zh(t,a)}isValid(){return''!==this.summary.trim()&&!isNaN(this.weighting)}execute(e,t){return e.addSummary(this.summary,this.weighting,t),e.current_event=Yo.CURRENT_EVENT_NULL_VALUE,e}};wx=Zh=tx([nx.registry.register(),ax('design:paramtypes',[String,Number])],wx);let Bx=Qh=class extends nx{id;constructor(e){super(),this.id=e}get REGEX(){return/activateCharacter\(\s*"([^"]+)"\s*\)/g}create(e){const t=e[0];return new Qh(t)}isValid(){return''!==this.id.trim()}execute(e,t){if(!e.deactive_characters.has(this.id))return e;const a=e.deactive_characters.get(this.id);return e.active_characters.set(this.id,a),e.deactive_characters.delete(this.id),e}};Bx=Qh=tx([nx.registry.register(),ax('design:paramtypes',[String])],Bx);let Cx=ex=class extends nx{id;constructor(e){super(),this.id=e}get REGEX(){return/deactivateCharacter\(\s*"([^"]+)"\s*\)/g}create(e){const t=e[0];return new ex(t)}isValid(){return''!==this.id.trim()}execute(e,t){if(!e.active_characters.has(this.id))return e;const a=e.active_characters.get(this.id);return e.deactive_characters.set(this.id,a),e.active_characters.delete(this.id),e}};Cx=ex=tx([nx.registry.register(),ax('design:paramtypes',[String])],Cx);class $x{commands=[];constructor(e){this.commands=e??[]}pushCommand(e){this.commands.push(e)}static fromString(e){if(!e.includes('<VariableUpdate>'))return new $x;const t=e.split('<VariableUpdate>'),a=t[t.length-1].split('</VariableUpdate>')[0];let n=[];for(const e of nx.registry.getAll().values())n=n.concat(e.parseString(a));n.sort((e,t)=>e.index-t.index);const o=n.map(e=>e.command);return console.log('[Commands] commands:',o),new $x(o)}execute(e,t){for(const a of this.commands)a.execute(e,t);return e}*[Symbol.iterator](){for(const e of this.commands)yield e}}eventOn('MESSAGE_SENT',e=>{console.log('[event_listener] MESSAGE_SENT start');const t=Yo.loadFromVariable(e-1),a=getChatMessages(e)[0].message;$x.fromString(a).execute(t,e),t.saveAsVariable(e),console.log('[event_listener] MESSAGE_SENT end')}),eventOn('MESSAGE_RECEIVED',e=>{console.log('[event_listener] MESSAGE_RECEIVED start');const t=Yo.loadFromVariable(e-1),a=getChatMessages(e)[0].message;$x.fromString(a).execute(t,e),t.saveAsVariable(e),console.log('[event_listener] MESSAGE_RECEIVED end'),eventEmit('MESSAGE_RECEIVED_PROCESSED',e)}),$(()=>{(0,e.createApp)(Ch).mount('#app')})})();