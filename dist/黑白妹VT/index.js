import{klona as e}from'https://testingcf.jsdelivr.net/npm/klona/+esm';var t={156:(e,t,a)=>{var n=a(3664);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('7cd8ef08',n,!1,{ssrId:!0})},325:(e,t,a)=>{var n=a(7817);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('ff3685a2',n,!1,{ssrId:!0})},575:(e,t,a)=>{var n=a(6603);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('06773433',n,!1,{ssrId:!0})},730:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.extra-container[data-v-09fb0ec2]{color:#e0e0e0;max-width:1000px;margin:0 0;padding:16px}.extra-container h3[data-v-09fb0ec2]{color:#007acc;margin-bottom:24px;font-size:20px}.section[data-v-09fb0ec2]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.section h4[data-v-09fb0ec2]{color:#b0b0b0;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.sortable-container[data-v-09fb0ec2]{margin-bottom:16px}.sortable-item[data-v-09fb0ec2]{margin-bottom:8px;transition:all .2s ease;position:relative}.sortable-item.dragging[data-v-09fb0ec2]{opacity:.7;transform:scale(1.02);box-shadow:0 4px 12px rgba(0,122,204,.3);z-index:1000}.sortable-item[data-v-09fb0ec2]:not(.dragging){transform:translateY(0)}.draggable-fold-bar.incomplete[data-v-09fb0ec2] .fold-bar-btn span{color:#ef4444 !important}.drop-indicator[data-v-09fb0ec2]{height:4px;background:linear-gradient(90deg,#007acc,#005999);border-radius:2px;margin:4px 0;box-shadow:0 0 8px rgba(0,122,204,.6);animation:pulse-09fb0ec2 1.5s ease-in-out infinite;position:relative}.drop-indicator[data-v-09fb0ec2]::before{content:"";position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:8px;height:8px;background:#007acc;border-radius:50%;box-shadow:0 0 12px rgba(0,122,204,.8)}@keyframes pulse-09fb0ec2{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.7;transform:scale(1.1)}}.fold-content[data-v-09fb0ec2]{padding:12px 0}.fold-content .input-group[data-v-09fb0ec2]{margin-bottom:16px}.fold-content .input-group[data-v-09fb0ec2]:last-child{margin-bottom:0}.fold-content .input-group label[data-v-09fb0ec2]{display:block;margin-bottom:6px;color:#b0b0b0;font-weight:500;font-size:13px}.fold-content .input-group .form-input[data-v-09fb0ec2],.fold-content .input-group .form-textarea[data-v-09fb0ec2]{width:100%;padding:8px 12px;background:#2a2a2a;border:1px solid #404040;border-radius:4px;color:#e0e0e0;font-size:14px;font-family:inherit;transition:all .2s ease}.fold-content .input-group .form-input[data-v-09fb0ec2]:focus,.fold-content .input-group .form-textarea[data-v-09fb0ec2]:focus{outline:none;border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.fold-content .input-group .form-input[data-v-09fb0ec2]::placeholder,.fold-content .input-group .form-textarea[data-v-09fb0ec2]::placeholder{color:#666}.fold-content .input-group .form-textarea[data-v-09fb0ec2]{resize:vertical;min-height:60px;line-height:1.4}.item-actions[data-v-09fb0ec2]{display:flex;gap:8px;margin-top:12px}.item-actions .action-btn[data-v-09fb0ec2]{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;min-width:0}.generated-result[data-v-09fb0ec2]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-09fb0ec2]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-09fb0ec2]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word;white-space:pre-wrap}.generated-result .replace-btn[data-v-09fb0ec2]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-09fb0ec2]:hover{background-color:#218838}.remove-btn[data-v-09fb0ec2]{background:#b91c1c;border:1px solid #b91c1c;border-radius:3px;color:#fff;font-size:16px;font-weight:bold;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer}.remove-btn span[data-v-09fb0ec2]{line-height:1;margin-top:-1px}.action-btn[data-v-09fb0ec2]{padding:8px 16px;border:1px solid #555;background:#2a2a2a;color:#e0e0e0;border-radius:4px;cursor:pointer;font-size:13px;font-weight:500;transition:all .2s ease}.action-btn[data-v-09fb0ec2]:hover{background:#404040;border-color:#777}.action-btn.generate[data-v-09fb0ec2]{background:linear-gradient(135deg,#007acc,#005999);border-color:#007acc;color:#fff}.action-btn.generate[data-v-09fb0ec2]:hover:not(:disabled){background:linear-gradient(135deg,#005999,#004477);transform:translateY(-1px)}.action-btn.generate[data-v-09fb0ec2]:active{transform:translateY(0)}.action-btn.generate[data-v-09fb0ec2]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.apply[data-v-09fb0ec2]{background:linear-gradient(135deg,#28a745,#20c997);border-color:#28a745;color:#fff}.action-btn.apply[data-v-09fb0ec2]:hover:not(:disabled){background:linear-gradient(135deg,#218838,#1aa085);transform:translateY(-1px)}.action-btn.apply[data-v-09fb0ec2]:active{transform:translateY(0)}.action-btn.apply[data-v-09fb0ec2]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.delete[data-v-09fb0ec2]{background:#3a1a1a;border-color:#622}.action-btn.delete[data-v-09fb0ec2]:hover{background:#622}.add-item-section[data-v-09fb0ec2]{text-align:center;margin-top:16px}.add-btn[data-v-09fb0ec2]{padding:10px 20px;background:linear-gradient(135deg,#007acc,#005999);border:none;color:#fff;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s ease}.add-btn[data-v-09fb0ec2]:hover{background:linear-gradient(135deg,#005999,#004477);transform:translateY(-1px)}.add-btn[data-v-09fb0ec2]:active{transform:translateY(0)}@media (max-width:768px){.extra-container[data-v-09fb0ec2]{padding:16px}.section[data-v-09fb0ec2]{padding:16px}.item-actions[data-v-09fb0ec2]{gap:6px}.item-actions .action-btn[data-v-09fb0ec2]{padding:6px 12px;font-size:12px}.add-btn[data-v-09fb0ec2]{width:100%}}.loading-spinner[data-v-09fb0ec2]{display:inline-block;width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-09fb0ec2 1s linear infinite;flex-shrink:0}@keyframes spin-09fb0ec2{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}','']);const i=l},1458:(e,t,a)=>{var n=a(3318);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('7a9a10e4',n,!1,{ssrId:!0})},2195:(e,t,a)=>{var n=a(7319);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('3a91a348',n,!1,{ssrId:!0})},2286:(e,t,a)=>{var n=a(5914);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('45e99bda',n,!1,{ssrId:!0})},2598:(e,t,a)=>{var n=a(9210);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('631a04e0',n,!1,{ssrId:!0})},3054:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var a='',n=void 0!==t[5];return t[4]&&(a+='@supports ('.concat(t[4],') {')),t[2]&&(a+='@media '.concat(t[2],' {')),n&&(a+='@layer'.concat(t[5].length>0?' '.concat(t[5]):'',' {')),a+=e(t),n&&(a+='}'),t[2]&&(a+='}'),t[4]&&(a+='}'),a}).join('')},t.i=function(e,a,n,r,o){'string'==typeof e&&(e=[[null,e,void 0]]);var l={};if(n)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(l[s]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);n&&l[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]='@layer'.concat(d[5].length>0?' '.concat(d[5]):'',' {').concat(d[1],'}')),d[5]=o),a&&(d[2]?(d[1]='@media '.concat(d[2],' {').concat(d[1],'}'),d[2]=a):d[2]=a),r&&(d[4]?(d[1]='@supports ('.concat(d[4],') {').concat(d[1],'}'),d[4]=r):d[4]=''.concat(r)),t.push(d))}},t}},3146:(e,t,a)=>{a.d(t,{_:()=>n});class n{registry=new Map;register(e){return t=>(e||(e=t.name),this.registry.set(e,t),t)}get(e){return this.registry.get(e)}getAll(){return this.registry}has(e){return this.registry.has(e)}}},3235:(e,t)=>{t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[e,n]of t)a[e]=n;return a}},3318:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.main-interface-container[data-v-9fb68f82]{display:flex;flex-direction:column;width:100%;height:100%;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.main-content[data-v-9fb68f82]{flex:1;display:flex;flex-direction:column}.conversation-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.user-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.character-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.item-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.storage-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.location-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.promise-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.summary-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.world-info-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.settings-area[data-v-9fb68f82]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a}.tab-navigation[data-v-9fb68f82]{display:flex;flex-direction:column;background-color:#2a2a2a;border-bottom:1px solid #404040;flex-shrink:0}.tab-navigation.top[data-v-9fb68f82]{border-top:none}.time-row[data-v-9fb68f82]{display:flex;padding:4px 12px;background-color:rgba(0,0,0,.3);border-bottom:1px solid #404040;align-items:center}.current-time[data-v-9fb68f82]{font-size:14px;font-weight:600;color:#fff;font-family:"Courier New",monospace}.tab-row[data-v-9fb68f82]{display:flex;border-bottom:1px solid #404040}.tab-row[data-v-9fb68f82]:last-child{border-bottom:none}.tab-button[data-v-9fb68f82]{flex:1;padding:10px;background:none;border:none;border-right:1px solid #404040;color:#b0b0b0;font-size:16px;cursor:pointer;transition:all .2s ease}.tab-button.active[data-v-9fb68f82]{color:#007acc;background-color:#3a3a3a}.tab-button[data-v-9fb68f82]:hover{background-color:#3a3a3a}.tab-button[data-v-9fb68f82]:last-child{border-right:none}@media (max-width:768px){.tab-button[data-v-9fb68f82]{padding:8px;font-size:14px}}.slide-right-enter-active[data-v-9fb68f82],.slide-right-leave-active[data-v-9fb68f82]{transition:all .2s cubic-bezier(0.25,0.46,0.45,0.94)}.slide-right-enter-from[data-v-9fb68f82]{opacity:0;transform:translateX(-50px)}.slide-right-leave-to[data-v-9fb68f82]{opacity:0;transform:translateX(50px)}.slide-left-enter-active[data-v-9fb68f82],.slide-left-leave-active[data-v-9fb68f82]{transition:all .2s cubic-bezier(0.25,0.46,0.45,0.94)}.slide-left-enter-from[data-v-9fb68f82]{opacity:0;transform:translateX(50px)}.slide-left-leave-to[data-v-9fb68f82]{opacity:0;transform:translateX(-50px)}.no-transition-enter-active[data-v-9fb68f82],.no-transition-leave-active[data-v-9fb68f82]{transition:none}.no-transition-enter-from[data-v-9fb68f82],.no-transition-leave-to[data-v-9fb68f82]{opacity:1;transform:none}','']);const i=l},3664:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.user-profile-container[data-v-76149319]{padding:20px;color:#e0e0e0;max-width:1000px;margin:0 0;min-height:600px}.user-profile-container h3[data-v-76149319]{color:#007acc;margin-bottom:24px;font-size:20px}.user-profile-container h4[data-v-76149319]{color:#b0b0b0;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.section[data-v-76149319]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.form-grid[data-v-76149319]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.input-group.full-width[data-v-76149319]{grid-column:1/-1}.birthday-inputs[data-v-76149319]{display:flex;gap:8px}.birthday-inputs .birthday-input[data-v-76149319]{flex:1;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.birthday-inputs .birthday-input[data-v-76149319]:focus{border-color:#007acc}.birthday-inputs .birthday-input[data-v-76149319]::placeholder{color:#666}.text-input[data-v-76149319]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.text-input[data-v-76149319]:focus{border-color:#007acc}.text-input[data-v-76149319]::placeholder{color:#666}.display-text[data-v-76149319]{width:100%;padding:12px 16px;background-color:rgba(0,0,0,0);border:1px dashed #555;border-radius:8px;color:#888;font-size:14px;display:flex;align-items:center;font-style:italic}.text-area[data-v-76149319]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;font-family:inherit;outline:none;resize:vertical;min-height:80px;transition:border-color .2s ease}.text-area[data-v-76149319]:focus{border-color:#007acc}.text-area[data-v-76149319]::placeholder{color:#666}.input-group label[data-v-76149319]{display:block;margin-bottom:8px;color:#b0b0b0;font-weight:500}.generated-result[data-v-76149319]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-76149319]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-76149319]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word}.generated-result .replace-btn[data-v-76149319]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-76149319]:hover{background-color:#218838}.action-section[data-v-76149319]{display:flex;justify-content:center;gap:16px;padding:20px 0}.generate-btn[data-v-76149319]{padding:14px 32px;background-color:#28a745;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center;gap:8px}.generate-btn[data-v-76149319]:hover:not(:disabled){background-color:#218838}.generate-btn[data-v-76149319]:disabled{background-color:#666;cursor:not-allowed}.loading-spinner[data-v-76149319]{width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-76149319 1s linear infinite}@keyframes spin-76149319{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.apply-all-btn[data-v-76149319]{padding:14px 32px;background-color:#007acc;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.apply-all-btn[data-v-76149319]:hover:not(:disabled){background-color:#0056b3}.apply-all-btn[data-v-76149319]:disabled{background-color:#666;cursor:not-allowed}.relations-list[data-v-76149319]{display:flex;flex-direction:column;gap:8px}.relation-item[data-v-76149319]{display:flex;align-items:center;flex-wrap:wrap;gap:8px;padding:12px;background:linear-gradient(135deg,#1e1e1e 0%,#252525 100%);border:1px solid #555;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.2);transition:border-color .2s ease}.relation-item[data-v-76149319]:hover{border-color:#666}.relation-item .relation-target[data-v-76149319]{color:#4fc3f7;font-weight:600;font-size:14px;min-width:60px;padding:4px 8px;background-color:#2a2a2a;border-radius:4px;text-align:center;flex-shrink:0}.relation-item .relation-input[data-v-76149319]{flex:1;min-width:120px;padding:10px 14px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.relation-item .relation-input[data-v-76149319]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.relation-item .relation-input[data-v-76149319]::placeholder{color:#888}.relation-item .remove-relation-btn[data-v-76149319]{background:linear-gradient(135deg,#dc3545 0%,#c82333 100%);border:1px solid #dc3545;border-radius:6px;color:#fff;font-size:16px;font-weight:bold;width:24px;height:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(220,53,69,.3);flex-shrink:0}.relation-item .remove-relation-btn[data-v-76149319]:hover{background:linear-gradient(135deg,#c82333 0%,#a02622 100%);border-color:#bd2130;transform:translateY(-1px);box-shadow:0 4px 8px rgba(220,53,69,.4)}.relation-item .remove-relation-btn[data-v-76149319]:active{transform:translateY(0)}.add-relation[data-v-76149319]{display:flex;flex-wrap:wrap;gap:8px;align-items:center;padding:12px;background:linear-gradient(135deg,#252525 0%,#2a2a2a 100%);border:1px solid #555;border-radius:8px;margin-top:12px}.add-relation .relation-select[data-v-76149319]{flex:1;min-width:150px;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.add-relation .relation-select[data-v-76149319]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.add-relation .add-relation-btn[data-v-76149319]{padding:10px 16px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:6px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(40,167,69,.3);flex-shrink:0}.add-relation .add-relation-btn[data-v-76149319]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 8px rgba(40,167,69,.4)}.add-relation .add-relation-btn[data-v-76149319]:disabled{background-color:#666;border-color:#666;cursor:not-allowed;box-shadow:none;transform:none}.add-relation .add-relation-btn[data-v-76149319]:active{transform:translateY(0)}.inventory-list[data-v-76149319]{display:flex;flex-direction:column;gap:8px}.inventory-item[data-v-76149319]{display:flex;align-items:center;flex-wrap:wrap;gap:8px;padding:12px;background:linear-gradient(135deg,#1e1e1e 0%,#252525 100%);border:1px solid #555;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.2);transition:border-color .2s ease}.inventory-item[data-v-76149319]:hover{border-color:#666}.inventory-item .inventory-target[data-v-76149319]{color:#4fc3f7;font-weight:600;font-size:14px;min-width:60px;padding:4px 8px;background-color:#2a2a2a;border-radius:4px;text-align:center;flex-shrink:0}.inventory-item .inventory-input[data-v-76149319]{flex:1;min-width:80px;padding:10px 14px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.inventory-item .inventory-input[data-v-76149319]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.inventory-item .inventory-input[data-v-76149319]::placeholder{color:#888}.inventory-item .remove-inventory-btn[data-v-76149319]{background:linear-gradient(135deg,#dc3545 0%,#c82333 100%);border:1px solid #dc3545;border-radius:6px;color:#fff;font-size:16px;font-weight:bold;width:24px;height:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(220,53,69,.3);flex-shrink:0}.inventory-item .remove-inventory-btn[data-v-76149319]:hover{background:linear-gradient(135deg,#c82333 0%,#a02622 100%);border-color:#bd2130;transform:translateY(-1px);box-shadow:0 4px 8px rgba(220,53,69,.4)}.inventory-item .remove-inventory-btn[data-v-76149319]:active{transform:translateY(0)}.add-inventory[data-v-76149319]{display:flex;flex-wrap:wrap;gap:8px;align-items:center;padding:12px;background:linear-gradient(135deg,#252525 0%,#2a2a2a 100%);border:1px solid #555;border-radius:8px;margin-top:12px}.add-inventory .inventory-select[data-v-76149319]{flex:1;min-width:150px;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.add-inventory .inventory-select[data-v-76149319]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.add-inventory .quantity-input[data-v-76149319]{padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease;width:80px;flex:1;min-width:80px}.add-inventory .quantity-input[data-v-76149319]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.add-inventory .quantity-input[data-v-76149319]::placeholder{color:#888}.add-inventory .quantity-input[data-v-76149319]:disabled{background-color:#333;color:#666;cursor:not-allowed}.add-inventory .add-inventory-btn[data-v-76149319]{padding:10px 16px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:6px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(40,167,69,.3);flex-shrink:0}.add-inventory .add-inventory-btn[data-v-76149319]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 8px rgba(40,167,69,.4)}.add-inventory .add-inventory-btn[data-v-76149319]:disabled{background-color:#666;border-color:#666;cursor:not-allowed;box-shadow:none;transform:none}.add-inventory .add-inventory-btn[data-v-76149319]:active{transform:translateY(0)}@media (max-width:768px){.user-profile-container[data-v-76149319]{padding:16px}.section[data-v-76149319]{padding:16px}.form-grid[data-v-76149319]{grid-template-columns:1fr}.birthday-inputs[data-v-76149319]{flex-direction:column}}','']);const i=l},3801:(e,t,a)=>{var n=a(7701);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('61159612',n,!1,{ssrId:!0})},4055:(e,t,a)=>{var n=a(7139);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('19fd6a26',n,!1,{ssrId:!0})},4149:(e,t,a)=>{var n=a(8937);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('961f2624',n,!1,{ssrId:!0})},4166:(e,t,a)=>{var n=a(730);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('29eb4496',n,!1,{ssrId:!0})},4424:(e,t,a)=>{function n(e,t){for(var a=[],n={},r=0;r<t.length;r++){var o=t[r],l=o[0],i={id:e+':'+r,css:o[1],media:o[2],sourceMap:o[3]};n[l]?n[l].parts.push(i):a.push(n[l]={id:l,parts:[i]})}return a}a.d(t,{A:()=>g});var r='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!r)throw new Error('vue-style-loader cannot be used in a non-browser environment. Use { target: \'node\' } in your Webpack config to indicate a server-rendering environment.');var o={},l=r&&(document.head||document.getElementsByTagName('head')[0]),i=null,s=0,c=!1,d=function(){},u=null,p='data-vue-ssr-id',m='undefined'!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function g(e,t,a,r){c=a,u=r||{};var l=n(e,t);return v(l),function(t){for(var a=[],r=0;r<l.length;r++){var i=l[r];(s=o[i.id]).refs--,a.push(s)}t?v(l=n(e,t)):l=[];for(r=0;r<a.length;r++){var s;if(0===(s=a[r]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete o[s.id]}}}}function v(e){for(var t=0;t<e.length;t++){var a=e[t],n=o[a.id];if(n){n.refs++;for(var r=0;r<n.parts.length;r++)n.parts[r](a.parts[r]);for(;r<a.parts.length;r++)n.parts.push(f(a.parts[r]));n.parts.length>a.parts.length&&(n.parts.length=a.parts.length)}else{var l=[];for(r=0;r<a.parts.length;r++)l.push(f(a.parts[r]));o[a.id]={id:a.id,refs:1,parts:l}}}}function b(){var e=document.createElement('style');return e.type='text/css',l.appendChild(e),e}function f(e){var t,a,n=document.querySelector('style['+p+'~="'+e.id+'"]');if(n){if(c)return d;n.parentNode.removeChild(n)}if(m){var r=s++;n=i||(i=b()),t=E.bind(null,n,r,!1),a=E.bind(null,n,r,!0)}else n=b(),t=y.bind(null,n),a=function(){n.parentNode.removeChild(n)};return t(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;t(e=n)}else a()}}var h,x=(h=[],function(e,t){return h[e]=t,h.filter(Boolean).join('\n')});function E(e,t,a,n){var r=a?'':n.css;if(e.styleSheet)e.styleSheet.cssText=x(t,r);else{var o=document.createTextNode(r),l=e.childNodes;l[t]&&e.removeChild(l[t]),l.length?e.insertBefore(o,l[t]):e.appendChild(o)}}function y(e,t){var a=t.css,n=t.media,r=t.sourceMap;if(n&&e.setAttribute('media',n),u.ssrId&&e.setAttribute(p,t.id),r&&(a+='\n/*# sourceURL='+r.sources[0]+' */',a+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+' */'),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}},4727:(e,t,a)=>{var n=a(6387);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('2ab786ed',n,!1,{ssrId:!0})},4952:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.world-background-container[data-v-6467ee74]{padding:20px;color:#e0e0e0;max-width:800px;margin:0 0;min-height:600px}.world-background-container h3[data-v-6467ee74]{color:#007acc;margin-bottom:24px;font-size:20px}.input-group[data-v-6467ee74]{margin-bottom:20px}.input-group label[data-v-6467ee74]{display:block;margin-bottom:8px;color:#b0b0b0;font-weight:500}.text-input[data-v-6467ee74]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.text-input[data-v-6467ee74]:focus{border-color:#007acc}.text-input[data-v-6467ee74]::placeholder{color:#666}.text-area[data-v-6467ee74]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;font-family:inherit;outline:none;resize:vertical;min-height:80px;transition:border-color .2s ease}.text-area[data-v-6467ee74]:focus{border-color:#007acc}.text-area[data-v-6467ee74]::placeholder{color:#666}.generate-btn[data-v-6467ee74]{width:100%;padding:14px;background-color:#007acc;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;margin-bottom:24px;display:flex;align-items:center;justify-content:center;gap:8px}.generate-btn[data-v-6467ee74]:hover:not(:disabled){background-color:#0056b3}.generate-btn[data-v-6467ee74]:disabled{background-color:#666;cursor:not-allowed}.loading-spinner[data-v-6467ee74]{width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-6467ee74 1s linear infinite}@keyframes spin-6467ee74{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.info-section[data-v-6467ee74]{background-color:#2a2a2a;padding:24px;border-radius:12px;border:1px solid #404040}.replace-btn[data-v-6467ee74]{width:100%;padding:14px;background-color:#28a745;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.replace-btn[data-v-6467ee74]:hover:not(:disabled){background-color:#218838}.replace-btn[data-v-6467ee74]:disabled{background-color:#666;cursor:not-allowed}@media (max-width:768px){.world-background-container[data-v-6467ee74]{padding:16px}.info-section[data-v-6467ee74]{padding:20px}.text-input[data-v-6467ee74],.text-area[data-v-6467ee74]{font-size:16px}}','']);const i=l},5184:(e,t,a)=>{var n=a(5828);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('192933bc',n,!1,{ssrId:!0})},5353:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.conversation-tab-container[data-v-18297b7b]{display:flex;flex-direction:column;width:100%;height:100%}.main-content[data-v-18297b7b]{flex:1;display:flex;flex-direction:column;overflow:hidden}.dialogue-fullscreen[data-v-18297b7b]{display:flex;flex-direction:column;flex:1;overflow:hidden}.messages-container[data-v-18297b7b]{flex:1;overflow-y:auto;background-color:#1a1a1a;min-height:var(--v14702539);max-height:var(--v14702539)}.messages-container[data-v-18297b7b]::-webkit-scrollbar{width:8px}.messages-container[data-v-18297b7b]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.messages-container[data-v-18297b7b]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.messages-container[data-v-18297b7b]::-webkit-scrollbar-thumb:hover{background:#666}.load-more-container[data-v-18297b7b]{display:flex;justify-content:center;padding:16px;margin-bottom:16px}.load-more-btn[data-v-18297b7b]{background-color:#2a2a2a;border:1px solid #404040;border-radius:20px;color:#b0b0b0;padding:8px 16px;font-size:14px;cursor:pointer;transition:all .2s ease}.load-more-btn[data-v-18297b7b]:hover{background-color:#3a3a3a;border-color:#007acc;color:#007acc}.message[data-v-18297b7b]{position:relative;border-bottom:1px solid #404040}.message.user[data-v-18297b7b]{background:linear-gradient(135deg,rgba(0,122,204,0.05) 0%,rgba(0,122,204,0.02) 100%);border-left:3px solid #007acc}.message.assistant[data-v-18297b7b]{background:linear-gradient(135deg,rgba(40,167,69,0.05) 0%,rgba(40,167,69,0.02) 100%);border-left:3px solid #28a745}.message-content[data-v-18297b7b]{line-height:1.5;word-wrap:break-word;white-space:pre-wrap;padding:16px 16px 24px 16px}[data-v-18297b7b] .dialogue-text{color:#f4c430;font-weight:500}.message-header[data-v-18297b7b]{margin-bottom:8px;background-color:rgba(0,0,0,.3);border-radius:8px 8px 0 0;overflow:hidden}.message-header-row[data-v-18297b7b]{display:flex;align-items:center;justify-content:space-between;padding:8px 16px}.message-status-row[data-v-18297b7b]{padding:4px 16px;background-color:rgba(0,0,0,.2);border-top:1px solid hsla(0,0%,100%,.1)}.message-id[data-v-18297b7b]{color:#b0b0b0;font-size:12px;font-weight:500;opacity:.8}.status-info[data-v-18297b7b]{color:#e0e0e0;font-size:12px;font-weight:400;opacity:.9;text-align:center;overflow:hidden;text-overflow:ellipsis}.status-datetime[data-v-18297b7b]{margin-bottom:2px}.status-location[data-v-18297b7b]{font-size:11px;opacity:.8}.message-actions[data-v-18297b7b]{display:flex;gap:8px}.edit-message-btn[data-v-18297b7b],.rewind-message-btn[data-v-18297b7b]{background:none;border:none;color:#888;font-size:14px;cursor:pointer;opacity:1;transition:opacity .2s ease;padding:4px 8px;border-radius:4px}.edit-message-btn[data-v-18297b7b]:hover,.rewind-message-btn[data-v-18297b7b]:hover{background-color:hsla(0,0%,100%,.1)}.edit-message-btn[data-v-18297b7b]:hover{color:#007acc}.rewind-message-btn[data-v-18297b7b]:hover{color:#28a745}.edit-mode[data-v-18297b7b]{width:100%;padding-left:16px}.edit-textarea[data-v-18297b7b]{width:100%;padding:12px;background-color:#2a2a2a;border:1px solid #007acc;border-radius:8px;color:#e0e0e0;font-size:14px;font-family:inherit;line-height:1.4;resize:none;outline:none;min-height:60px;field-sizing:content}.edit-textarea[data-v-18297b7b]:focus{border-color:#0056b3}.edit-textarea[data-v-18297b7b]::placeholder{color:#888}.edit-controls[data-v-18297b7b]{display:flex;justify-content:flex-end;gap:8px;margin-top:8px}.edit-btn[data-v-18297b7b]{width:32px;height:32px;border:none;border-radius:50%;cursor:pointer;font-size:16px;font-weight:bold;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.edit-btn.confirm-btn[data-v-18297b7b]{background-color:#28a745;color:#fff}.edit-btn.confirm-btn[data-v-18297b7b]:hover{background-color:#218838}.edit-btn.cancel-btn[data-v-18297b7b]{background-color:#dc3545;color:#fff}.edit-btn.cancel-btn[data-v-18297b7b]:hover{background-color:#c82333}.swipe-controls[data-v-18297b7b]{display:flex;align-items:center;justify-content:center;gap:8px;padding:12px 16px;background-color:rgba(0,0,0,.4);border:1px solid hsla(0,0%,100%,.1);backdrop-filter:blur(4px)}.swipe-btn[data-v-18297b7b]{background:none;border:none;color:#007acc;font-size:18px;font-weight:bold;cursor:pointer;padding:2px 6px;border-radius:4px;transition:background-color .2s ease}.swipe-btn[data-v-18297b7b]:hover:not(:disabled){background-color:rgba(0,122,204,.2)}.swipe-btn[data-v-18297b7b]:disabled{color:#666;cursor:not-allowed}.swipe-indicator[data-v-18297b7b]{color:#b0b0b0;font-size:12px;font-weight:500;min-width:40px;text-align:center}.delete-btn[data-v-18297b7b]{color:#ff6b6b !important;font-size:16px;font-weight:bold}.delete-btn[data-v-18297b7b]:hover:not(:disabled){background-color:rgba(255,107,107,.2)}.delete-btn[data-v-18297b7b]:disabled{color:#666 !important;cursor:not-allowed}.input-area[data-v-18297b7b]{padding:16px;background-color:#1a1a1a;border-top:1px solid #404040}.input-container[data-v-18297b7b]{display:flex;gap:8px;align-items:center}.message-input[data-v-18297b7b]{flex:1;padding:12px 16px;background-color:#2a2a2a;border:1px solid #404040;border-radius:24px;color:#e0e0e0;font-size:16px;outline:none;transition:border-color .2s ease;resize:none;min-height:20px;max-height:120px}.message-input[data-v-18297b7b]::-webkit-scrollbar{display:none}.message-input[data-v-18297b7b]{-ms-overflow-style:none;scrollbar-width:none}.message-input[data-v-18297b7b]:focus{border-color:#007acc}.message-input[data-v-18297b7b]::placeholder{color:#888}.send-button[data-v-18297b7b]{padding:12px 20px;background-color:#007acc;border:none;border-radius:24px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;white-space:nowrap}.send-button[data-v-18297b7b]:hover{background-color:#0056b3}.send-button[data-v-18297b7b]:active{background-color:#004085}.loading-spinner[data-v-18297b7b]{width:20px;height:20px;border:2px solid #404040;border-top:2px solid #007acc;border-radius:50%;animation:spin-18297b7b 1s linear infinite;flex-shrink:0}@keyframes spin-18297b7b{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@media (max-width:768px){.input-area[data-v-18297b7b]{padding:12px}.message-input[data-v-18297b7b]{font-size:16px}.send-button[data-v-18297b7b]{padding:12px 16px;font-size:14px}}','']);const i=l},5414:(e,t,a)=>{var n=a(8882);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('cc2e9356',n,!1,{ssrId:!0})},5612:(e,t,a)=>{var n=a(4952);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('4fd7f670',n,!1,{ssrId:!0})},5813:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.location-tabs-container[data-v-890af5d4]{color:#e0e0e0;max-width:1000px;margin:0 auto;padding:16px}.location-tabs-container h3[data-v-890af5d4]{color:#007acc;margin-bottom:24px;font-size:20px}.location-fold-bar[data-v-890af5d4]{margin-bottom:16px}.location-fold-bar[data-v-890af5d4] .fold-bar-btn{background:linear-gradient(135deg,#2a2a2a 0%,#333333 100%);border:1px solid #555;box-shadow:0 2px 8px rgba(0,0,0,.3);padding:12px 16px;font-size:16px;font-weight:600;color:#e0e0e0;transition:all .3s ease}.location-fold-bar[data-v-890af5d4] .fold-bar-btn:hover{background:linear-gradient(135deg,#333333 0%,#404040 100%);border-color:#666;box-shadow:0 4px 12px rgba(0,0,0,.4)}.location-fold-bar[data-v-890af5d4] .fold-bar-content{background:linear-gradient(135deg,#1a1a1a 0%,#222222 100%);border:1px solid #555;border-top:none;box-shadow:0 2px 8px rgba(0,0,0,.3)}.location-fold-bar[data-v-890af5d4] .fold-bar-content-text{padding:20px}.location-fold-bar[data-v-890af5d4] .fold-bar-footer-toggle{background:linear-gradient(135deg,#2a2a2a 0%,#333333 100%);border-top:1px solid #555;color:#b0b0b0;font-size:13px;font-weight:500;padding:12px 16px;transition:all .3s ease}.location-fold-bar[data-v-890af5d4] .fold-bar-footer-toggle:hover{background:linear-gradient(135deg,#333333 0%,#404040 100%);color:#e0e0e0;border-color:#666}.location-fold-bar[data-v-890af5d4] .fold-bar-toggle-icon{color:#007acc;font-size:14px;font-weight:bold}.location-fold-bar.location-incomplete[data-v-890af5d4] .fold-bar-btn span{color:#ff6b6b !important}.remove-location-btn[data-v-890af5d4]{background:#b91c1c;border:1px solid #b91c1c;border-radius:3px;color:#fff;font-size:16px;font-weight:bold;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer}.remove-location-btn span[data-v-890af5d4]{line-height:1;margin-top:-1px}.location-info-container .section[data-v-890af5d4]{margin-bottom:16px}.section[data-v-890af5d4]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.section h4[data-v-890af5d4]{color:#b0b0b0;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.form-grid[data-v-890af5d4]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.input-group.full-width[data-v-890af5d4]{grid-column:1/-1}.input-group label[data-v-890af5d4]{display:block;margin-bottom:8px;color:#b0b0b0;font-weight:500}.text-input[data-v-890af5d4]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.text-input[data-v-890af5d4]:focus{border-color:#007acc}.text-input[data-v-890af5d4]::placeholder{color:#666}.text-area[data-v-890af5d4]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;font-family:inherit;outline:none;resize:vertical;min-height:80px;transition:border-color .2s ease}.text-area[data-v-890af5d4]:focus{border-color:#007acc}.text-area[data-v-890af5d4]::placeholder{color:#666}.sub-locations-container[data-v-890af5d4]{display:flex;flex-direction:column;gap:8px}.sub-location-item[data-v-890af5d4]{display:flex;align-items:center;gap:8px}.sub-location-item .text-input[data-v-890af5d4]{flex:1}.sub-location-item .remove-sub-location-btn[data-v-890af5d4]{background:#b91c1c;border:1px solid #b91c1c;border-radius:3px;color:#fff;font-size:16px;font-weight:bold;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer}.sub-location-item .remove-sub-location-btn span[data-v-890af5d4]{line-height:1;margin-top:-1px}.add-sub-location-btn[data-v-890af5d4]{padding:8px 16px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:6px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .3s ease;align-self:flex-start}.add-sub-location-btn[data-v-890af5d4]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px)}.add-sub-location-btn span[data-v-890af5d4]{font-size:16px;font-weight:bold}.bulk-generate-section[data-v-890af5d4]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.bulk-generate-section h4[data-v-890af5d4]{color:#007acc;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.count-input-row[data-v-890af5d4]{display:flex;align-items:center;gap:16px;flex-wrap:wrap}.count-input[data-v-890af5d4]{flex:0 0 auto;width:120px}.ai-count-checkbox[data-v-890af5d4]{display:flex;align-items:center;gap:8px;margin-bottom:0}.ai-count-checkbox input[type=checkbox][data-v-890af5d4]{width:16px;height:16px;accent-color:#007acc;cursor:pointer}.ai-count-checkbox label[data-v-890af5d4]{color:#b0b0b0;font-size:14px;font-weight:500;cursor:pointer;margin-bottom:0;-webkit-user-select:none;user-select:none}.ai-count-checkbox label[data-v-890af5d4]:hover{color:#e0e0e0}.bulk-generate-btn[data-v-890af5d4]{padding:14px 32px;background-color:#28a745;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center;gap:8px;width:100%;margin-top:16px}.bulk-generate-btn[data-v-890af5d4]:hover:not(:disabled){background-color:#218838}.bulk-generate-btn[data-v-890af5d4]:disabled{background-color:#666;cursor:not-allowed}.add-location-section[data-v-890af5d4]{display:flex;justify-content:center;padding:20px 0;margin-top:20px;border-top:1px solid #404040}.add-location-btn[data-v-890af5d4]{padding:12px 24px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px}.add-location-btn[data-v-890af5d4]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 12px rgba(40,167,69,.3)}.add-location-btn span[data-v-890af5d4]{font-size:18px;font-weight:bold}@media (max-width:768px){.section[data-v-890af5d4]{padding:16px}.form-grid[data-v-890af5d4]{grid-template-columns:1fr}.input-group.full-width[data-v-890af5d4]{grid-column:1}.location-tabs-container[data-v-890af5d4]{max-width:100%;margin:0}.add-location-section[data-v-890af5d4]{padding:16px 0;margin-top:16px}.add-location-btn[data-v-890af5d4]{padding:10px 20px;font-size:14px}.add-location-btn span[data-v-890af5d4]{font-size:16px}.count-input-row[data-v-890af5d4]{flex-direction:column;align-items:flex-start;gap:12px}.count-input[data-v-890af5d4]{width:100%}.ai-count-checkbox[data-v-890af5d4]{font-size:13px}.remove-location-btn[data-v-890af5d4]{width:20px;height:20px;font-size:14px}[data-v-890af5d4] .fold-bar-content-text{padding:16px}.action-section[data-v-890af5d4]{flex-direction:row;align-items:stretch;gap:12px}.action-section .generate-btn[data-v-890af5d4],.action-section .apply-all-btn[data-v-890af5d4]{flex:1;width:auto;max-width:none}}.generated-result[data-v-890af5d4]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-890af5d4]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-890af5d4]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word}.generated-result .replace-btn[data-v-890af5d4]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-890af5d4]:hover{background-color:#218838}.action-section[data-v-890af5d4]{display:flex;justify-content:space-between;gap:16px;padding:20px 0}.action-section .generate-btn[data-v-890af5d4],.action-section .apply-all-btn[data-v-890af5d4]{flex:1;max-width:none}.generate-btn[data-v-890af5d4]{padding:14px 32px;background-color:#28a745;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center;gap:8px}.generate-btn[data-v-890af5d4]:hover:not(:disabled){background-color:#218838}.generate-btn[data-v-890af5d4]:disabled{background-color:#666;cursor:not-allowed}.loading-spinner[data-v-890af5d4]{width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-890af5d4 1s linear infinite}@keyframes spin-890af5d4{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.apply-all-btn[data-v-890af5d4]{padding:14px 32px;background-color:#007acc;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.apply-all-btn[data-v-890af5d4]:hover:not(:disabled){background-color:#0056b3}.apply-all-btn[data-v-890af5d4]:disabled{background-color:#666;cursor:not-allowed}','']);const i=l},5828:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.location-tab-container[data-v-bd354e5e]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.location-content[data-v-bd354e5e]{flex:1;padding:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--v77958077);max-height:var(--v77958077)}.location-content[data-v-bd354e5e]::-webkit-scrollbar{width:8px}.location-content[data-v-bd354e5e]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.location-content[data-v-bd354e5e]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.location-content[data-v-bd354e5e]::-webkit-scrollbar-thumb:hover{background:#666}.location-section[data-v-bd354e5e]:last-child{margin-bottom:0}.section-title[data-v-bd354e5e]{font-size:18px;font-weight:600;color:#007acc;margin:0 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.add-location-button[data-v-bd354e5e]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff;margin-top:12px}.add-location-button[data-v-bd354e5e]:hover{background:#005a99}.location-list[data-v-bd354e5e]{display:flex;flex-direction:column;gap:8px}.location-row[data-v-bd354e5e]{background:#252525;padding:12px 16px;border-radius:8px;border:1px solid #404040;display:flex;flex-direction:column;gap:8px;font-size:14px;transition:background-color .2s}.location-row[data-v-bd354e5e]:hover{background:#2a2a2a;border-color:#555}.new-location-row[data-v-bd354e5e]{background:#2a2a2a;border-color:#007acc;border-style:dashed}.location-first-row[data-v-bd354e5e]{display:flex;justify-content:space-between;align-items:center;gap:12px}.location-location-row[data-v-bd354e5e]{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-top:6px}.location-location-group[data-v-bd354e5e]{display:flex;align-items:center;gap:8px}.location-location-label[data-v-bd354e5e]{font-weight:500;color:#a0a0a0;font-size:13px;min-width:40px}.location-edit-actions[data-v-bd354e5e]{display:flex;gap:8px}.location-id-name-group[data-v-bd354e5e]{display:flex;gap:12px;align-items:center;flex:1}.location-id[data-v-bd354e5e]{font-weight:500;color:#007acc;font-size:14px}.location-name[data-v-bd354e5e]{font-weight:500;color:#fff;font-size:16px}.location-location[data-v-bd354e5e]{font-weight:500;color:#fff;font-size:16px}.location-location-input[data-v-bd354e5e]{font-weight:500;color:#fff;font-size:16px;width:35px;flex-shrink:0}.location-location-input-edit[data-v-bd354e5e]{background:#333;border:1px solid #555;border-radius:4px;padding:4px 8px}.location-location-input-edit[data-v-bd354e5e]:focus{outline:none;border-color:#007acc}.location-parent-display[data-v-bd354e5e]{display:flex;flex-wrap:wrap;gap:4px}.location-parent-tag[data-v-bd354e5e]{background:#007acc;color:#fff;padding:4px 10px;border-radius:4px;font-size:13px;display:flex;align-items:center;gap:4px;cursor:pointer;transition:opacity .2s}.location-parent-tag[data-v-bd354e5e]:hover{opacity:.8}.location-children-display[data-v-bd354e5e]{display:flex;flex-wrap:wrap;gap:4px}.location-child-tag[data-v-bd354e5e]{background:#4caf50;color:#fff;padding:4px 10px;border-radius:4px;font-size:13px;display:flex;align-items:center;gap:4px;cursor:pointer;transition:opacity .2s}.location-child-tag[data-v-bd354e5e]:hover{opacity:.8}.location-storages-display[data-v-bd354e5e]{display:flex;flex-wrap:wrap;gap:4px}.location-storage-tag[data-v-bd354e5e]{background:#ff9800;color:#fff;padding:4px 10px;border-radius:4px;font-size:13px;display:flex;align-items:center;gap:4px}.location-description[data-v-bd354e5e]{color:#a0a0a0;line-height:1.4;font-size:13px}.location-actions[data-v-bd354e5e]{display:flex;gap:8px}.edit-location-button[data-v-bd354e5e],.delete-location-button[data-v-bd354e5e]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.edit-location-button[data-v-bd354e5e]{background:#007acc;color:#fff}.edit-location-button[data-v-bd354e5e]:hover{background:#005a99}.delete-location-button[data-v-bd354e5e]{background:#f44336;color:#fff}.delete-location-button[data-v-bd354e5e]:hover{background:#da190b}.location-id-input[data-v-bd354e5e],.location-name-input[data-v-bd354e5e],.location-location-input[data-v-bd354e5e],.location-description-input[data-v-bd354e5e]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:14px;padding:4px 8px;width:35px;-webkit-appearance:none;appearance:none;appearance:none}.location-id-input[data-v-bd354e5e]:focus,.location-name-input[data-v-bd354e5e]:focus,.location-location-input[data-v-bd354e5e]:focus,.location-description-input[data-v-bd354e5e]:focus{outline:none;border-color:#007acc}.location-id-input[data-v-bd354e5e]::-webkit-outer-spin-button,.location-id-input[data-v-bd354e5e]::-webkit-inner-spin-button,.location-name-input[data-v-bd354e5e]::-webkit-outer-spin-button,.location-name-input[data-v-bd354e5e]::-webkit-inner-spin-button,.location-location-input[data-v-bd354e5e]::-webkit-outer-spin-button,.location-location-input[data-v-bd354e5e]::-webkit-inner-spin-button,.location-description-input[data-v-bd354e5e]::-webkit-outer-spin-button,.location-description-input[data-v-bd354e5e]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.location-id-input[type=number][data-v-bd354e5e],.location-name-input[type=number][data-v-bd354e5e],.location-location-input[type=number][data-v-bd354e5e],.location-description-input[type=number][data-v-bd354e5e]{-webkit-appearance:textfield;appearance:textfield}.location-id-input[data-v-bd354e5e]{font-weight:500;color:#007acc;font-size:14px;width:50px;flex-shrink:0;text-align:center}.location-name-input[data-v-bd354e5e]{font-weight:500;color:#fff;font-size:16px;width:120px;flex-shrink:0}.location-parent-input-group[data-v-bd354e5e]{display:flex;flex-direction:column;gap:6px}.location-children-input-group[data-v-bd354e5e]{display:flex;flex-direction:column;gap:6px}.selected-children[data-v-bd354e5e]{display:flex;flex-wrap:wrap;gap:4px}.selected-child-tag[data-v-bd354e5e]{background:#4caf50;color:#fff;padding:3px 8px;border-radius:4px;font-size:11px;display:flex;align-items:center;gap:4px}.remove-child-btn[data-v-bd354e5e]{background:none;border:none;color:#fff;cursor:pointer;font-size:14px;line-height:1;padding:0;margin-left:2px}.remove-child-btn[data-v-bd354e5e]:hover{color:#ccc}.location-storages-input-group[data-v-bd354e5e]{display:flex;flex-direction:column;gap:6px}.selected-storages[data-v-bd354e5e]{display:flex;flex-wrap:wrap;gap:4px}.selected-storage-tag[data-v-bd354e5e]{background:#ff9800;color:#fff;padding:3px 8px;border-radius:4px;font-size:11px;display:flex;align-items:center;gap:4px}.remove-storage-btn[data-v-bd354e5e]{background:none;border:none;color:#fff;cursor:pointer;font-size:14px;line-height:1;padding:0;margin-left:2px}.remove-storage-btn[data-v-bd354e5e]:hover{color:#ccc}.parent-location-select[data-v-bd354e5e],.child-location-select[data-v-bd354e5e],.storage-location-select[data-v-bd354e5e]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:4px 8px}.parent-location-select[data-v-bd354e5e]:focus,.child-location-select[data-v-bd354e5e]:focus,.storage-location-select[data-v-bd354e5e]:focus{outline:none;border-color:#007acc}.location-description-input[data-v-bd354e5e]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:6px 8px;resize:vertical;min-height:60px;line-height:1.4;width:100%}.location-description-input[data-v-bd354e5e]:focus{outline:none;border-color:#007acc}.confirm-button[data-v-bd354e5e],.cancel-button[data-v-bd354e5e]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.confirm-button[data-v-bd354e5e]{background:#4caf50;color:#fff}.confirm-button[data-v-bd354e5e]:hover{background:#45a049}.cancel-button[data-v-bd354e5e]{background:#f44336;color:#fff}.cancel-button[data-v-bd354e5e]:hover{background:#da190b}.no-locations-message[data-v-bd354e5e]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}@media (max-width:768px){.location-content[data-v-bd354e5e]{padding:12px}.section-title[data-v-bd354e5e]{font-size:18px}.location-row[data-v-bd354e5e]{padding:10px 12px;gap:6px}.location-first-row[data-v-bd354e5e]{gap:8px}.location-location-row[data-v-bd354e5e]{gap:6px;margin-top:4px}.location-location-group[data-v-bd354e5e]{gap:6px}.location-location-label[data-v-bd354e5e]{font-size:12px;min-width:35px}.location-name[data-v-bd354e5e]{font-size:15px}.location-location[data-v-bd354e5e]{font-size:15px}.location-location-input[data-v-bd354e5e]{font-size:15px;width:100px}.location-edit-actions[data-v-bd354e5e]{gap:6px}.location-description[data-v-bd354e5e]{font-size:12px}.location-actions[data-v-bd354e5e]{gap:6px}.edit-location-button[data-v-bd354e5e],.delete-location-button[data-v-bd354e5e]{padding:5px 10px;font-size:11px}.location-id-input[data-v-bd354e5e],.location-name-input[data-v-bd354e5e],.location-location-input[data-v-bd354e5e]{font-size:13px;padding:3px 6px}.location-id-input[data-v-bd354e5e]{width:40px}.location-name-input[data-v-bd354e5e]{width:100px}.parent-location-select[data-v-bd354e5e],.child-location-select[data-v-bd354e5e],.storage-location-select[data-v-bd354e5e]{font-size:12px;padding:3px 6px}.selected-child-tag[data-v-bd354e5e],.location-child-tag[data-v-bd354e5e],.location-parent-tag[data-v-bd354e5e],.location-storage-tag[data-v-bd354e5e],.selected-storage-tag[data-v-bd354e5e]{font-size:12px;padding:2px 6px}.location-description-input[data-v-bd354e5e]{font-size:12px;padding:4px 6px;min-height:50px}.confirm-button[data-v-bd354e5e],.cancel-button[data-v-bd354e5e]{padding:5px 10px;font-size:11px}}','']);const i=l},5914:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.storage-tab-container[data-v-62b84623]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.storage-content[data-v-62b84623]{flex:1;padding:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--v4efc9d77);max-height:var(--v4efc9d77)}.storage-content[data-v-62b84623]::-webkit-scrollbar{width:8px}.storage-content[data-v-62b84623]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.storage-content[data-v-62b84623]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.storage-content[data-v-62b84623]::-webkit-scrollbar-thumb:hover{background:#666}.storage-section[data-v-62b84623]:last-child{margin-bottom:0}.section-title[data-v-62b84623]{font-size:18px;font-weight:600;color:#007acc;margin:0 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.add-storage-button[data-v-62b84623]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff;margin-top:12px}.add-storage-button[data-v-62b84623]:hover{background:#005a99}.storage-list[data-v-62b84623]{display:flex;flex-direction:column;gap:8px}.storage-row[data-v-62b84623]{background:#252525;padding:12px 16px;border-radius:8px;border:1px solid #404040;display:flex;flex-direction:column;gap:8px;font-size:14px;transition:background-color .2s}.storage-row[data-v-62b84623]:hover{background:#2a2a2a;border-color:#555}.new-storage-row[data-v-62b84623]{background:#2a2a2a;border-color:#007acc;border-style:dashed}.storage-first-row[data-v-62b84623]{display:flex;justify-content:space-between;align-items:center;gap:12px}.storage-money-row[data-v-62b84623]{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-top:6px}.storage-money-group[data-v-62b84623]{display:flex;align-items:center;gap:8px}.storage-money-label[data-v-62b84623]{font-weight:500;color:#a0a0a0;font-size:16px;min-width:40px}.storage-edit-actions[data-v-62b84623]{display:flex;gap:8px}.storage-id-name-group[data-v-62b84623]{display:flex;gap:12px;align-items:center;flex:1}.storage-id[data-v-62b84623]{font-weight:500;color:#007acc;font-size:14px}.storage-name[data-v-62b84623]{font-weight:500;color:#fff;font-size:16px}.storage-money[data-v-62b84623]{font-weight:500;color:#4caf50;font-size:16px}.storage-money-input[data-v-62b84623]{font-weight:500;color:#fff;font-size:16px;width:80px;flex-shrink:0}.storage-money-input-edit[data-v-62b84623]{background:#333;border:1px solid #555;border-radius:4px;padding:4px 8px}.storage-money-input-edit[data-v-62b84623]:focus{outline:none;border-color:#007acc}.storage-parent-display[data-v-62b84623]{display:flex;flex-wrap:wrap;gap:4px}.storage-parent-tag[data-v-62b84623]{background:#007acc;color:#fff;padding:4px 10px;border-radius:4px;font-size:13px;display:flex;align-items:center;gap:4px}.storage-inventory-display[data-v-62b84623]{display:flex;flex-direction:column;gap:4px}.no-inventory[data-v-62b84623]{color:#888;font-style:italic;font-size:13px}.inventory-items[data-v-62b84623]{display:flex;flex-wrap:wrap;gap:4px}.inventory-item-tag[data-v-62b84623]{background:#4caf50;color:#fff;padding:2px 6px;border-radius:4px;font-size:13px;display:flex;align-items:center;gap:4px;white-space:nowrap;flex-shrink:0}.storage-item-tag[data-v-62b84623]{background:#ff9800;color:#fff;padding:2px 6px;border-radius:4px;font-size:12px;display:flex;align-items:center;gap:4px;white-space:nowrap;flex-shrink:0}.storage-description[data-v-62b84623]{color:#a0a0a0;line-height:1.4;font-size:13px}.storage-actions[data-v-62b84623]{display:flex;gap:8px}.edit-storage-button[data-v-62b84623],.delete-storage-button[data-v-62b84623]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.edit-storage-button[data-v-62b84623]{background:#007acc;color:#fff}.edit-storage-button[data-v-62b84623]:hover{background:#005a99}.delete-storage-button[data-v-62b84623]{background:#f44336;color:#fff}.delete-storage-button[data-v-62b84623]:hover{background:#da190b}.storage-id-input[data-v-62b84623],.storage-name-input[data-v-62b84623],.storage-money-input[data-v-62b84623],.storage-description-input[data-v-62b84623]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:14px;padding:4px 8px;width:35px;-webkit-appearance:none;appearance:none}.storage-id-input[data-v-62b84623]:focus,.storage-name-input[data-v-62b84623]:focus,.storage-money-input[data-v-62b84623]:focus,.storage-description-input[data-v-62b84623]:focus{outline:none;border-color:#007acc}.storage-id-input[data-v-62b84623]::-webkit-outer-spin-button,.storage-id-input[data-v-62b84623]::-webkit-inner-spin-button,.storage-name-input[data-v-62b84623]::-webkit-outer-spin-button,.storage-name-input[data-v-62b84623]::-webkit-inner-spin-button,.storage-money-input[data-v-62b84623]::-webkit-outer-spin-button,.storage-money-input[data-v-62b84623]::-webkit-inner-spin-button,.storage-description-input[data-v-62b84623]::-webkit-outer-spin-button,.storage-description-input[data-v-62b84623]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.storage-id-input[type=number][data-v-62b84623],.storage-name-input[type=number][data-v-62b84623],.storage-money-input[type=number][data-v-62b84623],.storage-description-input[type=number][data-v-62b84623]{-webkit-appearance:textfield;appearance:textfield}.storage-id-input[data-v-62b84623]{font-weight:500;color:#007acc;font-size:14px;width:50px;flex-shrink:0;text-align:center}.storage-name-input[data-v-62b84623]{font-weight:500;color:#fff;font-size:16px;width:120px;flex-shrink:0}.storage-parent-input-group[data-v-62b84623]{display:flex;flex-direction:column;gap:6px}.storage-inventory-input-group[data-v-62b84623]{display:flex;flex-direction:column;gap:6px}.selected-inventory[data-v-62b84623]{display:flex;flex-direction:column;gap:4px}.selected-inventory-item[data-v-62b84623]{display:flex;align-items:center;gap:8px;background:#333;padding:4px 8px;border-radius:4px}.item-name[data-v-62b84623]{flex:1;color:#e0e0e0;font-size:13px}.item-quantity-input[data-v-62b84623]{width:60px;background:#444;border:1px solid #555;border-radius:3px;color:#e0e0e0;padding:2px 4px;font-size:12px;text-align:center}.item-quantity-input[data-v-62b84623]:focus{outline:none;border-color:#007acc}.item-quantity-input[data-v-62b84623]::-webkit-outer-spin-button,.item-quantity-input[data-v-62b84623]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.item-quantity-input[type=number][data-v-62b84623]{-webkit-appearance:textfield;appearance:textfield}.inventory-edit-connector[data-v-62b84623]{color:#888;font-weight:400;font-size:14px;white-space:nowrap}.storage-indicator[data-v-62b84623]{font-weight:600;color:#fff;background:#4caf50;padding:2px 8px;border-radius:12px;font-size:12px}.remove-item-btn[data-v-62b84623]{background:none;border:none;color:#f44336;cursor:pointer;font-size:16px;line-height:1;padding:0;margin-left:4px}.remove-item-btn[data-v-62b84623]:hover{color:#da190b}.parent-select[data-v-62b84623],.item-select[data-v-62b84623]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:4px 8px}.parent-select[data-v-62b84623]:focus,.item-select[data-v-62b84623]:focus{outline:none;border-color:#007acc}.storage-description-input[data-v-62b84623]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:6px 8px;resize:vertical;min-height:60px;line-height:1.4;width:100%}.storage-description-input[data-v-62b84623]:focus{outline:none;border-color:#007acc}.confirm-button[data-v-62b84623],.cancel-button[data-v-62b84623]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.confirm-button[data-v-62b84623]{background:#4caf50;color:#fff}.confirm-button[data-v-62b84623]:hover:not(:disabled){background:#45a049}.confirm-button[data-v-62b84623]:disabled{background:#666;cursor:not-allowed;opacity:.6}.cancel-button[data-v-62b84623]{background:#f44336;color:#fff}.cancel-button[data-v-62b84623]:hover{background:#da190b}.no-storages-message[data-v-62b84623]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}@media (max-width:768px){.storage-content[data-v-62b84623]{padding:12px}.section-title[data-v-62b84623]{font-size:18px}.storage-row[data-v-62b84623]{padding:10px 12px;gap:6px}.storage-first-row[data-v-62b84623]{gap:8px}.storage-money-row[data-v-62b84623]{gap:6px;margin-top:4px}.storage-money-group[data-v-62b84623]{gap:6px}.storage-money-label[data-v-62b84623]{font-size:15px;min-width:35px}.storage-name[data-v-62b84623]{font-size:15px}.storage-money[data-v-62b84623]{font-size:15px}.storage-money-input[data-v-62b84623]{font-size:15px;width:70px}.storage-edit-actions[data-v-62b84623]{gap:6px}.storage-description[data-v-62b84623]{font-size:12px}.storage-actions[data-v-62b84623]{gap:6px}.edit-storage-button[data-v-62b84623],.delete-storage-button[data-v-62b84623]{padding:5px 10px;font-size:11px}.storage-id-input[data-v-62b84623],.storage-name-input[data-v-62b84623],.storage-money-input[data-v-62b84623]{font-size:13px;padding:3px 6px}.storage-id-input[data-v-62b84623]{width:40px}.storage-name-input[data-v-62b84623]{width:100px}.parent-select[data-v-62b84623],.item-select[data-v-62b84623]{font-size:12px;padding:3px 6px}.selected-inventory-item[data-v-62b84623]{padding:3px 6px}.item-name[data-v-62b84623]{font-size:12px}.item-quantity-input[data-v-62b84623]{width:50px;font-size:11px;padding:2px 3px}.inventory-item-tag[data-v-62b84623],.storage-parent-tag[data-v-62b84623]{font-size:12px;padding:2px 6px}.storage-description-input[data-v-62b84623]{font-size:12px;padding:4px 6px;min-height:50px}.confirm-button[data-v-62b84623],.cancel-button[data-v-62b84623]{padding:5px 10px;font-size:11px}}','']);const i=l},6108:(e,t,a)=>{var n=a(7776);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('289fd54e',n,!1,{ssrId:!0})},6307:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.world-info-container[data-v-ee3aed0a]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.world-info-content[data-v-ee3aed0a]{flex:1;padding:12px;gap:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--ae590e90);max-height:var(--ae590e90)}.world-info-content[data-v-ee3aed0a]::-webkit-scrollbar{width:8px}.world-info-content[data-v-ee3aed0a]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.world-info-content[data-v-ee3aed0a]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.world-info-content[data-v-ee3aed0a]::-webkit-scrollbar-thumb:hover{background:#666}.section[data-v-ee3aed0a]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.section h4[data-v-ee3aed0a]{color:#b0b0b0;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.sortable-container[data-v-ee3aed0a]{margin-bottom:16px}.sortable-item[data-v-ee3aed0a]{margin-bottom:8px;transition:all .2s ease;position:relative}.sortable-item.dragging[data-v-ee3aed0a]{opacity:.7;transform:scale(1.02);box-shadow:0 4px 12px rgba(0,122,204,.3);z-index:1000}.sortable-item[data-v-ee3aed0a]:not(.dragging){transform:translateY(0)}.draggable-fold-bar.incomplete[data-v-ee3aed0a] .fold-bar-btn span{color:#ef4444 !important}.drop-indicator[data-v-ee3aed0a]{height:4px;background:linear-gradient(90deg,#007acc,#005999);border-radius:2px;margin:4px 0;box-shadow:0 0 8px rgba(0,122,204,.6);animation:pulse-ee3aed0a 1.5s ease-in-out infinite;position:relative}.drop-indicator[data-v-ee3aed0a]::before{content:"";position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:8px;height:8px;background:#007acc;border-radius:50%;box-shadow:0 0 12px rgba(0,122,204,.8)}@keyframes pulse-ee3aed0a{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.7;transform:scale(1.1)}}.fold-content[data-v-ee3aed0a]{padding:12px 0}.fold-content .input-group[data-v-ee3aed0a]{margin-bottom:16px}.fold-content .input-group[data-v-ee3aed0a]:last-child{margin-bottom:0}.fold-content .input-group label[data-v-ee3aed0a]{display:block;margin-bottom:6px;color:#b0b0b0;font-weight:500;font-size:13px}.fold-content .input-group .form-input[data-v-ee3aed0a],.fold-content .input-group .form-textarea[data-v-ee3aed0a]{width:100%;padding:8px 12px;background:#2a2a2a;border:1px solid #404040;border-radius:4px;color:#e0e0e0;font-size:14px;font-family:inherit;transition:all .2s ease}.fold-content .input-group .form-input[data-v-ee3aed0a]:focus,.fold-content .input-group .form-textarea[data-v-ee3aed0a]:focus{outline:none;border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.fold-content .input-group .form-input[data-v-ee3aed0a]::placeholder,.fold-content .input-group .form-textarea[data-v-ee3aed0a]::placeholder{color:#666}.fold-content .input-group .form-textarea[data-v-ee3aed0a]{resize:vertical;min-height:60px;line-height:1.4}.item-actions[data-v-ee3aed0a]{display:flex;gap:8px;margin-top:12px}.item-actions .action-btn[data-v-ee3aed0a]{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;min-width:0}.generated-result[data-v-ee3aed0a]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-ee3aed0a]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-ee3aed0a]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word;white-space:pre-wrap}.generated-result .replace-btn[data-v-ee3aed0a]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-ee3aed0a]:hover{background-color:#218838}.remove-btn[data-v-ee3aed0a]{background:#b91c1c;border:1px solid #b91c1c;border-radius:3px;color:#fff;font-size:16px;font-weight:bold;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer}.remove-btn span[data-v-ee3aed0a]{line-height:1;margin-top:-1px}.action-btn[data-v-ee3aed0a]{padding:8px 16px;border:1px solid #555;background:#2a2a2a;color:#e0e0e0;border-radius:4px;cursor:pointer;font-size:13px;font-weight:500;transition:all .2s ease}.action-btn[data-v-ee3aed0a]:hover{background:#404040;border-color:#777}.action-btn.generate[data-v-ee3aed0a]{background:linear-gradient(135deg,#007acc,#005999);border-color:#007acc;color:#fff}.action-btn.generate[data-v-ee3aed0a]:hover:not(:disabled){background:linear-gradient(135deg,#005999,#004477);transform:translateY(-1px)}.action-btn.generate[data-v-ee3aed0a]:active{transform:translateY(0)}.action-btn.generate[data-v-ee3aed0a]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.apply[data-v-ee3aed0a]{background:linear-gradient(135deg,#28a745,#20c997);border-color:#28a745;color:#fff}.action-btn.apply[data-v-ee3aed0a]:hover:not(:disabled){background:linear-gradient(135deg,#218838,#1aa085);transform:translateY(-1px)}.action-btn.apply[data-v-ee3aed0a]:active{transform:translateY(0)}.action-btn.apply[data-v-ee3aed0a]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.delete[data-v-ee3aed0a]{background:#3a1a1a;border-color:#622}.action-btn.delete[data-v-ee3aed0a]:hover{background:#622}.add-item-section[data-v-ee3aed0a]{text-align:center;margin-top:16px}.add-btn[data-v-ee3aed0a]{padding:10px 20px;background:linear-gradient(135deg,#007acc,#005999);border:none;color:#fff;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s ease}.add-btn[data-v-ee3aed0a]:hover{background:linear-gradient(135deg,#005999,#004477);transform:translateY(-1px)}.add-btn[data-v-ee3aed0a]:active{transform:translateY(0)}@media (max-width:768px){.world-info-content[data-v-ee3aed0a]{padding:12px}.section[data-v-ee3aed0a]{padding:16px}.item-actions[data-v-ee3aed0a]{gap:6px}.item-actions .action-btn[data-v-ee3aed0a]{padding:6px 12px;font-size:12px}.add-btn[data-v-ee3aed0a]{width:100%}}.loading-spinner[data-v-ee3aed0a]{display:inline-block;width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-ee3aed0a 1s linear infinite;flex-shrink:0}@keyframes spin-ee3aed0a{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}','']);const i=l},6353:(e,t,a)=>{var n=a(5813);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('5bf10222',n,!1,{ssrId:!0})},6387:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.user-tab-container[data-v-ada46c14]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.user-content[data-v-ada46c14]{flex:1;padding:16px;overflow-y:auto;gap:20px;display:flex;flex-direction:column;min-height:var(--v68dcf940);max-height:var(--v68dcf940)}.user-content[data-v-ada46c14]::-webkit-scrollbar{width:8px}.user-content[data-v-ada46c14]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.user-content[data-v-ada46c14]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.user-content[data-v-ada46c14]::-webkit-scrollbar-thumb:hover{background:#666}.user-header[data-v-ada46c14]{text-align:center;position:relative}.user-name[data-v-ada46c14]{font-size:28px;font-weight:700;color:#007acc;margin:0;text-shadow:0 2px 4px rgba(0,0,0,.3)}.attributes-grid[data-v-ada46c14]{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;margin-bottom:20px}.attribute-item[data-v-ada46c14]{background:#252525;padding:12px;border-radius:8px;text-align:center;border:1px solid #404040}.attribute-item.full-width[data-v-ada46c14]{grid-column:1/-1;text-align:left;padding:16px}.attribute-item.horizontal[data-v-ada46c14]{display:flex;justify-content:space-between;align-items:center;text-align:left}.attribute-item.horizontal .attribute-label[data-v-ada46c14]{margin-bottom:0;flex-shrink:0}.attribute-item.horizontal .attribute-value[data-v-ada46c14]{margin-left:auto}.attribute-item.horizontal .attribute-input[data-v-ada46c14]{margin-left:8px}.attribute-item.birthday-fullwidth[data-v-ada46c14]{display:flex;justify-content:space-between;align-items:center;text-align:left}.attribute-item.birthday-fullwidth .attribute-label[data-v-ada46c14]{margin-bottom:0;flex-shrink:0}.attribute-item.birthday-fullwidth .attribute-value[data-v-ada46c14]{margin-left:auto}.attribute-item.birthday-fullwidth .birthday-edit-container[data-v-ada46c14]{margin-left:auto;justify-content:flex-end}.attribute-label[data-v-ada46c14]{display:block;font-size:12px;color:#888;margin-bottom:6px;text-transform:uppercase;letter-spacing:.5px;font-weight:500}.attribute-label.unit-label[data-v-ada46c14]{text-transform:none}.attribute-value[data-v-ada46c14]{display:block;font-size:16px;font-weight:600;color:#e0e0e0}.attribute-value.money[data-v-ada46c14]{color:#4caf50;font-weight:700}.attribute-value.no-bold[data-v-ada46c14]{font-weight:400}.section-title[data-v-ada46c14]{font-size:18px;font-weight:600;color:#007acc;margin:20px 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.relations-section[data-v-ada46c14],.inventory-section[data-v-ada46c14]{margin-bottom:16px}.relations-section[data-v-ada46c14]:last-child,.inventory-section[data-v-ada46c14]:last-child{margin-bottom:0}.relations-list[data-v-ada46c14],.inventory-list[data-v-ada46c14],.relations-edit-list[data-v-ada46c14],.inventory-edit-list[data-v-ada46c14]{display:flex;flex-direction:column;gap:8px}.relation-item[data-v-ada46c14]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;font-size:14px;color:#e0e0e0;line-height:1.4}.relation-highlight[data-v-ada46c14]{color:#fff;font-weight:500}.relation-connector[data-v-ada46c14]{color:#888;font-weight:400}.relation-edit-item[data-v-ada46c14]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;display:flex;align-items:center;gap:8px;flex-wrap:wrap}.relation-edit-connector[data-v-ada46c14]{color:#888;font-weight:400;font-size:14px;white-space:nowrap}.relation-input[data-v-ada46c14]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;flex:1;min-width:50px}.relation-input[data-v-ada46c14]:focus{outline:none;border-color:#007acc}.relation-select[data-v-ada46c14],.inventory-select[data-v-ada46c14]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;min-width:120px;flex-shrink:0}.relation-select[data-v-ada46c14]:focus,.inventory-select[data-v-ada46c14]:focus{outline:none;border-color:#007acc}.relation-select option[data-v-ada46c14],.inventory-select option[data-v-ada46c14]{background:#333;color:#e0e0e0}.relation-select option[data-v-ada46c14]:disabled,.inventory-select option[data-v-ada46c14]:disabled{color:#888;font-style:italic}.relation-remove-btn[data-v-ada46c14],.add-relation-btn[data-v-ada46c14],.add-inventory-btn[data-v-ada46c14]{background:#007acc;color:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;margin-top:8px;transition:background-color .2s}.relation-remove-btn[data-v-ada46c14]:hover,.add-relation-btn[data-v-ada46c14]:hover,.add-inventory-btn[data-v-ada46c14]:hover{background:#005a99}.inventory-item[data-v-ada46c14]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;display:flex;flex-direction:column;gap:6px}.inventory-first-row[data-v-ada46c14]{display:flex;justify-content:space-between;align-items:center}.item-name-id[data-v-ada46c14]{font-weight:500;color:#fff;font-size:14px}.item-quantity[data-v-ada46c14]{font-weight:600;color:#e0e0e0;background:#007acc;padding:2px 8px;border-radius:12px;font-size:12px}.storage-indicator[data-v-ada46c14]{font-weight:600;color:#fff;background:#4caf50;padding:2px 8px;border-radius:12px;font-size:12px}[data-v-ada46c14] .inventory-item-tag{background:#4caf50;color:#fff;padding:2px 6px;border-radius:4px;font-size:12px;display:flex;align-items:center;gap:4px;white-space:nowrap;flex-shrink:0}[data-v-ada46c14] .storage-item-tag{background:#ff9800;color:#fff;padding:2px 6px;border-radius:4px;font-size:12px;display:flex;align-items:center;gap:4px;white-space:nowrap;flex-shrink:0}.inventory-second-row[data-v-ada46c14]{font-size:12px;color:#a0a0a0;line-height:1.6}.inventory-tags-container[data-v-ada46c14]{display:flex;flex-wrap:wrap;gap:4px;align-items:flex-start;row-gap:6px;margin-top:4px}.inventory-third-row[data-v-ada46c14]{display:flex;flex-direction:column;gap:4px}.no-inventory[data-v-ada46c14]{color:#888;font-style:italic;font-size:13px}.inventory-items[data-v-ada46c14]{display:flex;flex-wrap:wrap;gap:4px}.inventory-edit-item[data-v-ada46c14]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;display:flex;align-items:center;gap:8px;flex-wrap:wrap}.inventory-edit-connector[data-v-ada46c14]{color:#888;font-weight:400;font-size:14px;white-space:nowrap}.inventory-quantity-input[data-v-ada46c14]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;width:80px;text-align:center}.inventory-quantity-input[data-v-ada46c14]:focus{outline:none;border-color:#007acc}.inventory-remove-btn[data-v-ada46c14]{background:#f44336;color:#fff;border:none;border-radius:4px;width:24px;height:24px;cursor:pointer;font-size:16px;font-weight:bold;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-left:auto}.inventory-remove-btn[data-v-ada46c14]:hover{background:#da190b}.attribute-input[data-v-ada46c14]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;width:100%}.attribute-input[data-v-ada46c14]:focus{outline:none;border-color:#007acc}.birthday-inputs[data-v-ada46c14]{display:flex;align-items:center;gap:2px;width:auto;margin-left:auto}.birthday-edit-container[data-v-ada46c14]{display:flex;justify-content:flex-start;width:100%}.birthday-input-group[data-v-ada46c14]{display:flex;align-items:center;gap:4px;padding:4px 0}.birthday-month[data-v-ada46c14],.birthday-date[data-v-ada46c14]{width:50px;flex-shrink:0}.birthday-separator[data-v-ada46c14]{color:#888;font-size:14px;white-space:nowrap}.attribute-textarea[data-v-ada46c14]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:8px;font-size:14px;width:100%;min-height:60px;resize:vertical;font-family:inherit}.attribute-textarea[data-v-ada46c14]:focus{outline:none;border-color:#007acc}.edit-buttons[data-v-ada46c14]{display:flex;justify-content:center;gap:16px;margin-top:20px;padding-top:20px;border-top:1px solid #404040}.edit-button[data-v-ada46c14]{position:absolute;top:0;left:0;padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff}.edit-button[data-v-ada46c14]:hover{background:#005a99}.confirm-button[data-v-ada46c14],.cancel-button[data-v-ada46c14]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s}.confirm-button[data-v-ada46c14]{background:#4caf50;color:#fff}.confirm-button[data-v-ada46c14]:hover{background:#45a049}.cancel-button[data-v-ada46c14]{background:#f44336;color:#fff}.cancel-button[data-v-ada46c14]:hover{background:#da190b}@media (max-width:768px){.user-content[data-v-ada46c14]{padding:12px;gap:16px}.user-name[data-v-ada46c14]{font-size:24px}.attributes-grid[data-v-ada46c14]{grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:8px}.attribute-item[data-v-ada46c14]{padding:10px}.attribute-item.full-width[data-v-ada46c14]{padding:12px}.attribute-value[data-v-ada46c14]{font-size:14px}.inventory-item[data-v-ada46c14]{gap:4px}[data-v-ada46c14] .inventory-item-tag{font-size:12px;padding:2px 6px}.inventory-third-row[data-v-ada46c14] .inventory-item-tag{font-size:12px;padding:2px 6px}}.no-relations-message[data-v-ada46c14],.no-inventory-message[data-v-ada46c14]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}','']);const i=l},6603:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.promise-tab-container[data-v-25ffb8d9]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.promise-content[data-v-25ffb8d9]{flex:1;padding:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--v592213a0);max-height:var(--v592213a0)}.promise-content[data-v-25ffb8d9]::-webkit-scrollbar{width:8px}.promise-content[data-v-25ffb8d9]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.promise-content[data-v-25ffb8d9]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.promise-content[data-v-25ffb8d9]::-webkit-scrollbar-thumb:hover{background:#666}.promise-section[data-v-25ffb8d9]:last-child{margin-bottom:0}.section-title[data-v-25ffb8d9]{font-size:18px;font-weight:600;color:#007acc;margin:0 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.add-promise-button[data-v-25ffb8d9]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff;margin-top:12px}.add-promise-button[data-v-25ffb8d9]:hover{background:#005a99}.promise-list[data-v-25ffb8d9]{display:flex;flex-direction:column;gap:8px}.promise-row[data-v-25ffb8d9]{background:#252525;padding:12px 16px;border-radius:8px;border:1px solid #404040;display:flex;flex-direction:column;gap:8px;font-size:14px;transition:background-color .2s}.promise-row[data-v-25ffb8d9]:hover{background:#2a2a2a;border-color:#555}.new-promise-row[data-v-25ffb8d9]{background:#2a2a2a;border-color:#007acc;border-style:dashed}.promise-first-row[data-v-25ffb8d9]{display:flex;justify-content:space-between;align-items:center;gap:12px}.promise-location-row[data-v-25ffb8d9]{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-top:6px}.promise-location-group[data-v-25ffb8d9]{display:flex;align-items:center;gap:8px}.promise-location-label[data-v-25ffb8d9]{font-weight:500;color:#a0a0a0;font-size:13px;min-width:40px}.promise-edit-actions[data-v-25ffb8d9]{display:flex;gap:8px}.promise-id-name-group[data-v-25ffb8d9]{display:flex;gap:12px;align-items:center;flex:1}.promise-id[data-v-25ffb8d9]{font-weight:500;color:#007acc;font-size:14px}.promise-location[data-v-25ffb8d9]{font-weight:500;color:#fff;font-size:16px}.promise-location-input[data-v-25ffb8d9]{font-weight:500;color:#fff;font-size:16px;width:200px;flex-shrink:0}.promise-location-input-edit[data-v-25ffb8d9]{background:#333;border:1px solid #555;border-radius:4px;padding:4px 8px}.promise-location-input-edit[data-v-25ffb8d9]:focus{outline:none;border-color:#007acc}.promise-deadline[data-v-25ffb8d9]{font-weight:500;color:#4caf50;font-size:14px;flex-shrink:0}.promise-character-ids-display[data-v-25ffb8d9]{display:flex;flex-wrap:wrap;gap:4px}.promise-character-id-tag[data-v-25ffb8d9]{background:#007acc;color:#fff;padding:3px 8px;border-radius:4px;font-size:11px;display:flex;align-items:center;gap:4px}.promise-description[data-v-25ffb8d9]{color:#a0a0a0;line-height:1.4;font-size:13px}.promise-actions[data-v-25ffb8d9]{display:flex;gap:8px}.edit-promise-button[data-v-25ffb8d9],.delete-promise-button[data-v-25ffb8d9]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.edit-promise-button[data-v-25ffb8d9]{background:#007acc;color:#fff}.edit-promise-button[data-v-25ffb8d9]:hover{background:#005a99}.delete-promise-button[data-v-25ffb8d9]{background:#f44336;color:#fff}.delete-promise-button[data-v-25ffb8d9]:hover{background:#da190b}.promise-id-input[data-v-25ffb8d9],.promise-deadline-input[data-v-25ffb8d9],.promise-character-ids-input[data-v-25ffb8d9]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:14px;padding:4px 8px;width:35px;-webkit-appearance:none;appearance:none;appearance:none}.promise-id-input[data-v-25ffb8d9]:focus,.promise-deadline-input[data-v-25ffb8d9]:focus,.promise-character-ids-input[data-v-25ffb8d9]:focus{outline:none;border-color:#007acc}.promise-id-input[data-v-25ffb8d9]::-webkit-outer-spin-button,.promise-id-input[data-v-25ffb8d9]::-webkit-inner-spin-button,.promise-deadline-input[data-v-25ffb8d9]::-webkit-outer-spin-button,.promise-deadline-input[data-v-25ffb8d9]::-webkit-inner-spin-button,.promise-character-ids-input[data-v-25ffb8d9]::-webkit-outer-spin-button,.promise-character-ids-input[data-v-25ffb8d9]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.promise-id-input[type=number][data-v-25ffb8d9],.promise-deadline-input[type=number][data-v-25ffb8d9],.promise-character-ids-input[type=number][data-v-25ffb8d9]{-webkit-appearance:textfield;appearance:textfield}.promise-id-input[data-v-25ffb8d9]{font-weight:500;color:#007acc;font-size:14px;width:50px;flex-shrink:0;text-align:center}.promise-deadline-input[data-v-25ffb8d9]{color:#4caf50;text-align:center}.promise-deadline-year-input[data-v-25ffb8d9]{width:60px}.promise-deadline-input-group[data-v-25ffb8d9]{display:flex;gap:4px;flex-shrink:0;font-weight:500;color:#4caf50;font-size:14px}.promise-deadline-year[data-v-25ffb8d9],.promise-deadline-month[data-v-25ffb8d9],.promise-deadline-day[data-v-25ffb8d9],.promise-deadline-hour[data-v-25ffb8d9],.promise-deadline-minute[data-v-25ffb8d9]{background:#333;border:1px solid #555;border-radius:4px;color:#4caf50;font-size:12px;padding:4px 6px;width:45px;text-align:center}.promise-deadline-year[data-v-25ffb8d9]:focus,.promise-deadline-month[data-v-25ffb8d9]:focus,.promise-deadline-day[data-v-25ffb8d9]:focus,.promise-deadline-hour[data-v-25ffb8d9]:focus,.promise-deadline-minute[data-v-25ffb8d9]:focus{outline:none;border-color:#007acc}.promise-location-input[data-v-25ffb8d9]{font-weight:500;color:#fff;font-size:16px;width:200px;flex-shrink:0}.promise-character-ids-input-group[data-v-25ffb8d9]{display:flex;flex-direction:column;gap:6px}.selected-characters[data-v-25ffb8d9]{display:flex;flex-wrap:wrap;gap:4px}.selected-character-tag[data-v-25ffb8d9]{background:#007acc;color:#fff;padding:3px 8px;border-radius:4px;font-size:11px;display:flex;align-items:center;gap:4px}.remove-character-btn[data-v-25ffb8d9]{background:none;border:none;color:#fff;cursor:pointer;font-size:14px;line-height:1;padding:0;margin-left:2px}.remove-character-btn[data-v-25ffb8d9]:hover{color:#ccc}.character-select[data-v-25ffb8d9]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:4px 8px}.character-select[data-v-25ffb8d9]:focus{outline:none;border-color:#007acc}.promise-description-input[data-v-25ffb8d9]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:6px 8px;resize:vertical;min-height:60px;line-height:1.4;width:100%}.promise-description-input[data-v-25ffb8d9]:focus{outline:none;border-color:#007acc}.confirm-button[data-v-25ffb8d9],.cancel-button[data-v-25ffb8d9]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.confirm-button[data-v-25ffb8d9]{background:#4caf50;color:#fff}.confirm-button[data-v-25ffb8d9]:hover{background:#45a049}.cancel-button[data-v-25ffb8d9]{background:#f44336;color:#fff}.cancel-button[data-v-25ffb8d9]:hover{background:#da190b}.no-promises-message[data-v-25ffb8d9]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}@media (max-width:768px){.promise-content[data-v-25ffb8d9]{padding:12px}.section-title[data-v-25ffb8d9]{font-size:18px}.promise-row[data-v-25ffb8d9]{padding:10px 12px;gap:6px}.promise-first-row[data-v-25ffb8d9]{gap:8px}.promise-location-row[data-v-25ffb8d9]{gap:6px;margin-top:4px}.promise-location-group[data-v-25ffb8d9]{gap:6px}.promise-location-label[data-v-25ffb8d9]{font-size:12px;min-width:35px}.promise-location[data-v-25ffb8d9]{font-size:15px}.promise-location-input[data-v-25ffb8d9]{font-size:15px;width:200px}.promise-edit-actions[data-v-25ffb8d9]{gap:6px}.promise-description[data-v-25ffb8d9]{font-size:12px}.promise-actions[data-v-25ffb8d9]{gap:6px}.edit-promise-button[data-v-25ffb8d9],.delete-promise-button[data-v-25ffb8d9]{padding:5px 10px;font-size:11px}.promise-id-input[data-v-25ffb8d9],.promise-deadline-input[data-v-25ffb8d9],.promise-location-input[data-v-25ffb8d9]{font-size:13px;padding:3px 6px}.promise-deadline-year-input[data-v-25ffb8d9]{width:50px}.promise-deadline-year[data-v-25ffb8d9],.promise-deadline-month[data-v-25ffb8d9],.promise-deadline-day[data-v-25ffb8d9],.promise-deadline-hour[data-v-25ffb8d9],.promise-deadline-minute[data-v-25ffb8d9]{font-size:11px;padding:3px 4px;width:35px}.character-select[data-v-25ffb8d9]{font-size:12px;padding:3px 6px}.selected-character-tag[data-v-25ffb8d9],.promise-character-id-tag[data-v-25ffb8d9]{font-size:10px;padding:1px 4px}.promise-description-input[data-v-25ffb8d9]{font-size:12px;padding:4px 6px;min-height:50px}.confirm-button[data-v-25ffb8d9],.cancel-button[data-v-25ffb8d9]{padding:5px 10px;font-size:11px}}','']);const i=l},6621:(e,t,a)=>{var n=a(7417);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('6b3940ae',n,!1,{ssrId:!0})},6680:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.character-tab-container[data-v-684d53c6]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.add-character-button[data-v-684d53c6]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff;margin-top:12px}.add-character-button[data-v-684d53c6]:hover{background:#005a99}.character-content[data-v-684d53c6],.character-detail-content[data-v-684d53c6]{flex:1;padding:12px;gap:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--v1299b277);max-height:var(--v1299b277)}.character-content[data-v-684d53c6]::-webkit-scrollbar,.character-detail-content[data-v-684d53c6]::-webkit-scrollbar{width:8px}.character-content[data-v-684d53c6]::-webkit-scrollbar-track,.character-detail-content[data-v-684d53c6]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.character-content[data-v-684d53c6]::-webkit-scrollbar-thumb,.character-detail-content[data-v-684d53c6]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.character-content[data-v-684d53c6]::-webkit-scrollbar-thumb:hover,.character-detail-content[data-v-684d53c6]::-webkit-scrollbar-thumb:hover{background:#666}.character-section[data-v-684d53c6]{margin-bottom:24px}.character-section[data-v-684d53c6]:last-child{margin-bottom:0}.section-title[data-v-684d53c6]{font-size:18px;font-weight:600;color:#007acc;margin:0 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.character-list[data-v-684d53c6]{display:flex;flex-direction:column;gap:8px}.character-item[data-v-684d53c6]{background:#252525;padding:12px 16px;border-radius:8px;border:1px solid #404040;display:flex;flex-direction:row;align-items:center;gap:16px;font-size:14px;transition:background-color .2s}.character-item.clickable[data-v-684d53c6]{cursor:pointer}.character-item.clickable[data-v-684d53c6]:hover{background:#2a2a2a;border-color:#555}.toggle-status-button[data-v-684d53c6]{background:#007acc;color:#fff;border:none;border-radius:4px;width:24px;height:24px;cursor:pointer;font-size:14px;font-weight:bold;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:background-color .2s}.toggle-status-button[data-v-684d53c6]:hover{background:#005a99}.toggle-status-button[data-v-684d53c6]:active{background:#004080}.character-id[data-v-684d53c6]{color:#fff;font-weight:700;min-width:40px;text-align:center;padding:6px 10px;border-radius:6px;font-size:14px;display:flex;align-items:center;justify-content:center;height:24px;text-shadow:0 1px 2px rgba(0,0,0,.3)}.user-id[data-v-684d53c6]{color:#fff;font-weight:700;min-width:40px;text-align:center;padding:6px 10px;border-radius:6px;font-size:14px;display:flex;align-items:center;justify-content:center;height:24px;width:80px;text-shadow:0 1px 2px rgba(0,0,0,.3)}.character-name[data-v-684d53c6]{color:#e0e0e0;font-weight:500;text-align:center;flex:1}.user-name[data-v-684d53c6]{color:#e0e0e0;font-weight:500;flex:1}.character-info[data-v-684d53c6]{display:flex;flex-direction:column;gap:8px;flex-shrink:0;min-width:0;width:80px}.user-character-info[data-v-684d53c6]{flex-direction:row;align-items:center;-moz-column-gap:16px;column-gap:16px;height:auto;width:auto}.character-progress-bars[data-v-684d53c6]{display:flex;flex-direction:column;gap:4px;flex:1;min-width:0}.character-progress-bars[data-v-684d53c6] .progress-bar-wrapper{height:16px}.character-progress-bars[data-v-684d53c6] .progress-bar-value{font-size:12px}.no-characters-message[data-v-684d53c6]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}.character-header[data-v-684d53c6]{text-align:center;position:relative}.character-detail-name[data-v-684d53c6]{font-size:24px;font-weight:700;color:#007acc;margin:0;text-shadow:0 2px 4px rgba(0,0,0,.3)}.header-buttons[data-v-684d53c6]{position:absolute;top:0;left:0;display:flex;gap:8px}.edit-button[data-v-684d53c6],.delete-button[data-v-684d53c6]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff}.edit-button[data-v-684d53c6]:hover,.delete-button[data-v-684d53c6]:hover{background:#005a99}.delete-button[data-v-684d53c6]{background:#f44336}.delete-button[data-v-684d53c6]:hover{background:#da190b}.back-button[data-v-684d53c6]{position:absolute;top:0;right:0;background:#007acc;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:background-color .2s}.back-button[data-v-684d53c6]:hover{background:#005a99}.attributes-grid[data-v-684d53c6]{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;margin-bottom:20px}.attribute-item[data-v-684d53c6]{background:#252525;padding:12px;border-radius:8px;text-align:center;border:1px solid #404040}.attribute-item.full-width[data-v-684d53c6]{grid-column:1/-1;text-align:left;padding:16px}.attribute-item.horizontal[data-v-684d53c6]{display:flex;justify-content:space-between;align-items:center;text-align:left}.attribute-item.horizontal .attribute-label[data-v-684d53c6]{margin-bottom:0;flex-shrink:0}.attribute-item.horizontal .attribute-value[data-v-684d53c6]{margin-left:auto}.attribute-item.horizontal .attribute-input[data-v-684d53c6]{margin-left:8px}.attribute-item.birthday-fullwidth[data-v-684d53c6]{display:flex;justify-content:space-between;align-items:center;text-align:left}.attribute-item.birthday-fullwidth .attribute-label[data-v-684d53c6]{margin-bottom:0;flex-shrink:0}.attribute-item.birthday-fullwidth .attribute-value[data-v-684d53c6]{margin-left:auto}.attribute-item.birthday-fullwidth .birthday-edit-container[data-v-684d53c6]{margin-left:auto;justify-content:flex-end}.attribute-item.mood-horny-layout[data-v-684d53c6]{display:flex;justify-content:space-between;align-items:center;text-align:left}.attribute-item.mood-horny-layout .attribute-label[data-v-684d53c6]{margin-bottom:0;flex-shrink:0}.attribute-item.mood-horny-layout .attribute-value[data-v-684d53c6]{margin-left:auto}.attribute-item.mood-horny-layout .attribute-input[data-v-684d53c6]{margin-left:auto;width:auto;min-width:80px}.attribute-item .progress-edit-container[data-v-684d53c6]{display:flex;justify-content:space-between;align-items:center;gap:12px}.attribute-item .progress-edit-container .attribute-label[data-v-684d53c6]{margin-bottom:0;flex-shrink:0}.attribute-item .progress-edit-container .attribute-input[data-v-684d53c6]{width:auto;min-width:80px}.attribute-label[data-v-684d53c6]{display:block;font-size:12px;color:#888;margin-bottom:6px;text-transform:uppercase;letter-spacing:.5px;font-weight:500}.attribute-label.unit-label[data-v-684d53c6]{text-transform:none}.required-asterisk[data-v-684d53c6]{color:#f44336;font-weight:bold;margin-left:2px}.attribute-value[data-v-684d53c6]{display:block;font-size:16px;font-weight:600;color:#e0e0e0}.attribute-value.money[data-v-684d53c6]{color:#4caf50;font-weight:700}.attribute-value.no-bold[data-v-684d53c6]{font-weight:400}.relations-section[data-v-684d53c6],.inventory-section[data-v-684d53c6],.friendships-section[data-v-684d53c6],.loves-section[data-v-684d53c6]{margin-bottom:16px}.relations-section[data-v-684d53c6]:last-child,.inventory-section[data-v-684d53c6]:last-child,.friendships-section[data-v-684d53c6]:last-child,.loves-section[data-v-684d53c6]:last-child{margin-bottom:0}.list-container[data-v-684d53c6],.relations-list[data-v-684d53c6],.inventory-list[data-v-684d53c6],.friendships-list[data-v-684d53c6],.loves-list[data-v-684d53c6],.relations-edit-list[data-v-684d53c6],.inventory-edit-list[data-v-684d53c6],.friendships-edit-list[data-v-684d53c6],.loves-edit-list[data-v-684d53c6]{display:flex;flex-direction:column;gap:8px}.relation-item[data-v-684d53c6]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;font-size:14px;color:#e0e0e0;line-height:1.4}.friendship-item[data-v-684d53c6],.love-item[data-v-684d53c6]{background:#252525;padding:12px;border-radius:6px;border:1px solid #404040;display:flex;flex-direction:row;align-items:center;gap:12px}.relation-highlight[data-v-684d53c6]{color:#fff;font-weight:500}.friendship-name[data-v-684d53c6],.love-name[data-v-684d53c6]{font-size:14px;color:#e0e0e0;line-height:1.4;white-space:nowrap;flex-shrink:0}.friendship-highlight[data-v-684d53c6],.love-highlight[data-v-684d53c6]{color:#fff;font-weight:500}.connector[data-v-684d53c6]{color:#888;font-weight:400}.edit-item[data-v-684d53c6]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;display:flex;align-items:center;gap:8px;flex-wrap:wrap}.edit-connector[data-v-684d53c6]{color:#888;font-weight:400;font-size:14px;white-space:nowrap}.input-field[data-v-684d53c6]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;flex:1;min-width:50px}.input-field[data-v-684d53c6]:focus{outline:none;border-color:#007acc}.relation-select[data-v-684d53c6],.inventory-select[data-v-684d53c6]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;min-width:120px;flex-shrink:0}.relation-select[data-v-684d53c6]:focus,.inventory-select[data-v-684d53c6]:focus{outline:none;border-color:#007acc}.relation-select option[data-v-684d53c6],.inventory-select option[data-v-684d53c6]{background:#333;color:#e0e0e0}.relation-select option[data-v-684d53c6]:disabled,.inventory-select option[data-v-684d53c6]:disabled{color:#888;font-style:italic}.btn[data-v-684d53c6],.action-btn[data-v-684d53c6],.relation-remove-btn[data-v-684d53c6],.add-relation-btn[data-v-684d53c6],.friendship-remove-btn[data-v-684d53c6],.add-friendship-btn[data-v-684d53c6],.love-remove-btn[data-v-684d53c6],.add-love-btn[data-v-684d53c6],.add-inventory-btn[data-v-684d53c6]{background:#007acc;color:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;margin-top:8px;transition:background-color .2s}.btn[data-v-684d53c6]:hover,.action-btn[data-v-684d53c6]:hover,.relation-remove-btn[data-v-684d53c6]:hover,.add-relation-btn[data-v-684d53c6]:hover,.friendship-remove-btn[data-v-684d53c6]:hover,.add-friendship-btn[data-v-684d53c6]:hover,.love-remove-btn[data-v-684d53c6]:hover,.add-love-btn[data-v-684d53c6]:hover,.add-inventory-btn[data-v-684d53c6]:hover{background:#005a99}.inventory-item[data-v-684d53c6]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;display:flex;flex-direction:column;gap:6px}.inventory-first-row[data-v-684d53c6]{display:flex;justify-content:space-between;align-items:center}.item-name-id[data-v-684d53c6]{font-weight:500;color:#fff;font-size:14px}.item-quantity[data-v-684d53c6]{font-weight:600;color:#e0e0e0;background:#007acc;padding:2px 8px;border-radius:12px;font-size:12px}.storage-indicator[data-v-684d53c6]{font-weight:600;color:#fff;background:#4caf50;padding:2px 8px;border-radius:12px;font-size:12px}[data-v-684d53c6] .inventory-item-tag{background:#4caf50;color:#fff;padding:2px 6px;border-radius:4px;font-size:12px;display:flex;align-items:center;gap:4px;white-space:nowrap;flex-shrink:0}[data-v-684d53c6] .storage-item-tag{background:#ff9800;color:#fff;padding:2px 6px;border-radius:4px;font-size:12px;display:flex;align-items:center;gap:4px;white-space:nowrap;flex-shrink:0}.inventory-second-row[data-v-684d53c6]{font-size:12px;color:#a0a0a0;line-height:1.4}.inventory-third-row[data-v-684d53c6]{display:flex;flex-direction:column;gap:4px}.no-inventory[data-v-684d53c6]{color:#888;font-style:italic;font-size:13px}.inventory-items[data-v-684d53c6]{display:flex;flex-wrap:wrap;gap:4px}.inventory-edit-item[data-v-684d53c6]{background:#252525;padding:10px 12px;border-radius:6px;border:1px solid #404040;display:flex;align-items:center;gap:8px;flex-wrap:wrap}.inventory-edit-connector[data-v-684d53c6]{color:#888;font-weight:400;font-size:14px;white-space:nowrap}.inventory-quantity-input[data-v-684d53c6]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;width:80px;text-align:center}.inventory-quantity-input[data-v-684d53c6]:focus{outline:none;border-color:#007acc}.inventory-remove-btn[data-v-684d53c6]{background:#f44336;color:#fff;border:none;border-radius:4px;width:24px;height:24px;cursor:pointer;font-size:16px;font-weight:bold;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-left:auto}.inventory-remove-btn[data-v-684d53c6]:hover{background:#da190b}.attribute-input[data-v-684d53c6]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:4px 8px;font-size:14px;width:100%}.attribute-input[data-v-684d53c6]:focus{outline:none;border-color:#007acc}.birthday-inputs[data-v-684d53c6]{display:flex;align-items:center;gap:2px;width:auto;margin-left:auto}.birthday-edit-container[data-v-684d53c6]{display:flex;justify-content:flex-start;width:100%}.birthday-input-group[data-v-684d53c6]{display:flex;align-items:center;gap:4px;padding:4px 0}.birthday-month[data-v-684d53c6],.birthday-date[data-v-684d53c6]{width:50px;flex-shrink:0}.birthday-separator[data-v-684d53c6]{color:#888;font-size:14px;white-space:nowrap}.attribute-textarea[data-v-684d53c6]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;padding:8px;font-size:14px;width:100%;min-height:60px;resize:vertical;font-family:inherit}.attribute-textarea[data-v-684d53c6]:focus{outline:none;border-color:#007acc}.edit-buttons[data-v-684d53c6]{display:flex;justify-content:center;gap:16px;margin-top:20px;padding-top:20px;border-top:1px solid #404040}.confirm-button[data-v-684d53c6],.cancel-button[data-v-684d53c6]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff}.confirm-button[data-v-684d53c6]:hover,.cancel-button[data-v-684d53c6]:hover{background:#005a99}.confirm-button[data-v-684d53c6]{background:#4caf50;color:#fff}.confirm-button[data-v-684d53c6]:hover:not(:disabled){background:#45a049}.confirm-button[data-v-684d53c6]:disabled{background:#666;cursor:not-allowed;opacity:.6}.cancel-button[data-v-684d53c6]{background:#f44336;color:#fff}.cancel-button[data-v-684d53c6]:hover{background:#da190b}@media (max-width:768px){.character-content[data-v-684d53c6],.character-detail-content[data-v-684d53c6]{padding:12px}.character-name[data-v-684d53c6]{font-size:24px}.attributes-grid[data-v-684d53c6]{grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:8px}.attribute-item[data-v-684d53c6]{padding:10px}.attribute-item.full-width[data-v-684d53c6]{padding:12px}.attribute-value[data-v-684d53c6]{font-size:14px}.inventory-item[data-v-684d53c6]{gap:4px}[data-v-684d53c6] .inventory-item-tag{font-size:12px;padding:2px 6px}.inventory-third-row[data-v-684d53c6] .inventory-item-tag{font-size:12px;padding:2px 6px}.character-item[data-v-684d53c6]{padding:10px 12px;gap:12px;flex-wrap:wrap}.user-character-info[data-v-684d53c6]{-moz-column-gap:16px;column-gap:16px;height:auto}.character-progress-bars[data-v-684d53c6]{gap:2px;flex:1;min-width:120px}.character-id[data-v-684d53c6]{min-width:35px;padding:3px 6px;font-size:11px;height:16px}.user-id[data-v-684d53c6]{min-width:35px;padding:3px 6px;font-size:11px;height:16px}.character-name[data-v-684d53c6]{font-size:13px;line-height:1.2}}.no-message[data-v-684d53c6]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}','']);const i=l},6742:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.item-tabs-container[data-v-d8256cea]{color:#e0e0e0;max-width:1000px;margin:0 auto;padding:16px}.item-tabs-container h3[data-v-d8256cea]{color:#007acc;margin-bottom:24px;font-size:20px}.item-fold-bar[data-v-d8256cea]{margin-bottom:16px}.item-fold-bar[data-v-d8256cea] .fold-bar-btn{background:linear-gradient(135deg,#2a2a2a 0%,#333333 100%);border:1px solid #555;box-shadow:0 2px 8px rgba(0,0,0,.3);padding:12px 16px;font-size:16px;font-weight:600;color:#e0e0e0;transition:all .3s ease}.item-fold-bar[data-v-d8256cea] .fold-bar-btn:hover{background:linear-gradient(135deg,#333333 0%,#404040 100%);border-color:#666;box-shadow:0 4px 12px rgba(0,0,0,.4)}.item-fold-bar[data-v-d8256cea] .fold-bar-content{background:linear-gradient(135deg,#1a1a1a 0%,#222222 100%);border:1px solid #555;border-top:none;box-shadow:0 2px 8px rgba(0,0,0,.3)}.item-fold-bar[data-v-d8256cea] .fold-bar-content-text{padding:20px}.item-fold-bar[data-v-d8256cea] .fold-bar-footer-toggle{background:linear-gradient(135deg,#2a2a2a 0%,#333333 100%);border-top:1px solid #555;color:#b0b0b0;font-size:13px;font-weight:500;padding:12px 16px;transition:all .3s ease}.item-fold-bar[data-v-d8256cea] .fold-bar-footer-toggle:hover{background:linear-gradient(135deg,#333333 0%,#404040 100%);color:#e0e0e0;border-color:#666}.item-fold-bar[data-v-d8256cea] .fold-bar-toggle-icon{color:#007acc;font-size:14px;font-weight:bold}.item-fold-bar.item-incomplete[data-v-d8256cea] .fold-bar-btn span{color:#ff6b6b !important}.remove-item-btn[data-v-d8256cea]{background:#b91c1c;border:1px solid #b91c1c;border-radius:3px;color:#fff;font-size:16px;font-weight:bold;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer}.remove-item-btn span[data-v-d8256cea]{line-height:1;margin-top:-1px}.item-info-container .section[data-v-d8256cea]{margin-bottom:16px}.section[data-v-d8256cea]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.section h4[data-v-d8256cea]{color:#b0b0b0;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.form-grid[data-v-d8256cea]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.input-group.full-width[data-v-d8256cea]{grid-column:1/-1}.input-group label[data-v-d8256cea]{display:block;margin-bottom:8px;color:#b0b0b0;font-weight:500}.text-input[data-v-d8256cea]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.text-input[data-v-d8256cea]:focus{border-color:#007acc}.text-input[data-v-d8256cea]::placeholder{color:#666}.text-area[data-v-d8256cea]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;font-family:inherit;outline:none;resize:vertical;min-height:80px;transition:border-color .2s ease}.text-area[data-v-d8256cea]:focus{border-color:#007acc}.text-area[data-v-d8256cea]::placeholder{color:#666}.add-item-section[data-v-d8256cea]{display:flex;justify-content:center;padding:20px 0;margin-top:20px;border-top:1px solid #404040}.add-item-btn[data-v-d8256cea]{padding:12px 24px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px}.add-item-btn[data-v-d8256cea]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 12px rgba(40,167,69,.3)}.add-item-btn span[data-v-d8256cea]{font-size:18px;font-weight:bold}@media (max-width:768px){.section[data-v-d8256cea]{padding:16px}.form-grid[data-v-d8256cea]{grid-template-columns:1fr}.input-group.full-width[data-v-d8256cea]{grid-column:1}.item-tabs-container[data-v-d8256cea]{max-width:100%;margin:0}.add-item-section[data-v-d8256cea]{padding:16px 0;margin-top:16px}.add-item-btn[data-v-d8256cea]{padding:10px 20px;font-size:14px}.add-item-btn span[data-v-d8256cea]{font-size:16px}.remove-item-btn[data-v-d8256cea]{width:20px;height:20px;font-size:14px}[data-v-d8256cea] .fold-bar-content-text{padding:16px}.action-section[data-v-d8256cea]{flex-direction:row;align-items:stretch;gap:12px}.action-section .generate-btn[data-v-d8256cea],.action-section .apply-all-btn[data-v-d8256cea]{flex:1;width:auto;max-width:none}}.generated-result[data-v-d8256cea]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-d8256cea]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-d8256cea]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word}.generated-result .replace-btn[data-v-d8256cea]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-d8256cea]:hover{background-color:#218838}.action-section[data-v-d8256cea]{display:flex;justify-content:space-between;gap:16px;padding:20px 0}.action-section .generate-btn[data-v-d8256cea],.action-section .apply-all-btn[data-v-d8256cea]{flex:1;max-width:none}.generate-btn[data-v-d8256cea]{padding:14px 32px;background-color:#28a745;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center;gap:8px}.generate-btn[data-v-d8256cea]:hover:not(:disabled){background-color:#218838}.generate-btn[data-v-d8256cea]:disabled{background-color:#666;cursor:not-allowed}.loading-spinner[data-v-d8256cea]{width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-d8256cea 1s linear infinite}@keyframes spin-d8256cea{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.apply-all-btn[data-v-d8256cea]{padding:14px 32px;background-color:#007acc;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.apply-all-btn[data-v-d8256cea]:hover:not(:disabled){background-color:#0056b3}.apply-all-btn[data-v-d8256cea]:disabled{background-color:#666;cursor:not-allowed}','']);const i=l},7139:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'body{overflow-y:auto}','']);const i=l},7319:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.start-container[data-v-ef5b3c42]{color:#e0e0e0;max-width:1000px;margin:0 0;padding:16px}.start-container h3[data-v-ef5b3c42]{color:#007acc;margin-bottom:24px;font-size:20px}.section[data-v-ef5b3c42]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.section .input-group[data-v-ef5b3c42],.section .datetime-group[data-v-ef5b3c42]{margin-bottom:16px}.section .input-group[data-v-ef5b3c42]:last-child,.section .datetime-group[data-v-ef5b3c42]:last-child{margin-bottom:0}.section .input-group label[data-v-ef5b3c42],.section .datetime-group label[data-v-ef5b3c42]{display:block;margin-bottom:6px;color:#b0b0b0;font-weight:500;font-size:13px}.section .datetime-inputs[data-v-ef5b3c42]{display:flex;gap:8px;flex-wrap:wrap}.section .datetime-inputs .datetime-input[data-v-ef5b3c42]{display:flex;align-items:center;gap:4px}.section .datetime-inputs .datetime-input .form-input[data-v-ef5b3c42]{width:80px;text-align:center}.section .datetime-inputs .datetime-input .unit[data-v-ef5b3c42]{color:#b0b0b0;font-size:12px;font-weight:500;min-width:12px}.section .form-input[data-v-ef5b3c42],.section .form-textarea[data-v-ef5b3c42]{width:100%;padding:8px 12px;background:#2a2a2a;border:1px solid #404040;border-radius:4px;color:#e0e0e0;font-size:14px;font-family:inherit;transition:all .2s ease}.section .form-input[data-v-ef5b3c42]:focus,.section .form-textarea[data-v-ef5b3c42]:focus{outline:none;border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.section .form-input[data-v-ef5b3c42]::placeholder,.section .form-textarea[data-v-ef5b3c42]::placeholder{color:#666}.section .form-textarea[data-v-ef5b3c42]{resize:vertical;min-height:60px;line-height:1.4}.item-actions[data-v-ef5b3c42]{display:flex;gap:8px;margin-top:12px}.item-actions .action-btn[data-v-ef5b3c42]{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;min-width:0}.settings-actions[data-v-ef5b3c42]{display:flex;gap:8px;margin-top:20px}.settings-actions .action-btn[data-v-ef5b3c42]{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;min-width:0}.settings-actions .import[data-v-ef5b3c42]{display:flex;align-items:center;justify-content:center}.start-action[data-v-ef5b3c42]{margin-top:20px;display:flex;justify-content:center}.start-action .action-btn[data-v-ef5b3c42]{min-width:120px;padding:12px 24px;font-size:16px;font-weight:600}.generated-result[data-v-ef5b3c42]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-ef5b3c42]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-ef5b3c42]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word;white-space:pre-wrap}.generated-result .replace-btn[data-v-ef5b3c42]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-ef5b3c42]:hover{background-color:#218838}.action-btn[data-v-ef5b3c42]{padding:8px 16px;border:1px solid #555;background:#2a2a2a;color:#e0e0e0;border-radius:4px;cursor:pointer;font-size:13px;font-weight:500;transition:all .2s ease}.action-btn[data-v-ef5b3c42]:hover{background:#404040;border-color:#777}.action-btn.generate[data-v-ef5b3c42]{background-color:#28a745;border-color:#28a745;color:#fff}.action-btn.generate[data-v-ef5b3c42]:hover:not(:disabled){background-color:#218838;transform:translateY(-1px)}.action-btn.generate[data-v-ef5b3c42]:active{transform:translateY(0)}.action-btn.generate[data-v-ef5b3c42]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.apply[data-v-ef5b3c42]{background:linear-gradient(135deg,#28a745,#20c997);border-color:#28a745;color:#fff}.action-btn.apply[data-v-ef5b3c42]:hover:not(:disabled){background:linear-gradient(135deg,#218838,#1aa085);transform:translateY(-1px)}.action-btn.apply[data-v-ef5b3c42]:active{transform:translateY(0)}.action-btn.apply[data-v-ef5b3c42]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.apply-all[data-v-ef5b3c42]{background:linear-gradient(135deg,#007acc,#005999);border-color:#007acc;color:#fff}.action-btn.apply-all[data-v-ef5b3c42]:hover:not(:disabled){background:linear-gradient(135deg,#005999,#004477);transform:translateY(-1px)}.action-btn.apply-all[data-v-ef5b3c42]:active{transform:translateY(0)}.action-btn.apply-all[data-v-ef5b3c42]:disabled{background-color:#666;cursor:not-allowed;transform:none}.action-btn.start[data-v-ef5b3c42]{background:linear-gradient(135deg,#28a745,#20c997);border-color:#28a745;color:#fff;box-shadow:0 2px 4px rgba(40,167,69,.3)}.action-btn.start[data-v-ef5b3c42]:hover:not(:disabled){background:linear-gradient(135deg,#218838,#1aa085);transform:translateY(-1px);box-shadow:0 4px 8px rgba(40,167,69,.4)}.action-btn.start[data-v-ef5b3c42]:active{transform:translateY(0)}.action-btn.start[data-v-ef5b3c42]:disabled{background:linear-gradient(135deg,#444,#333);border-color:#555;color:#888;box-shadow:none;cursor:not-allowed;transform:none;opacity:.6}.action-btn.start[data-v-ef5b3c42]:disabled::before{content:"";margin-right:8px}.action-btn.export[data-v-ef5b3c42]{background:linear-gradient(135deg,#007acc,#005999);border-color:#007acc;color:#fff}.action-btn.export[data-v-ef5b3c42]:hover{background:linear-gradient(135deg,#005999,#004477);transform:translateY(-1px)}.action-btn.export[data-v-ef5b3c42]:active{transform:translateY(0)}.action-btn.import[data-v-ef5b3c42]{background:linear-gradient(135deg,#ffc107,#e0a800);border-color:#ffc107;color:#212529;cursor:pointer}.action-btn.import[data-v-ef5b3c42]:hover{background:linear-gradient(135deg,#e0a800,#d39e00);transform:translateY(-1px)}.action-btn.import[data-v-ef5b3c42]:active{transform:translateY(0)}@media (max-width:768px){.start-container[data-v-ef5b3c42]{padding:16px}.section[data-v-ef5b3c42]{padding:16px}.section .datetime-inputs[data-v-ef5b3c42]{gap:6px}.section .datetime-inputs .datetime-input .form-input[data-v-ef5b3c42]{width:70px}.section .datetime-inputs .datetime-input .unit[data-v-ef5b3c42]{font-size:11px;min-width:10px}.item-actions[data-v-ef5b3c42]{gap:6px}.item-actions .action-btn[data-v-ef5b3c42]{padding:6px 12px;font-size:12px}.settings-actions[data-v-ef5b3c42]{gap:6px}.settings-actions .action-btn[data-v-ef5b3c42]{padding:8px 12px;font-size:13px}.completion-status[data-v-ef5b3c42]{padding:12px}.completion-status .status-item[data-v-ef5b3c42]{padding:6px 8px;margin-bottom:6px}.completion-status .status-item .status-label[data-v-ef5b3c42]{font-size:13px}.completion-status .status-item .status-value[data-v-ef5b3c42]{font-size:13px}.start-action .action-btn[data-v-ef5b3c42]{min-width:100px;padding:10px 20px;font-size:14px}}.loading-spinner[data-v-ef5b3c42]{display:inline-block;width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-ef5b3c42 1s linear infinite;flex-shrink:0}@keyframes spin-ef5b3c42{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.completion-status[data-v-ef5b3c42]{margin-top:20px;padding:16px;background-color:#2a2a2a;border-radius:12px;border:1px solid #404040}.completion-status .status-item[data-v-ef5b3c42]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;margin-bottom:8px;border-radius:6px;background-color:#1a1a1a;border:1px solid #555;transition:all .2s ease}.completion-status .status-item[data-v-ef5b3c42]:last-child{margin-bottom:0}.completion-status .status-item.completed[data-v-ef5b3c42]{background-color:#0f2a0f;border-color:#28a745}.completion-status .status-item.completed .status-label[data-v-ef5b3c42]{color:#4ade80}.completion-status .status-item.completed .status-value[data-v-ef5b3c42]{color:#28a745;font-weight:600}.completion-status .status-item[data-v-ef5b3c42]:not(.completed){background-color:#2a0f0f;border-color:#dc3545}.completion-status .status-item:not(.completed) .status-label[data-v-ef5b3c42]{color:#fca5a5}.completion-status .status-item:not(.completed) .status-value[data-v-ef5b3c42]{color:#dc3545;font-weight:600}.completion-status .status-item .status-label[data-v-ef5b3c42]{font-size:14px;font-weight:500}.completion-status .status-item .status-value[data-v-ef5b3c42]{font-size:14px}','']);const i=l},7417:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.character-tabs-container[data-v-41c909bc]{color:#e0e0e0;max-width:1000px;margin:0 auto;padding:16px}.character-tabs-container h3[data-v-41c909bc]{color:#007acc;margin-bottom:24px;font-size:20px}.character-fold-bar[data-v-41c909bc]{margin-bottom:16px}.character-fold-bar[data-v-41c909bc] .fold-bar-btn{background:linear-gradient(135deg,#2a2a2a 0%,#333333 100%);border:1px solid #555;box-shadow:0 2px 8px rgba(0,0,0,.3);padding:12px 16px;font-size:16px;font-weight:600;color:#e0e0e0;transition:all .3s ease}.character-fold-bar[data-v-41c909bc] .fold-bar-btn:hover{background:linear-gradient(135deg,#333333 0%,#404040 100%);border-color:#666;box-shadow:0 4px 12px rgba(0,0,0,.4)}.character-fold-bar[data-v-41c909bc] .fold-bar-content{background:linear-gradient(135deg,#1a1a1a 0%,#222222 100%);border:1px solid #555;border-top:none;box-shadow:0 2px 8px rgba(0,0,0,.3)}.character-fold-bar[data-v-41c909bc] .fold-bar-content-text{padding:20px}.character-fold-bar[data-v-41c909bc] .fold-bar-footer-toggle{background:linear-gradient(135deg,#2a2a2a 0%,#333333 100%);border-top:1px solid #555;color:#b0b0b0;font-size:13px;font-weight:500;padding:12px 16px;transition:all .3s ease}.character-fold-bar[data-v-41c909bc] .fold-bar-footer-toggle:hover{background:linear-gradient(135deg,#333333 0%,#404040 100%);color:#e0e0e0;border-color:#666}.character-fold-bar[data-v-41c909bc] .fold-bar-toggle-icon{color:#007acc;font-size:14px;font-weight:bold}.character-fold-bar.character-incomplete[data-v-41c909bc] .fold-bar-btn span{color:#ff6b6b !important}.remove-character-btn[data-v-41c909bc]{background:#b91c1c;border:1px solid #b91c1c;border-radius:3px;color:#fff;font-size:16px;font-weight:bold;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer}.remove-character-btn span[data-v-41c909bc]{line-height:1;margin-top:-1px}.character-info-container .section[data-v-41c909bc]{margin-bottom:16px}.section[data-v-41c909bc]{background-color:#2a2a2a;padding:20px;border-radius:12px;border:1px solid #404040;margin-bottom:20px}.section h4[data-v-41c909bc]{color:#b0b0b0;margin-bottom:16px;font-size:16px;border-bottom:1px solid #404040;padding-bottom:8px}.form-grid[data-v-41c909bc]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.input-group.full-width[data-v-41c909bc]{grid-column:1/-1}.input-group label[data-v-41c909bc]{display:block;margin-bottom:8px;color:#b0b0b0;font-weight:500}.text-input[data-v-41c909bc]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.text-input[data-v-41c909bc]:focus{border-color:#007acc}.text-input[data-v-41c909bc]::placeholder{color:#666}.text-area[data-v-41c909bc]{width:100%;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;font-family:inherit;outline:none;resize:vertical;min-height:80px;transition:border-color .2s ease}.text-area[data-v-41c909bc]:focus{border-color:#007acc}.text-area[data-v-41c909bc]::placeholder{color:#666}.birthday-inputs[data-v-41c909bc]{display:flex;gap:8px}.birthday-inputs .birthday-input[data-v-41c909bc]{flex:1;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;outline:none;transition:border-color .2s ease}.birthday-inputs .birthday-input[data-v-41c909bc]:focus{border-color:#007acc}.birthday-inputs .birthday-input[data-v-41c909bc]::placeholder{color:#666}.relations-list[data-v-41c909bc]{display:flex;flex-direction:column;gap:8px}.relation-item[data-v-41c909bc]{display:flex;align-items:center;flex-wrap:wrap;gap:8px;padding:12px;background:linear-gradient(135deg,#1e1e1e 0%,#252525 100%);border:1px solid #555;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.2);transition:border-color .2s ease}.relation-item[data-v-41c909bc]:hover{border-color:#666}.relation-item .relation-target[data-v-41c909bc]{color:#4fc3f7;font-weight:600;font-size:13px;flex-shrink:0;min-width:60px;padding:6px 8px;background-color:#2a2a2a;border-radius:4px;text-align:center}.relation-item .relation-input[data-v-41c909bc]{flex:1;min-width:120px;padding:10px 14px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.relation-item .relation-input[data-v-41c909bc]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.relation-item .relation-input[data-v-41c909bc]::placeholder{color:#888}.relation-item .remove-relation-btn[data-v-41c909bc]{background:linear-gradient(135deg,#dc3545 0%,#c82333 100%);border:1px solid #dc3545;border-radius:6px;color:#fff;font-size:14px;font-weight:bold;width:24px;height:24px;flex-shrink:0;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(220,53,69,.3)}.relation-item .remove-relation-btn[data-v-41c909bc]:hover{background:linear-gradient(135deg,#c82333 0%,#a02622 100%);border-color:#bd2130;transform:translateY(-1px);box-shadow:0 4px 8px rgba(220,53,69,.4)}.relation-item .remove-relation-btn[data-v-41c909bc]:active{transform:translateY(0)}.add-relation[data-v-41c909bc]{display:flex;flex-wrap:wrap;gap:8px;align-items:center;padding:12px;background:linear-gradient(135deg,#252525 0%,#2a2a2a 100%);border:1px solid #555;border-radius:8px;margin-top:12px}.add-relation .relation-select[data-v-41c909bc]{flex:1;min-width:150px;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.add-relation .relation-select[data-v-41c909bc]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.add-relation .add-relation-btn[data-v-41c909bc]{flex-shrink:0;padding:10px 16px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:6px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(40,167,69,.3)}.add-relation .add-relation-btn[data-v-41c909bc]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 8px rgba(40,167,69,.4)}.add-relation .add-relation-btn[data-v-41c909bc]:disabled{background-color:#666;border-color:#666;cursor:not-allowed;box-shadow:none;transform:none}.add-relation .add-relation-btn[data-v-41c909bc]:active{transform:translateY(0)}.inventory-list[data-v-41c909bc]{display:flex;flex-direction:column;gap:8px}.inventory-item[data-v-41c909bc]{display:flex;align-items:center;flex-wrap:wrap;gap:8px;padding:12px;background:linear-gradient(135deg,#1e1e1e 0%,#252525 100%);border:1px solid #555;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.2);transition:border-color .2s ease}.inventory-item[data-v-41c909bc]:hover{border-color:#666}.inventory-item .inventory-target[data-v-41c909bc]{color:#4fc3f7;font-weight:600;font-size:13px;flex-shrink:0;min-width:60px;padding:6px 8px;background-color:#2a2a2a;border-radius:4px;text-align:center}.inventory-item .inventory-input[data-v-41c909bc]{flex:1;min-width:120px;padding:10px 14px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.inventory-item .inventory-input[data-v-41c909bc]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.inventory-item .inventory-input[data-v-41c909bc]::placeholder{color:#888}.inventory-item .remove-inventory-btn[data-v-41c909bc]{background:linear-gradient(135deg,#dc3545 0%,#c82333 100%);border:1px solid #dc3545;border-radius:6px;color:#fff;font-size:14px;font-weight:bold;width:24px;height:24px;flex-shrink:0;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(220,53,69,.3)}.inventory-item .remove-inventory-btn[data-v-41c909bc]:hover{background:linear-gradient(135deg,#c82333 0%,#a02622 100%);border-color:#bd2130;transform:translateY(-1px);box-shadow:0 4px 8px rgba(220,53,69,.4)}.inventory-item .remove-inventory-btn[data-v-41c909bc]:active{transform:translateY(0)}.add-inventory[data-v-41c909bc]{display:flex;flex-wrap:wrap;gap:8px;align-items:center;padding:12px;background:linear-gradient(135deg,#252525 0%,#2a2a2a 100%);border:1px solid #555;border-radius:8px;margin-top:12px}.add-inventory .inventory-select[data-v-41c909bc]{flex:1;min-width:150px;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.add-inventory .inventory-select[data-v-41c909bc]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.add-inventory .quantity-input[data-v-41c909bc]{flex:1;min-width:80px;padding:12px 16px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px;color:#e0e0e0;font-size:14px;outline:none;transition:all .2s ease}.add-inventory .quantity-input[data-v-41c909bc]:focus{border-color:#007acc;box-shadow:0 0 0 2px rgba(0,122,204,.2)}.add-inventory .quantity-input[data-v-41c909bc]::placeholder{color:#888}.add-inventory .quantity-input[data-v-41c909bc]:disabled{background-color:#333;color:#666;cursor:not-allowed}.add-inventory .add-inventory-btn[data-v-41c909bc]{flex-shrink:0;padding:10px 16px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:6px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(40,167,69,.3)}.add-inventory .add-inventory-btn[data-v-41c909bc]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 8px rgba(40,167,69,.4)}.add-inventory .add-inventory-btn[data-v-41c909bc]:disabled{background-color:#666;border-color:#666;cursor:not-allowed;box-shadow:none;transform:none}.add-inventory .add-inventory-btn[data-v-41c909bc]:active{transform:translateY(0)}.generated-result[data-v-41c909bc]{margin-top:8px;padding:8px;background-color:#1a1a1a;border:1px solid #404040;border-radius:6px}.generated-result label[data-v-41c909bc]{display:block;margin-bottom:4px;color:#007acc;font-size:12px;font-weight:500}.generated-result .generated-text[data-v-41c909bc]{color:#e0e0e0;font-size:14px;margin-bottom:8px;word-wrap:break-word}.generated-result .replace-btn[data-v-41c909bc]{padding:6px 12px;background-color:#28a745;border:none;border-radius:4px;color:#fff;font-size:12px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.generated-result .replace-btn[data-v-41c909bc]:hover{background-color:#218838}.action-section[data-v-41c909bc]{display:flex;justify-content:space-between;gap:16px;padding:20px 0}.action-section .generate-btn[data-v-41c909bc],.action-section .apply-all-btn[data-v-41c909bc]{flex:1;max-width:none}.add-character-section[data-v-41c909bc]{display:flex;justify-content:center;padding:20px 0;margin-top:20px;border-top:1px solid #404040}.add-character-btn[data-v-41c909bc]{padding:12px 24px;background:linear-gradient(135deg,#28a745 0%,#20c997 100%);border:1px solid #28a745;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px}.add-character-btn[data-v-41c909bc]:hover:not(:disabled){background:linear-gradient(135deg,#218838 0%,#1aa085 100%);border-color:#218838;transform:translateY(-1px);box-shadow:0 4px 12px rgba(40,167,69,.3)}.add-character-btn span[data-v-41c909bc]{font-size:18px;font-weight:bold}.generate-btn[data-v-41c909bc]{padding:14px 32px;background-color:#28a745;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center;gap:8px}.generate-btn[data-v-41c909bc]:hover:not(:disabled){background-color:#218838}.generate-btn[data-v-41c909bc]:disabled{background-color:#666;cursor:not-allowed}.loading-spinner[data-v-41c909bc]{width:16px;height:16px;border:2px solid #fff;border-top:2px solid rgba(0,0,0,0);border-radius:50%;animation:spin-41c909bc 1s linear infinite}@keyframes spin-41c909bc{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.apply-all-btn[data-v-41c909bc]{padding:14px 32px;background-color:#007acc;border:none;border-radius:8px;color:#fff;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.apply-all-btn[data-v-41c909bc]:hover:not(:disabled){background-color:#0056b3}.apply-all-btn[data-v-41c909bc]:disabled{background-color:#666;cursor:not-allowed}@media (max-width:768px){.section[data-v-41c909bc]{padding:16px}.form-grid[data-v-41c909bc]{grid-template-columns:1fr}.input-group.full-width[data-v-41c909bc]{grid-column:1}.birthday-inputs[data-v-41c909bc]{flex-direction:column}.info-item[data-v-41c909bc]{flex-direction:column;align-items:flex-start;gap:4px}.info-item label[data-v-41c909bc]{min-width:unset}.character-tabs-container[data-v-41c909bc]{max-width:100%;margin:0}.action-section[data-v-41c909bc]{flex-direction:row;align-items:stretch;gap:12px}.action-section .generate-btn[data-v-41c909bc],.action-section .apply-all-btn[data-v-41c909bc]{flex:1;width:auto;max-width:none}.add-character-section[data-v-41c909bc]{padding:16px 0;margin-top:16px}.add-character-btn[data-v-41c909bc]{padding:10px 20px;font-size:14px}.add-character-btn span[data-v-41c909bc]{font-size:16px}.remove-character-btn[data-v-41c909bc]{width:20px;height:20px;font-size:14px}}','']);const i=l},7557:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.confirm-dialog-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;z-index:9999}.confirm-dialog{background-color:#2a2a2a;border-radius:12px;border:1px solid #404040;min-width:300px;max-width:90vw;box-shadow:0 4px 20px rgba(0,0,0,.3)}.confirm-dialog-header{padding:20px 20px 0 20px}.confirm-dialog-header h3{margin:0;color:#e0e0e0;font-size:18px;font-weight:600}.confirm-dialog-body{padding:16px 20px}.confirm-dialog-body p{margin:0;color:#b0b0b0;line-height:1.5;font-size:14px}.confirm-dialog-footer{padding:0 20px 20px 20px;display:flex;gap:12px;justify-content:flex-end}.confirm-btn{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.confirm-btn.cancel-btn{background-color:#404040;color:#b0b0b0}.confirm-btn.cancel-btn:hover{background-color:#505050}.confirm-btn.confirm-action-btn{background-color:#007acc;color:#fff}.confirm-btn.confirm-action-btn:hover{background-color:#0056b3}.confirm-btn.confirm-action-btn:active{background-color:#004085}.confirm-btn.confirm-action-btn[data-confirm-text=]{background-color:#dc3545}.confirm-btn.confirm-action-btn[data-confirm-text=]:hover{background-color:#c82333}.confirm-btn.confirm-action-btn[data-confirm-text=]:active{background-color:#bd2130}','']);const i=l},7701:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.app-container[data-v-e8f6a8aa]{display:flex;flex-direction:column;width:100%;height:100%;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.initialization-wrapper[data-v-e8f6a8aa]{height:100%;width:100%;display:flex;flex-direction:column}','']);const i=l},7772:(e,t,a)=>{var n=a(7808);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('4e12f3b5',n,!1,{ssrId:!0})},7776:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.progress-bar-container[data-v-be0274c0]{display:flex;flex-direction:row;align-items:center;gap:12px;width:100%}.progress-bar-label[data-v-be0274c0]{font-size:12px;color:#888;letter-spacing:.5px;font-weight:500;min-width:100px;flex-shrink:0}.progress-bar-wrapper[data-v-be0274c0]{position:relative;height:20px;background:#333;border-radius:10px;border:1px solid #555;overflow:hidden;display:flex;align-items:center;padding:0 8px;flex:1}.progress-bar-fill[data-v-be0274c0]{position:absolute;left:0;top:0;height:100%;border-radius:10px;transition:width .3s ease;z-index:1}.progress-bar-value[data-v-be0274c0]{position:relative;z-index:2;font-size:13px;font-weight:700;color:#fff;white-space:nowrap;text-shadow:0 0 2px #000,0 0 4px rgba(0,0,0,.9),0 0 8px rgba(0,0,0,.7),0 1px 2px rgba(0,0,0,.8);-webkit-text-stroke:.5px rgba(0,0,0,.5)}','']);const i=l},7808:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.summary-tab-container[data-v-3de5c4ec]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.summary-content[data-v-3de5c4ec]{flex:1;padding:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--v70237b32);max-height:var(--v70237b32)}.summary-content[data-v-3de5c4ec]::-webkit-scrollbar{width:8px}.summary-content[data-v-3de5c4ec]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.summary-content[data-v-3de5c4ec]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.summary-content[data-v-3de5c4ec]::-webkit-scrollbar-thumb:hover{background:#666}.summary-section[data-v-3de5c4ec]{margin-bottom:16px}.summary-section[data-v-3de5c4ec]:last-child{margin-bottom:0}.section-title[data-v-3de5c4ec]{font-size:18px;font-weight:600;color:#007acc;margin:0 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.add-summary-button[data-v-3de5c4ec]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff;margin-top:12px;width:100%}.add-summary-button[data-v-3de5c4ec]:hover{background:#005a99}.summary-list[data-v-3de5c4ec]{display:flex;flex-direction:column;gap:8px}.summary-row[data-v-3de5c4ec]{background:#252525;padding:12px 16px;border-radius:8px;border:1px solid #404040;display:flex;flex-direction:column;gap:8px;font-size:14px;transition:background-color .2s}.summary-row[data-v-3de5c4ec]:hover{background:#2a2a2a;border-color:#555}.new-summary-row[data-v-3de5c4ec]{background:#2a2a2a;border-color:#007acc;border-style:dashed}.summary-first-row[data-v-3de5c4ec]{display:flex;justify-content:space-between;align-items:center;gap:12px}.summary-weighting-last-message-group[data-v-3de5c4ec]{display:flex;gap:12px;align-items:center}.summary-datetime-row[data-v-3de5c4ec]{margin-bottom:4px}.summary-datetime[data-v-3de5c4ec]{font-weight:500;color:#4caf50;font-size:14px;flex-shrink:0}.summary-weighting[data-v-3de5c4ec]{font-weight:500;color:#ff9800;font-size:13px}.summary-last-message-id[data-v-3de5c4ec]{font-weight:500;color:#bb86fc;font-size:13px}.summary-status[data-v-3de5c4ec]{font-weight:500;font-size:12px;padding:2px 6px;border-radius:4px;text-align:center;min-width:50px}.summary-status.status-used[data-v-3de5c4ec]{background-color:#4caf50;color:#fff}.summary-status.status-unused[data-v-3de5c4ec]{background-color:#ff9800;color:#fff}.summary-content-display[data-v-3de5c4ec]{color:#a0a0a0;line-height:1.4;font-size:13px}.summary-actions[data-v-3de5c4ec]{display:flex;gap:8px}.edit-summary-button[data-v-3de5c4ec],.delete-summary-button[data-v-3de5c4ec]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.edit-summary-button[data-v-3de5c4ec]{background:#007acc;color:#fff}.edit-summary-button[data-v-3de5c4ec]:hover{background:#005a99}.delete-summary-button[data-v-3de5c4ec]{background:#f44336;color:#fff}.delete-summary-button[data-v-3de5c4ec]:hover{background:#da190b}.no-summaries-message[data-v-3de5c4ec]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}.summary-edit-mode[data-v-3de5c4ec]{display:flex;flex-direction:column;gap:8px}.summary-edit-first-row[data-v-3de5c4ec]{display:flex;justify-content:space-between;align-items:center;gap:12px}.summary-weighting-last-message-input-group[data-v-3de5c4ec]{display:flex;gap:12px;align-items:center}.summary-weighting-input-group[data-v-3de5c4ec],.summary-last-message-id-input-group[data-v-3de5c4ec]{display:flex;gap:4px;align-items:center;font-size:13px;color:#a0a0a0}.summary-edit-actions[data-v-3de5c4ec]{display:flex;gap:8px;justify-content:flex-end}.summary-edit-datetime-row[data-v-3de5c4ec]{margin-bottom:4px}.summary-datetime-input-group[data-v-3de5c4ec]{display:flex;gap:4px;flex-shrink:0;font-weight:500;color:#4caf50;font-size:14px}.summary-datetime-input[data-v-3de5c4ec]{background:#333;border:1px solid #555;border-radius:4px;color:#4caf50;font-size:14px;padding:4px 8px;width:35px;-webkit-appearance:none;appearance:none;text-align:center}.summary-datetime-input[data-v-3de5c4ec]:focus{outline:none;border-color:#007acc}.summary-datetime-input[data-v-3de5c4ec]::-webkit-outer-spin-button,.summary-datetime-input[data-v-3de5c4ec]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.summary-datetime-input[type=number][data-v-3de5c4ec]{-webkit-appearance:textfield;appearance:textfield}.summary-datetime-year-input[data-v-3de5c4ec]{width:60px}.summary-weighting-input[data-v-3de5c4ec]{background:#333;border:1px solid #555;border-radius:4px;color:#ff9800;font-size:14px;padding:4px 8px;width:60px;-webkit-appearance:none;appearance:none;text-align:center}.summary-weighting-input[data-v-3de5c4ec]:focus{outline:none;border-color:#007acc}.summary-weighting-input[data-v-3de5c4ec]::-webkit-outer-spin-button,.summary-weighting-input[data-v-3de5c4ec]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.summary-weighting-input[type=number][data-v-3de5c4ec]{-webkit-appearance:textfield;appearance:textfield}.summary-last-message-id-input[data-v-3de5c4ec]{background:#333;border:1px solid #555;border-radius:4px;color:#9c27b0;font-size:14px;padding:4px 8px;width:40px;-webkit-appearance:none;appearance:none;text-align:center}.summary-last-message-id-input[data-v-3de5c4ec]:focus{outline:none;border-color:#007acc}.summary-last-message-id-input[data-v-3de5c4ec]::-webkit-outer-spin-button,.summary-last-message-id-input[data-v-3de5c4ec]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.summary-last-message-id-input[type=number][data-v-3de5c4ec]{-webkit-appearance:textfield;appearance:textfield}.summary-content-input[data-v-3de5c4ec]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:6px 8px;resize:vertical;min-height:60px;line-height:1.4;width:100%}.summary-content-input[data-v-3de5c4ec]:focus{outline:none;border-color:#007acc}.confirm-button[data-v-3de5c4ec],.cancel-button[data-v-3de5c4ec]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.confirm-button[data-v-3de5c4ec]{background:#4caf50;color:#fff}.confirm-button[data-v-3de5c4ec]:hover:not(:disabled){background:#45a049}.confirm-button[data-v-3de5c4ec]:disabled{background:#666;color:#ccc;cursor:not-allowed}.cancel-button[data-v-3de5c4ec]{background:#f44336;color:#fff}.cancel-button[data-v-3de5c4ec]:hover{background:#da190b}@media (max-width:768px){.summary-content[data-v-3de5c4ec]{padding:12px}.section-title[data-v-3de5c4ec]{font-size:18px}.summary-row[data-v-3de5c4ec]{padding:10px 12px;gap:6px}.summary-first-row[data-v-3de5c4ec]{gap:8px}.summary-weighting-last-message-group[data-v-3de5c4ec]{gap:8px}.summary-datetime-row[data-v-3de5c4ec]{margin-bottom:3px}.summary-content-display[data-v-3de5c4ec]{font-size:12px}.summary-actions[data-v-3de5c4ec]{gap:6px}.edit-summary-button[data-v-3de5c4ec],.delete-summary-button[data-v-3de5c4ec]{padding:5px 10px;font-size:11px}.summary-edit-first-row[data-v-3de5c4ec]{gap:8px}.summary-weighting-last-message-input-group[data-v-3de5c4ec]{gap:8px}.summary-edit-actions[data-v-3de5c4ec]{gap:6px}.summary-datetime-input[data-v-3de5c4ec]{font-size:13px;padding:3px 6px}.summary-datetime-year-input[data-v-3de5c4ec]{width:50px}.summary-weighting-input[data-v-3de5c4ec]{width:50px}.summary-last-message-id-input[data-v-3de5c4ec]{width:35px}.summary-content-input[data-v-3de5c4ec]{font-size:12px;padding:4px 6px;min-height:50px}.confirm-button[data-v-3de5c4ec],.cancel-button[data-v-3de5c4ec]{padding:5px 10px;font-size:11px}}','']);const i=l},7817:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.fold-bar[data-v-112e8be8]{background:rgba(0,0,0,0);border:none;border-radius:0;box-shadow:none;font-size:14px;font-weight:500;color:#e0e0e0;padding:0;margin:0}.fold-bar-header[data-v-112e8be8]{margin-bottom:0;padding-bottom:0;display:flex;align-items:center;justify-content:flex-start;position:relative}.fold-bar-header-actions[data-v-112e8be8]{display:flex;align-items:center;gap:8px;position:absolute;right:0;top:0;bottom:0}.fold-bar-btn[data-v-112e8be8]{cursor:pointer;display:flex;align-items:center;background:#333;border:1px solid #404040;border-bottom:none;flex:1;text-align:left;color:#e0e0e0;font-size:14px;font-weight:500;padding:6px 12px;border-radius:0}.fold-bar-title-actions[data-v-112e8be8]{display:flex;align-items:center;gap:4px;margin-left:auto;margin-right:8px}.fold-bar-btn[data-v-112e8be8]:hover{background:#404040}.fold-bar-btn[data-v-112e8be8]:focus{outline:none}.fold-bar-toggle-icon[data-v-112e8be8]{margin-left:8px;flex-shrink:0;font-size:12px;color:#b0b0b0;transition:transform .3s ease}.fold-bar-toggle-icon[data-v-112e8be8]::before{content:""}.fold-bar-toggle-icon.open[data-v-112e8be8]{transform:rotate(180deg)}.fold-bar-content[data-v-112e8be8]{max-height:0;overflow:hidden;transition:max-height .3s ease;background:#1a1a1a;border:1px solid #404040;border-top:none;padding:0}.fold-bar-content.open[data-v-112e8be8]{overflow-y:auto;scrollbar-width:none;-ms-overflow-style:none}.fold-bar-content.open[data-v-112e8be8]::-webkit-scrollbar{display:none}.fold-bar-content-text[data-v-112e8be8]{padding:0 12px}.fold-bar-footer-toggle[data-v-112e8be8]{text-align:center;color:#888;font-size:12px;cursor:pointer;margin-top:8px;padding:8px 12px;border-top:1px solid #404040;background:#333}.fold-bar-footer-toggle[data-v-112e8be8]:hover{color:#b0b0b0;background:#404040}@media (max-width:768px){.fold-bar-btn[data-v-112e8be8]{font-size:12px}.fold-bar-footer-toggle[data-v-112e8be8]{font-size:11px}}','']);const i=l},8093:e=>{e.exports=function(e){return e[1]}},8871:(e,t,a)=>{var n=a(6307);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('32359e75',n,!1,{ssrId:!0})},8882:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.initializations-container[data-v-252c6a8b]{display:flex;flex-direction:column;width:100%;height:100%;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.main-content[data-v-252c6a8b]{flex:1;display:flex;flex-direction:column;overflow:hidden}.initialization-area[data-v-252c6a8b]{display:flex;flex-direction:column;flex:1;background-color:#1a1a1a;overflow-y:auto}.tab-navigation[data-v-252c6a8b]{display:flex;background-color:#2a2a2a;border-bottom:1px solid #404040;flex-shrink:0}.tab-navigation.top[data-v-252c6a8b]{border-top:none}.tab-navigation.first-row[data-v-252c6a8b]{border-bottom:none}.tab-navigation.second-row[data-v-252c6a8b]{border-top:none}.tab-button[data-v-252c6a8b]{flex:1;padding:16px;background:none;border:none;color:#b0b0b0;font-size:16px;cursor:pointer;transition:all .2s ease}.tab-button.active[data-v-252c6a8b]{color:#007acc;background-color:#3a3a3a}.tab-button[data-v-252c6a8b]:hover{background-color:#3a3a3a}@media (max-width:768px){.tab-button[data-v-252c6a8b]{padding:14px;font-size:14px}}','']);const i=l},8937:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.settings-container[data-v-d8917884]{display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;overflow:hidden;min-height:var(--v50c01ddd);max-height:var(--v50c01ddd)}.settings-header[data-v-d8917884]{padding:20px 16px 16px 16px;border-bottom:1px solid #404040}.settings-header h2[data-v-d8917884]{margin:0;font-size:24px;font-weight:600;color:#e0e0e0}.settings-list[data-v-d8917884]{flex:1;overflow-y:auto;padding:8px 0}.setting-item[data-v-d8917884]{display:flex;align-items:center;justify-content:space-between;padding:16px;border-bottom:1px solid #2a2a2a;transition:background-color .2s ease}.setting-item[data-v-d8917884]:hover{background-color:hsla(0,0%,100%,.02)}.setting-item[data-v-d8917884]:last-child{border-bottom:none}.setting-item.version-item[data-v-d8917884]{border-bottom:1px solid #2a2a2a}.setting-item.xml-rules-item[data-v-d8917884]{border-bottom:none;padding-bottom:8px}.setting-label[data-v-d8917884]{flex:1;display:flex;flex-direction:column;gap:4px}.setting-title[data-v-d8917884]{font-size:16px;font-weight:500;color:#e0e0e0}.setting-description[data-v-d8917884]{font-size:14px;color:#888;line-height:1.4}.setting-control[data-v-d8917884]{display:flex;align-items:center;margin-left:16px}.switch[data-v-d8917884]{position:relative;display:inline-block;width:50px;height:24px}.switch input[data-v-d8917884]{opacity:0;width:0;height:0}.slider[data-v-d8917884]{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#404040;transition:.3s;border-radius:24px}.slider[data-v-d8917884]:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:#fff;transition:.3s;border-radius:50%}input:checked+.slider[data-v-d8917884]{background-color:#007acc}input:checked+.slider[data-v-d8917884]:before{transform:translateX(26px)}.number-input[data-v-d8917884]{width:80px;padding:8px 12px;background-color:#2a2a2a;border:1px solid #404040;border-radius:8px;color:#e0e0e0;font-size:14px;text-align:center;outline:none;transition:border-color .2s ease}.number-input[data-v-d8917884]:focus{border-color:#007acc}.number-input[data-v-d8917884]::placeholder{color:#888}.number-input[data-v-d8917884]::-webkit-outer-spin-button,.number-input[data-v-d8917884]::-webkit-inner-spin-button{-webkit-appearance:none;appearance:none;margin:0}.number-input[type=number][data-v-d8917884]{-webkit-appearance:textfield;appearance:textfield}.setting-section-header[data-v-d8917884]{padding:16px 16px 8px 16px;display:flex;align-items:center;gap:12px}.setting-section-header h3[data-v-d8917884]{margin:0;font-size:18px;font-weight:600;color:#e0e0e0}.setting-section-header .section-description[data-v-d8917884]{font-size:14px;color:#888;line-height:1.4}.folding-rules-fullwidth[data-v-d8917884]{margin-top:8px;padding:0 16px}.folding-rules-container[data-v-d8917884]{width:100%;border:1px solid #404040;border-radius:8px;overflow:hidden}.rules-header[data-v-d8917884]{display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr auto;gap:12px;padding:12px 16px;background-color:#2a2a2a;border-bottom:1px solid #404040;font-size:12px;font-weight:500;color:#b0b0b0;text-transform:uppercase;letter-spacing:.5px}.header-cell[data-v-d8917884]{text-align:center;padding:4px 0}.folding-rule-row[data-v-d8917884]{display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr auto;gap:12px;padding:12px 16px;background-color:#1a1a1a;border-bottom:1px solid #2a2a2a;align-items:center}.folding-rule-row[data-v-d8917884]:last-child{border-bottom:none}.folding-rule-row[data-v-d8917884]:hover{background-color:#202020}.rule-cell[data-v-d8917884]{display:flex;align-items:center;justify-content:center;min-height:32px}.field-label[data-v-d8917884]{font-size:12px;font-weight:500;color:#b0b0b0;text-transform:uppercase;letter-spacing:.5px}.text-input[data-v-d8917884]{padding:6px 8px;background-color:#2a2a2a;border:1px solid #404040;border-radius:4px;color:#e0e0e0;font-size:13px;outline:none;transition:border-color .2s ease;width:100%;min-width:80px}.text-input[data-v-d8917884]:focus{border-color:#007acc}.text-input[data-v-d8917884]::placeholder{color:#666}.text-input.compact[data-v-d8917884]{padding:4px 6px;font-size:12px;min-width:60px}.select-input[data-v-d8917884]{padding:6px 8px;background-color:#2a2a2a;border:1px solid #404040;border-radius:4px;color:#e0e0e0;font-size:13px;outline:none;cursor:pointer;transition:border-color .2s ease;width:100%;min-width:80px}.select-input[data-v-d8917884]:focus{border-color:#007acc}.select-input.compact[data-v-d8917884]{padding:4px 6px;font-size:12px;min-width:60px}.radio-group[data-v-d8917884]{display:flex;flex-direction:column;gap:4px;width:100%}.radio-group.compact[data-v-d8917884]{gap:2px}.radio-option[data-v-d8917884]{display:flex;align-items:center;gap:4px;cursor:pointer;padding:2px 4px;border-radius:3px;transition:background-color .2s ease;justify-content:center}.radio-option[data-v-d8917884]:hover{background-color:hsla(0,0%,100%,.05)}.radio-option.compact[data-v-d8917884]{padding:1px 2px;gap:2px}.radio-option input[type=radio][data-v-d8917884]{margin:0;width:14px;height:14px;accent-color:#007acc;cursor:pointer}.radio-option .radio-label[data-v-d8917884]{font-size:11px;color:#b0b0b0;-webkit-user-select:none;user-select:none;white-space:nowrap}.delete-rule-btn[data-v-d8917884]{padding:6px 10px;background-color:#dc3545;border:none;border-radius:4px;color:#fff;font-size:11px;font-weight:500;cursor:pointer;transition:background-color .2s ease;white-space:nowrap;min-width:50px}.delete-rule-btn[data-v-d8917884]:hover{background-color:#c82333}.delete-rule-btn.compact[data-v-d8917884]{padding:4px 8px;font-size:10px;min-width:40px}.add-rule-row[data-v-d8917884]{display:flex;justify-content:center;padding:12px 0}.add-rule-btn[data-v-d8917884]{padding:10px 20px;background-color:#007acc;border:none;border-radius:8px;color:#fff;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s ease}.add-rule-btn[data-v-d8917884]:hover{background-color:#0056b3}@media (max-width:768px){.settings-header[data-v-d8917884]{padding:16px 12px 12px 12px}.settings-header h2[data-v-d8917884]{font-size:20px}.setting-item[data-v-d8917884]{padding:12px}.setting-title[data-v-d8917884]{font-size:15px}.setting-description[data-v-d8917884]{font-size:13px}.number-input[data-v-d8917884]{width:70px;padding:6px 10px;font-size:13px}.rules-header[data-v-d8917884]{font-size:10px;padding:8px 12px}.folding-rule-row[data-v-d8917884]{padding:8px 12px;gap:6px}.rule-cell[data-v-d8917884]{min-height:28px}.text-input.compact[data-v-d8917884],.select-input.compact[data-v-d8917884]{font-size:11px;padding:3px 4px;min-width:45px}.radio-option.compact .radio-label[data-v-d8917884]{font-size:10px}.delete-rule-btn.compact[data-v-d8917884]{padding:3px 6px;font-size:9px;min-width:35px}}.version-number[data-v-d8917884]{font-size:16px;font-weight:600;color:#007acc;padding:6px 12px;min-width:80px;text-align:center;-webkit-user-select:text;user-select:text}','']);const i=l},8949:(e,t,a)=>{var n=a(5353);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('493e88bf',n,!1,{ssrId:!0})},8988:(e,t,a)=>{var n=a(6680);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('51d77048',n,!1,{ssrId:!0})},9106:(e,t,a)=>{var n=a(6742);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('22344c88',n,!1,{ssrId:!0})},9121:(e,t,a)=>{var n=a(7557);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,a(4424).A)('5946a430',n,!1,{ssrId:!0})},9210:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(8093),r=a.n(n),o=a(3054),l=a.n(o)()(r());l.push([e.id,'.item-tab-container[data-v-b32ed7ea]{width:100%;height:100%;display:flex;flex-direction:column;background-color:#1a1a1a;color:#e0e0e0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}.item-content[data-v-b32ed7ea]{flex:1;padding:16px;overflow-y:auto;display:flex;flex-direction:column;min-height:var(--f33397ea);max-height:var(--f33397ea)}.item-content[data-v-b32ed7ea]::-webkit-scrollbar{width:8px}.item-content[data-v-b32ed7ea]::-webkit-scrollbar-track{background:#2a2a2a;border-radius:4px}.item-content[data-v-b32ed7ea]::-webkit-scrollbar-thumb{background:#555;border-radius:4px}.item-content[data-v-b32ed7ea]::-webkit-scrollbar-thumb:hover{background:#666}.item-section[data-v-b32ed7ea]:last-child{margin-bottom:0}.section-title[data-v-b32ed7ea]{font-size:18px;font-weight:600;color:#007acc;margin:0 0 12px 0;padding-bottom:8px;border-bottom:2px solid #007acc}.add-item-button[data-v-b32ed7ea]{padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s;background:#007acc;color:#fff;margin-top:12px}.add-item-button[data-v-b32ed7ea]:hover{background:#005a99}.item-list[data-v-b32ed7ea]{display:flex;flex-direction:column;gap:8px}.item-row[data-v-b32ed7ea]{background:#252525;padding:12px 16px;border-radius:8px;border:1px solid #404040;display:flex;flex-direction:column;gap:8px;font-size:14px;transition:background-color .2s}.item-row[data-v-b32ed7ea]:hover{background:#2a2a2a;border-color:#555}.new-item-row[data-v-b32ed7ea]{background:#2a2a2a;border-color:#007acc;border-style:dashed}.item-info[data-v-b32ed7ea]{display:flex;flex-direction:column;gap:6px;flex:1}.item-id-name-row[data-v-b32ed7ea]{display:flex;gap:12px;align-items:center}.item-id[data-v-b32ed7ea]{font-weight:500;color:#007acc;font-size:14px}.item-name[data-v-b32ed7ea]{font-weight:500;color:#fff;font-size:16px}.item-description[data-v-b32ed7ea]{color:#a0a0a0;line-height:1.4;font-size:13px}.item-value-actions-row[data-v-b32ed7ea]{display:flex;justify-content:space-between;align-items:center}.item-value[data-v-b32ed7ea]{font-weight:600;color:#4caf50;font-size:14px}.item-actions[data-v-b32ed7ea]{display:flex;gap:8px}.edit-item-button[data-v-b32ed7ea],.delete-item-button[data-v-b32ed7ea]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.edit-item-button[data-v-b32ed7ea]{background:#007acc;color:#fff}.edit-item-button[data-v-b32ed7ea]:hover{background:#005a99}.delete-item-button[data-v-b32ed7ea]{background:#f44336;color:#fff}.delete-item-button[data-v-b32ed7ea]:hover{background:#da190b}.item-id-input[data-v-b32ed7ea],.item-name-input[data-v-b32ed7ea],.item-value-input[data-v-b32ed7ea]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:14px;padding:4px 8px}.item-id-input[data-v-b32ed7ea]:focus,.item-name-input[data-v-b32ed7ea]:focus,.item-value-input[data-v-b32ed7ea]:focus{outline:none;border-color:#007acc}.item-id-input[data-v-b32ed7ea]{font-weight:500;color:#007acc;font-size:14px;width:50px;flex-shrink:0;text-align:center}.item-name-input[data-v-b32ed7ea]{font-weight:500;color:#fff;font-size:16px;flex:1}.item-value-input[data-v-b32ed7ea]{font-weight:600;color:#4caf50;font-size:14px;width:50px;text-align:left;outline:none}.item-value-input-wrapper[data-v-b32ed7ea]{display:flex;align-items:center;font-weight:600;color:#4caf50;font-size:14px}.dollar-sign[data-v-b32ed7ea]{margin-right:2px}.item-description-input[data-v-b32ed7ea]{background:#333;border:1px solid #555;border-radius:4px;color:#e0e0e0;font-size:13px;padding:6px 8px;resize:vertical;min-height:60px;line-height:1.4}.item-description-input[data-v-b32ed7ea]:focus{outline:none;border-color:#007acc}.confirm-button[data-v-b32ed7ea],.cancel-button[data-v-b32ed7ea]{padding:6px 12px;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:background-color .2s}.confirm-button[data-v-b32ed7ea]{background:#4caf50;color:#fff}.confirm-button[data-v-b32ed7ea]:hover{background:#45a049}.cancel-button[data-v-b32ed7ea]{background:#f44336;color:#fff}.cancel-button[data-v-b32ed7ea]:hover{background:#da190b}.no-items-message[data-v-b32ed7ea]{background:#252525;padding:16px 12px;border-radius:6px;border:1px solid #404040;color:#888;text-align:center;font-size:14px;font-style:italic}@media (max-width:768px){.item-content[data-v-b32ed7ea]{padding:12px}.section-title[data-v-b32ed7ea]{font-size:18px}.item-row[data-v-b32ed7ea]{padding:10px 12px;gap:6px}.item-info[data-v-b32ed7ea]{gap:4px}.item-name[data-v-b32ed7ea]{font-size:15px}.item-description[data-v-b32ed7ea]{font-size:12px}.item-actions[data-v-b32ed7ea]{gap:6px}.edit-item-button[data-v-b32ed7ea],.delete-item-button[data-v-b32ed7ea]{padding:5px 10px;font-size:11px}.item-id-input[data-v-b32ed7ea],.item-name-input[data-v-b32ed7ea],.item-value-input[data-v-b32ed7ea]{font-size:13px;padding:3px 6px}.item-description-input[data-v-b32ed7ea]{font-size:12px;padding:4px 6px;min-height:50px}.confirm-button[data-v-b32ed7ea],.cancel-button[data-v-b32ed7ea]{padding:5px 10px;font-size:11px}}','']);const i=l}},a={};function n(e){var r=a[e];if(void 0!==r)return r.exports;var o=a[e]={id:e,exports:{}};return t[e](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},(()=>{const e=_;var t=n.n(e),a=n(3146);var r,o,l,i,s,c,d,u=function(e,t,a,n){var r,o=arguments.length,l=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,a,l):r(t,a))||l);return o>3&&l&&Object.defineProperty(t,a,l),l},p=function(e,t){if('object'==typeof Reflect&&'function'==typeof Reflect.metadata)return Reflect.metadata(e,t)};class m{static registry=new a._;constructor(...e){}static fromObject(e){return this.prototype.fromObject(e)}}let g=r=class extends m{low;high;num;constructor(e,t,a){super(),this.low=e,this.high=t,this.num=a}fromObject(e){const t=e.low,a=e.high,n=e.num;return new r(t,a,n)}get TYPE(){return'num'}getValue(){return{low:this.low,high:this.high,num:this.num}}getLow(){return this.low}getHigh(){return this.high}getNum(){return this.num}deltaLow(e){null===e?this.low=null:null===this.low?this.low=e:this.low+=e,this.applyConstrain()}deltaHigh(e){null===e?this.high=null:null===this.high?this.high=e:this.high+=e,this.applyConstrain()}deltaNum(e){this.num+=e,this.applyConstrain()}applyConstrain(){null!==this.low&&this.num<this.low&&(this.num=this.low),null!==this.high&&this.num>this.high&&(this.num=this.high)}};g=r=u([m.registry.register(g.prototype.TYPE),p('design:paramtypes',[Object,Object,Number])],g);let v=o=class extends m{str;constructor(e){super(),this.str=e}fromObject(e){const t=e.str;return new o(t)}get TYPE(){return'str'}getValue(){return{str:this.str}}getStr(){return this.str}setStr(e){this.str=e}};v=o=u([m.registry.register(v.prototype.TYPE),p('design:paramtypes',[String])],v);let b=l=class extends m{datetime;constructor(e){super(),this.datetime=new Date(e)}fromObject(e){const t=e.datetime;return new l(t)}get TYPE(){return'datetime'}getValue(){return{datetime:this.datetime}}getYear(){return this.datetime.getFullYear()}getMonth(){return this.datetime.getMonth()}getDate(){return this.datetime.getDate()}getHours(){return this.datetime.getHours()}getMinutes(){return this.datetime.getMinutes()}getSeconds(){return this.datetime.getSeconds()}getDay(){return this.datetime.getDay()}getDateTime(){return this.datetime}deltaDatetime(e,t,a,n,r,o){this.datetime.setFullYear(this.datetime.getFullYear()+e),this.datetime.setMonth(this.datetime.getMonth()+t),this.datetime.setDate(this.datetime.getDate()+a),this.datetime.setHours(this.datetime.getHours()+n),this.datetime.setMinutes(this.datetime.getMinutes()+r),this.datetime.setSeconds(this.datetime.getSeconds()+o)}};b=l=u([m.registry.register(b.prototype.TYPE),p('design:paramtypes',['function'==typeof(c='undefined'!=typeof Date&&Date)?c:Object])],b);let f=i=class extends m{outcome;random_events;constructor(e,t){super(),this.outcome=e,this.random_events=t}fromObject(e){const t=e?.outcome,a=e.random_events;return new i(t,a)}get TYPE(){return'random'}getValue(){return{outcome:this.outcome,random_events:this.random_events}}roll(){this.outcome=function(e){let t=0;for(const a of e)t+=a.weighting;let a=Math.random()*t;for(const t of e)if(a-=t.weighting,a<=0)return t.event;return e[-1].event}(this.random_events)}};f=i=u([m.registry.register(f.prototype.TYPE),p('design:paramtypes',[Object,Array])],f);let h=s=class extends m{map;constructor(e){if(super(),this.map=new Map,e)for(const[t,a]of Object.entries(e)){const e=m.registry.get(a.type)?.fromObject(a.values);e&&this.map.set(t,e)}}get TYPE(){return'map'}fromObject(e){return new s(e)}getValue(){const e={};for(const[t,a]of this.map.entries())e[t]={type:a.TYPE,values:a.getValue()};return e}getVariable(e){return this.map.get(e)}setVariable(e,t){this.map.set(e,t)}deleteVariable(e){this.map.delete(e)}get size(){return this.map.size}keys(){return this.map.keys()}};h=s=u([m.registry.register(h.prototype.TYPE),p('design:paramtypes',['function'==typeof(d='undefined'!=typeof Record&&Record)?d:Object])],h);var x,E,y,k,N,V,w,S,C,T,B,I,D,R,M,Y,A=function(e,t,a,n){var r,o=arguments.length,l=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,a,l):r(t,a))||l);return o>3&&l&&Object.defineProperty(t,a,l),l},O=function(e,t){if('object'==typeof Reflect&&'function'==typeof Reflect.metadata)return Reflect.metadata(e,t)};class K{static registry=new a._;constructor(...e){}static parseString(e){if(void 0===e)return[];return[...e.matchAll(this.prototype.REGEX)].map(e=>({command:this.prototype.create(e.slice(1).map(e=>e.trim())),index:e.index})).filter(({command:e})=>e.isValid())}}class L extends K{}let U=x=class extends K{key;low;high;num;constructor(e,t,a,n){super(),this.key=e,this.low=t,this.high=a,this.num=n}get REGEX(){return/init_num\s*\(\s*([^(),:]+?)\s*,\s*([^(),:]+?)\s*,\s*([^(),:]+?)\s*,\s*([^)]+?)\s*\)/g}create(e){const t=e[0],a='null'===e[1]?null:Number(e[1]),n='null'===e[2]?null:Number(e[2]),r=Number(e[3]);return new x(t,a,n,r)}isValid(){return(null===this.low||!isNaN(this.low))&&((null===this.high||!isNaN(this.high))&&(!isNaN(this.num)&&!(null!==this.low&&null!==this.high&&this.low>this.high)))}execute(e){const t=new g(this.low,this.high,this.num);return e.setVariable(this.key,t),e}};U=x=A([K.registry.register(),O('design:paramtypes',[String,Object,Object,Number])],U);let F=E=class extends K{key;delta;constructor(e,t){super(),this.key=e,this.delta=t}get REGEX(){return/delta_num\s*\(\s*([^(),:]+?)\s*,\s*([^)]+?)\s*\)/g}create(e){const t=e[0],a=Number(e[1]);return new E(t,a)}isValid(){return!isNaN(this.delta)}execute(e){const t=e.getVariable(this.key);return null===t||t instanceof g==!1||(t.deltaNum(this.delta),e.setVariable(this.key,t)),e}};F=E=A([K.registry.register(),O('design:paramtypes',[String,Number])],F);let P=y=class extends K{key;delta;constructor(e,t){super(),this.key=e,this.delta=t}get REGEX(){return/delta_low\s*\(\s*([^(),:]+?)\s*,\s*([^)]+?)\s*\)/g}create(e){const t=e[0],a='null'===e[1]?null:Number(e[1]);return new y(t,a)}isValid(){return null===this.delta||!isNaN(this.delta)}execute(e){const t=e.getVariable(this.key);return null===t||t instanceof g==!1||(t.deltaLow(this.delta),e.setVariable(this.key,t)),e}};P=y=A([K.registry.register(),O('design:paramtypes',[String,Object])],P);let j=k=class extends K{key;delta;constructor(e,t){super(),this.key=e,this.delta=t}get REGEX(){return/delta_high\s*\(\s*([^(),:]+?)\s*,\s*([^)]+?)\s*\)/g}create(e){const t=e[0],a='null'===e[1]?null:Number(e[1]);return new k(t,a)}isValid(){return null===this.delta||!isNaN(this.delta)}execute(e){const t=e.getVariable(this.key);return null===t||t instanceof g==!1||(t.deltaHigh(this.delta),e.setVariable(this.key,t)),e}};j=k=A([K.registry.register(),O('design:paramtypes',[String,Object])],j);let H=N=class extends K{key;str;constructor(e,t){super(),this.key=e,this.str=t}get REGEX(){return/init_str\s*\(\s*([^(),:]+?)\s*,\s*([^)]+?)\s*\)/g}create(e){const t=e[0],a=e[1];return new N(t,a)}isValid(){return!0}execute(e){const t=new v(this.str);return e.setVariable(this.key,t),e}};H=N=A([K.registry.register(),O('design:paramtypes',[String,String])],H);let G=V=class extends K{key;str;constructor(e,t){super(),this.key=e,this.str=t}get REGEX(){return/set_str\s*\(\s*([^(),:]+?)\s*,\s*([^)]+?)\s*\)/g}create(e){const t=e[0],a=e[1];return new V(t,a)}isValid(){return!0}execute(e){const t=e.getVariable(this.key);return null===t||t instanceof v==!1||(t.setStr(this.str),e.setVariable(this.key,t)),e}};G=V=A([K.registry.register(),O('design:paramtypes',[String,String])],G);let q=w=class extends K{key;datetime_string;constructor(e,t){super(),this.key=e,this.datetime_string=t}get REGEX(){return/init_datetime\(([^,:]+),\s*([^)]+)\)/g}create(e){const t=e[0],a=e[1];return new w(t,a)}isValid(){const e=new Date(this.datetime_string);return!isNaN(e.getTime())}execute(e){const t=new Date(this.datetime_string),a=new b(t);return e.setVariable(this.key,a),e}};q=w=A([K.registry.register(),O('design:paramtypes',[String,String])],q);let X=S=class extends K{key;delta_year;delta_month;delta_date;delta_hour;delta_minute;delta_second;constructor(e,t,a,n,r,o,l){super(),this.key=e,this.delta_year=t,this.delta_month=a,this.delta_date=n,this.delta_hour=r,this.delta_minute=o,this.delta_second=l}get REGEX(){return/delta_datetime\(([^,]+),\s*([^)]+),\s*([^)]+),\s*([^)]+),\s*([^)]+),\s*([^)]+),\s*([^)]+)\)/g}create(e){const t=e[0],a=Number(e[1]),n=Number(e[2]),r=Number(e[3]),o=Number(e[4]),l=Number(e[5]),i=Number(e[6]);return new S(t,a,n,r,o,l,i)}isValid(){return!isNaN(this.delta_year)&&(!isNaN(this.delta_month)&&(!isNaN(this.delta_date)&&(!isNaN(this.delta_hour)&&(!isNaN(this.delta_minute)&&!isNaN(this.delta_second)))))}execute(e){const t=e.getVariable(this.key);return null===t||t instanceof b==!1||(t.deltaDatetime(this.delta_year,this.delta_month,this.delta_date,this.delta_hour,this.delta_minute,this.delta_second),e.setVariable(this.key,t)),e}};X=S=A([K.registry.register(),O('design:paramtypes',[String,Number,Number,Number,Number,Number,Number])],X);let W=C=class extends K{command_name;key;delta;constructor(e,t,a){super(),this.command_name=e,this.key=t,this.delta=a}get REGEX(){return/(delta_year|delta_month|delta_date|delta_hour|delta_minute|delta_second)\(([^,]+),\s*([^)]+)\)/g}create(e){const t=e[0],a=e[1],n=Number(e[2]);return new C(t,a,n)}isValid(){return!isNaN(this.delta)}execute(e){const t=e.getVariable(this.key);if(null===t||t instanceof b==!1)return e;const a='delta_year'===this.command_name?this.delta:0,n='delta_month'===this.command_name?this.delta:0,r='delta_date'===this.command_name?this.delta:0,o='delta_hour'===this.command_name?this.delta:0,l='delta_minute'===this.command_name?this.delta:0,i='delta_second'===this.command_name?this.delta:0;return t.deltaDatetime(a,n,r,o,l,i),e.setVariable(this.key,t),e}};W=C=A([K.registry.register(),O('design:paramtypes',[String,String,Number])],W);let J=T=class extends K{key;random_events;constructor(e,t){super(),this.key=e,this.random_events=t}get REGEX(){return/init_random\(\s*([^,]+)\s*,\s*(.+)\s*\)/g}create(e){const t=e[0],a=e[1],n=[];for(const e of a.split(',')){const[t,a]=e.split(':');n.push({event:t,weighting:Number(a)})}return new T(t,n)}isValid(){for(const e of this.random_events)if(Number.isNaN(e.weighting))return!1;return!0}execute(e){const t=new f(null,this.random_events);return e.setVariable(this.key,t),e}};J=T=A([K.registry.register(),O('design:paramtypes',[String,Array])],J);let Z=B=class extends L{key;constructor(e){super(),this.key=e}get REGEX(){return/roll\(\s*([^,()]+)\s*\)/g}create(e){const t=e[0];return new B(t)}isValid(){return!0}execute(e){const t=e.getVariable(this.key);return null===t||t instanceof f==!1||(t.roll(),e.setVariable(this.key,t)),e}getRestoreKeys(e){return[this.key]}};Z=B=A([K.registry.register(),O('design:paramtypes',[String])],Z);let Q=I=class extends K{key;constructor(e){super(),this.key=e}get REGEX(){return/delete\(([^,()]+)\s*\)/g}create(e){const t=e[0];return new I(t)}isValid(){return!0}execute(e){return e.deleteVariable(this.key),e}};Q=I=A([K.registry.register(),O('design:paramtypes',[String])],Q);let ee=D=class extends K{key;constructor(e){super(),this.key=e}get REGEX(){return/init_map\(\s*([^,]+)\s*\)/g}create(e){const t=e[0];return new D(t)}isValid(){return!0}execute(e){const t=new h;return e.setVariable(this.key,t),e}};ee=D=A([K.registry.register(),O('design:paramtypes',[String])],ee);let te=R=class extends K{map_key;variable_key;constructor(e,t){super(),this.map_key=e,this.variable_key=t}get REGEX(){return/add_map\(\s*([^,]+)\s*,\s*(.+)\s*\)/g}create(e){const t=e[0],a=e[1];return new R(t,a)}isValid(){return!0}execute(e){const t=e.getVariable(this.map_key);if(null===t||t instanceof h==!1)return e;const a=e.getVariable(this.variable_key);return null===a||(t.setVariable(this.variable_key,a),e.deleteVariable(this.variable_key),e.setVariable(this.map_key,t)),e}};te=R=A([K.registry.register(),O('design:paramtypes',[String,String])],te);let ae=M=class extends K{map_key;variable_key;constructor(e,t){super(),this.map_key=e,this.variable_key=t}get REGEX(){return/pop_map\(\s*([^,]+)\s*,\s*(.+)\s*\)/g}create(e){const t=e[0],a=e[1];return new M(t,a)}isValid(){return!0}execute(e){const t=e.getVariable(this.map_key);if(null===t||t instanceof h==!1)return e;const a=t.getVariable(this.variable_key);return void 0===a||(t.deleteVariable(this.variable_key),e.setVariable(this.variable_key,a),e.setVariable(this.map_key,t)),e}};ae=M=A([K.registry.register(),O('design:paramtypes',[String,String])],ae);let ne=Y=class extends K{map_key;variable_key;constructor(e,t){super(),this.map_key=e,this.variable_key=t}get REGEX(){return/delete_map\(\s*([^,]+)\s*,\s*(.+)\s*\)/g}create(e){const t=e[0],a=e[1];return new Y(t,a)}isValid(){return!0}execute(e){const t=e.getVariable(this.map_key);return null===t||t instanceof h==!1||(t.deleteVariable(this.variable_key),e.setVariable(this.map_key,t)),e}};ne=Y=A([K.registry.register(),O('design:paramtypes',[String,String])],ne);class re{commands=[];constructor(e){this.commands=e??[]}pushCommand(e){this.commands.push(e)}static fromString(e,t='normal'){let a=e.split('<UserPerspective>');if(!e.includes('<VTC>'))return new re;a=a[a.length-1].split('<VTC>');const n=a[a.length-1].split('</VTC>')[0];let r=[];for(const e of K.registry.getAll().values())'normal'===t&&e.prototype instanceof L||('post'!==t||e.prototype instanceof L)&&(r=r.concat(e.parseString(n)));r.sort((e,t)=>e.index-t.index);const o=r.map(e=>e.command);return console.log('[VariableTracker] commands:',o),new re(o)}execute(e){for(const t of this.commands)t.execute(e);return e}*[Symbol.iterator](){for(const e of this.commands)yield e}}class oe{state;constructor(e){this.state=e?e.state:new Map}static fromVariables(e){const t=new oe;if(null===e)return t;for(const[a,n]of Object.entries(e)){const e=m.registry.get(n.type)?.fromObject(n.values);e&&t.setVariable(a,e)}return t}toVariables(){const e={};for(const[t,a]of this.state)e[t]={type:a.TYPE,values:a.getValue()};return e}getVariable(e){return this.state.get(e)??null}setVariable(e,t){this.state.set(e,t)}deleteVariable(e){this.state.delete(e)}}const le={type:'chat'};function ie(e){return e<0&&(e=getLastMessageId()+e+1),e}function se(){const e=getVariables(le).current??null;return oe.fromVariables(e)}function ce(e){const t=getVariables(le);t.current=e.toVariables(),replaceVariables(t,le)}function de(){const e=getVariables(le);e.current={},replaceVariables(e,le)}function ue(e){if(0===e)de();else{const t=e-1;ce(pe(t,ve(t)))}}function pe(e,t){e=ie(e);const a=getVariables(le);return oe.fromVariables(a.history[e][t])}function me(e,t=-1,a){t=ie(t);const n=getVariables(le);n.history=n.history??[],n.history[t]=n.history[t]??[],n.history[t][a]=e.toVariables(),replaceVariables(n,le)}function ge(e){const t=getVariables(le);t.history&&(t.history.splice(e),replaceVariables(t,le))}function ve(e){return getChatMessages(e,{include_swipes:!0})[0].swipe_id}function be(e){return getChatMessages(e,{include_swipes:!0})[0].swipes.length}function fe(e,t){let a;console.log('[VariableTracker] executeCommand strat'),a=void 0===t?getChatMessages(e)[0].message:getChatMessages(e,{include_swipes:!0})[0].swipes[t];const n=re.fromString(a);console.log('[VariableTracker] commands:',n);const r=se();n.execute(r),console.log('[VariableTracker] state:',r),ce(r),console.log('[VariableTracker] executeCommand end')}function he(e,t){let a;console.log('[VariableTracker] executePostCommand strat'),a=void 0===t?getChatMessages(e)[0].message:getChatMessages(e,{include_swipes:!0})[0].swipes[t];const n=re.fromString(a,'post');console.log('[VariableTracker] post commands:',n);const r=se();n.execute(r),console.log('[VariableTracker] state:',r),ce(r),console.log('[VariableTracker] executePostCommand end')}function xe(e,t){t||(t=ve(e));const a=getChatMessages(e,{include_swipes:!0})[0].swipes[t],n=re.fromString(a,'post'),r=pe(e,t),o=e+1,l=pe(o,ve(o));for(const e of n){const t=e;for(const e of t.getRestoreKeys(r)){const t=l.getVariable(e);t&&r.setVariable(e,t)}}me(r,e,t)}function _e(e){ue(e);for(let t=e;t<=getLastMessageId();t++){console.log('[DEBUG] message_id:',t);for(let e=0;e<be(t);e++)fe(t,e),me(se(),t,e),ue(t);ce(pe(t,ve(t)))}}eventOn(tavern_events.MESSAGE_SENT,async e=>{console.log('[VariableTracker] MESSAGE_SENT strat'),fe(e),he(e);const t=ve(e);me(se(),e,t),console.log('[VariableTracker] MESSAGE_SENT end')}),eventOn(tavern_events.MESSAGE_UPDATED,async e=>{await new Promise(e=>setTimeout(e,100)),console.log('[VariableTracker] MESSAGE_UPDATED strat');const t=be(e=Number(e)),a=function(e){return e=ie(e),getVariables(le).history[e].length}(e);if(t<a){!function(e,t){const a=getVariables(le);a.history&&(a.history[e].splice(t,1),replaceVariables(a,le))}(e,ve(e))}ue(e),_e(e),0!==e&&xe(e-1),console.log('[VariableTracker] MESSAGE_UPDATED end')}),eventOn(tavern_events.MESSAGE_RECEIVED,async e=>{console.log('[VariableTracker] MESSAGE_RECEIVED strat'),fe(e),he(e);const t=ve(e);me(se(),e,t),console.log('[VariableTracker] MESSAGE_RECEIVED end')}),eventOn(tavern_events.MESSAGE_SWIPED,async e=>{console.log('[VariableTracker] MESSAGE_SWIPED strat');const t=ve(e),a=0===e?null:e-1;if(function(e,t){return t<getChatMessages(e,{include_swipes:!0})[0].swipes.length}(e,t))ce(pe(e,t)),null!==a&&xe(a);else if(null!==a){ue(a),0!==a&&(fe(a-1),he(a-1));const e=ve(a);he(a),me(se(),a,e)}else de();console.log('[VariableTracker] MESSAGE_SWIPED end')}),eventOn(tavern_events.MESSAGE_DELETED,async e=>{console.log('[VariableTracker] MESSAGE_DELETED strat');const a=getChatMessages('0-{{lastMessageId}}',{include_swipes:!0});let n,r;n=getCharData('current')?.first_mes?'assistant':'user';for(const e of a){if(e.role!==n){r=e.message_id;break}n='assistant'===n?'user':'assistant'}r||(r=a.length),ue(r),ge(r),deleteChatMessages(t().range(r,getLastMessageId()+1)),console.log('[VariableTracker] MESSAGE_DELETED end')}),eventOn(getButtonEvent(''),function(){toastr.info('...','VariableTracker Debug');const e=getVariables(le);e.current={},e.history=[],replaceVariables(e,le),toastr.success('','VariableTracker Debug')}),eventOn(getButtonEvent(''),async function(){toastr.info('...','VariableTracker Debug');try{ge(0),_e(0)}catch(e){return console.error('[VariableTracker] :',e),void toastr.error('','VariableTracker Debug')}toastr.success('','VariableTracker Debug')});class Ee{registry=new Map;register(e,t){this.registry.set(e,t)}get(e){return this.registry.get(e)}getAll(){return this.registry}has(e){return this.registry.has(e)}}class ye{static registry=new Ee;name;description;constructor(e,t){this.name=e,this.description=t}static register(e){ye.registry.register(e.name,e)}static get(e){return ye.registry.get(e)}}class ke extends oe{constructor(e){super(e)}static get STAMINA_KEY(){return''}static get MONEY_KEY(){return''}static get TRUST_KEY(){return''}static get INTEREST_KEY(){return''}static get MOOD_KEY(){return''}static get CURRENT_ACTION_KEY(){return''}static get EXPECT_RESULT_KEY(){return''}static get DATETIME_KEY(){return''}static get BIG_PLACE_KEY(){return''}static get MIDDLE_PLACE_KEY(){return''}static get SMALL_PLACE_KEY(){return''}static get WEATHER_KEY(){return''}static get FLAGS_KEY(){return'flags'}static get FLAG_BATH_KEY(){return''}static get SHOP_ITEMS_KEY(){return'shop_items'}static get INVENTORIES_KEY(){return'inventories'}static get TRUST_ROC_KEY(){return''}static get INTEREST_ROC_KEY(){return''}static get MOOD_ROC_KEY(){return''}static get ITEM_TABLE_KEY(){return'item_table'}static get CLOTHING_KEY(){return''}static get SUMMARY_TABLE_KEY(){return'summary_table'}static get SUMMARY_KEY(){return''}static get WEIGHTING_KEY(){return''}getNumVariable(e){const t=this.state.get(e);return t instanceof g?t:null}getStrVariable(e){const t=this.state.get(e);return t instanceof v?t:null}getMapVariable(e){const t=this.state.get(e);return t instanceof h?t:null}getStaminaVariable(){return this.getNumVariable(ke.STAMINA_KEY)}getStamina(){return this.getStaminaVariable().getNum()}deltaStamina(e){this.getStaminaVariable().deltaNum(e)}getStaminaHigh(){return this.getStaminaVariable().getHigh()}deltaStaminaHigh(e){this.getStaminaVariable().deltaHigh(e)}getMoneyVariable(){return this.getNumVariable(ke.MONEY_KEY)}getMoney(){return this.getMoneyVariable().getNum()}deltaMoney(e){this.getMoneyVariable().deltaNum(e)}getTrustVariable(){return this.getNumVariable(ke.TRUST_KEY)}getTrust(){return this.getTrustVariable().getNum()}deltaTrust(e){this.getTrustVariable().deltaNum(e)}getInterestVariable(){return this.getNumVariable(ke.INTEREST_KEY)}getInterest(){return this.getInterestVariable().getNum()}deltaInterest(e){this.getInterestVariable().deltaNum(e)}getMoodVariable(){return this.getNumVariable(ke.MOOD_KEY)}getMood(){return this.getMoodVariable().getNum()}deltaMood(e){this.getMoodVariable().deltaNum(e)}getCurrentAction(){return this.getStrVariable(ke.CURRENT_ACTION_KEY).getStr()}setCurrentAction(e){this.getStrVariable(ke.CURRENT_ACTION_KEY).setStr(e)}getExpectResult(){return this.getStrVariable(ke.EXPECT_RESULT_KEY).getStr()}setExpectResult(e){this.getStrVariable(ke.EXPECT_RESULT_KEY).setStr(e)}getDatetimeVariable(){const e=this.state.get(ke.DATETIME_KEY);return e instanceof b?e:null}getYear(){return this.getDatetimeVariable().getYear()}getMonth(){return this.getDatetimeVariable().getMonth()}getDate(){return this.getDatetimeVariable().getDate()}getHours(){return this.getDatetimeVariable().getHours()}getMinutes(){return this.getDatetimeVariable().getMinutes()}getSeconds(){return this.getDatetimeVariable().getSeconds()}getDay(){return this.getDatetimeVariable().getDay()}isWeekday(){switch(this.getDay()){case 1:case 2:case 3:case 4:case 5:return!0}return!1}isWeekend(){switch(this.getDay()){case 0:case 6:return!0}return!1}deltaMinutes(e){this.getDatetimeVariable().deltaDatetime(0,0,0,0,e,0)}deltaDatetimeUntil(e,t){const a=this.getDatetimeVariable(),n=60*a.getHours()+a.getMinutes();let r=60*e+t;n>r&&(r+=1440);const o=r-n;a.deltaDatetime(0,0,0,0,o,0)}getBigPlace(){return this.getStrVariable(ke.BIG_PLACE_KEY).getStr()}setBigPlace(e){this.getStrVariable(ke.BIG_PLACE_KEY).setStr(e)}getMiddlePlace(){return this.getStrVariable(ke.MIDDLE_PLACE_KEY).getStr()}setMiddlePlace(e){this.getStrVariable(ke.MIDDLE_PLACE_KEY).setStr(e)}getSmallPlace(){return this.getStrVariable(ke.SMALL_PLACE_KEY).getStr()}setSmallPlace(e){this.getStrVariable(ke.SMALL_PLACE_KEY).setStr(e)}getWeather(){return this.getStrVariable(ke.WEATHER_KEY).getStr()}setWeather(e){this.getStrVariable(ke.WEATHER_KEY).setStr(e)}getFlagsVariable(){return this.getMapVariable(ke.FLAGS_KEY)}getFlagBathVariable(){return this.getFlagsVariable().getVariable(ke.FLAG_BATH_KEY)}isAlreadyBath(){return 1===this.getFlagBathVariable().getNum()}setFlagBath(e){e?this.getFlagBathVariable().deltaNum(1):this.getFlagBathVariable().deltaNum(-1)}getShopItemsVariable(){return this.getMapVariable(ke.SHOP_ITEMS_KEY)}addShopItem(e,t,a){const n=ye.get(e);if(!n)return;const r=new h;r.setVariable('price',new g(null,null,t)),null!==a&&r.setVariable('max_quantity',new g(0,a,a));this.getShopItemsVariable().setVariable(n.name,r)}getShopItem(e){const t=this.getShopItemsVariable().getVariable(e);if(!t)return null;const a=ye.get(e),n=t.getVariable('price').getNum();let r;const o=t.getVariable('max_quantity');return r=o?o.getNum():null,{item:a,price:n,max_quantity:r}}getShopItems(){const e=this.getShopItemsVariable(),t=[];for(const a of e.keys())t.push(this.getShopItem(a));return t}getShopItemsSize(){return this.getShopItemsVariable().size}clearShopItems(){this.setVariable(ke.SHOP_ITEMS_KEY,new h)}buyShopItem(e,t){const a=this.getShopItemsVariable().getVariable(e);if(!a)return;const n=a.getVariable('price').getNum();this.deltaMoney(-n*t);const r=a.getVariable('max_quantity');r&&r.deltaNum(-t),this.deltaInventory(e,t)}sellShopItem(e,t){if(!this.getInventory(e))return;const a=this.getShopItem(e);let n=a.max_quantity;null!==n&&(n+=t),this.deltaInventory(e,-t),this.deltaMoney(a.price*t),this.addShopItem(e,a.price,n)}getInventoriesVariable(){return this.getMapVariable(ke.INVENTORIES_KEY)}deltaInventory(e,t){const a=this.getInventoriesVariable();let n=a.getVariable(e);n?n.deltaNum(t):n=new g(0,null,t),0===n.getNum()?a.deleteVariable(e):a.setVariable(e,n)}getInventory(e){const t=this.getInventoriesVariable().getVariable(e);if(!t)return null;const a=t.getNum();return{name:e,description:this.getItem(e).description,quantity:a}}hasInventory(e){const t=ye.get(e);return!!t&&void 0!==this.getInventoriesVariable().getVariable(t.name)}getInventories(){const e=this.getInventoriesVariable(),t=[];for(const a of e.keys())t.push(this.getInventory(a));return t}getDinnerInventory(){return this.hasInventory('')?'':this.hasInventory('')?'':this.hasInventory('')?'':''}getTrustROCVariable(){return this.getNumVariable(ke.TRUST_ROC_KEY)}getTrustROC(){return this.getTrustROCVariable().getNum()}deltaTrustROC(e){this.getTrustROCVariable().deltaNum(e)}resetTrustROC(){this.getTrustROCVariable().deltaNum(-this.getTrustROC())}getInterestROCVariable(){return this.getNumVariable(ke.INTEREST_ROC_KEY)}getInterestROC(){return this.getInterestROCVariable().getNum()}deltaInterestROC(e){this.getInterestROCVariable().deltaNum(e)}resetInterestROC(){this.getInterestROCVariable().deltaNum(-this.getInterestROC())}getMoodROCVariable(){return this.getNumVariable(ke.MOOD_ROC_KEY)}getMoodROC(){return this.getMoodROCVariable().getNum()}deltaMoodROC(e){this.getMoodROCVariable().deltaNum(e)}resetMoodROC(){this.getMoodROCVariable().deltaNum(-this.getMoodROC())}getItemTableVariable(){return this.getMapVariable(ke.ITEM_TABLE_KEY)}createItem(e,t){const a=this.getItemTableVariable(),n=new v(t);a.setVariable(e,n)}getItem(e){const t=this.getItemTableVariable().getVariable(e);if(!t)return null;return{description:t.getStr()}}getItemTable(){const e=this.getItemTableVariable(),t=new Map;for(const a of e.keys()){const n=e.getVariable(a).getStr();t.set(a,n)}return t}getClothing(){return this.getStrVariable(ke.CLOTHING_KEY).getStr()}setClothing(e){this.getStrVariable(ke.CLOTHING_KEY).setStr(e)}getSummaryTableVariable(){return this.getMapVariable(ke.SUMMARY_TABLE_KEY)}addSummary(e,t){const a=this.getSummaryTableVariable(),n=a.size,r=this.getDatetimeVariable(),o=this.getBigPlace(),l=this.getMiddlePlace(),i=this.getSmallPlace(),s=new h;s.setVariable(ke.DATETIME_KEY,r),s.setVariable(ke.BIG_PLACE_KEY,new v(o)),s.setVariable(ke.MIDDLE_PLACE_KEY,new v(l)),s.setVariable(ke.SMALL_PLACE_KEY,new v(i)),s.setVariable(ke.SUMMARY_KEY,new v(e)),s.setVariable(ke.WEIGHTING_KEY,new g(0,1,t)),a.setVariable(String(n),s)}getSummary(e){const t=this.getSummaryTableVariable().getVariable(String(e));if(!t)return null;return{datetime:t.getVariable(ke.DATETIME_KEY).getDateTime(),big_place:t.getVariable(ke.BIG_PLACE_KEY).getStr(),middle_place:t.getVariable(ke.MIDDLE_PLACE_KEY).getStr(),small_place:t.getVariable(ke.SMALL_PLACE_KEY).getStr(),summary:t.getVariable(ke.SUMMARY_KEY).getStr(),weighting:t.getVariable(ke.WEIGHTING_KEY).getNum()}}getSummaries(){const e=this.getSummaryTableVariable(),t=[];for(let a=0;a<e.size;a++)t.push(this.getSummary(a));return t}finishCurrentAction(e,t){this.addSummary(e,t),t=Math.trunc(10*t);const a=this.getTrustROC(),n=this.getInterestROC(),r=Math.max(1,Math.abs(a)+Math.abs(n));let o=Math.trunc(a/r*t);o<0&&(o*=2);let l=Math.trunc(n/r*t);l<0&&(l*=2);const i=this.getMoodROC();let s=0;i>0&&i>10-t?s=1:i<0&&2*i<t-10&&(s=-1),console.log('[Action Command] weighting:',t),console.log('[Action Command] trust_roc:',a),console.log('[Action Command] interest_roc:',n),console.log('[Action Command] roc_sum:',r),console.log('[Action Command] delta_trust:',o),console.log('[Action Command] delta_interest:',l),console.log('[Action Command] mood_roc:',i),console.log('[Action Command] delta_mood:',s),this.deltaTrust(o),this.deltaInterest(l),this.deltaMood(s),this.resetTrustROC(),this.resetInterestROC(),this.resetMoodROC()}handleChangeDateEvents(e,t,a,n,r,o){const l=new Date(e,t,a),i=new Date(n,r,o),s=Math.floor((i.getTime()-l.getTime())/864e5);s<=0||this.deltaMoney(2e3*s)}isCurrentDateTimeBetween(e,t,a,n){const r=this.state.get(ke.DATETIME_KEY);if(!(r instanceof b))return!1;const o=60*r.getHours()+r.getMinutes(),l=60*e+t,i=60*a+n;return l<=i?o>=l&&o<=i:o>=l||o<=i}isCurrentDateTimeAtNight(){return this.isCurrentDateTimeBetween(19,0,0,0)}}var Ne,Ve,we,Se,Ce,Te,Be,Ie,$e,De,Re,Me,Ye,Ae,ze=function(e,t,a,n){var r,o=arguments.length,l=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,a,l):r(t,a))||l);return o>3&&l&&Object.defineProperty(t,a,l),l};class Oe{static registry=new a._;static NONE_STR=''}let Ke=class extends Oe{static{Ne=this}static SUCCESS_STR='';static NORMAL_STR='';get category(){return''}get name(){return''}start(e){e.setCurrentAction(this.name),e.deltaStamina(-10),Math.random()<.33?e.setExpectResult(Ne.SUCCESS_STR):e.setExpectResult(Ne.NORMAL_STR)}getStartRestoreKeys(){return[ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY,ke.STAMINA_KEY]}finish(e){switch(e.getExpectResult()){case Ne.SUCCESS_STR:e.deltaTrust(4);break;case Ne.NORMAL_STR:e.deltaTrust(2)}e.deltaMinutes(30),e.setCurrentAction(Oe.NONE_STR),e.setExpectResult(Oe.NONE_STR)}getFinishRestoreKeys(){return[ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY,ke.TRUST_KEY,ke.DATETIME_KEY]}isPossible(e){return e.getCurrentAction()===Oe.NONE_STR&&(!(e.getStamina()<10)&&!!e.isCurrentDateTimeAtNight())}isForce(e){return!1}};Ke=Ne=ze([Oe.registry.register(Ke.prototype.name)],Ke);let Le=class extends Oe{static{Ve=this}static SUCCESS_STR='';static NORMAL_STR='';static FAIL_STR='';get category(){return''}get name(){return''}start(e){e.setCurrentAction(this.name),e.deltaStamina(-15);const t=Math.random();t<.25?e.setExpectResult(Ve.SUCCESS_STR):t<.5?e.setExpectResult(Ve.FAIL_STR):e.setExpectResult(Ve.NORMAL_STR)}getStartRestoreKeys(){return[ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY,ke.STAMINA_KEY]}finish(e){let t=-1,a=2;switch(e.getExpectResult()){case Ve.SUCCESS_STR:a+=2;break;case Ve.FAIL_STR:t-=1,a-=1}e.deltaTrust(t),e.deltaInterest(a),e.deltaMinutes(30),e.setCurrentAction(Oe.NONE_STR),e.setExpectResult(Oe.NONE_STR)}getFinishRestoreKeys(){return[ke.TRUST_KEY,ke.INTEREST_KEY,ke.DATETIME_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}isPossible(e){return e.getCurrentAction()===Oe.NONE_STR&&(!(e.getStamina()<15)&&!!e.isCurrentDateTimeAtNight())}isForce(e){return!1}};Le=Ve=ze([Oe.registry.register(Le.prototype.name)],Le);let Ue=class extends Oe{static{we=this}static SUCCESS_STR='';get category(){return''}get name(){return''}start(e){e.setCurrentAction(this.name),e.deltaStamina(-20),e.setExpectResult(we.SUCCESS_STR)}getStartRestoreKeys(){return[ke.CURRENT_ACTION_KEY,ke.STAMINA_KEY,ke.EXPECT_RESULT_KEY]}finish(e){e.getMood()<=0&&e.deltaMood(1),e.deltaMinutes(60),e.setCurrentAction(Oe.NONE_STR),e.setExpectResult(Oe.NONE_STR)}getFinishRestoreKeys(){return[ke.MOOD_KEY,ke.DATETIME_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}isPossible(e){return e.getCurrentAction()===Oe.NONE_STR&&(!(e.getStamina()<20)&&!!e.isCurrentDateTimeAtNight())}isForce(e){return!1}};Ue=we=ze([Oe.registry.register(Ue.prototype.name)],Ue);let Fe=class extends Oe{static{Se=this}static SUCCESS_STR='';static NORMAL_STR='';static FAIL_STR='';get category(){return''}get name(){return''}start(e){e.setCurrentAction(this.name),e.deltaStamina(-20);const t=Math.random();t<.3?e.setExpectResult(Se.SUCCESS_STR):t<.4?e.setExpectResult(Se.FAIL_STR):e.setExpectResult(Se.NORMAL_STR)}getStartRestoreKeys(){return[ke.CURRENT_ACTION_KEY,ke.STAMINA_KEY,ke.EXPECT_RESULT_KEY]}finish(e){let t=5,a=0;switch(e.getExpectResult()){case Se.SUCCESS_STR:t+=4,a+=1;break;case Se.FAIL_STR:a-=1}e.deltaMinutes(120),e.deltaTrust(t),e.deltaMood(a),e.setCurrentAction(Oe.NONE_STR),e.setExpectResult(Oe.NONE_STR)}getFinishRestoreKeys(){return[ke.DATETIME_KEY,ke.TRUST_KEY,ke.MOOD_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}isPossible(e){return e.getCurrentAction()===Oe.NONE_STR&&(!(e.getStamina()<20)&&!!e.isCurrentDateTimeAtNight())}isForce(e){return!1}};Fe=Se=ze([Oe.registry.register(Fe.prototype.name)],Fe);let Pe=class extends Oe{static{Ce=this}static SUCCESS_STR='';static NORMAL_STR='';static FAIL_STR='';get category(){return''}get name(){return''}start(e){e.setCurrentAction(this.name),e.deltaStamina(-20);const t=Math.random();t<.5?e.setExpectResult(Ce.SUCCESS_STR):t<.8?e.setExpectResult(Ce.FAIL_STR):e.setExpectResult(Ce.NORMAL_STR)}getStartRestoreKeys(){return[ke.CURRENT_ACTION_KEY,ke.STAMINA_KEY,ke.EXPECT_RESULT_KEY]}finish(e){let t=3,a=0;switch(e.getExpectResult()){case Ce.SUCCESS_STR:t+=6,a+=1;break;case Ce.FAIL_STR:a-=1}e.deltaMinutes(120),e.deltaTrust(t),e.deltaMood(a),e.setCurrentAction(Oe.NONE_STR),e.setExpectResult(Oe.NONE_STR)}getFinishRestoreKeys(){return[ke.DATETIME_KEY,ke.TRUST_KEY,ke.MOOD_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}isPossible(e){return e.getCurrentAction()===Oe.NONE_STR&&(!(e.getStamina()<20)&&!!e.isCurrentDateTimeAtNight())}isForce(e){return!1}};Pe=Ce=ze([Oe.registry.register(Pe.prototype.name)],Pe);let je=class extends Oe{static{Te=this}static SUCCESS_STR='';static NORMAL_STR='';static FAIL_STR='';get category(){return''}get name(){return''}start(e){e.setCurrentAction(this.name),e.deltaStamina(-20);const t=Math.random();t<.7?e.setExpectResult(Te.SUCCESS_STR):t<.8?e.setExpectResult(Te.FAIL_STR):e.setExpectResult(Te.NORMAL_STR)}getStartRestoreKeys(){return[ke.CURRENT_ACTION_KEY,ke.STAMINA_KEY,ke.EXPECT_RESULT_KEY]}finish(e){let t=2,a=0;switch(e.getExpectResult()){case Te.SUCCESS_STR:t+=2,a+=1;break;case Te.FAIL_STR:t-=3,a-=1}e.deltaMinutes(120),e.deltaTrust(t),e.deltaMood(a),e.setCurrentAction(Oe.NONE_STR),e.setExpectResult(Oe.NONE_STR)}getFinishRestoreKeys(){return[ke.DATETIME_KEY,ke.TRUST_KEY,ke.MOOD_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}isPossible(e){return e.getCurrentAction()===Oe.NONE_STR&&(!(e.getStamina()<20)&&!!e.isCurrentDateTimeAtNight())}isForce(e){return!1}};je=Te=ze([Oe.registry.register(je.prototype.name)],je);let He=class extends Oe{static{Be=this}static SUCCESS_STR='';static NORMAL_STR='';static FAIL_STR='';get category(){return''}get name(){return''}start(e){e.setCurrentAction(this.name),e.deltaStamina(-20);const t=Math.random();t<.4?e.setExpectResult(Be.SUCCESS_STR):t<.8?e.setExpectResult(Be.FAIL_STR):e.setExpectResult(Be.NORMAL_STR)}getStartRestoreKeys(){return[ke.CURRENT_ACTION_KEY,ke.STAMINA_KEY,ke.EXPECT_RESULT_KEY]}finish(e){let t=3,a=0;switch(e.getExpectResult()){case Be.SUCCESS_STR:t+=10,a+=1;break;case Be.FAIL_STR:t-=2,a-=1}e.deltaMinutes(120),e.deltaTrust(t),e.deltaMood(a),e.setCurrentAction(Oe.NONE_STR),e.setExpectResult(Oe.NONE_STR)}getFinishRestoreKeys(){return[ke.DATETIME_KEY,ke.TRUST_KEY,ke.MOOD_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}isPossible(e){return e.getCurrentAction()===Oe.NONE_STR&&(!(e.getStamina()<20)&&!!e.isCurrentDateTimeAtNight())}isForce(e){return!1}};He=Be=ze([Oe.registry.register(He.prototype.name)],He);let Ge=class extends Oe{get category(){return''}get name(){return''}start(e){e.setCurrentAction(this.name),e.setSmallPlace('')}getStartRestoreKeys(){return[ke.CURRENT_ACTION_KEY,ke.SMALL_PLACE_KEY]}finish(e){e.deltaStamina(15),e.deltaMinutes(30),e.setFlagBath(!0),e.setSmallPlace(''),e.setCurrentAction(qe.prototype.name)}getFinishRestoreKeys(){return[ke.STAMINA_KEY,ke.DATETIME_KEY,ke.FLAGS_KEY,ke.BIG_PLACE_KEY,ke.CURRENT_ACTION_KEY]}isPossible(e){return e.getCurrentAction()===Oe.NONE_STR&&(!e.isAlreadyBath()&&!!e.isCurrentDateTimeAtNight())}isForce(e){return e.getCurrentAction()===Oe.NONE_STR&&(!e.isAlreadyBath()&&!!e.isCurrentDateTimeBetween(21,0,2,0))}};Ge=ze([Oe.registry.register(Ge.prototype.name)],Ge);let qe=class extends Oe{get category(){return null}get name(){return''}start(e){e.setCurrentAction(this.name)}getStartRestoreKeys(){return[ke.CURRENT_ACTION_KEY]}finish(e){e.deltaMinutes(30),e.setCurrentAction(Oe.NONE_STR)}getFinishRestoreKeys(){return[ke.DATETIME_KEY,ke.CURRENT_ACTION_KEY]}isPossible(e){return!1}isForce(e){return!1}};qe=ze([Oe.registry.register(qe.prototype.name)],qe);let Xe=class extends Oe{static{Ie=this}static SUCCESS_STR='';static FAIL_STR='';get category(){return null}get name(){return''}start(e){e.setSmallPlace(''),e.setCurrentAction(this.name),e.deltaStamina(-10);Math.random()<.1?e.setExpectResult(Ie.FAIL_STR):e.setExpectResult(Ie.SUCCESS_STR)}getStartRestoreKeys(){return[ke.SMALL_PLACE_KEY,ke.STAMINA_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}finish(e){e.getExpectResult()===Ie.FAIL_STR&&e.deltaTrust(-2),e.deltaMinutes(30),e.setSmallPlace(''),e.setCurrentAction(Oe.NONE_STR),e.setExpectResult(Oe.NONE_STR)}getFinishRestoreKeys(){return[ke.TRUST_KEY,ke.DATETIME_KEY,ke.SMALL_PLACE_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}isPossible(e){return e.getCurrentAction()===qe.prototype.name}isForce(e){return!1}};Xe=Ie=ze([Oe.registry.register(Xe.prototype.name)],Xe);let We=class extends Oe{static{$e=this}static SUCCESS_STR='';static FAIL_STR='';get category(){return null}get name(){return''}start(e){e.setCurrentAction(this.name);Math.random()<.2?e.setExpectResult($e.FAIL_STR):e.setExpectResult($e.SUCCESS_STR)}getStartRestoreKeys(){return[ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}finish(e){let t=0,a=0;switch(e.getExpectResult()){case $e.SUCCESS_STR:t-=1;break;case $e.FAIL_STR:-2===e.getMood()?t-=5:a-=1}e.deltaMinutes(30),e.setSmallPlace(''),e.setCurrentAction(Oe.NONE_STR),e.setExpectResult(Oe.NONE_STR)}getFinishRestoreKeys(){return[ke.TRUST_KEY,ke.MOOD_KEY,ke.DATETIME_KEY,ke.SMALL_PLACE_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}isPossible(e){return e.getCurrentAction()===Xe.prototype.name}isForce(e){return!1}};We=$e=ze([Oe.registry.register(We.prototype.name)],We);let Je=class extends Oe{static{De=this}static MOOD_INCREASE_STR='';static MOOD_DECREASE_STR='';get category(){return null}get name(){return''}start(e){e.setSmallPlace(''),e.setCurrentAction(this.name);const t=Math.random();switch(e.getMood()){case-2:t<.63&&e.setExpectResult(De.MOOD_INCREASE_STR);break;case 1:case 2:t<.13&&e.setExpectResult(De.MOOD_DECREASE_STR)}}getStartRestoreKeys(){return[ke.SMALL_PLACE_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}finish(e){e.isCurrentDateTimeBetween(19,0,20,0)?e.deltaStamina(65):e.isCurrentDateTimeBetween(20,0,21,0)?e.deltaStamina(60):e.isCurrentDateTimeBetween(21,0,22,0)?e.deltaStamina(55):e.isCurrentDateTimeBetween(22,0,23,0)?e.deltaStamina(50):e.isCurrentDateTimeBetween(24,0,0,0)?e.deltaStamina(45):e.isCurrentDateTimeBetween(0,0,1,0)?e.deltaStamina(40):e.isCurrentDateTimeBetween(1,0,2,0)?e.deltaStamina(35):e.isCurrentDateTimeBetween(2,0,3,0)?e.deltaStamina(30):e.isCurrentDateTimeBetween(3,0,4,0)?e.deltaStamina(20):e.isCurrentDateTimeBetween(4,0,5,0)&&e.deltaStamina(10);let t=0,a=0,n=0;switch(e.getMood()){case-2:a-=3,n-=2,e.getExpectResult()===De.MOOD_INCREASE_STR&&(t+=1);break;case-1:a-=2,n-=1;break;case 0:a-=1,n-=1;break;case 1:n-=1,e.getExpectResult()==De.MOOD_DECREASE_STR&&(t-=1);break;case 2:a+=1,e.getExpectResult()===De.MOOD_DECREASE_STR&&(t-=1)}n-=2,e.getInterest()>=200&&(n-=3),e.deltaTrust(a),e.deltaInterest(n),e.deltaMood(t),e.deltaDatetimeUntil(7,0),e.setSmallPlace(''),e.setCurrentAction(Ze.prototype.name),e.setExpectResult(Oe.NONE_STR),e.setFlagBath(!1)}getFinishRestoreKeys(){return[ke.STAMINA_KEY,ke.TRUST_KEY,ke.INTEREST_KEY,ke.MOOD_KEY,ke.DATETIME_KEY,ke.SMALL_PLACE_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY,ke.FLAGS_KEY]}isPossible(e){return!!e.isCurrentDateTimeAtNight()&&!!e.isAlreadyBath()}isForce(e){return!1}};Je=De=ze([Oe.registry.register(Je.prototype.name)],Je);let Ze=Re=class extends Oe{get category(){return null}get name(){return''}start(e){e.setCurrentAction(Re.prototype.name),e.setExpectResult(Oe.NONE_STR)}getStartRestoreKeys(){return[ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}finish(e){e.isWeekday()&&(e.deltaDatetimeUntil(8,30),(new Qe).start(e))}getFinishRestoreKeys(){const e=[ke.DATETIME_KEY];return e.concat((new Qe).getStartRestoreKeys()),e}isPossible(e){return!1}isForce(e){return!1}};Ze=Re=ze([Oe.registry.register(Ze.prototype.name)],Ze);let Qe=Me=class extends Oe{get category(){return null}get name(){return''}start(e){e.setBigPlace(''),e.setMiddlePlace(''),e.setSmallPlace(''),e.setCurrentAction(Me.prototype.name),e.setExpectResult(Oe.NONE_STR)}getStartRestoreKeys(){return[ke.BIG_PLACE_KEY,ke.MIDDLE_PLACE_KEY,ke.SMALL_PLACE_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}finish(e){e.deltaDatetimeUntil(18,0),(new et).start(e)}getFinishRestoreKeys(){const e=[ke.DATETIME_KEY];return e.concat((new et).getStartRestoreKeys()),e}isPossible(e){return!1}isForce(e){return!1}};Qe=Me=ze([Oe.registry.register(Qe.prototype.name)],Qe);let et=Ye=class extends Oe{get category(){return null}get name(){return''}start(e){e.addShopItem('',1e3,null),e.addShopItem('',5e3,null),e.addShopItem('',1e3,null),e.addShopItem('',2e3,null),e.setBigPlace(''),e.setMiddlePlace(''),e.setSmallPlace(''),e.setCurrentAction(Ye.prototype.name),e.setExpectResult(Oe.NONE_STR)}getStartRestoreKeys(){return[ke.SHOP_ITEMS_KEY,ke.BIG_PLACE_KEY,ke.MIDDLE_PLACE_KEY,ke.SMALL_PLACE_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}finish(e){e.deltaDatetimeUntil(18,30),(new ot).start(e)}getFinishRestoreKeys(){const e=[ke.DATETIME_KEY];return e.concat((new ot).getStartRestoreKeys()),e}isPossible(e){return!1}isForce(e){return!1}};et=Ye=ze([Oe.registry.register(et.prototype.name)],et);let tt=class extends Oe{get category(){return null}get name(){return''}start(e){e.setBigPlace(''),e.setMiddlePlace(''),e.setSmallPlace(''),e.setCurrentAction(this.name),e.setExpectResult(Oe.NONE_STR)}getStartRestoreKeys(){return[ke.BIG_PLACE_KEY,ke.MIDDLE_PLACE_KEY,ke.SMALL_PLACE_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}finish(e){e.deltaInventory('',1),e.deltaDatetimeUntil(18,30),(new ot).start(e)}getFinishRestoreKeys(){const e=[ke.INVENTORIES_KEY,ke.DATETIME_KEY];return e.concat((new ot).getStartRestoreKeys()),e}isPossible(e){return e.getCurrentAction()===et.prototype.name}isForce(e){return!1}};tt=ze([Oe.registry.register(tt.prototype.name)],tt);let at=class extends Oe{get category(){return null}get name(){return' [3000]'}start(e){e.setBigPlace(''),e.setMiddlePlace(''),e.setSmallPlace(''),e.setCurrentAction(this.name),e.setExpectResult(Oe.NONE_STR)}getStartRestoreKeys(){return[ke.BIG_PLACE_KEY,ke.MIDDLE_PLACE_KEY,ke.SMALL_PLACE_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}finish(e){e.deltaInventory('',1),e.deltaMoney(-3e3),e.deltaDatetimeUntil(18,30),(new ot).start(e)}getFinishRestoreKeys(){const e=[ke.INVENTORIES_KEY,ke.MONEY_KEY,ke.DATETIME_KEY];return e.concat((new ot).getStartRestoreKeys()),e}isPossible(e){return e.getCurrentAction()===et.prototype.name&&!(e.getMoney()<3e3)}isForce(e){return!1}};at=ze([Oe.registry.register(at.prototype.name)],at);let nt=class extends Oe{get category(){return null}get name(){return' [2000]'}start(e){e.setBigPlace(''),e.setMiddlePlace(''),e.setSmallPlace(''),e.setCurrentAction(this.name),e.setExpectResult(Oe.NONE_STR)}getStartRestoreKeys(){return[ke.BIG_PLACE_KEY,ke.MIDDLE_PLACE_KEY,ke.SMALL_PLACE_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}finish(e){e.deltaInventory('',1),e.deltaMoney(-2e3),e.deltaDatetimeUntil(18,30),(new ot).start(e)}getFinishRestoreKeys(){const e=[ke.INVENTORIES_KEY,ke.MONEY_KEY,ke.DATETIME_KEY];return e.concat((new ot).getStartRestoreKeys()),e}isPossible(e){return e.getCurrentAction()===et.prototype.name&&!(e.getMoney()<2e3)}isForce(e){return!1}};nt=ze([Oe.registry.register(nt.prototype.name)],nt);let rt=class extends Oe{get category(){return null}get name(){return' [1000]'}start(e){e.setBigPlace(''),e.setMiddlePlace(''),e.setSmallPlace(''),e.setCurrentAction(this.name),e.setExpectResult(Oe.NONE_STR)}getStartRestoreKeys(){return[ke.BIG_PLACE_KEY,ke.MIDDLE_PLACE_KEY,ke.SMALL_PLACE_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}finish(e){e.deltaInventory('',1),e.deltaMoney(-1e3),e.deltaDatetimeUntil(18,30),(new ot).start(e)}getFinishRestoreKeys(){const e=[ke.INVENTORIES_KEY,ke.MONEY_KEY,ke.DATETIME_KEY];return e.concat((new ot).getStartRestoreKeys()),e}isPossible(e){return e.getCurrentAction()===et.prototype.name&&!(e.getMoney()<1e3)}isForce(e){return!1}};rt=ze([Oe.registry.register(rt.prototype.name)],rt);let ot=class extends Oe{static{Ae=this}static CUP_NOODLE_SUCCESS_STR='';static CUP_NOODLE_FAIL_STR='';static STAMINA_INGREDIENTS_STR='';static BENTO_STR='';static COOKING_INGREDIENTS_STR='';get category(){return null}get name(){return''}start(e){switch(e.getDinnerInventory()){case'':e.setExpectResult(Ae.STAMINA_INGREDIENTS_STR);break;case'':e.setExpectResult(Ae.BENTO_STR);break;case'':e.setExpectResult(Ae.COOKING_INGREDIENTS_STR);break;case'':Math.random()<.5?e.setExpectResult(Ae.CUP_NOODLE_SUCCESS_STR):e.setExpectResult(Ae.CUP_NOODLE_FAIL_STR)}e.clearShopItems(),e.setBigPlace(''),e.setMiddlePlace(''),e.setSmallPlace(''),e.setCurrentAction(this.name)}getStartRestoreKeys(){return[ke.SHOP_ITEMS_KEY,ke.BIG_PLACE_KEY,ke.MIDDLE_PLACE_KEY,ke.SMALL_PLACE_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}finish(e){let t='',a=0,n=0,r=0;switch(e.getExpectResult()){case Ae.STAMINA_INGREDIENTS_STR:t='',a+=20,n+=90;break;case Ae.BENTO_STR:t='',a+=10,n+=30;break;case Ae.COOKING_INGREDIENTS_STR:t='',a+=15,n+=90;break;case Ae.CUP_NOODLE_SUCCESS_STR:t='',a+=5,n+=30;break;case Ae.CUP_NOODLE_FAIL_STR:t='',a+=5,n+=30,r-=1}e.deltaInventory(t,-1),e.deltaStamina(a),e.deltaMinutes(n),e.deltaMood(r),e.setCurrentAction(Oe.NONE_STR),e.setExpectResult(Oe.NONE_STR)}getFinishRestoreKeys(){return[ke.INVENTORIES_KEY,ke.STAMINA_KEY,ke.DATETIME_KEY,ke.MOOD_KEY,ke.CURRENT_ACTION_KEY,ke.EXPECT_RESULT_KEY]}isPossible(e){return!1}isForce(e){return!1}};ot=Ae=ze([Oe.registry.register(ot.prototype.name)],ot);var lt,it,st,ct,dt,ut,pt,mt,gt,vt,bt,ft,ht,xt,_t,Et=function(e,t,a,n){var r,o=arguments.length,l=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,a,l):r(t,a))||l);return o>3&&l&&Object.defineProperty(t,a,l),l},yt=function(e,t){if('object'==typeof Reflect&&'function'==typeof Reflect.metadata)return Reflect.metadata(e,t)};let kt=lt=class extends K{get REGEX(){return/initialize\(\)/g}create(e){return new lt}isValid(){return!0}execute(e){const t=new ke(e),a=new re;return a.pushCommand(new U(ke.STAMINA_KEY,0,60,40)),a.pushCommand(new U(ke.MONEY_KEY,0,null,6e3)),a.pushCommand(new U(ke.TRUST_KEY,0,1e3,25)),a.pushCommand(new U(ke.INTEREST_KEY,0,1e3,10)),a.pushCommand(new U(ke.MOOD_KEY,-2,2,0)),a.pushCommand(new q(ke.DATETIME_KEY,'2025-11-19T19:00:00')),a.pushCommand(new H(ke.BIG_PLACE_KEY,'')),a.pushCommand(new H(ke.MIDDLE_PLACE_KEY,'')),a.pushCommand(new H(ke.SMALL_PLACE_KEY,'')),a.pushCommand(new H(ke.WEATHER_KEY,'')),a.pushCommand(new H(ke.CLOTHING_KEY,'')),a.pushCommand(new H(ke.CURRENT_ACTION_KEY,Oe.NONE_STR)),a.pushCommand(new H(ke.EXPECT_RESULT_KEY,Oe.NONE_STR)),a.pushCommand(new ee(ke.FLAGS_KEY)),a.pushCommand(new U(ke.FLAG_BATH_KEY,0,1,0)),a.pushCommand(new te(ke.FLAGS_KEY,ke.FLAG_BATH_KEY)),a.pushCommand(new ee(ke.SHOP_ITEMS_KEY)),a.pushCommand(new ee(ke.INVENTORIES_KEY)),a.pushCommand(new U(ke.TRUST_ROC_KEY,null,null,0)),a.pushCommand(new U(ke.INTEREST_ROC_KEY,null,null,0)),a.pushCommand(new U(ke.MOOD_ROC_KEY,null,null,0)),a.pushCommand(new ee(ke.ITEM_TABLE_KEY)),a.pushCommand(new ee(ke.SUMMARY_TABLE_KEY)),a.execute(t),t}};kt=lt=Et([K.registry.register()],kt);let Nt=it=class extends K{current_action;expected_result;constructor(e,t){super(),this.current_action=e,this.expected_result=t}get REGEX(){return/actionStart\(\s*([^,()]+)\s*,\s*(.+)\s*\)/g}create(e){const t=e[0].slice(1,-1),a=e[1].slice(1,-1);return new it(t,a)}isValid(){return!0}execute(e){const t=new ke(e);return t.setCurrentAction(this.current_action),t.setExpectResult(this.expected_result),t.resetTrustROC(),t.resetInterestROC(),t.resetMoodROC(),t}};Nt=it=Et([K.registry.register(),yt('design:paramtypes',[String,String])],Nt);let Vt=st=class extends K{summary;weighting;constructor(e,t){super(),this.summary=e,this.weighting=t}get REGEX(){return/actionFinish\(\s*([^,()]+)\s*,\s*(.+)\s*\)/g}create(e){const t=e[0].slice(1,-1),a=Number(e[1]);return new st(t,a)}isValid(){return!isNaN(this.weighting)}execute(e){const t=new ke(e);return t.setCurrentAction(Oe.NONE_STR),t.setExpectResult(Oe.NONE_STR),t.finishCurrentAction(this.summary,this.weighting),t}};Vt=st=Et([K.registry.register(),yt('design:paramtypes',[String,Number])],Vt);let wt=ct=class extends K{delta_minutes;constructor(e){super(),this.delta_minutes=e}get REGEX(){return/deltaMinutes\(\s*([^,()]+)\s*\)/g}create(e){const t=Number(e[0]);return new ct(t)}isValid(){return!isNaN(this.delta_minutes)}execute(e){const t=new ke(e),a=t.getYear(),n=t.getMonth(),r=t.getDate();t.deltaMinutes(this.delta_minutes);const o=t.getYear(),l=t.getMonth(),i=t.getDate();return t.handleChangeDateEvents(a,n,r,o,l,i),t}};wt=ct=Et([K.registry.register(),yt('design:paramtypes',[Number])],wt);let St=dt=class extends K{big_place;constructor(e){super(),this.big_place=e}get REGEX(){return/setBigPlace\(\s*([^,()]+)\s*\)/g}create(e){const t=e[0].slice(1,-1);return new dt(t)}isValid(){return!0}execute(e){const t=new ke(e);return t.setBigPlace(this.big_place),t}};St=dt=Et([K.registry.register(),yt('design:paramtypes',[String])],St);let Ct=ut=class extends K{middle_place;constructor(e){super(),this.middle_place=e}get REGEX(){return/setMiddlePlace\(\s*([^,()]+)\s*\)/g}create(e){const t=e[0].slice(1,-1);return new ut(t)}isValid(){return!0}execute(e){const t=new ke(e);return t.setMiddlePlace(this.middle_place),t}};Ct=ut=Et([K.registry.register(),yt('design:paramtypes',[String])],Ct);let Tt=pt=class extends K{small_place;constructor(e){super(),this.small_place=e}get REGEX(){return/setSmallPlace\(\s*([^,()]+)\s*\)/g}create(e){const t=e[0].slice(1,-1);return new pt(t)}isValid(){return!0}execute(e){const t=new ke(e);return t.setSmallPlace(this.small_place),t}};Tt=pt=Et([K.registry.register(),yt('design:paramtypes',[String])],Tt);let Bt=mt=class extends K{weather;constructor(e){super(),this.weather=e}get REGEX(){return/setWeather\(\s*([^,()]+)\s*\)/g}create(e){const t=e[0].slice(1,-1);return new mt(t)}isValid(){return!0}execute(e){const t=new ke(e);return t.setWeather(this.weather),t}};Bt=mt=Et([K.registry.register(),yt('design:paramtypes',[String])],Bt);let It=gt=class extends K{clothing;constructor(e){super(),this.clothing=e}get REGEX(){return/setClothing\(\s*([^,()]+)\s*\)/g}create(e){const t=e[0].slice(1,-1);return new gt(t)}isValid(){return!0}execute(e){const t=new ke(e);return t.setClothing(this.clothing),t}};It=gt=Et([K.registry.register(),yt('design:paramtypes',[String])],It);let $t=vt=class extends K{delta_trust_roc;constructor(e){super(),this.delta_trust_roc=e}get REGEX(){return/deltaTrustROC\(\s*([^,()]+)\s*\)/g}create(e){const t=Number(e[0]);return new vt(t)}isValid(){return!isNaN(this.delta_trust_roc)}execute(e){const t=new ke(e);return this.delta_trust_roc<-3&&(this.delta_trust_roc=-3),this.delta_trust_roc>3&&(this.delta_trust_roc=3),this.delta_trust_roc<0&&(this.delta_trust_roc*=2),t.deltaTrustROC(this.delta_trust_roc),t}};$t=vt=Et([K.registry.register(),yt('design:paramtypes',[Number])],$t);let Dt=bt=class extends K{delta_interest_roc;constructor(e){super(),this.delta_interest_roc=e}get REGEX(){return/deltaInterestROC\(\s*([^,()]+)\s*\)/g}create(e){const t=Number(e[0]);return new bt(t)}isValid(){return!isNaN(this.delta_interest_roc)}execute(e){const t=new ke(e);return this.delta_interest_roc<-3&&(this.delta_interest_roc=-3),this.delta_interest_roc>3&&(this.delta_interest_roc=3),this.delta_interest_roc<0&&(this.delta_interest_roc*=2),t.deltaInterestROC(this.delta_interest_roc),t}};Dt=bt=Et([K.registry.register(),yt('design:paramtypes',[Number])],Dt);let Rt=ft=class extends K{delta_mood_roc;constructor(e){super(),this.delta_mood_roc=e}get REGEX(){return/deltaMoodROC\(\s*([^,()]+)\s*\)/g}create(e){const t=Number(e[0]);return new ft(t)}isValid(){return!isNaN(this.delta_mood_roc)}execute(e){const t=new ke(e);return this.delta_mood_roc<-3&&(this.delta_mood_roc=-3),this.delta_mood_roc>3&&(this.delta_mood_roc=3),this.delta_mood_roc<0&&(this.delta_mood_roc*=2),t.deltaMoodROC(this.delta_mood_roc),t}};Rt=ft=Et([K.registry.register(),yt('design:paramtypes',[Number])],Rt);let Mt=ht=class extends K{delta_money;constructor(e){super(),this.delta_money=e}get REGEX(){return/deltaMoney\(\s*([^,()]+)\s*\)/g}create(e){const t=Number(e[0]);return new ht(t)}isValid(){return!isNaN(this.delta_money)}execute(e){const t=new ke(e);return t.deltaMoney(this.delta_money),t}};Mt=ht=Et([K.registry.register(),yt('design:paramtypes',[Number])],Mt);let Yt=xt=class extends K{name;description;constructor(e,t){super(),this.name=e,this.description=t}get REGEX(){return/createItem\(\s*([^,()]+)\s*,\s*(.+)\s*\)/g}create(e){const t=e[0].slice(1,-1),a=e[1].slice(1,-1);return new xt(t,a)}isValid(){return!0}execute(e){const t=new ke(e);return t.createItem(this.name,this.description),t}};Yt=xt=Et([K.registry.register(),yt('design:paramtypes',[String,String])],Yt);let At=_t=class extends K{name;delta_quantity;constructor(e,t){super(),this.name=e,this.delta_quantity=t}get REGEX(){return/deltaInventory\(\s*([^,()]+)\s*,\s*(.+)\s*\)/g}create(e){const t=e[0].slice(1,-1),a=Number(e[1]);return new _t(t,a)}isValid(){return!isNaN(this.delta_quantity)}execute(e){const t=new ke(e);return t.deltaInventory(this.name,this.delta_quantity),t}};At=_t=Et([K.registry.register(),yt('design:paramtypes',[String,Number])],At);class zt{game_state;constructor(e){this.game_state=new ke(e)}getGameState(){return this.game_state}initiateState(){const e=new re;e.pushCommand(new U(ke.STAMINA_KEY,0,60,40)),e.pushCommand(new U(ke.MONEY_KEY,0,null,6e3)),e.pushCommand(new U(ke.TRUST_KEY,0,1e3,25)),e.pushCommand(new U(ke.INTEREST_KEY,0,1e3,10)),e.pushCommand(new U(ke.MOOD_KEY,-2,2,0)),e.pushCommand(new q(ke.DATETIME_KEY,'2025-11-19T19:00:00')),e.pushCommand(new H(ke.BIG_PLACE_KEY,'')),e.pushCommand(new H(ke.MIDDLE_PLACE_KEY,'')),e.pushCommand(new H(ke.SMALL_PLACE_KEY,'')),e.pushCommand(new H(ke.WEATHER_KEY,'')),e.pushCommand(new H(ke.CLOTHING_KEY,'')),e.pushCommand(new H(ke.CURRENT_ACTION_KEY,Oe.NONE_STR)),e.pushCommand(new H(ke.EXPECT_RESULT_KEY,Oe.NONE_STR)),e.pushCommand(new ee(ke.FLAGS_KEY)),e.pushCommand(new U(ke.FLAG_BATH_KEY,0,1,0)),e.pushCommand(new te(ke.FLAGS_KEY,ke.FLAG_BATH_KEY)),e.pushCommand(new ee(ke.SHOP_ITEMS_KEY)),e.pushCommand(new ee(ke.INVENTORIES_KEY)),e.pushCommand(new U(ke.TRUST_ROC_KEY,null,null,0)),e.pushCommand(new U(ke.INTEREST_ROC_KEY,null,null,0)),e.pushCommand(new U(ke.MOOD_ROC_KEY,null,null,0)),e.pushCommand(new ee(ke.ITEM_TABLE_KEY)),e.pushCommand(new ee(ke.SUMMARY_TABLE_KEY)),e.execute(this.game_state)}getForceActionStr(){const e=new Map;for(const[t,a]of Oe.registry.getAll())if(a.prototype.isForce(this.game_state))if(a.prototype.category){const n=a.prototype.category,r=e.get(n)??[];r.push(t),e.set(n,r)}else e.set(t,null);let t='';for(const[a,n]of e)if(null===n)t+=`[${a}]\n`;else{t+=`[${a}]:\n`;for(const e of n)t+=`  [${e}]\n`}return t&&(t='<ActionBlock>\n'+t+'</ActionBlock>'),t}getPossibleActionStr(){const e=new Map;for(const[t,a]of Oe.registry.getAll())if(a.prototype.isPossible(this.game_state))if(a.prototype.category){const n=a.prototype.category,r=e.get(n)??[];r.push(t),e.set(n,r)}else e.set(t,null);let t='';for(const[a,n]of e)if(null===n)t+=`[${a}]\n`;else{t+=`[${a}]:\n`;for(const e of n)t+=`  [${e}]\n`}return t&&(t='<ActionBlock>\n'+t+'</ActionBlock>'),t}getForceActions(){const e=new Map;for(const[t,a]of Oe.registry.getAll())if(a.prototype.isForce(this.game_state))if(a.prototype.category){const n=a.prototype.category,r=e.get(n)??[];r.push(t),e.set(n,r)}else e.set(t,null);return e}getPossibleActions(){const e=new Map;for(const[t,a]of Oe.registry.getAll())if(a.prototype.isPossible(this.game_state))if(a.prototype.category){const n=a.prototype.category,r=e.get(n)??[];r.push(t),e.set(n,r)}else e.set(t,null);return e}getStatusStr(){let e='';e+=`:$${this.game_state.getMoney()}\n`,e+=`:${this.game_state.getTrust()}\n`,e+=`:${this.game_state.getInterest()}\n`;e+=`:${['','','','',''][this.game_state.getMood()+2]}\n`;return e+=`:${['','','','','','',''][this.game_state.getDay()]}\n`,e+=`:${this.game_state.getMonth()}${this.game_state.getDate()}\n`,e+=`:${this.game_state.getHours().toString().padStart(2,'0')}:${this.game_state.getMinutes().toString().padStart(2,'0')}\n`,e+=`:${this.game_state.getBigPlace()}\n`,e+=`:${this.game_state.getMiddlePlace()}\n`,e+=`:${this.game_state.getSmallPlace()}\n`,e+=`:${this.game_state.getWeather()}\n`,e+=`:${this.game_state.getClothing()}\n`,e+=`:${this.game_state.getCurrentAction()}\n`,e+=`:${this.game_state.getExpectResult()}\n`,e&&(e='<StatusBlock>\n'+e+'</StatusBlock>'),e}getItemTableStr(){let e='<ItemTable>\n';const t=this.game_state.getItemTable();for(const[a,n]of t)e+=`${a}: ${n}\n`;return e+='<ItemTable>',e}getSummaryTableStr(){let e='<SummaryTable>\n';e+='  #\n',e+='  #|  |  |  | (0.0~1.0) |\n';const t=this.game_state.getSummaries();for(const a of t){if(null===a)continue;const t=a.datetime.getFullYear(),n=a.datetime.getMonth(),r=a.datetime.getDate(),o=a.datetime.getHours(),l=a.datetime.getMinutes();e+=`| ${`${t}${n}${r} (${['','','','','','',''][a.datetime.getDay()]}) ${o.toString().padStart(2,'0')}:${l.toString().padStart(2,'0')}`} | ${`${a.big_place}-${a.middle_place}-${a.small_place}`} | ${a.summary} | ${a.weighting} |\n`}return e+='<SummaryTable>',e}}function Ot(){uninjectPrompts(['variable_injection']);const e=new zt(se());let t='';t+=`${e.getStatusStr()}\n`,t+=`${e.getItemTableStr()}`,injectPrompts([{id:'variable_injection',position:'in_chat',depth:0,role:'system',content:t,should_scan:!0}],{once:!1}),injectPrompts([{id:'summary_injection',position:'in_chat',depth:9999,role:'system',content:e.getSummaryTableStr(),should_scan:!0}],{once:!1})}eventMakeFirst(tavern_events.CHAT_CREATED,()=>{console.log('[VT] CHAT_CREATED start'),console.log('[VT] CHAT_CREATED end')}),eventMakeLast(tavern_events.GENERATE_AFTER_COMBINE_PROMPTS,()=>{console.log('[VT] GENERATE_AFTER_COMBINE_PROMPTS start'),Ot(),console.log('[VT] GENERATE_AFTER_COMBINE_PROMPTS end')})})(),(()=>{const t=Vue,a={class:'fold-bar'},r={class:'fold-bar-header'},o={class:'fold-bar-title-actions'},l={class:'fold-bar-header-actions'},i={class:'fold-bar-content-text'},s=(0,t.defineComponent)({__name:'fold_bar',props:{title:{},isOpen:{type:Boolean}},emits:['toggle'],setup(e,{emit:n}){const s=e,c=n,d=(0,t.ref)(s.isOpen),u=(0,t.ref)(),p=()=>{u.value&&(d.value?(d.value=!1,u.value.style.maxHeight='0'):(d.value=!0,setTimeout(()=>{if(u.value){const e=u.value.scrollHeight,t=.8*window.innerHeight,a=Math.min(e,t);u.value.style.maxHeight=a+'px'}},0)),c('toggle',d.value))};return(0,t.watch)(()=>s.isOpen,e=>{e!==d.value&&(u.value&&(e?setTimeout(()=>{if(u.value){const e=u.value.scrollHeight,t=.8*window.innerHeight,a=Math.min(e,t);u.value.style.maxHeight=a+'px'}},0):u.value.style.maxHeight='0'),d.value=e)}),(n,s)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',a,[(0,t.createElementVNode)('div',r,[(0,t.createElementVNode)('button',{class:'fold-bar-btn',onClick:p},[(0,t.createElementVNode)('span',null,(0,t.toDisplayString)(e.title),1),(0,t.createElementVNode)('div',o,[(0,t.renderSlot)(n.$slots,'title-actions')]),(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['fold-bar-toggle-icon',{open:(0,t.unref)(d)}])},null,2)]),(0,t.createElementVNode)('div',l,[(0,t.renderSlot)(n.$slots,'header-actions')])]),(0,t.createElementVNode)('div',{ref_key:'contentRef',ref:u,class:(0,t.normalizeClass)(['fold-bar-content',{open:(0,t.unref)(d)}])},[(0,t.createElementVNode)('div',i,[(0,t.renderSlot)(n.$slots,'default')]),(0,t.createElementVNode)('div',{class:'fold-bar-footer-toggle',onClick:p},'  ')],2)]))}});n(325);var c=n(3235);const d=(0,c.A)(s,[['__scopeId','data-v-112e8be8']]),u={class:'character-tabs-container'},p=['onClick'],m={class:'character-info-container'},g={class:'section'},v={class:'form-grid'},b={class:'input-group'},f=['onUpdate:modelValue'],h={key:0,class:'generated-result'},x={class:'generated-text'},E=['onClick'],y={class:'input-group'},k=['onUpdate:modelValue'],N={key:0,class:'generated-result'},V={class:'generated-text'},w=['onClick'],S={class:'input-group'},C=['value','onInput'],T={key:0,class:'generated-result'},B={class:'generated-text'},I=['onClick'],D={class:'input-group'},R=['onUpdate:modelValue'],M={key:0,class:'generated-result'},Y={class:'generated-text'},A=['onClick'],O={class:'input-group'},K=['onUpdate:modelValue'],L={key:0,class:'generated-result'},U={class:'generated-text'},F=['onClick'],P={class:'input-group'},j=['value','onInput'],H={key:0,class:'generated-result'},G={class:'generated-text'},q=['onClick'],X={class:'input-group'},W=['value','onInput'],J={key:0,class:'generated-result'},Z={class:'generated-text'},Q=['onClick'],ee={class:'input-group'},te=['value','onInput'],ae={key:0,class:'generated-result'},ne={class:'generated-text'},re=['onClick'],oe={class:'input-group'},le=['onUpdate:modelValue'],ie={key:0,class:'generated-result'},se={class:'generated-text'},ce=['onClick'],de={class:'input-group'},ue=['value','onInput'],pe={key:0,class:'generated-result'},me={class:'generated-text'},ge=['onClick'],ve={class:'input-group'},be=['value','onInput'],fe={key:0,class:'generated-result'},he={class:'generated-text'},xe=['onClick'],_e={class:'input-group full-width'},Ee=['onUpdate:modelValue'],ye={key:0,class:'generated-result'},ke={class:'generated-text'},Ne=['onClick'],Ve={class:'input-group full-width'},we={class:'birthday-inputs'},Se=['value','onInput'],Ce=['value','onInput'],Te={key:0,class:'generated-result'},Be={class:'generated-text'},Ie=['onClick'],$e={class:'section'},De={class:'form-grid'},Re={class:'input-group full-width'},Me=['onUpdate:modelValue'],Ye={key:0,class:'generated-result'},Ae={class:'generated-text'},ze=['onClick'],Oe={class:'input-group full-width'},Ke=['onUpdate:modelValue'],Le={key:0,class:'generated-result'},Ue={class:'generated-text'},Fe=['onClick'],Pe={class:'section'},je={class:'form-grid'},He={class:'input-group full-width'},Ge=['onUpdate:modelValue'],qe={key:0,class:'generated-result'},Xe={class:'generated-text'},We=['onClick'],Je={class:'input-group full-width'},Ze=['onUpdate:modelValue'],Qe={key:0,class:'generated-result'},et={class:'generated-text'},tt=['onClick'],at={class:'input-group full-width'},nt=['onUpdate:modelValue'],rt={key:0,class:'generated-result'},ot={class:'generated-text'},lt=['onClick'],it={class:'section'},st={class:'form-grid'},ct={class:'input-group'},dt=['value','onInput'],ut={key:0,class:'generated-result'},pt={class:'generated-text'},mt=['onClick'],gt={class:'input-group'},vt=['value','onInput'],bt={key:0,class:'generated-result'},ft={class:'generated-text'},ht=['onClick'],xt={class:'input-group'},_t=['value','onInput'],Et={key:0,class:'generated-result'},yt={class:'generated-text'},kt=['onClick'],Nt={class:'input-group full-width'},Vt=['onUpdate:modelValue'],wt={key:0,class:'generated-result'},St={class:'generated-text'},Ct=['onClick'],Tt={class:'input-group full-width'},Bt={class:'relations-list'},It={class:'relation-target'},$t=['value','onInput'],Dt=['onClick'],Rt={class:'add-relation'},Mt=['onUpdate:modelValue'],Yt=['value'],At=['disabled','onClick'],zt={key:0,class:'generated-result'},Ot={class:'generated-text'},Kt=['onClick'],Lt={class:'input-group full-width'},Ut={class:'relations-list'},Ft={class:'relation-target'},Pt=['value','onInput'],jt=['onClick'],Ht={class:'add-relation'},Gt=['onUpdate:modelValue'],qt=['value'],Xt=['disabled','onClick'],Wt={key:0,class:'generated-result'},Jt={class:'generated-text'},Zt=['onClick'],Qt={class:'input-group full-width'},ea={class:'relations-list'},ta={class:'relation-target'},aa=['value','onInput'],na=['onClick'],ra={class:'add-relation'},oa=['onUpdate:modelValue'],la=['value'],ia=['disabled','onClick'],sa={key:0,class:'generated-result'},ca={class:'generated-text'},da=['onClick'],ua={class:'input-group full-width'},pa={class:'inventory-list'},ma={class:'inventory-target'},ga=['value','onInput'],va=['onClick'],ba={class:'add-inventory'},fa=['onUpdate:modelValue'],ha=['value'],xa=['onUpdate:modelValue','disabled'],_a=['disabled','onClick'],Ea={key:0,class:'generated-result'},ya={class:'generated-text'},ka=['onClick'],Na={class:'section'},Va={class:'form-grid'},wa={class:'input-group full-width'},Sa=['onUpdate:modelValue'],Ca={class:'action-section'},Ta=['disabled','onClick'],Ba={key:0,class:'loading-spinner'},Ia=['disabled','onClick'],$a=(0,t.defineComponent)({__name:'character_tab',setup(e){const a=(e,t)=>{const a=e[t];return a?.toString()||''},n=(e,t,a)=>{if(''===a||''===a.trim())e[t]=null;else{const n=parseInt(a);e[t]=isNaN(n)?null:n}},r=(e,t,a)=>{const n=c.value.get(e);if(!n)return;const r={:{field:''},:{field:''},:{field:'',parser:e=>parseInt(e)||null},:{field:''},:{field:''},:{field:'',parser:e=>parseInt(e)||null},:{field:'',parser:e=>parseInt(e)||null},:{field:'',parser:e=>parseInt(e)||null},:{field:''},:{field:'',parser:e=>parseInt(e)||null},:{field:'',parser:e=>parseInt(e)||null},:{field:''},:{field:''},:{field:''},:{field:''},:{field:''},:{field:''},:{field:'',parser:e=>parseInt(e)||null},:{field:'',parser:e=>parseInt(e)||null},:{field:'',parser:e=>parseInt(e)||null},:{field:'',parser:e=>parseInt(e)||null},:{field:'',parser:e=>parseInt(e)||null},:{field:''}}[t];if(r){const e=r.parser?r.parser(a):a;n[r.field]=e,n[`generated_${t}`]=''}else if(''===t){const e=a.split('-');2===e.length&&(n.=parseInt(e[0])||null,n.=parseInt(e[1])||null,n.generated_birthday_month='',n.generated_birthday_day='')}else''===t?o(n,a):''===t?l(n,a):''===t?i(n,a):''===t&&s(n,a);c.value.set(e,{...n}),ja(e)},o=(e,t)=>{e.||(e.=new Map);const a=t.replace(/^["']|["']$/g,'');if(a.startsWith('[')&&a.endsWith(']')){const t=a.slice(1,-1).split(',').map(e=>e.trim());for(const a of t){const t=a.indexOf(':');if(t>0){const n=a.substring(0,t).replace(/^["']|["']$/g,'').trim(),r=a.substring(t+1).replace(/^["']|["']$/g,'').trim();n&&r&&e..set(n,r)}}}else e.selected_relation_target&&e..set(e.selected_relation_target,t);e.generated_relationship=''},l=(e,t)=>{e.||(e.=new Map);const a=t.replace(/^["']|["']$/g,'');if(a.startsWith('[')&&a.endsWith(']')){const t=a.slice(1,-1).split(',').map(e=>e.trim());for(const a of t){const t=a.indexOf(':');if(t>0){const n=a.substring(0,t).replace(/^["']|["']$/g,'').trim(),r=parseInt(a.substring(t+1).replace(/^["']|["']$/g,'').trim());n&&!isNaN(r)&&e..set(n,r)}}}e.generated_friendship=''},i=(e,t)=>{e.||(e.=new Map);const a=t.replace(/^["']|["']$/g,'');if(a.startsWith('[')&&a.endsWith(']')){const t=a.slice(1,-1).split(',').map(e=>e.trim());for(const a of t){const t=a.indexOf(':');if(t>0){const n=a.substring(0,t).replace(/^["']|["']$/g,'').trim(),r=parseInt(a.substring(t+1).replace(/^["']|["']$/g,'').trim());n&&!isNaN(r)&&e..set(n,r)}}}e.generated_love=''},s=(e,t)=>{e.||(e.=new Map);const a=t.replace(/^["']|["']$/g,'');if(a.startsWith('[')&&a.endsWith(']')){const t=a.slice(1,-1).split(',').map(e=>e.trim());for(const a of t){const t=a.indexOf(':');if(t>0){const n=a.substring(0,t).replace(/^["']|["']$/g,'').trim(),r=parseInt(a.substring(t+1).replace(/^["']|["']$/g,'').trim());n&&!isNaN(r)&&r>0&&e..set(n,r)}}}e.generated_inventory=''},c=(0,t.ref)(new Map),$a=(0,t.ref)(new Map),Da=(0,t.computed)(()=>{const e=new Map;for(const[t,a]of c.value)'c1'!==t&&e.set(t,a);return e}),Ra=(0,t.computed)(()=>Array.from(Da.value.entries())),Ma=e=>{const a=new Map(c.value),n=getVariables({type:'chat'}),r=n.characters?.c1;return r&&!a.has('c1')&&a.set('c1',(0,t.reactive)(r)),Array.from(a.entries()).filter(([t])=>t!==e)},Ya=()=>{const e=new Map,a=getVariables({type:'chat'});if(a?.items)for(const[n,r]of Object.entries(a.items))e.set(n,(0,t.reactive)(r));return Array.from(e.entries())},Aa=e=>{const t=getVariables({type:'chat'}),a=t.items?.[e];return a&&a.name||''},za=e=>`${e?.||''}${e?.||''}`.trim()||'',Oa=e=>{const t=getVariables({type:'chat'}),a=t.characters?.[e];if(a){return`${a.||''}${a.||''}`.trim()||''}return''},Ka=e=>!!(e?.generated_surname||e?.generated_name||e?.generated_age||e?.generated_gender||e?.generated_identity||e?.generated_height||e?.generated_weight||e?.generated_chest_size||e?.generated_cup_size||e?.generated_waist_size||e?.generated_hips_size||e?.generated_hairstyle||e?.generated_appearance||e?.generated_clothes||e?.generated_introduction||e?.generated_personality||e?.generated_favourite||e?.generated_money||e?.generated_mood||e?.generated_sexuality||e?.generated_birthday_month||e?.generated_birthday_day||e?.generated_extra_information||e?.generated_relationship||e?.generated_friendship||e?.generated_love||e?.generated_inventory),La=e=>{const t=(()=>{if(!(e?. instanceof Map))return!1;if(0===e..size)return!0;for(const[t,a]of e.)if(!a||!a.trim())return!1;return!0})();return!!(e?.?.trim()&&e?.?.trim()&&null!==e?.&&e?.?.trim()&&e?.?.trim()&&null!==e?.&&null!==e?.&&null!==e?.&&e?.?.trim()&&null!==e?.&&null!==e?.&&e?.?.trim()&&e?.?.trim()&&e?.?.trim()&&e?.?.trim()&&e?.?.trim()&&e?.?.trim()&&null!==e?.&&null!==e?.&&null!==e?.&&null!==e?.&&null!==e?.&&e?.?.trim()&&t)},Ua=(0,t.computed)(()=>{try{const e=getVariables({type:'chat'});return!!e?.world_info?.trim()}catch{return!1}}),Fa=e=>{['generated_surname','generated_name','generated_age','generated_gender','generated_identity','generated_height','generated_weight','generated_chest_size','generated_cup_size','generated_waist_size','generated_hips_size','generated_hairstyle','generated_appearance','generated_clothes','generated_introduction','generated_personality','generated_favourite','generated_money','generated_mood','generated_sexuality','generated_birthday_month','generated_birthday_day','generated_extra_information','generated_relationship','generated_selected_relation_target','generated_friendship','generated_love','generated_inventory'].forEach(t=>{e[t]||(e[t]='')}),e.generation_requirement||(e.generation_requirement='')},Pa=e=>{!e.||'object'!=typeof e.||e. instanceof Map?e.||(e.=new Map):e.=new Map(Object.entries(e.)),!e.||'object'!=typeof e.||e. instanceof Map?e.||(e.=new Map):e.=new Map(Object.entries(e.)),!e.||'object'!=typeof e.||e. instanceof Map?e.||(e.=new Map):e.=new Map(Object.entries(e.)),!e.||'object'!=typeof e.||e. instanceof Map?e.||(e.=new Map):e.=new Map(Object.entries(e.)),e.selected_relation_target||(e.selected_relation_target=''),e.selected_friendship_target||(e.selected_friendship_target=''),e.selected_love_target||(e.selected_love_target=''),e.selected_inventory_item||(e.selected_inventory_item=''),void 0!==e.selected_inventory_quantity&&null!==e.selected_inventory_quantity||(e.selected_inventory_quantity=1)},ja=e=>{try{const t=getVariables({type:'chat'}),a={...t.characters||{}},n=c.value.get(e);if(!n)return;const r={:n.||'',:n.||'',:n.,:n.||'',:n.||'',:n.,:n.,:n.,:n.||'',:n.,:n.,:n.||'',:n.||'',:n.||'',:n.||'',:n.||'',:n.||'',:n.,:n.,:n.,:n.,:n.,:n.||'',:Object.fromEntries(n.||new Map),:Object.fromEntries(n.||new Map),:Object.fromEntries(n.||new Map),:Object.fromEntries(n.||new Map)};a[e]=r,t.characters=a,replaceVariables(t,{type:'chat'})}catch(t){console.error(` ${e} :`,t)}},Ha=e=>'['+Object.entries(e).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']',Ga=(e,t)=>{let a='\n</>\n';return a+='\n',a+=`${(()=>{const e=getVariables({type:'chat'}).characters.c1,t=`${e.}${e.}`;let a=`<${t}Status>\n`;return a+='idc1\n',a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${Ha(e.)}\n`,a+=`  ${Ha(e.)}\n`,a+=`  ${Ha(e.)}\n`,a+=`</${t}Status>`,a})()}\n`,a+='\n',a+=`${(e=>{const t=getVariables({type:'chat'}).characters;if(void 0===t)return'';let a='<CharacterStatus>\n';for(const[n,r]of Object.entries(t))'c1'!==n&&n!==e&&(a+=`id${n}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${r.||''}\n`,a+=`  ${Ha(r.)}\n`,a+=`  ${Ha(r.)}\n`,a+=`  ${Ha(r.)}\n\n`);return a+='</CharacterStatus>',a})(e)}\n`,a+='\n',a+=`${(()=>{let e='<ItemTable>\n';e+='|id||||\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).items;if(void 0===t)return'';for(const[a,n]of Object.entries(t))e+=`|${a}|${n.name}|${n.description}|${n.value}|\n`;return e+='</ItemTable>',e})()}\n`,a+='\n',a+=`${(()=>{let e='<LocationTable>\n';e+='|id|||||\n',e+='|---|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.location||''}|${n.description}|${t}|\n`}return e+='</LocationTable>',e})()}\n`,a+='\n',a+=`${(()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e})()}\n`,a+='\n',a+='<>\n',a+=`${t.generation_requirement||''}\n`,a+='</>\n',a+='\n',a+='<example>\n',a+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output. Output anything other than this format is prohibited.\n',a+='string\n',a+='string\n',a+='number\n',a+='\'\' | \'\' | \'\'\n',a+='\'\'\n',a+='number\n',a+='number\n',a+='number\n',a+='\'Capital Letter\' | \'\'\n',a+='number\n',a+='number\n',a+='\'\'\n',a+='\'\'\n',a+='\'\'\n',a+='\'\'\n',a+='\'\'\n',a+='\'\'\n',a+='number\n',a+='number[-100~100]\n',a+='number[0~100]\n',a+='number\n',a+='number\n',a+='\'\'\n',a+='[\'id\':\'\', ...]\n',a+='\'[\'id\':number[-1000~1000], ...]\'\n',a+='\'[\'id\':number[1~1000], ...]\'\n',a+='[\'item_id\':quantity, ...]\n',a+='</example>\n',a},qa=async e=>{const t=c.value.get(e);if(!t)return;const a=new Map($a.value);a.set(e,!0),$a.value=a;try{const a=(e=>{let t='\n\n';return t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${e.||''}\n`,t+=`${Ha(Object.fromEntries(e.||new Map))}\n`,t+=`${Ha(Object.fromEntries(e.||new Map))}\n`,t+=`${Ha(Object.fromEntries(e.||new Map))}\n`,t+=`${Ha(Object.fromEntries(e.||new Map))}\n`,t})(t),n=(()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='\n';return a+='\n',a+='<>\n','\n\n<>\n'})(),r=Ga(e,t);((e,t)=>{const a=e.split('\n');for(const e of a){const a=e.indexOf('');if(a>0){const n=e.substring(0,a).trim(),r=e.substring(a+1).trim();switch(n){case'':t.generated_surname=r.replace(/^["']|["']$/g,'');break;case'':t.generated_name=r.replace(/^["']|["']$/g,'');break;case'':t.generated_age=r.replace(/[^\d]/g,'');break;case'':t.generated_gender=r.replace(/^["']|["']$/g,'');break;case'':t.generated_identity=r.replace(/^["']|["']$/g,'');break;case'':t.generated_height=r.replace(/[^\d]/g,'');break;case'':t.generated_weight=r.replace(/[^\d]/g,'');break;case'':t.generated_chest_size=r.replace(/[^\d]/g,'');break;case'':t.generated_cup_size=r.replace(/^["']|["']$/g,'');break;case'':t.generated_waist_size=r.replace(/[^\d]/g,'');break;case'':t.generated_hips_size=r.replace(/[^\d]/g,'');break;case'':t.generated_hairstyle=r.replace(/^["']|["']$/g,'');break;case'':t.generated_appearance=r.replace(/^["']|["']$/g,'');break;case'':t.generated_clothes=r.replace(/^["']|["']$/g,'');break;case'':t.generated_introduction=r.replace(/^["']|["']$/g,'');break;case'':t.generated_personality=r.replace(/^["']|["']$/g,'');break;case'':t.generated_favourite=r.replace(/^["']|["']$/g,'');break;case'':t.generated_money=r.replace(/[^\d]/g,'');break;case'':t.generated_mood=r.replace(/[^\d]/g,'');break;case'':t.generated_sexuality=r.replace(/[^\d]/g,'');break;case'':t.generated_birthday_month=r.replace(/[^\d]/g,'');break;case'':t.generated_birthday_day=r.replace(/[^\d]/g,'');break;case'':t.generated_extra_information=r.replace(/^["']|["']$/g,'');break;case'':t.generated_relationship=r.replace(/^["']|["']$/g,'');break;case'':t.generated_friendship=r.replace(/^["']|["']$/g,'');break;case'':t.generated_love=r.replace(/^["']|["']$/g,'');break;case'':t.generated_inventory=r.replace(/^["']|["']$/g,'')}}}})(await generateRaw({user_input:a,ordered_prompts:[{role:'system',content:n},'char_description',{role:'system',content:r},'user_input']}),t);try{localStorage.setItem(`character_profile_generated_${e}`,JSON.stringify({generation_requirement:t.generation_requirement,generated_surname:t.generated_surname,generated_name:t.generated_name,generated_age:t.generated_age,generated_gender:t.generated_gender,generated_identity:t.generated_identity,generated_height:t.generated_height,generated_weight:t.generated_weight,generated_chest_size:t.generated_chest_size,generated_cup_size:t.generated_cup_size,generated_waist_size:t.generated_waist_size,generated_hips_size:t.generated_hips_size,generated_hairstyle:t.generated_hairstyle,generated_appearance:t.generated_appearance,generated_clothes:t.generated_clothes,generated_introduction:t.generated_introduction,generated_personality:t.generated_personality,generated_favourite:t.generated_favourite,generated_money:t.generated_money,generated_mood:t.generated_mood,generated_sexuality:t.generated_sexuality,generated_birthday_month:t.generated_birthday_month,generated_birthday_day:t.generated_birthday_day,generated_extra_information:t.generated_extra_information,generated_relationship:t.generated_relationship,generated_friendship:t.generated_friendship,generated_love:t.generated_love,generated_inventory:t.generated_inventory}))}catch(t){console.error(`Failed to save generated character profile for ${e} to localStorage:`,t)}c.value.set(e,{...t})}catch(a){console.error(` ${e} :`,a),t.generated_age=''}finally{const t=new Map($a.value);t.set(e,!1),$a.value=t}};(0,t.watch)(()=>getVariables({type:'chat'}),e=>{if(e?.characters){const a=new Map;for(const[n,r]of Object.entries(e.characters)){const e=(0,t.reactive)(r);Fa(e),Pa(e),a.set(n,e)}c.value=a}},{deep:!0}),(0,t.watch)(c,()=>{for(const[e]of c.value.entries())ja(e)},{deep:!0}),(0,t.watch)(()=>c.value,e=>{for(const[a,n]of e.entries())(0,t.watch)(()=>n.generation_requirement,e=>{try{const t=localStorage.getItem(`character_profile_generated_${a}`),n=t?JSON.parse(t):{};n.generation_requirement=e,localStorage.setItem(`character_profile_generated_${a}`,JSON.stringify(n))}catch(e){console.error(`Failed to save generation_requirement for ${a} to localStorage:`,e)}},{immediate:!1})},{deep:!0,immediate:!0}),(0,t.onMounted)(()=>{(()=>{try{const e=getVariables({type:'chat'});if(e?.characters){const a=new Map;for(const[n,r]of Object.entries(e.characters)){const e=(0,t.reactive)(r);Fa(e),Pa(e),a.set(n,e)}c.value=a}else c.value=new Map}catch(e){console.error(':',e),c.value=new Map}try{for(const[e,t]of c.value){const a=localStorage.getItem(`character_profile_generated_${e}`);a&&Object.assign(t,JSON.parse(a))}}catch(e){console.error('Failed to load generated character profiles from localStorage:',e)}})()});const Xa=()=>{const e=(()=>{const e=Array.from(c.value.keys());let t=2;for(;e.includes(`c${t}`);)t++;return`c${t}`})(),a={:'',:'',:null,:'',:'',:null,:null,:null,:'',:null,:null,:'',:'',:'',:'',:'',:'',:null,:50,:0,:null,:null,:'',:new Map,selected_relation_target:'',:new Map,:new Map,selected_friendship_target:'',selected_love_target:'',:new Map,selected_inventory_item:'',selected_inventory_quantity:1,generation_requirement:'',generated_surname:'',generated_name:'',generated_age:'',generated_gender:'',generated_identity:'',generated_height:'',generated_weight:'',generated_chest_size:'',generated_cup_size:'',generated_waist_size:'',generated_hips_size:'',generated_hairstyle:'',generated_appearance:'',generated_clothes:'',generated_introduction:'',generated_personality:'',generated_favourite:'',generated_money:'',generated_mood:'',generated_sexuality:'',generated_birthday_month:'',generated_birthday_day:'',generated_extra_information:''},n=(0,t.reactive)(a);c.value.set(e,n);try{const t=getVariables({type:'chat'}).characters||{};t[e]={:'',:'',:null,:'',:'',:null,:null,:null,:'',:null,:null,:'',:'',:'',:'',:'',:'',:null,:50,:0,:null,:null,:'',:{},:{},:{}},insertOrAssignVariables({characters:t},{type:'chat'})}catch(e){console.error('Failed to add new character to chat variables:',e)}},Wa=(e,t,a,n,r)=>{const o=c.value.get(e);if(!o)return;const l=o[t];l||(o[t]=new Map);const i=new Map(l),s=r?r(n):n;i.set(a,s),o[t]=i,c.value.set(e,{...o}),ja(e)},Ja=(e,t,a,n)=>{const r=c.value.get(e);if(!r)return;const o=r[a];if(!o)return;r[t]||(r[t]=new Map),r[t].set(o,n),r[a]='',c.value.set(e,{...r}),ja(e)},Za=(e,t,a)=>{const n=c.value.get(e);if(!n)return;const r=n[t];if(!r)return;const o=new Map(r);o.delete(a),n[t]=o,c.value.set(e,{...n}),ja(e)};return(e,Da)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',u,[Da[68]||(Da[68]=(0,t.createElementVNode)('h3',null,'',-1)),(0,t.createCommentVNode)('  '),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Ra.value,([e,u])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:(0,t.normalizeClass)(['character-fold-bar',{'character-incomplete':!La(u)}])},[(0,t.createVNode)(d,{title:`${e}: ${za(u)}`,'is-open':!1},{'title-actions':(0,t.withCtx)(()=>[(0,t.createElementVNode)('button',{class:'remove-character-btn',title:'',onClick:t=>(e=>{c.value.delete(e);try{const t=getVariables({type:'chat'});delete t.characters[e],replaceVariables(t,{type:'chat'})}catch(t){console.error(`Failed to remove character ${e} from chat variables:`,t)}})(e)},[...Da[0]||(Da[0]=[(0,t.createElementVNode)('span',null,'',-1)])],8,p)]),default:(0,t.withCtx)(()=>[(0,t.createElementVNode)('div',m,[(0,t.createElementVNode)('div',g,[Da[27]||(Da[27]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',v,[(0,t.createElementVNode)('div',b,[Da[2]||(Da[2]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':e=>u.=e,type:'text',placeholder:'',class:'text-input'},null,8,f),[[t.vModelText,u.]]),u.generated_surname?((0,t.openBlock)(),(0,t.createElementBlock)('div',h,[Da[1]||(Da[1]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',x,(0,t.toDisplayString)(u.generated_surname),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_surname)},'  ',8,E)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',y,[Da[4]||(Da[4]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':e=>u.=e,type:'text',placeholder:'',class:'text-input'},null,8,k),[[t.vModelText,u.]]),u.generated_name?((0,t.openBlock)(),(0,t.createElementBlock)('div',N,[Da[3]||(Da[3]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',V,(0,t.toDisplayString)(u.generated_name),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_name)},'  ',8,w)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',S,[Da[6]||(Da[6]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('input',{value:a(u,''),type:'number',placeholder:'18',class:'text-input',min:'0',max:'200',onInput:e=>n(u,'',e.target.value)},null,40,C),u.generated_age?((0,t.openBlock)(),(0,t.createElementBlock)('div',T,[Da[5]||(Da[5]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',B,(0,t.toDisplayString)(u.generated_age),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_age)},'  ',8,I)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',D,[Da[8]||(Da[8]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':e=>u.=e,type:'text',placeholder:'',class:'text-input'},null,8,R),[[t.vModelText,u.]]),u.generated_gender?((0,t.openBlock)(),(0,t.createElementBlock)('div',M,[Da[7]||(Da[7]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Y,(0,t.toDisplayString)(u.generated_gender),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_gender)},'  ',8,A)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',O,[Da[10]||(Da[10]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':e=>u.=e,type:'text',placeholder:'',class:'text-input'},null,8,K),[[t.vModelText,u.]]),u.generated_identity?((0,t.openBlock)(),(0,t.createElementBlock)('div',L,[Da[9]||(Da[9]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',U,(0,t.toDisplayString)(u.generated_identity),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_identity)},'  ',8,F)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',P,[Da[12]||(Da[12]=(0,t.createElementVNode)('label',null,' (cm)',-1)),(0,t.createElementVNode)('input',{value:a(u,''),type:'number',placeholder:'165',class:'text-input',min:'0',max:'300',onInput:e=>n(u,'',e.target.value)},null,40,j),u.generated_height?((0,t.openBlock)(),(0,t.createElementBlock)('div',H,[Da[11]||(Da[11]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',G,(0,t.toDisplayString)(u.generated_height),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_height)},'  ',8,q)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',X,[Da[14]||(Da[14]=(0,t.createElementVNode)('label',null,' (kg)',-1)),(0,t.createElementVNode)('input',{value:a(u,''),type:'number',placeholder:'50',class:'text-input',min:'0',max:'500',onInput:e=>n(u,'',e.target.value)},null,40,W),u.generated_weight?((0,t.openBlock)(),(0,t.createElementBlock)('div',J,[Da[13]||(Da[13]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Z,(0,t.toDisplayString)(u.generated_weight),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_weight)},'  ',8,Q)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',ee,[Da[16]||(Da[16]=(0,t.createElementVNode)('label',null,' (cm)',-1)),(0,t.createElementVNode)('input',{value:a(u,''),type:'number',placeholder:'85',class:'text-input',min:'0',max:'200',onInput:e=>n(u,'',e.target.value)},null,40,te),u.generated_chest_size?((0,t.openBlock)(),(0,t.createElementBlock)('div',ae,[Da[15]||(Da[15]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',ne,(0,t.toDisplayString)(u.generated_chest_size),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_chest_size)},'  ',8,re)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',oe,[Da[18]||(Da[18]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':e=>u.=e,type:'text',placeholder:'C',class:'text-input'},null,8,le),[[t.vModelText,u.]]),u.generated_cup_size?((0,t.openBlock)(),(0,t.createElementBlock)('div',ie,[Da[17]||(Da[17]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',se,(0,t.toDisplayString)(u.generated_cup_size),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_cup_size)},'  ',8,ce)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',de,[Da[20]||(Da[20]=(0,t.createElementVNode)('label',null,' (cm)',-1)),(0,t.createElementVNode)('input',{value:a(u,''),type:'number',placeholder:'60',class:'text-input',min:'0',max:'200',onInput:e=>n(u,'',e.target.value)},null,40,ue),u.generated_waist_size?((0,t.openBlock)(),(0,t.createElementBlock)('div',pe,[Da[19]||(Da[19]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',me,(0,t.toDisplayString)(u.generated_waist_size),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_waist_size)},'  ',8,ge)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',ve,[Da[22]||(Da[22]=(0,t.createElementVNode)('label',null,' (cm)',-1)),(0,t.createElementVNode)('input',{value:a(u,''),type:'number',placeholder:'88',class:'text-input',min:'0',max:'200',onInput:e=>n(u,'',e.target.value)},null,40,be),u.generated_hips_size?((0,t.openBlock)(),(0,t.createElementBlock)('div',fe,[Da[21]||(Da[21]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',he,(0,t.toDisplayString)(u.generated_hips_size),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_hips_size)},'  ',8,xe)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',_e,[Da[24]||(Da[24]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':e=>u.=e,type:'text',placeholder:'',class:'text-input'},null,8,Ee),[[t.vModelText,u.]]),u.generated_hairstyle?((0,t.openBlock)(),(0,t.createElementBlock)('div',ye,[Da[23]||(Da[23]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',ke,(0,t.toDisplayString)(u.generated_hairstyle),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_hairstyle)},'  ',8,Ne)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Ve,[Da[26]||(Da[26]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',we,[(0,t.createElementVNode)('input',{value:a(u,''),type:'number',placeholder:'',class:'birthday-input',min:'1',max:'12',onInput:e=>n(u,'',e.target.value)},null,40,Se),(0,t.createElementVNode)('input',{value:a(u,''),type:'number',placeholder:'',class:'birthday-input',min:'1',max:'31',onInput:e=>n(u,'',e.target.value)},null,40,Ce)]),u.generated_birthday_month||u.generated_birthday_day?((0,t.openBlock)(),(0,t.createElementBlock)('div',Te,[Da[25]||(Da[25]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Be,(0,t.toDisplayString)(u.generated_birthday_month)+' '+(0,t.toDisplayString)(u.generated_birthday_day)+' ',1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',`${u.generated_birthday_month}-${u.generated_birthday_day}`)},'  ',8,Ie)])):(0,t.createCommentVNode)('v-if',!0)])])]),(0,t.createElementVNode)('div',$e,[Da[32]||(Da[32]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',De,[(0,t.createElementVNode)('div',Re,[Da[29]||(Da[29]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':e=>u.=e,placeholder:'...',class:'text-area',rows:'3'},null,8,Me),[[t.vModelText,u.]]),u.generated_appearance?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ye,[Da[28]||(Da[28]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Ae,(0,t.toDisplayString)(u.generated_appearance),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_appearance)},'  ',8,ze)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Oe,[Da[31]||(Da[31]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':e=>u.=e,placeholder:'...',class:'text-area',rows:'3'},null,8,Ke),[[t.vModelText,u.]]),u.generated_clothes?((0,t.openBlock)(),(0,t.createElementBlock)('div',Le,[Da[30]||(Da[30]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Ue,(0,t.toDisplayString)(u.generated_clothes),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_clothes)},'  ',8,Fe)])):(0,t.createCommentVNode)('v-if',!0)])])]),(0,t.createElementVNode)('div',Pe,[Da[39]||(Da[39]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',je,[(0,t.createElementVNode)('div',He,[Da[34]||(Da[34]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':e=>u.=e,placeholder:'...',class:'text-area',rows:'3'},null,8,Ge),[[t.vModelText,u.]]),u.generated_introduction?((0,t.openBlock)(),(0,t.createElementBlock)('div',qe,[Da[33]||(Da[33]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Xe,(0,t.toDisplayString)(u.generated_introduction),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_introduction)},'  ',8,We)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Je,[Da[36]||(Da[36]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':e=>u.=e,placeholder:'...',class:'text-area',rows:'3'},null,8,Ze),[[t.vModelText,u.]]),u.generated_personality?((0,t.openBlock)(),(0,t.createElementBlock)('div',Qe,[Da[35]||(Da[35]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',et,(0,t.toDisplayString)(u.generated_personality),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_personality)},'  ',8,tt)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',at,[Da[38]||(Da[38]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':e=>u.=e,placeholder:'...',class:'text-area',rows:'3'},null,8,nt),[[t.vModelText,u.]]),u.generated_favourite?((0,t.openBlock)(),(0,t.createElementBlock)('div',rt,[Da[37]||(Da[37]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',ot,(0,t.toDisplayString)(u.generated_favourite),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_favourite)},'  ',8,lt)])):(0,t.createCommentVNode)('v-if',!0)])])]),(0,t.createElementVNode)('div',it,[Da[64]||(Da[64]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',st,[(0,t.createElementVNode)('div',ct,[Da[41]||(Da[41]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('input',{value:a(u,''),type:'number',placeholder:'10000',class:'text-input',min:'0',onInput:e=>n(u,'',e.target.value)},null,40,dt),u.generated_money?((0,t.openBlock)(),(0,t.createElementBlock)('div',ut,[Da[40]||(Da[40]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',pt,(0,t.toDisplayString)(u.generated_money),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_money)},'  ',8,mt)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',gt,[Da[43]||(Da[43]=(0,t.createElementVNode)('label',null,' (-100~100)',-1)),(0,t.createElementVNode)('input',{value:a(u,''),type:'number',placeholder:'50',class:'text-input',min:'0',max:'100',onInput:e=>n(u,'',e.target.value)},null,40,vt),u.generated_mood?((0,t.openBlock)(),(0,t.createElementBlock)('div',bt,[Da[42]||(Da[42]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',ft,(0,t.toDisplayString)(u.generated_mood),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_mood)},'  ',8,ht)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',xt,[Da[45]||(Da[45]=(0,t.createElementVNode)('label',null,' (0~100)',-1)),(0,t.createElementVNode)('input',{value:a(u,''),type:'number',placeholder:'0',class:'text-input',min:'0',max:'100',onInput:e=>n(u,'',e.target.value)},null,40,_t),u.generated_sexuality?((0,t.openBlock)(),(0,t.createElementBlock)('div',Et,[Da[44]||(Da[44]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',yt,(0,t.toDisplayString)(u.generated_sexuality),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_sexuality)},'  ',8,kt)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Nt,[Da[47]||(Da[47]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':e=>u.=e,placeholder:'...',class:'text-area',rows:'3'},null,8,Vt),[[t.vModelText,u.]]),u.generated_extra_information?((0,t.openBlock)(),(0,t.createElementBlock)('div',wt,[Da[46]||(Da[46]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',St,(0,t.toDisplayString)(u.generated_extra_information),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_extra_information)},'  ',8,Ct)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Tt,[Da[51]||(Da[51]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Bt,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Array.from(u.||new Map),([a,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:a,class:'relation-item'},[(0,t.createElementVNode)('span',It,'['+(0,t.toDisplayString)(a)+'] '+(0,t.toDisplayString)(Oa(a)),1),Da[48]||(Da[48]=(0,t.createTextVNode)('  ',-1)),(0,t.createElementVNode)('input',{value:n,type:'text',placeholder:'',class:'relation-input',onInput:t=>((e,t,a)=>Wa(e,'',t,a))(e,a,t.target.value)},null,40,$t),(0,t.createElementVNode)('button',{class:'remove-relation-btn',onClick:t=>((e,t)=>Za(e,'',t))(e,a)},'',8,Dt)]))),128)),(0,t.createElementVNode)('div',Rt,[(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':e=>u.selected_relation_target=e,class:'relation-select'},[Da[49]||(Da[49]=(0,t.createElementVNode)('option',{value:''},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Ma(e),([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e,value:e},(0,t.toDisplayString)(`${e}: ${a.||''}${a.||''}`),9,Yt))),128))],8,Mt),[[t.vModelSelect,u.selected_relation_target]]),(0,t.createElementVNode)('button',{class:'add-relation-btn',disabled:!u.selected_relation_target,onClick:t=>(e=>Ja(e,'','selected_relation_target',''))(e)},'  ',8,At)])]),u.generated_relationship?((0,t.openBlock)(),(0,t.createElementBlock)('div',zt,[Da[50]||(Da[50]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Ot,(0,t.toDisplayString)(u.generated_relationship),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_relationship)},'  ',8,Kt)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Lt,[Da[55]||(Da[55]=(0,t.createElementVNode)('label',null,' (-1000~1000)',-1)),(0,t.createElementVNode)('div',Ut,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Array.from(u.||new Map),([a,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:a,class:'relation-item'},[(0,t.createElementVNode)('span',Ft,'['+(0,t.toDisplayString)(a)+'] '+(0,t.toDisplayString)(Oa(a)),1),Da[52]||(Da[52]=(0,t.createTextVNode)(' : ',-1)),(0,t.createElementVNode)('input',{value:n,type:'number',placeholder:'',class:'relation-input',min:'0',max:'100',onInput:t=>((e,t,a)=>Wa(e,'',t,a,e=>parseInt(e)||0))(e,a,t.target.value)},null,40,Pt),(0,t.createElementVNode)('button',{class:'remove-relation-btn',onClick:t=>((e,t)=>Za(e,'',t))(e,a)},'',8,jt)]))),128)),(0,t.createElementVNode)('div',Ht,[(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':e=>u.selected_friendship_target=e,class:'relation-select'},[Da[53]||(Da[53]=(0,t.createElementVNode)('option',{value:''},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Ma(e),([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e,value:e},(0,t.toDisplayString)(`${e}: ${a.||''}${a.||''}`),9,qt))),128))],8,Gt),[[t.vModelSelect,u.selected_friendship_target]]),(0,t.createElementVNode)('button',{class:'add-relation-btn',disabled:!u.selected_friendship_target,onClick:t=>(e=>Ja(e,'','selected_friendship_target',0))(e)},'  ',8,Xt)])]),u.generated_friendship?((0,t.openBlock)(),(0,t.createElementBlock)('div',Wt,[Da[54]||(Da[54]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Jt,(0,t.toDisplayString)(u.generated_friendship),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_friendship)},'  ',8,Zt)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Qt,[Da[59]||(Da[59]=(0,t.createElementVNode)('label',null,' (0~1000)',-1)),(0,t.createElementVNode)('div',ea,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Array.from(u.||new Map),([a,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:a,class:'relation-item'},[(0,t.createElementVNode)('span',ta,'['+(0,t.toDisplayString)(a)+'] '+(0,t.toDisplayString)(Oa(a)),1),Da[56]||(Da[56]=(0,t.createTextVNode)(' : ',-1)),(0,t.createElementVNode)('input',{value:n,type:'number',placeholder:'',class:'relation-input',min:'0',max:'100',onInput:t=>((e,t,a)=>Wa(e,'',t,a,e=>parseInt(e)||0))(e,a,t.target.value)},null,40,aa),(0,t.createElementVNode)('button',{class:'remove-relation-btn',onClick:t=>((e,t)=>Za(e,'',t))(e,a)},'',8,na)]))),128)),(0,t.createElementVNode)('div',ra,[(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':e=>u.selected_love_target=e,class:'relation-select'},[Da[57]||(Da[57]=(0,t.createElementVNode)('option',{value:''},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Ma(e),([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e,value:e},(0,t.toDisplayString)(`${e}: ${a.||''}${a.||''}`),9,la))),128))],8,oa),[[t.vModelSelect,u.selected_love_target]]),(0,t.createElementVNode)('button',{class:'add-relation-btn',disabled:!u.selected_love_target,onClick:t=>(e=>Ja(e,'','selected_love_target',0))(e)},'  ',8,ia)])]),u.generated_love?((0,t.openBlock)(),(0,t.createElementBlock)('div',sa,[Da[58]||(Da[58]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',ca,(0,t.toDisplayString)(u.generated_love),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_love)},'  ',8,da)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',ua,[Da[63]||(Da[63]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',pa,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Array.from(u.||new Map),([a,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:a,class:'inventory-item'},[(0,t.createElementVNode)('span',ma,'['+(0,t.toDisplayString)(a)+'] '+(0,t.toDisplayString)(Aa(a)),1),Da[60]||(Da[60]=(0,t.createTextVNode)(' : ',-1)),(0,t.createElementVNode)('input',{value:n,type:'number',placeholder:'',class:'inventory-input',min:'1',onInput:t=>((e,t,a)=>{const n=c.value.get(e);if(!n)return;n.||(n.=new Map);const r=new Map(n.);a>0?r.set(t,a):r.delete(t),n.=r,ja(e)})(e,a,parseInt(t.target.value)||1)},null,40,ga),(0,t.createElementVNode)('button',{class:'remove-inventory-btn',onClick:t=>((e,t)=>{const a=c.value.get(e);if(!a||!a.)return;const n=new Map(a.);n.delete(t),a.=n,ja(e)})(e,a)},'',8,va)]))),128)),(0,t.createElementVNode)('div',ba,[(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':e=>u.selected_inventory_item=e,class:'inventory-select'},[Da[61]||(Da[61]=(0,t.createElementVNode)('option',{value:''},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Ya(),([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e,value:e},(0,t.toDisplayString)(`${e}: ${a.name||''}`),9,ha))),128))],8,fa),[[t.vModelSelect,u.selected_inventory_item]]),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':e=>u.selected_inventory_quantity=e,type:'number',placeholder:'',class:'quantity-input',min:'1',disabled:!u.selected_inventory_item},null,8,xa),[[t.vModelText,u.selected_inventory_quantity,void 0,{number:!0}]]),(0,t.createElementVNode)('button',{class:'add-inventory-btn',disabled:!u.selected_inventory_item||!u.selected_inventory_quantity,onClick:t=>(e=>{const t=c.value.get(e);if(!t||!t.selected_inventory_item||!t.selected_inventory_quantity)return;t.||(t.=new Map);const a=t..get(t.selected_inventory_item)||0;t..set(t.selected_inventory_item,a+t.selected_inventory_quantity),t.selected_inventory_item='',t.selected_inventory_quantity=1,ja(e)})(e)},'  ',8,_a)])]),u.generated_inventory?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ea,[Da[62]||(Da[62]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',ya,(0,t.toDisplayString)(u.generated_inventory),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>r(e,'',u.generated_inventory)},'  ',8,ka)])):(0,t.createCommentVNode)('v-if',!0)])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Na,[Da[66]||(Da[66]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',Va,[(0,t.createElementVNode)('div',wa,[Da[65]||(Da[65]=(0,t.createElementVNode)('label',null,'AI',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':e=>u.generation_requirement=e,placeholder:'AI...',class:'text-area',rows:'3'},null,8,Sa),[[t.vModelText,u.generation_requirement]])])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Ca,[(0,t.createElementVNode)('button',{class:'generate-btn',disabled:!Ua.value||$a.value.get(e),onClick:t=>qa(e)},[$a.value.get(e)?((0,t.openBlock)(),(0,t.createElementBlock)('span',Ba)):(0,t.createCommentVNode)('v-if',!0),(0,t.createTextVNode)(' '+(0,t.toDisplayString)($a.value.get(e)?'...':Ua.value?'':''),1)],8,Ta),(0,t.createElementVNode)('button',{class:'apply-all-btn',disabled:!Ka(u),onClick:t=>(e=>{const t=c.value.get(e);if(!t)return;[{generated:'generated_surname',field:'',parser:e=>e},{generated:'generated_name',field:'',parser:e=>e},{generated:'generated_age',field:'',parser:e=>parseInt(e)||null},{generated:'generated_gender',field:'',parser:e=>e},{generated:'generated_identity',field:'',parser:e=>e},{generated:'generated_height',field:'',parser:e=>parseInt(e)||null},{generated:'generated_weight',field:'',parser:e=>parseInt(e)||null},{generated:'generated_chest_size',field:'',parser:e=>parseInt(e)||null},{generated:'generated_cup_size',field:'',parser:e=>e},{generated:'generated_waist_size',field:'',parser:e=>parseInt(e)||null},{generated:'generated_hips_size',field:'',parser:e=>parseInt(e)||null},{generated:'generated_hairstyle',field:'',parser:e=>e},{generated:'generated_appearance',field:'',parser:e=>e},{generated:'generated_clothes',field:'',parser:e=>e},{generated:'generated_introduction',field:'',parser:e=>e},{generated:'generated_personality',field:'',parser:e=>e},{generated:'generated_favourite',field:'',parser:e=>e},{generated:'generated_money',field:'',parser:e=>parseInt(e)||null},{generated:'generated_mood',field:'',parser:e=>parseInt(e)||null},{generated:'generated_sexuality',field:'',parser:e=>parseInt(e)||null},{generated:'generated_birthday_month',field:'',parser:e=>parseInt(e)||null},{generated:'generated_birthday_day',field:'',parser:e=>parseInt(e)||null},{generated:'generated_extra_information',field:'',parser:e=>e}].forEach(({generated:e,field:a,parser:n})=>{const r=t[e];r&&(t[a]=n(r),t[e]='')}),t.generated_relationship&&o(t,t.generated_relationship),t.generated_friendship&&l(t,t.generated_friendship),t.generated_love&&i(t,t.generated_love),t.generated_inventory&&s(t,t.generated_inventory),c.value.set(e,{...t}),ja(e);try{localStorage.removeItem(`character_profile_generated_${e}`)}catch(t){console.error(`Failed to remove generated character profile for ${e} from localStorage:`,t)}})(e)},'  ',8,Ia)])])]),_:2},1032,['title'])],2))),128)),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',{class:'add-character-section'},[(0,t.createElementVNode)('button',{class:'add-character-btn',onClick:Xa},[...Da[67]||(Da[67]=[(0,t.createElementVNode)('span',null,'+ ',-1)])])])]))}});n(6621);const Da=(0,c.A)($a,[['__scopeId','data-v-41c909bc']]),Ra={class:'extra-container'},Ma={class:'section'},Ya={class:'sortable-container'},Aa={key:0,class:'drop-indicator'},za=['data-id','onDragstart','onDragover','onDrop'],Oa=['onClick'],Ka={class:'fold-content'},La={class:'input-group'},Ua=['onUpdate:modelValue'],Fa={class:'input-group'},Pa=['onUpdate:modelValue'],ja={class:'input-group'},Ha=['onUpdate:modelValue'],Ga={key:0,class:'generated-result'},qa={class:'generated-text'},Xa=['onClick'],Wa={class:'item-actions'},Ja=['disabled','onClick'],Za={key:0,class:'loading-spinner'},Qa=['disabled','onClick'],en={key:0,class:'drop-indicator'},tn=(0,t.defineComponent)({__name:'extra_tab',setup(e){const a=(0,t.ref)([]),n=(0,t.ref)(new Map),r=(0,t.computed)(()=>{try{const e=getVariables({type:'chat'});return!!e?.world_info?.trim()}catch{return!1}}),o=(0,t.ref)(null),l=(0,t.ref)(null),i=e=>{const t=a.value[e];if(t&&t.generated_content){t.content=t.generated_content,t.generated_content='',a.value[e]={...t};try{t.name&&t.name.trim()&&localStorage.removeItem(`extra_item_generated_${t.name.trim()}`)}catch(e){console.error(`Failed to remove generated extra item for ${t.name} from localStorage:`,e)}}},s=()=>{const e={id:Date.now().toString(),name:'',content:'',generation_requirement:'',is_open:!1,generated_content:''};a.value.push(e)},c=()=>{try{const e=getVariables({type:'chat'}),t=a.value.map(e=>({name:e.name,content:e.content}));e.extra_world_info=t,replaceVariables(e,{type:'chat'}),(()=>{const e=getVariables({type:'chat'});let t='';for(const a of Array.from(e.extra_world_info))''!==a.name.trim()&&''!==a.content.trim()&&(t+=`<${a.name}>\n`,t+=`${a.content}\n`,t+=`</${a.name}>\n`,t+='\n');e.extra_world_info_prompt=t,replaceVariables(e,{type:'chat'})})()}catch(e){console.error(' extra_world_info :',e)}},u=()=>{try{const e=getVariables({type:'chat'});if(e?.extra_world_info&&Array.isArray(e.extra_world_info)){const t=e.extra_world_info.map((e,t)=>({id:`loaded_${t}_${Date.now()}`,name:e.name||'',content:e.content||'',generation_requirement:'',is_open:!1,generated_content:''}));a.value=t}}catch(e){console.error(' extra_world_info :',e)}},p=()=>{l.value=null},m=()=>{o.value=null,l.value=null};(0,t.onMounted)(()=>{u(),g()});const g=()=>{try{const e=localStorage.getItem('extra_tab_generation_requirements');if(e){const t=JSON.parse(e);a.value.forEach(e=>{e.name&&e.name.trim()&&t[e.name.trim()]&&(e.generation_requirement=t[e.name.trim()])})}a.value.forEach(e=>{if(e.name&&e.name.trim()){const t=localStorage.getItem(`extra_item_generated_${e.name.trim()}`);if(t)try{const a=JSON.parse(t);a[e.name.trim()]&&(e.generated_content=a[e.name.trim()])}catch(t){console.error(`Failed to parse generated content for ${e.name}:`,t)}}})}catch(e){console.error(' localStorage :',e)}};(0,t.watch)(a,()=>{c(),(()=>{try{const e={};a.value.forEach(t=>{t.name&&t.name.trim()&&(e[t.name.trim()]=t.generation_requirement)}),localStorage.setItem('extra_tab_generation_requirements',JSON.stringify(e))}catch(e){console.error(' localStorage :',e)}})()},{deep:!0}),(0,t.watch)(()=>getVariables({type:'chat'}),e=>{e?.extra_world_info&&u()},{deep:!0});const v=e=>{let t='\n\n';return t+=`${e.name||''}\n`,t+=`${e.content||''}\n`,t},b=()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='\n';return a+='\n',a+='<>\n','\n\n<>\n'},f=e=>{let t='\n</>\n';return t+='\n',t+=`${(()=>{const e=getVariables({type:'chat'}).characters.c1,t=`${e.}${e.}`;let a=`<${t}Status>\n`;return a+='idc1\n',a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${h(e.)}\n`,a+=`  ${h(e.)}\n`,a+=`  ${h(e.)}\n`,a+=`</${t}Status>`,a})()}\n`,t+='\n',t+=`${(()=>{const e=getVariables({type:'chat'}).characters;if(void 0===e)return'';let t='<CharacterStatus>\n';for(const[a,n]of Object.entries(e))'c1'!==a&&(t+=`id${a}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${h(n.)}\n`,t+=`  ${h(n.)}\n`,t+=`  ${h(n.)}\n\n`);return t+='</CharacterStatus>',t})()}\n`,t+='\n',t+=`${(()=>{let e='<ItemTable>\n';e+='|id||||\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).items;if(void 0===t)return'';for(const[a,n]of Object.entries(t))e+=`|${a}|${n.name}|${n.description}|${n.value}|\n`;return e+='</ItemTable>',e})()}\n`,t+='\n',t+=`${(()=>{let e='<LocationTable>\n';e+='|id|||||\n',e+='|---|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.location||''}|${n.description}|${t}|\n`}return e+='</LocationTable>',e})()}\n`,t+='\n',t+=`${(()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e})()}\n`,t+='\n',t+='<>\n',t+=`${e.generation_requirement||''}\n`,t+='</>\n',t},h=e=>'['+Object.entries(e).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']',x=(e,t)=>{t.generated_content=e};return(e,c)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',Ra,[c[5]||(c[5]=(0,t.createElementVNode)('h3',null,'',-1)),(0,t.createElementVNode)('div',Ma,[(0,t.createElementVNode)('div',Ya,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(a.value,(e,s)=>((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,{key:e.id},[l.value===s&&null!==o.value&&o.value!==s?((0,t.openBlock)(),(0,t.createElementBlock)('div',Aa)):(0,t.createCommentVNode)('v-if',!0),(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['sortable-item',{dragging:o.value===s}]),'data-id':e.id,draggable:'true',onDragstart:e=>((e,t)=>{o.value=t,e.dataTransfer&&(e.dataTransfer.effectAllowed='move')})(e,s),onDragover:(0,t.withModifiers)(e=>((e,t)=>{e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect='move');const a=e.target.getBoundingClientRect(),n=e.clientY-a.top,r=a.height;l.value=n<r/2?t:t+1})(e,s),['prevent']),onDrop:e=>((e,t)=>{e.preventDefault();const n=o.value;if(null!==n&&n!==t){const e=[...a.value],[r]=e.splice(n,1);e.splice(t,0,r),a.value=e}o.value=null})(e,s),onDragend:m,onDragleave:p},[(0,t.createVNode)(d,{title:e.name||'','is-open':e.is_open,class:(0,t.normalizeClass)(['draggable-fold-bar',{incomplete:!e.name||!e.content}]),onToggle:e=>(e=>{a.value[e].is_open=!a.value[e].is_open})(s)},{'title-actions':(0,t.withCtx)(()=>[(0,t.createElementVNode)('button',{class:'remove-btn',title:'',onClick:(0,t.withModifiers)(e=>(e=>{a.value.splice(e,1)})(s),['stop'])},[...c[0]||(c[0]=[(0,t.createElementVNode)('span',null,'',-1)])],8,Oa)]),default:(0,t.withCtx)(()=>[(0,t.createElementVNode)('div',Ka,[(0,t.createElementVNode)('div',La,[c[1]||(c[1]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>e.name=t,type:'text',class:'form-input',placeholder:''},null,8,Ua),[[t.vModelText,e.name]])]),(0,t.createElementVNode)('div',Fa,[c[2]||(c[2]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':t=>e.content=t,class:'form-textarea',placeholder:'',rows:'3'},null,8,Pa),[[t.vModelText,e.content]])]),(0,t.createElementVNode)('div',ja,[c[3]||(c[3]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':t=>e.generation_requirement=t,class:'form-textarea',placeholder:'',rows:'2'},null,8,Ha),[[t.vModelText,e.generation_requirement]])]),e.generated_content?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ga,[c[4]||(c[4]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',qa,(0,t.toDisplayString)(e.generated_content),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:e=>i(s)},'',8,Xa)])):(0,t.createCommentVNode)('v-if',!0),(0,t.createElementVNode)('div',Wa,[(0,t.createElementVNode)('button',{class:'action-btn generate',disabled:!(0,t.unref)(r)||n.value.get(e.id),onClick:e=>(async e=>{const t=a.value[e];if(t){n.value.set(t.id,!0);try{const n=v(t),r=b(),o=f(t),l=await generateRaw({user_input:n,ordered_prompts:[{role:'system',content:r},'char_description',{role:'system',content:o},'user_input']});x(l,t);try{if(t.name&&t.name.trim()){const e={};e[t.name.trim()]=t.generated_content||'',localStorage.setItem(`extra_item_generated_${t.name.trim()}`,JSON.stringify(e))}}catch(e){console.error(`Failed to save generated extra item for ${t.name} to localStorage:`,e)}a.value[e]={...t}}catch(e){console.error(` ${t.name} :`,e)}finally{n.value.set(t.id,!1)}}})(s)},[n.value.get(e.id)?((0,t.openBlock)(),(0,t.createElementBlock)('span',Za)):(0,t.createCommentVNode)('v-if',!0),(0,t.createTextVNode)(' '+(0,t.toDisplayString)(n.value.get(e.id)?'...':(0,t.unref)(r)?'':''),1)],8,Ja),(0,t.createElementVNode)('button',{class:'action-btn apply',disabled:!e.generated_content,onClick:e=>i(s)},'  ',8,Qa)])])]),_:2},1032,['title','is-open','class','onToggle'])],42,za)],64))),128)),l.value===a.value.length&&null!==o.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',en)):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',{class:'add-item-section'},[(0,t.createElementVNode)('button',{class:'add-btn',onClick:s},'+ ')])])]))}});n(4166);const an=(0,c.A)(tn,[['__scopeId','data-v-09fb0ec2']]),nn={class:'item-tabs-container'},rn=['onClick'],on={class:'item-info-container'},ln={class:'section'},sn={class:'form-grid'},cn={class:'input-group'},dn=['onUpdate:modelValue'],un={key:0,class:'generated-result'},pn={class:'generated-text'},mn=['onClick'],gn={class:'input-group'},vn=['value','onInput'],bn={key:0,class:'generated-result'},fn={class:'generated-text'},hn=['onClick'],xn={class:'input-group full-width'},_n=['onUpdate:modelValue'],En={key:0,class:'generated-result'},yn={class:'generated-text'},kn=['onClick'],Nn={class:'section'},Vn={class:'form-grid'},wn={class:'input-group full-width'},Sn=['onUpdate:modelValue'],Cn={class:'action-section'},Tn=['disabled','onClick'],Bn={key:0,class:'loading-spinner'},In=['disabled','onClick'],$n=(0,t.defineComponent)({__name:'item_tab',setup(e){const a=(e,t)=>{const a=e[t];return a?.toString()||''},n=(0,t.ref)(new Map),r=(0,t.ref)(new Map),o=(0,t.computed)(()=>{try{const e=getVariables({type:'chat'});return!!e?.world_info?.trim()}catch{return!1}}),l=(0,t.computed)(()=>{const e=new Map;for(const[t,a]of n.value)e.set(t,a);return e}),i=(0,t.computed)(()=>Array.from(l.value.entries())),s=e=>e?.name||'',c=e=>!!(e?.generated_name||e?.generated_description||e?.generated_value),u=e=>!(!e?.name?.trim()||!e?.description?.trim()||null===e?.value),p=e=>{['generated_name','generated_description','generated_value'].forEach(t=>{e[t]||(e[t]='')}),e.generation_requirement||(e.generation_requirement='')},m=e=>{try{const t=getVariables({type:'chat'}),a={...t.items||{}},r=n.value.get(e);if(!r)return;a[e]={name:r.name||'',description:r.description||'',value:r.value},t.items=a,replaceVariables(t,{type:'chat'})}catch(t){console.error(` ${e} :`,t)}};(0,t.watch)(()=>getVariables({type:'chat'}),e=>{if(e?.items){const a=new Map;for(const[n,r]of Object.entries(e.items)){const e=(0,t.reactive)(r);p(e),a.set(n,e)}n.value=a}},{deep:!0}),(0,t.watch)(n,()=>{for(const[e]of n.value.entries())m(e)},{deep:!0}),(0,t.watch)(()=>n.value,e=>{for(const[a,n]of e.entries())(0,t.watch)(()=>n.generation_requirement,e=>{try{const t=localStorage.getItem(`item_profile_generated_${a}`),n=t?JSON.parse(t):{};n.generation_requirement=e,localStorage.setItem(`item_profile_generated_${a}`,JSON.stringify(n))}catch(e){console.error(`Failed to save generation_requirement for ${a} to localStorage:`,e)}},{immediate:!1})},{deep:!0,immediate:!0}),(0,t.onMounted)(()=>{(()=>{try{const e=getVariables({type:'chat'});if(e?.items){const a=new Map;for(const[n,r]of Object.entries(e.items)){const e=(0,t.reactive)(r);p(e),a.set(n,e)}n.value=a}else n.value=new Map}catch(e){console.error(':',e),n.value=new Map}try{for(const[e,t]of n.value){const a=localStorage.getItem(`item_profile_generated_${e}`);a&&Object.assign(t,JSON.parse(a))}}catch(e){console.error('Failed to load generated item profiles from localStorage:',e)}})()});const g=(e,t,a)=>{const r=n.value.get(e);if(!r)return;const o={name:{field:'name'},description:{field:'description'},value:{field:'value',parser:e=>parseInt(e)||null}}[t];if(o){const e=o.parser?o.parser(a):a;r[o.field]=e,r[`generated_${t}`]=''}n.value.set(e,{...r}),m(e)},v=e=>'['+Object.entries(e).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']',b=()=>{const e=(()=>{const e=Array.from(n.value.keys());let t=1;for(;e.includes(`i${t}`);)t++;return`i${t}`})(),a=(0,t.reactive)({name:'',description:'',value:null,generation_requirement:'',generated_name:'',generated_description:'',generated_value:''});n.value.set(e,a);try{const t=getVariables({type:'chat'}).items||{};t[e]={name:'',description:'',value:null},insertOrAssignVariables({items:t},{type:'chat'})}catch(e){console.error('Failed to add new item to chat variables:',e)}},f=e=>{let t='\n</>\n';return t+='\n',t+=`${(()=>{const e=getVariables({type:'chat'}).characters.c1,t=`${e.}${e.}`;let a=`<${t}Status>\n`;return a+='idc1\n',a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${v(e.)}\n`,a+=`  ${v(e.)}\n`,a+=`  ${v(e.)}\n`,a+=`</${t}Status>`,a})()}\n`,t+='\n',t+=`${(()=>{const e=getVariables({type:'chat'}).characters;if(void 0===e)return'';let t='<CharacterStatus>\n';for(const[a,n]of Object.entries(e))'c1'!==a&&(t+=`id${a}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${v(n.)}\n`,t+=`  ${v(n.)}\n`,t+=`  ${v(n.)}\n\n`);return t+='</CharacterStatus>',t})()}\n`,t+='\n',t+=`${(()=>{let e='<ItemTable>\n';e+='|id||||\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).items;if(void 0===t)return'';for(const[a,n]of Object.entries(t))e+=`|${a}|${n.name}|${n.description}|${n.value}|\n`;return e+='</ItemTable>',e})()}\n`,t+='\n',t+=`${(()=>{let e='<LocationTable>\n';e+='|id|||||\n',e+='|---|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.location||''}|${n.description}|${t}|\n`}return e+='</LocationTable>',e})()}\n`,t+='\n',t+=`${(()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e})()}\n`,t+='\n',t+='<>\n',t+=`${e.generation_requirement||''}\n`,t+='</>\n',t+='\n',t+='<example>\n',t+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output. Output anything other than this format is prohibited.\n',t+='string\n',t+='\'\'\n',t+='number\n',t+='</example>\n',t},h=async e=>{const t=n.value.get(e);if(!t)return;const a=new Map(r.value);a.set(e,!0),r.value=a;try{const a=(e=>{let t='\n\n';return t+=`${e.name||''}\n`,t+=`${e.description||''}\n`,t+=`${e.value||''}\n`,t})(t),r=(()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='\n';return a+='\n',a+='<>\n','\n\n<>\n'})(),o=f(t);((e,t)=>{const a=e.split('\n');for(const e of a){const a=e.indexOf('');if(a>0){const n=e.substring(0,a).trim(),r=e.substring(a+1).trim();switch(n){case'':t.generated_name=r.replace(/^["']|["']$/g,'');break;case'':t.generated_description=r.replace(/^["']|["']$/g,'');break;case'':t.generated_value=r.replace(/[^\d]/g,'')}}}})(await generateRaw({user_input:a,ordered_prompts:[{role:'system',content:r},'char_description',{role:'system',content:o},'user_input']}),t);try{localStorage.setItem(`item_profile_generated_${e}`,JSON.stringify({generation_requirement:t.generation_requirement,generated_name:t.generated_name,generated_description:t.generated_description,generated_value:t.generated_value}))}catch(t){console.error(`Failed to save generated item profile for ${e} to localStorage:`,t)}n.value.set(e,{...t})}catch(a){console.error(` ${e} :`,a),t.generated_name=''}finally{const t=new Map(r.value);t.set(e,!1),r.value=t}};return(e,l)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',nn,[l[11]||(l[11]=(0,t.createElementVNode)('h3',null,'',-1)),(0,t.createCommentVNode)('  '),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(i.value,([e,i])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:(0,t.normalizeClass)(['item-fold-bar',{'item-incomplete':!u(i)}])},[(0,t.createVNode)(d,{title:`${e}: ${s(i)}`,'is-open':!1},{'title-actions':(0,t.withCtx)(()=>[(0,t.createElementVNode)('button',{class:'remove-item-btn',title:'',onClick:t=>(e=>{n.value.delete(e);try{const t=getVariables({type:'chat'});delete t.items[e],replaceVariables(t,{type:'chat'})}catch(t){console.error(`Failed to remove item ${e} from chat variables:`,t)}})(e)},[...l[0]||(l[0]=[(0,t.createElementVNode)('span',null,'',-1)])],8,rn)]),default:(0,t.withCtx)(()=>[(0,t.createElementVNode)('div',on,[(0,t.createElementVNode)('div',ln,[l[7]||(l[7]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',sn,[(0,t.createElementVNode)('div',cn,[l[2]||(l[2]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':e=>i.name=e,type:'text',placeholder:'',class:'text-input'},null,8,dn),[[t.vModelText,i.name]]),i.generated_name?((0,t.openBlock)(),(0,t.createElementBlock)('div',un,[l[1]||(l[1]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',pn,(0,t.toDisplayString)(i.generated_name),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>g(e,'name',i.generated_name)},'  ',8,mn)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',gn,[l[4]||(l[4]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('input',{value:a(i,'value'),type:'number',placeholder:'100',class:'text-input',min:'0',onInput:e=>((e,t,a)=>{if(''===a||''===a.trim())e[t]=null;else{const n=parseInt(a);e[t]=isNaN(n)?null:n}})(i,'value',e.target.value)},null,40,vn),i.generated_value?((0,t.openBlock)(),(0,t.createElementBlock)('div',bn,[l[3]||(l[3]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',fn,(0,t.toDisplayString)(i.generated_value),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>g(e,'value',i.generated_value)},'  ',8,hn)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',xn,[l[6]||(l[6]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':e=>i.description=e,placeholder:'...',class:'text-area',rows:'3'},null,8,_n),[[t.vModelText,i.description]]),i.generated_description?((0,t.openBlock)(),(0,t.createElementBlock)('div',En,[l[5]||(l[5]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',yn,(0,t.toDisplayString)(i.generated_description),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>g(e,'description',i.generated_description)},'  ',8,kn)])):(0,t.createCommentVNode)('v-if',!0)])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Nn,[l[9]||(l[9]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',Vn,[(0,t.createElementVNode)('div',wn,[l[8]||(l[8]=(0,t.createElementVNode)('label',null,'AI',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':e=>i.generation_requirement=e,placeholder:'AI...',class:'text-area',rows:'3'},null,8,Sn),[[t.vModelText,i.generation_requirement]])])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Cn,[(0,t.createElementVNode)('button',{class:'generate-btn',disabled:!o.value||r.value.get(e),onClick:t=>h(e)},[r.value.get(e)?((0,t.openBlock)(),(0,t.createElementBlock)('span',Bn)):(0,t.createCommentVNode)('v-if',!0),(0,t.createTextVNode)(' '+(0,t.toDisplayString)(r.value.get(e)?'...':o.value?'':''),1)],8,Tn),(0,t.createElementVNode)('button',{class:'apply-all-btn',disabled:!c(i),onClick:t=>(e=>{const t=n.value.get(e);if(!t)return;[{generated:'generated_name',field:'name',parser:e=>e},{generated:'generated_description',field:'description',parser:e=>e},{generated:'generated_value',field:'value',parser:e=>parseInt(e)||null}].forEach(({generated:e,field:a,parser:n})=>{const r=t[e];r&&(t[a]=n(r),t[e]='')}),n.value.set(e,{...t}),m(e);try{localStorage.removeItem(`item_profile_generated_${e}`)}catch(t){console.error(`Failed to remove generated item profile for ${e} from localStorage:`,t)}})(e)},'  ',8,In)])])]),_:2},1032,['title'])],2))),128)),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',{class:'add-item-section'},[(0,t.createElementVNode)('button',{class:'add-item-btn',onClick:b},[...l[10]||(l[10]=[(0,t.createElementVNode)('span',null,'+ ',-1)])])])]))}});n(9106);const Dn=(0,c.A)($n,[['__scopeId','data-v-d8256cea']]),Rn={class:'location-tabs-container'},Mn=['onClick'],Yn={class:'location-info-container'},An={class:'section'},zn={class:'form-grid'},On={class:'input-group'},Kn=['onUpdate:modelValue'],Ln={key:0,class:'generated-result'},Un={class:'generated-text'},Fn=['onClick'],Pn={class:'input-group'},jn=['onUpdate:modelValue'],Hn={key:0,class:'generated-result'},Gn={class:'generated-text'},qn=['onClick'],Xn={class:'input-group full-width'},Wn=['onUpdate:modelValue'],Jn={key:0,class:'generated-result'},Zn={class:'generated-text'},Qn=['onClick'],er={class:'input-group full-width'},tr={key:0,class:'generated-result'},ar={class:'generated-text'},nr=['onClick'],rr={class:'input-group full-width'},or={class:'sub-locations-container'},lr=['value','onChange'],ir=['value','disabled'],sr=['onClick'],cr=['onClick'],dr={class:'section'},ur={class:'form-grid'},pr={class:'input-group full-width'},mr=['onUpdate:modelValue'],gr={class:'action-section'},vr=['disabled','onClick'],br={key:0,class:'loading-spinner'},fr=['disabled','onClick'],hr={class:'bulk-generate-section'},xr={class:'form-grid'},_r={class:'input-group'},Er={class:'count-input-row'},yr=['disabled'],kr={class:'ai-count-checkbox'},Nr={class:'input-group full-width'},Vr=['disabled'],wr={key:0,class:'loading-spinner'},Sr=(0,t.defineComponent)({__name:'location_tab',setup(e){const a=(0,t.ref)(new Map),n=(0,t.ref)(new Map),r=(0,t.ref)(!1),o=(0,t.ref)(3),l=(0,t.ref)(''),i=(0,t.ref)(!1),s=['generated_name','generated_location','generated_description'],c=['generated_name','generated_location','generated_description','generated_sub_location'],u=(0,t.computed)(()=>{try{const e=getVariables({type:'chat'});return!!e?.world_info?.trim()}catch{return!1}}),p=(0,t.computed)(()=>Array.from(a.value.entries())),m=e=>e?.name||'',g=e=>!!(e?.generated_name||e?.generated_location||e?.generated_description||e?.generated_sub_location),v=e=>!!(e?.name?.trim()&&e?.location?.trim()&&e?.description?.trim()),b=e=>{s.forEach(t=>{e[t]||(e[t]='')}),e.generated_sub_location||(e.generated_sub_location=[]),e.sub_location||(e.sub_location=[]),e.location||(e.location=''),e.generated_location||(e.generated_location=''),e.generation_requirement||(e.generation_requirement='')},f=e=>{try{const t=getVariables({type:'chat'}),n={...t.locations||{}},r=a.value.get(e);if(!r)return;n[e]={name:r.name||'',location:r.location||'',description:r.description||'',sub_location:r.sub_location||[]},t.locations=n,replaceVariables(t,{type:'chat'})}catch(t){console.error(` ${e} :`,t)}};(0,t.watch)(()=>getVariables({type:'chat'}),e=>{if(e?.locations){const n=new Map;for(const[a,r]of Object.entries(e.locations)){const e=(0,t.reactive)(r);b(e),n.set(a,e)}a.value=n}},{deep:!0}),(0,t.watch)(a,()=>{for(const[e]of a.value.entries())f(e)},{deep:!0}),(0,t.watch)(()=>a.value,e=>{for(const[a,n]of e.entries())(0,t.watch)(()=>n.generation_requirement,e=>{try{const t=localStorage.getItem(`location_profile_generated_${a}`),n=t?JSON.parse(t):{};n.generation_requirement=e,localStorage.setItem(`location_profile_generated_${a}`,JSON.stringify(n))}catch(e){console.error(`Failed to save generation_requirement for ${a} to localStorage:`,e)}},{immediate:!1})},{deep:!0,immediate:!0}),(0,t.onMounted)(()=>{(()=>{try{const e=getVariables({type:'chat'});if(e?.locations){const n=new Map;for(const[a,r]of Object.entries(e.locations)){const e=(0,t.reactive)(r);b(e),n.set(a,e)}a.value=n}else a.value=new Map}catch(e){console.error(':',e),a.value=new Map}try{for(const[e,t]of a.value){const a=localStorage.getItem(`location_profile_generated_${e}`);a&&Object.assign(t,JSON.parse(a))}}catch(e){console.error('Failed to load generated location profiles from localStorage:',e)}try{const e=localStorage.getItem('bulk_location_generation_requirement');e&&(l.value=e);const t=localStorage.getItem('bulk_location_allow_ai_count');t&&(i.value='true'===t)}catch(e){console.error('Failed to load bulk generation settings from localStorage:',e)}})()});const h=()=>{const e=Array.from(a.value.keys());let t=1;for(;e.includes(`l${t}`);)t++;return`l${t}`},x=(e,t,n)=>{const r=a.value.get(e);if(!r)return;const o={name:{field:'name'},location:{field:'location'},description:{field:'description'},sub_location:{field:'sub_location',parser:e=>e}}[t];if(o){const e=o.parser?o.parser(n):n;r[o.field]=e,r[`generated_${t}`]=''}a.value.set(e,{...r}),f(e)},E=()=>{const e=h(),n=(0,t.reactive)({name:'',location:'',description:'',sub_location:[],generation_requirement:'',generated_name:'',generated_location:'',generated_description:'',generated_sub_location:[]});a.value.set(e,n);try{const t=getVariables({type:'chat'}).locations||{};t[e]={name:'',location:'',description:'',sub_location:[]},insertOrAssignVariables({locations:t},{type:'chat'})}catch(e){console.error('Failed to add new location to chat variables:',e)}},y=()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='\n';return a+='\n',a+='<>\n','\n\n<>\n'},k=['','','','','','','','','','','','','','','','','','','','',''],N=['','',''],V=(e,t,a=!1)=>{let n=`id${t}\n`;return k.forEach(t=>{n+=`  ${t}${e[t]||''}\n`}),a&&(n+=`  ${e.||''}\n`,n+=`  ${e.||''}\n`),N.forEach(t=>{var a;n+=`  ${t}${a=e[t],'['+Object.entries(a).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']'}\n`}),n},w=()=>{const e=getVariables({type:'chat'}).characters.c1,t=`${e.}${e.}`;let a=`<${t}Status>\n`;return a+=V(e,'c1'),a+=`</${t}Status>`,a},S=()=>{const e=getVariables({type:'chat'}).characters;if(void 0===e)return'';let t='<CharacterStatus>\n';for(const[a,n]of Object.entries(e))'c1'!==a&&(t+=V(n,a,!0)+'\n');return t+='</CharacterStatus>',t},C=()=>{let e='<LocationTable>\n';e+='|id|||||\n',e+='|---|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.location||''}|${n.description}|${t}|\n`}return e+='</LocationTable>',e},T=()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e},B={id:{field:'id',parser:e=>e.replace(/^["']|["']$/g,'')},:{field:'name',parser:e=>e.replace(/^["']|["']$/g,'')},:{field:'location',parser:e=>e.replace(/^["']|["']$/g,'')},:{field:'description',parser:e=>e.replace(/^["']|["']$/g,'')},:{field:'sub_location',parser:e=>{try{let t=e;t.startsWith('\'')&&t.endsWith('\'')&&(t=t.slice(1,-1)),t=t.replace(/'/g,'"');const a=JSON.parse(t);return Array.isArray(a)?a:[]}catch(t){return console.warn('Failed to parse sub_location:',e,t),[]}}}},I=(e,t,a=!1)=>{const n=e.indexOf('');if(n<=0)return;const r=e.substring(0,n).trim(),o=e.substring(n+1).trim(),l=B[r];if(l){t[a?`generated_${l.field}`:l.field]=l.parser(o)}},D=async e=>{const t=a.value.get(e);if(!t)return;const r=new Map(n.value);r.set(e,!0),n.value=r;try{const n=(e=>{let t='\n\n';return t+=`id${e.id||''}\n`,t+=`${e.name||''}\n`,t+=`${e.location||''}\n`,t+=`${e.description||''}\n`,t+=`${e.sub_location&&e.sub_location.length>0?JSON.stringify(e.sub_location):'[]'}\n`,t+='\nID "l1", "l2", "l3", ... ID\n',t})(t),r=y(),o=(e=>{let t='\n</>\n';return t+='\n',t+=`${w()}\n`,t+='\n',t+=`${S()}\n`,t+='\n',t+=`${C()}\n`,t+='\n',t+=`${T()}\n`,t+='\n',t+='<>\n',t+=`${e.generation_requirement||''}\n`,t+='</>\n',t+='\n',t+='<>\n',t+='\n',t+='-  l2  l1  l2  l1 \n',t+='-  l3  l2  l3  l1  l3  l1 \n',t+='- ididid\n',t+='</>\n',t+='\n',t+='<example>\n',t+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output. Output anything other than this format is prohibited.\n',t+='idl1\n',t+='\'\'\n',t+='\'\'\n',t+='\'\'\n',t+='[\'l2\', \'l4\']\n',t+='</example>\n',t})(t);((e,t)=>{e.split('\n').forEach(e=>I(e,t,!0))})(await generateRaw({user_input:n,ordered_prompts:[{role:'system',content:r},'char_description',{role:'system',content:o},'user_input']}),t);try{localStorage.setItem(`location_profile_generated_${e}`,JSON.stringify({generation_requirement:t.generation_requirement,generated_name:t.generated_name,generated_location:t.generated_location,generated_description:t.generated_description,generated_sub_location:t.generated_sub_location}))}catch(t){console.error(`Failed to save generated location profile for ${e} to localStorage:`,t)}a.value.set(e,{...t})}catch(a){console.error(` ${e} :`,a),t.generated_name=''}finally{const t=new Map(n.value);t.set(e,!1),n.value=t}},R=async()=>{if(i.value||!(o.value<1||o.value>10)){r.value=!0;try{try{localStorage.setItem('bulk_location_generation_requirement',l.value),localStorage.setItem('bulk_location_allow_ai_count',i.value.toString())}catch(e){console.error('Failed to save bulk generation settings to localStorage:',e)}const e=`${i.value?'':` ${o.value} `}\n\n${l.value||''}\n\n\nidl1\n\n\n\n['id1', 'id2', ...]\n\n---\n\n\n- id "l1", "l2", "l3", ... id\n- IDidid\n`,n=y(),r=(()=>{let e='\n</>\n';return e+='\n',e+=`${w()}\n`,e+='\n',e+=`${S()}\n`,e+='\n',e+=`${C()}\n`,e+='\n',e+=`${T()}\n`,e+='\n',e+='<>\n',e+='\n',e+='-  l2  l1  l2  l1 \n',e+='-  l3  l2  l3  l1  l3  l1 \n',e+='- ididid\n',e+='</>\n',e+='\n',i.value&&(e+='<>\n',e+='\n',e+='\n',e+='</>\n',e+='\n'),e+='<example>\n',e+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output. Output anything other than this format is prohibited.\n',e+='idl1\n',e+='\'\'\n',e+='\'\'\n',e+='\'\'\n',e+='[\'id\', ...]\n',e+='\n---\n',e+='idl2\n',e+='\'\'\n',e+='\'\'\n',e+='\'\'\n',e+='[\'id\', ...]\n',e+='</example>\n',e})(),s=(e=>{const t=[],a=e.split('---').map(e=>e.trim()).filter(e=>e);for(const e of a){const a=e.split('\n'),n={id:'',name:'',location:'',description:'',sub_location:[]};a.forEach(e=>I(e,n)),n.name&&n.name.trim()&&t.push(n)}return t})(await generateRaw({user_input:e,ordered_prompts:[{role:'system',content:n},'char_description',{role:'system',content:r},'user_input']}));for(const e of s){const n=e.id||h(),r={id:n,name:e.name||'',location:e.location||'',description:e.description||'',sub_location:e.sub_location||[],generation_requirement:l.value,generated_name:'',generated_location:'',generated_description:'',generated_sub_location:[]},o=(0,t.reactive)(r);a.value.set(n,o);try{const e=getVariables({type:'chat'}).locations||{};e[n]={name:r.name,location:r.location,description:r.description,sub_location:r.sub_location},insertOrAssignVariables({locations:e},{type:'chat'})}catch(e){console.error('Failed to add bulk generated location to chat variables:',e)}}toastr.success(` ${s.length} `)}catch(e){console.error(':',e),toastr.error('')}finally{r.value=!1}}};return(e,s)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',Rn,[s[24]||(s[24]=(0,t.createElementVNode)('h3',null,'',-1)),(0,t.createCommentVNode)('  '),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(p.value,([e,r])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:(0,t.normalizeClass)(['location-fold-bar',{'location-incomplete':!v(r)}])},[(0,t.createVNode)(d,{title:`${e}: ${m(r)}`,'is-open':!1},{'title-actions':(0,t.withCtx)(()=>[(0,t.createElementVNode)('button',{class:'remove-location-btn',title:'',onClick:t=>(e=>{a.value.delete(e);try{const t=getVariables({type:'chat'});delete t.locations[e],replaceVariables(t,{type:'chat'})}catch(t){console.error(`Failed to remove location ${e} from chat variables:`,t)}})(e)},[...s[3]||(s[3]=[(0,t.createElementVNode)('span',null,'',-1)])],8,Mn)]),default:(0,t.withCtx)(()=>[(0,t.createElementVNode)('div',Yn,[(0,t.createElementVNode)('div',An,[s[16]||(s[16]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',zn,[(0,t.createElementVNode)('div',On,[s[5]||(s[5]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':e=>r.name=e,type:'text',placeholder:'',class:'text-input'},null,8,Kn),[[t.vModelText,r.name]]),r.generated_name?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ln,[s[4]||(s[4]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Un,(0,t.toDisplayString)(r.generated_name),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>x(e,'name',r.generated_name)},'  ',8,Fn)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Pn,[s[7]||(s[7]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':e=>r.location=e,type:'text',placeholder:'',class:'text-input'},null,8,jn),[[t.vModelText,r.location]]),r.generated_location?((0,t.openBlock)(),(0,t.createElementBlock)('div',Hn,[s[6]||(s[6]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Gn,(0,t.toDisplayString)(r.generated_location),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>x(e,'location',r.generated_location)},'  ',8,qn)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Xn,[s[9]||(s[9]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':e=>r.description=e,placeholder:'...',class:'text-area',rows:'3'},null,8,Wn),[[t.vModelText,r.description]]),r.generated_description?((0,t.openBlock)(),(0,t.createElementBlock)('div',Jn,[s[8]||(s[8]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Zn,(0,t.toDisplayString)(r.generated_description),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>x(e,'description',r.generated_description)},'  ',8,Qn)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',er,[s[11]||(s[11]=(0,t.createElementVNode)('label',null,'',-1)),r.generated_sub_location&&r.generated_sub_location.length>0?((0,t.openBlock)(),(0,t.createElementBlock)('div',tr,[s[10]||(s[10]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',ar,(0,t.toDisplayString)(r.generated_sub_location.join(', ')),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:t=>x(e,'sub_location',r.generated_sub_location)},'  ',8,nr)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',rr,[s[15]||(s[15]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',or,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(r.sub_location||[],(n,r)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:r,class:'sub-location-item'},[(0,t.createElementVNode)('select',{value:n,class:'text-input',onChange:t=>((e,t,n)=>{const r=a.value.get(e);r&&r.sub_location&&(r.sub_location[t]=n,a.value.set(e,{...r}),f(e))})(e,r,t.target.value)},[s[12]||(s[12]=(0,t.createElementVNode)('option',{value:''},'...',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(a.value,([a,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:a,value:a,disabled:a===e},(0,t.toDisplayString)(a)+': '+(0,t.toDisplayString)(m(n)),9,ir))),128))],40,lr),(0,t.createElementVNode)('button',{class:'remove-sub-location-btn',onClick:t=>((e,t)=>{const n=a.value.get(e);n&&n.sub_location&&(n.sub_location.splice(t,1),a.value.set(e,{...n}),f(e))})(e,r)},[...s[13]||(s[13]=[(0,t.createElementVNode)('span',null,'',-1)])],8,sr)]))),128)),(0,t.createElementVNode)('button',{class:'add-sub-location-btn',onClick:t=>(e=>{const t=a.value.get(e);t&&(t.sub_location||(t.sub_location=[]),t.sub_location.push(''),a.value.set(e,{...t}),f(e))})(e)},[...s[14]||(s[14]=[(0,t.createElementVNode)('span',null,'+ ',-1)])],8,cr)])])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',dr,[s[18]||(s[18]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',ur,[(0,t.createElementVNode)('div',pr,[s[17]||(s[17]=(0,t.createElementVNode)('label',null,'AI',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':e=>r.generation_requirement=e,placeholder:'AI...',class:'text-area',rows:'3'},null,8,mr),[[t.vModelText,r.generation_requirement]])])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',gr,[(0,t.createElementVNode)('button',{class:'generate-btn',disabled:!u.value||n.value.get(e),onClick:t=>D(e)},[n.value.get(e)?((0,t.openBlock)(),(0,t.createElementBlock)('span',br)):(0,t.createCommentVNode)('v-if',!0),(0,t.createTextVNode)(' '+(0,t.toDisplayString)(n.value.get(e)?'...':u.value?'':''),1)],8,vr),(0,t.createElementVNode)('button',{class:'apply-all-btn',disabled:!g(r),onClick:t=>(e=>{const t=a.value.get(e);if(t){c.forEach(e=>{const a=e,n=e.replace('generated_',''),r=t[a];r&&(t[n]=r,t[a]='generated_sub_location'===e?[]:'')}),a.value.set(e,{...t}),f(e);try{localStorage.removeItem(`location_profile_generated_${e}`)}catch(t){console.error(`Failed to remove generated location profile for ${e} from localStorage:`,t)}}})(e)},'  ',8,fr)])])]),_:2},1032,['title'])],2))),128)),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',hr,[s[22]||(s[22]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',xr,[(0,t.createElementVNode)('div',_r,[s[20]||(s[20]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Er,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':s[0]||(s[0]=e=>o.value=e),type:'number',min:'1',max:'10',class:'text-input count-input',placeholder:'1-10',disabled:i.value},null,8,yr),[[t.vModelText,o.value,void 0,{number:!0}]]),(0,t.createElementVNode)('div',kr,[(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'allow_ai_count','onUpdate:modelValue':s[1]||(s[1]=e=>i.value=e),type:'checkbox'},null,512),[[t.vModelCheckbox,i.value]]),s[19]||(s[19]=(0,t.createElementVNode)('label',{for:'allow_ai_count'},'AI',-1))])])]),(0,t.createElementVNode)('div',Nr,[s[21]||(s[21]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':s[2]||(s[2]=e=>l.value=e),placeholder:'...',class:'text-area',rows:'3'},null,512),[[t.vModelText,l.value]])])]),(0,t.createElementVNode)('button',{class:'bulk-generate-btn',disabled:!u.value||r.value||!i.value&&(o.value<1||o.value>10),onClick:R},[r.value?((0,t.openBlock)(),(0,t.createElementBlock)('span',wr)):(0,t.createCommentVNode)('v-if',!0),(0,t.createTextVNode)(' '+(0,t.toDisplayString)(r.value?'...':u.value?i.value?'AI':` ${o.value} `:''),1)],8,Vr)]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',{class:'add-location-section'},[(0,t.createElementVNode)('button',{class:'add-location-btn',onClick:E},[...s[23]||(s[23]=[(0,t.createElementVNode)('span',null,'+ ',-1)])])])]))}});n(6353);const Cr=(0,c.A)(Sr,[['__scopeId','data-v-890af5d4']]);class Tr{_date;constructor(e){this._date=e}static fromString(e){return new Tr(new Date(e))}toString(){return this._date.toString()}get year(){return this._date.getFullYear()}get month(){return this._date.getMonth()+1}get date(){return this._date.getDate()}get hours(){return this._date.getHours()}get minutes(){return this._date.getMinutes()}get seconds(){return this._date.getSeconds()}toDate(){return this._date}deltaMinutes(e){this._date.setMinutes(this._date.getMinutes()+e)}clone(){return new Tr(new Date(this._date))}}class Br{name;static NAME_KEY='';age;static AGE_KEY='';gender;static GENDER_KEY='';identity;static IDENTITY_KEY='';introduction;static INTRODUCTION_KEY='';personality;static PERSONALITY_KEY='';height;static HEIGHT_KEY='';weight;static WEIGHT_KEY='';chest_size;static CHEST_SIZE_KEY='';cup_size;static CUP_SIZE_KEY='';waist_size;static WAIST_SIZE_KEY='';hips_size;static HIPS_SIZE_KEY='';hairstyle;static HAIRSTYLE_KEY='';appearance;static APPEARANCE_KEY='';clothes;static CLOTHES_KEY='';birthday;static BIRTHDAY_KEY='';favourite;static FAVOURITE_KEY='';extra_information;static EXTRA_INFORMATION_KEY='';money;static MONEY_KEY='';mood;static MOOD_KEY='';horny;static HORNY_KEY='';relations;static RELATIONS_KEY='';friendships;static FRIENDSHIPS_KEY='';loves;static LOVES_KEY='';inventory;static INVENTORY_KEY='';static MOOD_LOW=-100;static MOOD_HIGH=100;static HORNY_LOW=0;static HORNY_HIGH=100;static FRIENDSHIP_LOW=-1e3;static FRIENDSHIP_HIGH=1e3;static LOVE_LOW=0;static LOVE_HIGH=1e3;constructor(e,t,a,n,r,o,l,i,s,c,d,u,p,m,g,v,b,f,h,x,E,y,k,N,V){this.name=e,this.age=t,this.gender=a,this.identity=n,this.introduction=r,this.personality=o,this.height=l,this.weight=i,this.chest_size=s,this.cup_size=c,this.waist_size=d,this.hips_size=u,this.hairstyle=p,this.appearance=m,this.clothes=g,this.birthday=v,this.favourite=b,this.extra_information=f,this.money=h,this.mood=x,this.horny=E,this.relations=y,this.friendships=k,this.loves=N,this.inventory=V}static instantiate(){return new Br('',17,'','','','',172,52,70,null,50,55,'','','',new Tr(new Date(1998,8,22,0,0,0)),'','',1e4,20,0,new Map([['c2','']]),new Map([['c2',100],['c5',70],['c6',-40]]),new Map([['c2',50]]),new Map([['i2',2]]))}static fromRecord(e){return new Br(e[Br.NAME_KEY],e[Br.AGE_KEY],e[Br.GENDER_KEY],e[Br.IDENTITY_KEY],e[Br.INTRODUCTION_KEY],e[Br.PERSONALITY_KEY],e[Br.HEIGHT_KEY],e[Br.WEIGHT_KEY],e[Br.CHEST_SIZE_KEY],e[Br.CUP_SIZE_KEY]??null,e[Br.WAIST_SIZE_KEY],e[Br.HIPS_SIZE_KEY],e[Br.HAIRSTYLE_KEY],e[Br.APPEARANCE_KEY],e[Br.CLOTHES_KEY],Tr.fromString(e[Br.BIRTHDAY_KEY]),e[Br.FAVOURITE_KEY],e[Br.EXTRA_INFORMATION_KEY],e[Br.MONEY_KEY],e[Br.MOOD_KEY],e[Br.HORNY_KEY],new Map(Object.entries(e[Br.RELATIONS_KEY])),new Map(Object.entries(e[Br.FRIENDSHIPS_KEY])),new Map(Object.entries(e[Br.LOVES_KEY])),new Map(Object.entries(e[Br.INVENTORY_KEY])))}toRecord(){return{[Br.NAME_KEY]:this.name,[Br.AGE_KEY]:this.age,[Br.GENDER_KEY]:this.gender,[Br.IDENTITY_KEY]:this.identity,[Br.INTRODUCTION_KEY]:this.introduction,[Br.PERSONALITY_KEY]:this.personality,[Br.HEIGHT_KEY]:this.height,[Br.WEIGHT_KEY]:this.weight,[Br.CHEST_SIZE_KEY]:this.chest_size,[Br.CUP_SIZE_KEY]:this.cup_size,[Br.WAIST_SIZE_KEY]:this.waist_size,[Br.HIPS_SIZE_KEY]:this.hips_size,[Br.HAIRSTYLE_KEY]:this.hairstyle,[Br.APPEARANCE_KEY]:this.appearance,[Br.CLOTHES_KEY]:this.clothes,[Br.BIRTHDAY_KEY]:this.birthday.toString(),[Br.FAVOURITE_KEY]:this.favourite,[Br.EXTRA_INFORMATION_KEY]:this.extra_information,[Br.MONEY_KEY]:this.money,[Br.MOOD_KEY]:this.mood,[Br.HORNY_KEY]:this.horny,[Br.RELATIONS_KEY]:Object.fromEntries(this.relations),[Br.FRIENDSHIPS_KEY]:Object.fromEntries(this.friendships),[Br.LOVES_KEY]:Object.fromEntries(this.loves),[Br.INVENTORY_KEY]:Object.fromEntries(this.inventory)}}deltaFriendship(e,t){let a=this.friendships.get(e)||0;a+=t,a<Br.FRIENDSHIP_LOW&&(a=Br.FRIENDSHIP_LOW),a>Br.FRIENDSHIP_HIGH&&(a=Br.FRIENDSHIP_HIGH),this.friendships.set(e,a)}deltaLove(e,t){let a=this.loves.get(e)||0;a+=t,a<Br.LOVE_LOW&&(a=Br.LOVE_LOW),a>Br.LOVE_HIGH&&(a=Br.LOVE_HIGH),0===a?this.loves.delete(e):this.loves.set(e,a)}deltaMood(e){this.mood+=e,this.mood<Br.MOOD_LOW&&(this.mood=Br.MOOD_LOW),this.mood>Br.MOOD_HIGH&&(this.mood=Br.MOOD_HIGH)}deltaHorny(e){this.horny+=e,this.horny<Br.HORNY_LOW&&(this.horny=Br.HORNY_LOW),this.horny>Br.HORNY_HIGH&&(this.horny=Br.HORNY_HIGH)}}class Ir{name;static NAME_KEY='';description;static DESCRIPTION_KEY='';value;static VALUE_KEY='';constructor(e,t,a){this.name=e,this.description=t,this.value=a}static fromRecord(e){return new Ir(e[Ir.NAME_KEY],e[Ir.DESCRIPTION_KEY],e[Ir.VALUE_KEY])}toRecord(){return{[Ir.NAME_KEY]:this.name,[Ir.DESCRIPTION_KEY]:this.description,[Ir.VALUE_KEY]:this.value}}}class $r{id;static ID_KEY='id';name;static NAME_KEY='';location;static LOCATION_KEY='';description;static DESCRIPTION_KEY='';parent_location_id;static PARENT_LOCATION_ID_KEY='id';sub_location_ids;static SUB_LOCATION_IDS_KEY='ids';storage_ids;static STORAGE_IDS_KEY='ids';constructor(e,t,a,n,r,o,l){this.id=e,this.name=t,this.location=a,this.description=n,this.parent_location_id=r,this.sub_location_ids=o,this.storage_ids=l}static fromRecord(e){return new $r(e[$r.ID_KEY],e[$r.NAME_KEY],e[$r.LOCATION_KEY],e[$r.DESCRIPTION_KEY],e[$r.PARENT_LOCATION_ID_KEY],e[$r.SUB_LOCATION_IDS_KEY]||[],e[$r.STORAGE_IDS_KEY]||[])}toRecord(){return{[$r.ID_KEY]:this.id,[$r.NAME_KEY]:this.name,[$r.LOCATION_KEY]:this.location,[$r.DESCRIPTION_KEY]:this.description,[$r.PARENT_LOCATION_ID_KEY]:this.parent_location_id,[$r.SUB_LOCATION_IDS_KEY]:this.sub_location_ids,[$r.STORAGE_IDS_KEY]:this.storage_ids}}}class Dr{deadline;static DEADLINE_KEY='';character_ids;static CHARACTER_IDS_KEY='';location_id;static LOCATION_ID_KEY='';description;static DESCRIPTION_KEY='';constructor(e,t,a,n){this.deadline=e,this.character_ids=t,this.location_id=a,this.description=n}static fromRecord(e){return new Dr(Tr.fromString(e[Dr.DEADLINE_KEY]),e[Dr.CHARACTER_IDS_KEY],e[Dr.LOCATION_ID_KEY],e[Dr.DESCRIPTION_KEY])}toRecord(){return{[Dr.DEADLINE_KEY]:this.deadline.toString(),[Dr.CHARACTER_IDS_KEY]:this.character_ids,[Dr.LOCATION_ID_KEY]:this.location_id,[Dr.DESCRIPTION_KEY]:this.description}}}class Rr{name;static NAME_KEY='';description;static DESCRIPTION_KEY='';parent_id;static PARENT_ID_KEY='id';money;static MONEY_KEY='';inventory;static INVENTORY_KEY='';constructor(e,t,a,n,r){this.name=e,this.description=t,this.parent_id=a,this.money=n,this.inventory=r}static fromRecord(e){const t=new Map,a=e[Rr.INVENTORY_KEY]||{};for(const[e,n]of Object.entries(a))t.set(e,n);return new Rr(e[Rr.NAME_KEY],e[Rr.DESCRIPTION_KEY],e[Rr.PARENT_ID_KEY],e[Rr.MONEY_KEY],t)}toRecord(){const e={};for(const[t,a]of Array.from(this.inventory))e[t]=a;return{[Rr.NAME_KEY]:this.name,[Rr.DESCRIPTION_KEY]:this.description,[Rr.PARENT_ID_KEY]:this.parent_id,[Rr.MONEY_KEY]:this.money,[Rr.INVENTORY_KEY]:e}}}class Mr{datetime;static DATETIME_KEY='';summary;static SUMMARY_KEY='';weighting;static WEIGHTING_KEY='';last_message_id;static LAST_MESSAGE_ID_KEY='';constructor(e,t,a,n){this.datetime=e,this.summary=t,this.weighting=a,this.last_message_id=n}static fromRecord(e){return new Mr(Tr.fromString(e[Mr.DATETIME_KEY]),e[Mr.SUMMARY_KEY],e[Mr.WEIGHTING_KEY],e[Mr.LAST_MESSAGE_ID_KEY])}toRecord(){return{[Mr.DATETIME_KEY]:this.datetime.toString(),[Mr.SUMMARY_KEY]:this.summary,[Mr.WEIGHTING_KEY]:this.weighting,[Mr.LAST_MESSAGE_ID_KEY]:this.last_message_id}}}class Yr{datetime;static DATETIME_KEY='';current_location_id;static CURRENT_LOCATION_ID_KEY='';weather;static WEATHER_KEY='';current_event;static CURRENT_EVENT_KEY='';static CURRENT_EVENT_NULL_VALUE='';active_characters;static ACTIVE_CHARACTERS_KEY='';deactive_characters;static DEACTIVE_CHARACTERS_KEY='';items;static ITEMS_KEY='';storages;static STORAGES_KEY='';locations;static LOCATIONS_KEY='';promises;static PROMISES_KEY='';summaries;static SUMMARIES_KEY='';constructor(e,t,a,n,r,o,l,i,s,c,d){this.datetime=e,this.current_location_id=t,this.weather=a,this.current_event=n,this.active_characters=r,this.deactive_characters=o,this.items=l,this.storages=i,this.locations=s,this.promises=c,this.summaries=d}static loadFromVariable(e){let t;t=e<0?getVariables({type:'chat'}).state:getVariables({type:'message',message_id:e});const a=new Map,n=t[Yr.ACTIVE_CHARACTERS_KEY];for(const[e,t]of Object.entries(n))a.set(e,Br.fromRecord(t));const r=new Map,o=t[Yr.DEACTIVE_CHARACTERS_KEY];for(const[e,t]of Object.entries(o))r.set(e,Br.fromRecord(t));const l=new Map,i=t[Yr.ITEMS_KEY];for(const[e,t]of Object.entries(i))l.set(e,Ir.fromRecord(t));const s=new Map;if(t[Yr.STORAGES_KEY]){const e=t[Yr.STORAGES_KEY];for(const[t,a]of Object.entries(e))s.set(t,Rr.fromRecord(a))}const c=new Map,d=t[Yr.LOCATIONS_KEY];for(const[e,t]of Object.entries(d))c.set(e,$r.fromRecord(t));const u=new Map,p=t[Yr.PROMISES_KEY];for(const[e,t]of Object.entries(p))u.set(e,Dr.fromRecord(t));const m=new Array,g=t[Yr.SUMMARIES_KEY];for(const e of g)m.push(Mr.fromRecord(e));return new Yr(Tr.fromString(t[Yr.DATETIME_KEY]),t[Yr.CURRENT_LOCATION_ID_KEY],t[Yr.WEATHER_KEY],t[Yr.CURRENT_EVENT_KEY],a,r,l,s,c,u,m)}saveAsVariable(e){const t={};for(const[e,a]of this.active_characters)t[e]=a.toRecord();const a={};for(const[e,t]of this.deactive_characters)a[e]=t.toRecord();const n={};for(const[e,t]of this.items)n[e]=t.toRecord();const r={};for(const[e,t]of this.storages)r[e]=t.toRecord();const o={};for(const[e,t]of this.locations)o[e]=t.toRecord();const l={};for(const[e,t]of this.promises)l[e]=t.toRecord();const i=[],s=[...this.summaries].sort((e,t)=>e.last_message_id-t.last_message_id);for(const e of s)i.push(e.toRecord());const c={[Yr.DATETIME_KEY]:this.datetime.toString(),[Yr.CURRENT_LOCATION_ID_KEY]:this.current_location_id,[Yr.WEATHER_KEY]:this.weather,[Yr.CURRENT_EVENT_KEY]:this.current_event,[Yr.ACTIVE_CHARACTERS_KEY]:t,[Yr.DEACTIVE_CHARACTERS_KEY]:a,[Yr.ITEMS_KEY]:n,[Yr.STORAGES_KEY]:r,[Yr.LOCATIONS_KEY]:o,[Yr.PROMISES_KEY]:l,[Yr.SUMMARIES_KEY]:i};if(e<0){const e=getVariables({type:'chat'});e.state=c,replaceVariables(e,{type:'chat'})}else replaceVariables(c,{type:'message',message_id:e})}getCharacter(e){return this.active_characters.get(e)||this.deactive_characters.get(e)}hasCharacter(e){return this.active_characters.has(e)||this.deactive_characters.has(e)}getCurrentLocations(){const e=new Set,t=[];let a=this.locations.get(this.current_location_id);for(;a&&!e.has(a.id);)t.push(a),e.add(a.id),a=this.locations.get(a.parent_location_id||'');return t.reverse()}addStorage(e,t,a,n){if(this.storages.has(e))return;if(!(this.hasCharacter(n)||this.storages.has(n)||this.locations.has(n)))return;const r=new Rr(t,a,n,0,new Map);if(this.storages.set(e,r),this.hasCharacter(n)){const t=this.getCharacter(n);t&&t.inventory.set(e,1)}else if(this.storages.has(n)){const t=this.storages.get(n);t&&t.inventory.set(e,1)}else if(this.locations.has(n)){const t=this.locations.get(n);t&&t.storage_ids.push(e)}}removeStorage(e){const t=this.storages.get(e);if(!t)return;this.storages.delete(e);const a=t.parent_id;if(this.hasCharacter(a)){const t=this.getCharacter(a);t&&t.inventory.delete(e)}else if(this.storages.has(a)){const t=this.storages.get(a);t&&t.inventory.delete(e)}else if(this.locations.has(a)){const t=this.locations.get(a);if(t){const a=t.storage_ids.indexOf(e);-1!==a&&t.storage_ids.splice(a,1)}}}setStorageParent(e,t){const a=this.storages.get(e);if(!a)return;if(!(this.hasCharacter(t)||this.storages.has(t)&&t!==e||this.locations.has(t)))return;const n=a.parent_id;if(this.hasCharacter(n)){const t=this.getCharacter(n);t&&t.inventory.delete(e)}else if(this.storages.has(n)){const t=this.storages.get(n);t&&t.inventory.delete(e)}else if(this.locations.has(n)){const t=this.locations.get(n);if(t){const a=t.storage_ids.indexOf(e);-1!==a&&t.storage_ids.splice(a,1)}}if(a.parent_id=t,this.hasCharacter(t)){const a=this.getCharacter(t);a&&a.inventory.set(e,1)}else if(this.storages.has(t)){const a=this.storages.get(t);a&&a.inventory.set(e,1)}else if(this.locations.has(t)){const a=this.locations.get(t);a&&a.storage_ids.push(e)}}addPromise(e,t,a,n){const r=Array.from(this.promises.keys()).map(e=>parseInt(e.substring(1))).filter(e=>!isNaN(e)),o=`p${Math.max(...r,0)+1}`,l=new Dr(e,t,a,n);this.promises.set(o,l)}addSummary(e,t,a){const n=this.datetime.clone();this.summaries.push(new Mr(n,e,t,a))}getLatestSummaryLastMessageId(){const e=getVariables({type:'chat'}),t=e.settings?.exclude_latest_summaries||0;if(t>=this.summaries.length)return-1;const a=this.summaries.slice(0,this.summaries.length-t);return 0===a.length?-1:a[a.length-1].last_message_id}getGeneralStatusPrompt(){const e=this.datetime.year,t=this.datetime.month,a=this.datetime.date,n=this.datetime.hours,r=this.datetime.minutes,o=`${e}${t}${a} (${['','','','','','',''][this.datetime.toDate().getDay()]}) ${n.toString().padStart(2,'0')}:${r.toString().padStart(2,'0')}`,l=this.getCurrentLocations().map(e=>`${e.name}(${e.id})`).join('-');let i='<GeneralStatus>\n';return i+=`  ${Yr.DATETIME_KEY}:${o}\n`,i+=`  ${Yr.CURRENT_LOCATION_ID_KEY}:${l}\n`,i+=`  ${Yr.WEATHER_KEY}:${this.weather}\n`,i+=`  ${Yr.CURRENT_EVENT_KEY}:${this.current_event}\n`,i+='</GeneralStatus>\n',i}getUserPrompt(){const e=this.active_characters.get('c1');let t=`<${e.name}Status>\n`;t+='id: c1\n',t+=`  ${Br.NAME_KEY}:${e.name}\n`,t+=`  ${Br.AGE_KEY}:${e.age}\n`,t+=`  ${Br.GENDER_KEY}:${e.gender}\n`,t+=`  ${Br.IDENTITY_KEY}:${e.identity}\n`,t+=`  ${Br.INTRODUCTION_KEY}:${e.introduction}\n`,t+=`  ${Br.PERSONALITY_KEY}:${e.personality}\n`,t+=`  ${Br.HEIGHT_KEY}:${e.height}\n`,t+=`  ${Br.WEIGHT_KEY}:${e.weight}\n`,t+=`  ${Br.CHEST_SIZE_KEY}:${e.chest_size}\n`,e.cup_size&&(t+=`  ${Br.CUP_SIZE_KEY}:${e.cup_size}\n`),t+=`  ${Br.WAIST_SIZE_KEY}:${e.waist_size}\n`,t+=`  ${Br.HIPS_SIZE_KEY}:${e.hips_size}\n`,t+=`  ${Br.HAIRSTYLE_KEY}:${e.hairstyle}\n`,t+=`  ${Br.CLOTHES_KEY}:${e.clothes}\n`,t+=`  ${Br.BIRTHDAY_KEY}:${e.birthday.month}${e.birthday.date}\n`,t+=`  ${Br.FAVOURITE_KEY}:${e.favourite}\n`,t+=`  ${Br.EXTRA_INFORMATION_KEY}:${e.extra_information}\n`,t+=`  ${Br.MONEY_KEY}:${e.money}\n`,t+=`  ${Br.RELATIONS_KEY}:\n`;for(const[a,n]of e.relations)t+=`    ${a}:${n}\n`;t+=`  ${Br.INVENTORY_KEY}:\n`;for(const[a,n]of e.inventory)t+=`    ${a}:${n}\n`;return t+=`</${e.name}Status>\n`,t}getActiveCharacterPrompt(){let e='<ActiveCharacterStatus>\n';for(const[t,a]of this.active_characters)if('c1'!==t){e+=`id: ${t}\n`,e+=`  ${Br.NAME_KEY}:${a.name}\n`,e+=`  ${Br.AGE_KEY}:${a.age}\n`,e+=`  ${Br.GENDER_KEY}:${a.gender}\n`,e+=`  ${Br.IDENTITY_KEY}:${a.identity}\n`,e+=`  ${Br.INTRODUCTION_KEY}:${a.introduction}\n`,e+=`  ${Br.PERSONALITY_KEY}:${a.personality}\n`,e+=`  ${Br.HEIGHT_KEY}:${a.height}\n`,e+=`  ${Br.WEIGHT_KEY}:${a.weight}\n`,e+=`  ${Br.CHEST_SIZE_KEY}:${a.chest_size}\n`,a.cup_size&&(e+=`  ${Br.CUP_SIZE_KEY}:${a.cup_size}\n`),e+=`  ${Br.WAIST_SIZE_KEY}:${a.waist_size}\n`,e+=`  ${Br.HIPS_SIZE_KEY}:${a.hips_size}\n`,e+=`  ${Br.HAIRSTYLE_KEY}:${a.hairstyle}\n`,e+=`  ${Br.CLOTHES_KEY}:${a.clothes}\n`,e+=`  ${Br.BIRTHDAY_KEY}:${a.birthday.month}${a.birthday.date}\n`,e+=`  ${Br.FAVOURITE_KEY}:${a.favourite}\n`,e+=`  ${Br.EXTRA_INFORMATION_KEY}:${a.extra_information}\n`,e+=`  ${Br.MONEY_KEY}:${a.money}\n`,e+=`  ${Br.MOOD_KEY}:${a.mood}\n`,e+=`  ${Br.HORNY_KEY}:${a.horny}\n`,e+=`  ${Br.RELATIONS_KEY}:\n`;for(const[t,n]of a.relations)e+=`    ${t}:${n}\n`;e+=`  ${Br.FRIENDSHIPS_KEY}:\n`;for(const[t,n]of a.friendships)e+=`    ${t}:${n}\n`;e+=`  ${Br.LOVES_KEY}:\n`;for(const[t,n]of a.loves)e+=`    ${t}:${n}\n`;e+=`  ${Br.INVENTORY_KEY}:\n`;for(const[t,n]of a.inventory)e+=`    ${t}:${n}\n`;e+='\n'}return e+='</ActiveCharacterStatus>\n',e}getDeactiveCharacterPrompt(){let e='<DeactiveCharacterStatus>\n';for(const[t,a]of this.deactive_characters){e+=`id: ${t}\n`,e+=`  ${Br.NAME_KEY}:${a.name}\n`,e+=`  ${Br.AGE_KEY}:${a.age}\n`,e+=`  ${Br.GENDER_KEY}:${a.gender}\n`,e+=`  ${Br.IDENTITY_KEY}:${a.identity}\n`,e+=`  ${Br.INTRODUCTION_KEY}:${a.introduction}\n`,e+=`  ${Br.PERSONALITY_KEY}:${a.personality}\n`,e+=`  ${Br.FAVOURITE_KEY}:${a.favourite}\n`,e+=`  ${Br.EXTRA_INFORMATION_KEY}:${a.extra_information}\n`,e+=`  ${Br.RELATIONS_KEY}:\n`;for(const[t,n]of a.relations)e+=`    ${t}:${n}\n`;e+=`  ${Br.FRIENDSHIPS_KEY}:\n`;for(const[t,n]of a.friendships)e+=`    ${t}:${n}\n`;e+=`  ${Br.LOVES_KEY}:\n`;for(const[t,n]of a.loves)e+=`    ${t}:${n}\n`;e+='\n'}return e+='</DeactiveCharacterStatus>\n',e}getItemPrompt(){let e='<ItemTable>\n';e+=`|id|${Ir.NAME_KEY}|${Ir.DESCRIPTION_KEY}|${Ir.VALUE_KEY}|\n`,e+='|---|---|---|---|\n';for(const[t,a]of this.items)e+=`|${t}|${a.name}|${a.description}|${a.value}|\n`;return e+='</ItemTable>\n',e}getLocationPrompt(){let e='<LocationTable>\n';e+=`|id|${$r.NAME_KEY}|${$r.LOCATION_KEY}|${$r.DESCRIPTION_KEY}|${$r.SUB_LOCATION_IDS_KEY}|${$r.STORAGE_IDS_KEY}|\n`,e+='|---|---|---|---|---|\n';for(const[t,a]of this.locations)e+=`|${t}|${a.name}|${a.location}|${a.description}|${a.sub_location_ids.join(',')}|${a.storage_ids.join(',')}|\n`;return e+='</LocationTable>\n',e}getStoragePrompt(){let e='<StorageTable>\n';e+=`|id|${Rr.NAME_KEY}|${Rr.DESCRIPTION_KEY}|${Rr.MONEY_KEY}|${Rr.INVENTORY_KEY}|\n`,e+='|---|---|---|---|---|\n';for(const[t,a]of this.storages){const n=Array.from(a.inventory.entries()).map(([e,t])=>`${e}:${t}`).join(', ');e+=`|${t}|${a.name}|${a.description}|${a.money}|${n}|\n`}return e+='</StorageTable>\n',e}getPromisePrompt(){let e='<PromiseTable>\n';e+=`|id|${Dr.DEADLINE_KEY}|${Dr.CHARACTER_IDS_KEY}|${Dr.LOCATION_ID_KEY}|${Dr.DESCRIPTION_KEY}|\n`,e+='|---|---|---|---|---|\n';for(const[t,a]of this.promises){e+=`|${t}|${`${a.deadline.year}${a.deadline.month}${a.deadline.date} ${a.deadline.hours.toString().padStart(2,'0')}:${a.deadline.minutes.toString().padStart(2,'0')}`}|${a.character_ids.join(',')}|${a.location_id}|${a.description}|\n`}return e+='</PromiseTable>\n',e}getSummaryPrompt(){const e=getVariables({type:'chat'}),t=e.settings?.exclude_latest_summaries||0,a=this.summaries.slice(0,this.summaries.length-t);let n='<HistorySummary>\n';n+=`|${Mr.DATETIME_KEY}|${Mr.SUMMARY_KEY}|${Mr.WEIGHTING_KEY}|\n`,n+='|---|---|---|\n';for(const e of a){n+=`|${`${e.datetime.year}${e.datetime.month}${e.datetime.date} ${e.datetime.hours.toString().padStart(2,'0')}:${e.datetime.minutes.toString().padStart(2,'0')}`}|${e.summary}|${e.weighting.toFixed(2)}|\n`}return n+='</HistorySummary>\n',n}getStartingBackground(){let e='<StartingBackground>\n';return e+=`${getVariables({type:'chat'}).start_settings.information}\n`,e+='</StartingBackground>\n',e}injectPrompt(e){let t='';e&&(t+=`${this.getStartingBackground()}\n`),t+=`${this.getSummaryPrompt()}`;let a=`${this.getGeneralStatusPrompt()}\n`;a+=`${this.getUserPrompt()}\n`,a+=`${this.getActiveCharacterPrompt()}\n`,a+=`${this.getDeactiveCharacterPrompt()}\n`,a+=`${this.getItemPrompt()}\n`,a+=`${this.getStoragePrompt()}\n`,a+=`${this.getLocationPrompt()}\n`,a+=`${this.getPromisePrompt()}`,injectPrompts([{id:'pre-chat_prompt',position:'in_chat',depth:9999,role:'system',content:t,should_scan:!0}]),injectPrompts([{id:'post-chat_prompt',position:'in_chat',depth:0,role:'system',content:a,should_scan:!0}])}}const Ar={class:'start-container'},zr={class:'section'},Or={class:'datetime-group'},Kr={class:'datetime-inputs'},Lr={class:'datetime-input'},Ur={class:'datetime-input'},Fr={class:'datetime-input'},Pr={class:'datetime-input'},jr={class:'datetime-input'},Hr={key:0,class:'generated-result'},Gr={class:'generated-text'},qr={class:'input-group'},Xr=['value'],Wr={key:0,class:'generated-result'},Jr={class:'generated-text'},Zr={class:'input-group'},Qr={key:0,class:'generated-result'},eo={class:'generated-text'},to={class:'input-group'},ao={key:0,class:'generated-result'},no={class:'generated-text'},ro={class:'input-group'},oo={class:'item-actions'},lo=['disabled'],io={key:0,class:'loading-spinner'},so=['disabled'],co={class:'completion-status'},uo={class:'status-value'},po={class:'status-value'},mo={class:'status-value'},go={class:'status-value'},vo={class:'status-value'},bo={class:'status-value'},fo={class:'status-value'},ho={class:'settings-actions'},xo={class:'action-btn import'},_o={class:'start-action'},Eo=['disabled'],yo=(0,t.defineComponent)({__name:'start_tab',setup(e){const a=(0,t.ref)(''),n=(0,t.ref)(''),r=(0,t.ref)(''),o=(0,t.ref)(''),l=(0,t.ref)(''),i=(0,t.ref)(''),s=(0,t.ref)(''),c=(0,t.ref)(''),d=(0,t.ref)(''),u=(0,t.ref)(!1),p=(0,t.ref)(''),m=(0,t.ref)(''),g=(0,t.ref)(''),v=(0,t.ref)(''),b=(0,t.ref)(''),f=(0,t.ref)(''),h=(0,t.ref)(''),x=(0,t.ref)(''),E=(0,t.computed)(()=>{try{const e=getVariables({type:'chat'});return!!e?.world_info?.trim()}catch{return!1}}),y=(0,t.computed)(()=>{try{const e=getVariables({type:'chat'}),t=e?.locations||{},a=new Map;for(const[e,n]of Object.entries(t))a.set(e,n);return a}catch{return new Map}}),k=(0,t.computed)(()=>p.value||m.value||g.value||v.value||b.value||f.value||h.value||x.value),N=(0,t.computed)(()=>''!==String(a.value).trim()&&''!==String(n.value).trim()&&''!==String(r.value).trim()&&''!==String(o.value).trim()&&''!==String(l.value).trim()&&''!==String(i.value).trim()&&''!==String(s.value).trim()&&''!==String(c.value).trim()),V=(0,t.computed)(()=>K()&&L()&&U()&&F()&&P()&&j()&&N.value),w=async()=>{u.value=!0;try{const e=B(),t=I(),d=D(),u=await generateRaw({user_input:e,ordered_prompts:[{role:'system',content:t},'char_description',{role:'system',content:d},'user_input']});M(u);try{const e={start_year:a.value,start_month:n.value,start_date:r.value,start_hour:o.value,start_minute:l.value,selected_location:i.value,weather:s.value,information:c.value,generated_start_year:p.value,generated_start_month:m.value,generated_start_date:g.value,generated_start_hour:v.value,generated_start_minute:b.value,generated_location:f.value,generated_weather:h.value,generated_information:x.value};localStorage.setItem('start_tab_generated',JSON.stringify(e))}catch(e){console.error(' localStorage :',e)}}catch(e){console.error(':',e)}finally{u.value=!1}},S=()=>{try{const e=getVariables({type:'chat'});e.start_settings={start_year:a.value,start_month:n.value,start_date:r.value,start_hour:o.value,start_minute:l.value,selected_location:i.value,weather:s.value,information:c.value},replaceVariables(e,{type:'chat'})}catch(e){console.error(':',e)}},C=()=>{try{const e=getVariables({type:'chat'});e?.start_settings&&(a.value=String(e.start_settings.start_year||''),n.value=String(e.start_settings.start_month||''),r.value=String(e.start_settings.start_date||''),o.value=String(e.start_settings.start_hour||''),l.value=String(e.start_settings.start_minute||''),i.value=String(e.start_settings.selected_location||''),s.value=String(e.start_settings.weather||''),c.value=String(e.start_settings.information||''));const t=localStorage.getItem('start_tab_generated');if(t)try{const e=JSON.parse(t);a.value||(a.value=e.start_year||''),n.value||(n.value=e.start_month||''),r.value||(r.value=e.start_date||''),o.value||(o.value=e.start_hour||''),l.value||(l.value=e.start_minute||''),i.value||(i.value=e.selected_location||''),s.value||(s.value=e.weather||''),c.value||(c.value=e.information||''),p.value=e.generated_start_year||'',m.value=e.generated_start_month||'',g.value=e.generated_start_date||'',v.value=e.generated_start_hour||'',b.value=e.generated_start_minute||'',f.value=e.generated_location||'',h.value=e.generated_weather||'',x.value=e.generated_information||''}catch(e){console.error(':',e)}const u=localStorage.getItem('start_tab_generation_requirement');u&&(d.value=u)}catch(e){console.error(':',e)}};(0,t.onMounted)(()=>{C()}),(0,t.watch)([a,n,r,o,l,i,s,c,d],()=>{S(),T()},{deep:!0}),(0,t.watch)(()=>getVariables({type:'chat'}),e=>{e?.start_settings&&C()},{deep:!0});const T=()=>{try{localStorage.setItem('start_tab_generation_requirement',d.value)}catch(e){console.error(' localStorage :',e)}},B=()=>{let e='\n\n';return e+=`()${a.value||''}\n`,e+=`()${n.value||''}\n`,e+=`()${r.value||''}\n`,e+=`()${o.value||''}\n`,e+=`()${l.value||''}\n`,e+=`${i.value||''}\n`,e+=`${s.value||''}\n`,e+=`${c.value||''}\n`,e},I=()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='\n';return a+='\n',a+='<>\n','\n\n<>\n'},D=()=>{let e='\n</>\n';return e+='\n',e+=`${(()=>{const e=getVariables({type:'chat'}).characters.c1,t=`${e.}${e.}`;let a=`<${t}Status>\n`;return a+='idc1\n',a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${R(e.)}\n`,a+=`  ${R(e.)}\n`,a+=`  ${R(e.)}\n`,a+=`</${t}Status>`,a})()}\n`,e+='\n',e+=`${(()=>{const e=getVariables({type:'chat'}).characters;if(void 0===e)return'';let t='<CharacterStatus>\n';for(const[a,n]of Object.entries(e))'c1'!==a&&(t+=`id${a}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${R(n.)}\n`,t+=`  ${R(n.)}\n`,t+=`  ${R(n.)}\n\n`);return t+='</CharacterStatus>',t})()}\n`,e+='\n',e+=`${(()=>{let e='<ItemTable>\n';e+='|id||||\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).items;if(void 0===t)return'';for(const[a,n]of Object.entries(t))e+=`|${a}|${n.name}|${n.description}|${n.value}|\n`;return e+='</ItemTable>',e})()}\n`,e+='\n',e+=`${(()=>{let e='<LocationTable>\n';e+='|id||||\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.description}|${t}|\n`}return e+='</LocationTable>',e})()}\n`,e+='\n',e+=`${(()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e})()}\n`,e+='\n',e+='<>\n',e+=`${d.value||''}\n`,e+='</>\n',e+='\n',e+='<example>\n',e+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output. Output anything other than this format is prohibited.\n',e+='()number\n',e+='()number[1~12]\n',e+='()number[1~31]\n',e+='()number[0~23]\n',e+='()number[0~59]\n',e+='location id\n',e+='\'\'\n',e+='\'\'\n',e+='</example>\n',e},R=e=>'['+Object.entries(e).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']',M=e=>{const t=e.split('\n'),a={};for(const e of t){const t=e.trim();if(t.includes('')){const[e,n]=t.split('',2),r=n?.trim().replace(/^["']|["']$/g,'')||'';switch(e.trim()){case'()':a.generated_start_year=r;break;case'()':a.generated_start_month=r;break;case'()':a.generated_start_date=r;break;case'()':a.generated_start_hour=r;break;case'()':a.generated_start_minute=r;break;case'':a.generated_location=r;break;case'':a.generated_weather=r;break;case'':a.generated_information=r}}}Object.assign(p,{value:a.generated_start_year||''}),Object.assign(m,{value:a.generated_start_month||''}),Object.assign(g,{value:a.generated_start_date||''}),Object.assign(v,{value:a.generated_start_hour||''}),Object.assign(b,{value:a.generated_start_minute||''}),Object.assign(f,{value:a.generated_location||''}),Object.assign(h,{value:a.generated_weather||''}),Object.assign(x,{value:a.generated_information||''})},Y=()=>{p.value&&(a.value=p.value),m.value&&(n.value=m.value),g.value&&(r.value=g.value),v.value&&(o.value=v.value),b.value&&(l.value=b.value),p.value='',m.value='',g.value='',v.value='',b.value=''},A=()=>{Y(),f.value&&(i.value=f.value),h.value&&(s.value=h.value),x.value&&(c.value=x.value),f.value='',h.value='',x.value='',S();try{localStorage.removeItem('start_tab_generated')}catch(e){console.error(' localStorage :',e)}},O=e=>''===e||(null===e||void 0===e),K=()=>''!==(getVariables({type:'chat'}).world_info||'').trim(),L=()=>{const e=getVariables({type:'chat'}),t=e?.characters?.c1;if(!t)return!1;for(const e of Object.values(t))if(O(e))return!1;return!0},U=()=>{const e=getVariables({type:'chat'}),t=e?.characters;if(!t)return!1;for(const[e,a]of Object.entries(t))if('c1'!==e)for(const e of Object.values(a))if(O(e))return!1;return!0},F=()=>{const e=getVariables({type:'chat'}),t=e?.items;if(!t)return!1;for(const e of Object.values(t))for(const t of Object.values(e))if(O(t))return!1;return!0},P=()=>{const e=getVariables({type:'chat'}),t=e?.extra_world_info;if(!t)return!1;for(const e of Object.values(t))for(const t of Object.values(e))if(O(t))return!1;return!0},j=()=>{const e=getVariables({type:'chat'}),t=e?.locations;if(!t)return!1;const a=Object.keys(t);if(0===a.length)return!1;for(const e of a){const a=t[e];if(!a?.name?.trim()||!a?.location?.trim()||!a?.description?.trim())return!1}return!0},H=()=>{const e=parseInt(a.value),t=parseInt(n.value),c=parseInt(r.value),d=parseInt(o.value),u=parseInt(l.value),p=getVariables({type:'chat'}),m=p?.locations||{},g=i.value,v=s.value;let b=getVariables({type:'chat'});const f=b.characters,h=new Map,x=new Map;for(const[a,n]of Object.entries(f)){const r=`${n.}${n.}`,o=parseInt(n.),l=parseInt(n.),i=parseInt(n.);let s=e-o;(t<i||t===i&&c<l)&&(s-=1);const d=new Tr(new Date(s,i-1,l));let u=n.;/^[a-zA-Z]$/.test(n.)||(u=null);const p=new Br(r,o,n.,n.,n.,n.,n.,n.,n.,u,n.,n.,n.,n.,n.,d,n.,n.,n.,n.,n.,new Map(Object.entries(n.)),new Map(Object.entries(n.)),new Map(Object.entries(n.)),new Map(Object.entries(n.)));'c1'===a?h.set(a,p):x.set(a,p)}const E=b.items,y=new Map;for(const[e,t]of Object.entries(E)){const a=new Ir(t.name,t.description,t.value);y.set(e,a)}const k=new Map;for(const[e,t]of Object.entries(m)){const a=new $r(e,t.name,t.location,t.description,null,t.sub_location,t.storage_ids||[]);k.set(e,a)}for(const[e,t]of k.entries())for(const a of t.sub_location_ids)k.has(a)&&(k.get(a).parent_location_id=e);const N=new Yr(new Tr(new Date(e,t-1,c,d,u)),g,v,Yr.CURRENT_EVENT_NULL_VALUE,h,x,y,new Map,k,new Map,[]);N.saveAsVariable(-1),N.saveAsVariable(0),b=getVariables({type:'chat'}),b.is_initialized=!0,replaceVariables(b,{type:'chat'}),eventEmit('initialization_completed')},G=()=>{try{const e=getVariables({type:'chat'}),t={world_info:e.world_info||'',characters:e.characters||{},items:e.items||{},storages:e.storages||{},locations:e.locations||{},extra_world_info:e.extra_world_info||[],extra_world_info_prompt:e.extra_world_info_prompt||'',start_settings:e.start_settings||{}},a=JSON.stringify(t,null,2),n=new Blob([a],{type:'application/json'}),r=URL.createObjectURL(n),o=document.createElement('a');o.href=r,o.download=`initialization_settings_${(new Date).toISOString().split('T')[0]}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r),toastr.success('')}catch(e){console.error(':',e),toastr.error('')}},q=e=>{const t=e.target.files?.[0];if(!t)return;const a=new FileReader;a.onload=e=>{try{const t=e.target?.result,a=JSON.parse(t),n=['world_info','characters','items','storages','locations','extra_world_info','extra_world_info_prompt','start_settings'];for(const e of n)if(!(e in a))throw new Error(`: ${e}`);const r=getVariables({type:'chat'});r.world_info=a.world_info,r.characters=a.characters,r.items=a.items,r.storages=a.storages,r.locations=a.locations,r.extra_world_info=a.extra_world_info,r.extra_world_info_prompt=a.extra_world_info_prompt,r.start_settings=a.start_settings,replaceVariables(r,{type:'chat'}),C(),toastr.success('')}catch(e){console.error(':',e),toastr.error('')}},a.readAsText(t)};return(e,S)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',Ar,[S[35]||(S[35]=(0,t.createElementVNode)('h3',null,'',-1)),(0,t.createElementVNode)('div',zr,[(0,t.createElementVNode)('div',Or,[S[18]||(S[18]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Kr,[(0,t.createElementVNode)('div',Lr,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':S[0]||(S[0]=e=>a.value=e),type:'number',class:'form-input',placeholder:'',min:'1900',max:'2100'},null,512),[[t.vModelText,a.value]]),S[12]||(S[12]=(0,t.createElementVNode)('span',{class:'unit'},'',-1))]),(0,t.createElementVNode)('div',Ur,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':S[1]||(S[1]=e=>n.value=e),type:'number',class:'form-input',placeholder:'',min:'1',max:'12'},null,512),[[t.vModelText,n.value]]),S[13]||(S[13]=(0,t.createElementVNode)('span',{class:'unit'},'',-1))]),(0,t.createElementVNode)('div',Fr,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':S[2]||(S[2]=e=>r.value=e),type:'number',class:'form-input',placeholder:'',min:'1',max:'31'},null,512),[[t.vModelText,r.value]]),S[14]||(S[14]=(0,t.createElementVNode)('span',{class:'unit'},'',-1))]),(0,t.createElementVNode)('div',Pr,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':S[3]||(S[3]=e=>o.value=e),type:'number',class:'form-input',placeholder:'',min:'0',max:'23'},null,512),[[t.vModelText,o.value]]),S[15]||(S[15]=(0,t.createElementVNode)('span',{class:'unit'},'',-1))]),(0,t.createElementVNode)('div',jr,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':S[4]||(S[4]=e=>l.value=e),type:'number',class:'form-input',placeholder:'',min:'0',max:'59'},null,512),[[t.vModelText,l.value]]),S[16]||(S[16]=(0,t.createElementVNode)('span',{class:'unit'},'',-1))])]),p.value||m.value||g.value||v.value||b.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Hr,[S[17]||(S[17]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Gr,(0,t.toDisplayString)(p.value?`${p.value}\n`:'')+(0,t.toDisplayString)(m.value?`${m.value}\n`:'')+(0,t.toDisplayString)(g.value?`${g.value}\n`:'')+(0,t.toDisplayString)(v.value?`${v.value}\n`:'')+(0,t.toDisplayString)(b.value?`${b.value}`:''),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:Y},'')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',qr,[S[21]||(S[21]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':S[5]||(S[5]=e=>i.value=e),class:'form-input'},[S[19]||(S[19]=(0,t.createElementVNode)('option',{value:''},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)((0,t.unref)(y),([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e,value:e},(0,t.toDisplayString)(a.name)+' ('+(0,t.toDisplayString)(e)+') ',9,Xr))),128))],512),[[t.vModelSelect,i.value]]),f.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Wr,[S[20]||(S[20]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Jr,(0,t.toDisplayString)(f.value),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:S[6]||(S[6]=e=>{i.value=f.value,f.value=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Zr,[S[23]||(S[23]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':S[7]||(S[7]=e=>s.value=e),type:'text',class:'form-input',placeholder:''},null,512),[[t.vModelText,s.value]]),h.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Qr,[S[22]||(S[22]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',eo,(0,t.toDisplayString)(h.value),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:S[8]||(S[8]=e=>{s.value=h.value,h.value=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',to,[S[25]||(S[25]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':S[9]||(S[9]=e=>c.value=e),class:'form-textarea',placeholder:'',rows:'3'},null,512),[[t.vModelText,c.value]]),x.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',ao,[S[24]||(S[24]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',no,(0,t.toDisplayString)(x.value),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:S[10]||(S[10]=e=>{c.value=x.value,x.value=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',ro,[S[26]||(S[26]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':S[11]||(S[11]=e=>d.value=e),class:'form-textarea',placeholder:'',rows:'3'},null,512),[[t.vModelText,d.value]])]),(0,t.createElementVNode)('div',oo,[(0,t.createElementVNode)('button',{class:'action-btn generate',disabled:!(0,t.unref)(E)||u.value,onClick:w},[u.value?((0,t.openBlock)(),(0,t.createElementBlock)('span',io)):(0,t.createCommentVNode)('v-if',!0),(0,t.createTextVNode)(' '+(0,t.toDisplayString)(u.value?'...':(0,t.unref)(E)?'':''),1)],8,lo),(0,t.createElementVNode)('button',{class:'action-btn apply-all',disabled:!(0,t.unref)(k),onClick:A},'  ',8,so)])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',co,[(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['status-item',{completed:K()}])},[S[27]||(S[27]=(0,t.createElementVNode)('span',{class:'status-label'},'',-1)),(0,t.createElementVNode)('span',uo,(0,t.toDisplayString)(K()?'':''),1)],2),(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['status-item',{completed:L()}])},[S[28]||(S[28]=(0,t.createElementVNode)('span',{class:'status-label'},'',-1)),(0,t.createElementVNode)('span',po,(0,t.toDisplayString)(L()?'':''),1)],2),(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['status-item',{completed:U()}])},[S[29]||(S[29]=(0,t.createElementVNode)('span',{class:'status-label'},'',-1)),(0,t.createElementVNode)('span',mo,(0,t.toDisplayString)(U()?'':''),1)],2),(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['status-item',{completed:F()}])},[S[30]||(S[30]=(0,t.createElementVNode)('span',{class:'status-label'},'',-1)),(0,t.createElementVNode)('span',go,(0,t.toDisplayString)(F()?'':''),1)],2),(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['status-item',{completed:P()}])},[S[31]||(S[31]=(0,t.createElementVNode)('span',{class:'status-label'},'',-1)),(0,t.createElementVNode)('span',vo,(0,t.toDisplayString)(P()?'':''),1)],2),(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['status-item',{completed:j()}])},[S[32]||(S[32]=(0,t.createElementVNode)('span',{class:'status-label'},'',-1)),(0,t.createElementVNode)('span',bo,(0,t.toDisplayString)(j()?'':''),1)],2),(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['status-item',{completed:(0,t.unref)(N)}])},[S[33]||(S[33]=(0,t.createElementVNode)('span',{class:'status-label'},'',-1)),(0,t.createElementVNode)('span',fo,(0,t.toDisplayString)((0,t.unref)(N)?'':''),1)],2)]),(0,t.createCommentVNode)(' / '),(0,t.createElementVNode)('div',ho,[(0,t.createElementVNode)('button',{class:'action-btn export',onClick:G},''),(0,t.createElementVNode)('label',xo,[S[34]||(S[34]=(0,t.createTextVNode)('  ',-1)),(0,t.createElementVNode)('input',{type:'file',accept:'.json',style:{display:'none'},onChange:q},null,32)])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',_o,[(0,t.createElementVNode)('button',{class:'action-btn start',disabled:!(0,t.unref)(V),onClick:H},'',8,Eo)])]))}});n(2195);const ko=(0,c.A)(yo,[['__scopeId','data-v-ef5b3c42']]),No={class:'user-profile-container'},Vo={class:'section'},wo={class:'form-grid'},So={class:'input-group'},Co={key:0,class:'generated-result'},To={class:'generated-text'},Bo={class:'input-group'},Io={key:0,class:'generated-result'},$o={class:'generated-text'},Do={class:'input-group'},Ro={key:0,class:'generated-result'},Mo={class:'generated-text'},Yo={class:'input-group'},Ao={key:0,class:'generated-result'},zo={class:'generated-text'},Oo={class:'input-group'},Ko={key:0,class:'generated-result'},Lo={class:'generated-text'},Uo={class:'input-group'},Fo={class:'birthday-inputs'},Po={key:0,class:'generated-result'},jo={class:'generated-text'},Ho={class:'section'},Go={class:'form-grid'},qo={class:'input-group'},Xo={key:0,class:'generated-result'},Wo={class:'generated-text'},Jo={class:'input-group'},Zo={key:0,class:'generated-result'},Qo={class:'generated-text'},el={class:'input-group'},tl={key:0,class:'generated-result'},al={class:'generated-text'},nl={class:'input-group'},rl={key:0,class:'generated-result'},ol={class:'generated-text'},ll={class:'input-group'},il={key:0,class:'generated-result'},sl={class:'generated-text'},cl={class:'input-group'},dl={key:0,class:'generated-result'},ul={class:'generated-text'},pl={class:'section'},ml={class:'form-grid'},gl={class:'input-group full-width'},vl={key:0,class:'generated-result'},bl={class:'generated-text'},fl={class:'input-group full-width'},hl={key:0,class:'generated-result'},xl={class:'generated-text'},_l={class:'input-group full-width'},El={key:0,class:'generated-result'},yl={class:'generated-text'},kl={class:'section'},Nl={class:'form-grid'},Vl={class:'input-group full-width'},wl={key:0,class:'generated-result'},Sl={class:'generated-text'},Cl={class:'input-group full-width'},Tl={key:0,class:'generated-result'},Bl={class:'generated-text'},Il={class:'input-group full-width'},$l={key:0,class:'generated-result'},Dl={class:'generated-text'},Rl={class:'section'},Ml={class:'form-grid'},Yl={class:'input-group'},Al={key:0,class:'generated-result'},zl={class:'generated-text'},Ol={class:'input-group full-width'},Kl={key:0,class:'generated-result'},Ll={class:'generated-text'},Ul={class:'input-group full-width'},Fl={class:'relations-list'},Pl={class:'relation-target'},jl=['value','onInput'],Hl=['onClick'],Gl={class:'add-relation'},ql=['value'],Xl=['disabled'],Wl={key:0,class:'generated-result'},Jl={class:'generated-text'},Zl={class:'input-group full-width'},Ql={class:'inventory-list'},ei={class:'inventory-target'},ti=['value','onInput'],ai=['onClick'],ni={class:'add-inventory'},ri=['value'],oi=['disabled'],li=['disabled'],ii={key:0,class:'generated-result'},si={class:'generated-text'},ci={class:'section'},di={class:'form-grid'},ui={class:'input-group full-width'},pi={class:'action-section'},mi=['disabled'],gi={key:0,class:'loading-spinner'},vi=['disabled'],bi=(0,t.defineComponent)({__name:'user_tab',setup(e){const a=(0,t.ref)({surname:'',name:'',age:null,gender:'',identity:'',introduction:'',personality:'',height:null,weight:null,chest_size:null,cup_size:'',waist_size:null,hips_size:null,hairstyle:'',appearance:'',clothes:'',birthday_month:null,birthday_day:null,favourite:'',extra_information:'',money:null,generation_requirement:'',:new Map,selected_relation_target:'',:new Map,selected_inventory_item:'',selected_inventory_quantity:1,generated_surname:'',generated_name:'',generated_age:'',generated_gender:'',generated_identity:'',generated_introduction:'',generated_personality:'',generated_height:'',generated_weight:'',generated_chest_size:'',generated_cup_size:'',generated_waist_size:'',generated_hips_size:'',generated_hairstyle:'',generated_appearance:'',generated_clothes:'',generated_birthday_month:'',generated_birthday_day:'',generated_favourite:'',generated_extra_information:'',generated_money:'',generated_relationship:'',generated_inventory:''}),n=(0,t.ref)(!1),r=()=>{const e=new Map,a=getVariables({type:'chat'});if(a?.items)for(const[n,r]of Object.entries(a.items))e.set(n,(0,t.reactive)(r));return Array.from(e.entries())},o=e=>{if('c1'===e){const e=getVariables({type:'chat'}),t=e.characters?.c1;if(t){return`${t.||''}${t.||''}`.trim()||''}return''}{const t=getVariables({type:'chat'}),a=t.characters?.[e];if(a){return`${a.||''}${a.||''}`.trim()||''}return''}},l=e=>{const t=getVariables({type:'chat'}),a=t.items?.[e];return a&&a.name||''},i=(0,t.computed)(()=>a.value.generated_surname||a.value.generated_name||a.value.generated_age||a.value.generated_gender||a.value.generated_identity||a.value.generated_introduction||a.value.generated_personality||a.value.generated_height||a.value.generated_weight||a.value.generated_chest_size||a.value.generated_cup_size||a.value.generated_waist_size||a.value.generated_hips_size||a.value.generated_hairstyle||a.value.generated_appearance||a.value.generated_clothes||a.value.generated_birthday_month||a.value.generated_birthday_day||a.value.generated_favourite||a.value.generated_extra_information||a.value.generated_money||a.value.generated_relationship||a.value.generated_inventory),s=()=>{const e=new Map,a=getVariables({type:'chat'});if(a?.characters)for(const[n,r]of Object.entries(a.characters))'c1'!==n&&e.set(n,(0,t.reactive)(r));return Array.from(e.entries())},c=(0,t.computed)(()=>{try{const e=getVariables({type:'chat'});return e?.world_info?.trim()}catch{return!1}}),d=()=>{try{const e=getVariables({type:'chat'}),t=e.characters||{},n={:a.value.surname,:a.value.name,:a.value.age,:a.value.gender,:a.value.identity,:a.value.introduction,:a.value.personality,:a.value.height,:a.value.weight,:a.value.chest_size,:a.value.cup_size,:a.value.waist_size,:a.value.hips_size,:a.value.hairstyle,:a.value.appearance,:a.value.clothes,:a.value.birthday_month,:a.value.birthday_day,:a.value.favourite,:a.value.extra_information,:a.value.money,:50,:0,:Object.fromEntries(a.value.||new Map),:{},:{},:Object.fromEntries(a.value.||new Map)};t.c1=n,e.characters=t,replaceVariables(e,{type:'chat'})}catch(e){console.error('Failed to save user data to chat variables:',e)}},u=e=>'['+Object.entries(e).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']',p=()=>{let e='\n</>\n';return e+='\n',e+=`${(()=>{const e=getVariables({type:'chat'}).characters;if(void 0===e)return'';let t='<CharacterStatus>\n';for(const[a,n]of Object.entries(e))'c1'!==a&&(t+=`id${a}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${u(n.)}\n`,t+=`  ${u(n.)}\n`,t+=`  ${u(n.)}\n\n`);return t+='</CharacterStatus>',t})()}\n`,e+='\n',e+=`${(()=>{let e='<ItemTable>\n';e+='|id||||\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).items;if(void 0===t)return'';for(const[a,n]of Object.entries(t))e+=`|${a}|${n.name}|${n.description}|${n.value}|\n`;return e+='</ItemTable>',e})()}\n`,e+='\n',e+=`${(()=>{let e='<LocationTable>\n';e+='|id|||||\n',e+='|---|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.location||''}|${n.description}|${t}|\n`}return e+='</LocationTable>',e})()}\n`,e+='\n',e+=`${(()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e})()}\n`,e+='\n',e+='<>\n',e+=`${a.value.generation_requirement}\n`,e+='</>\n',e+='\n',e+='<example>\n',e+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output. Output anything other than this format is prohibited.\n',e+='string\n',e+='string\n',e+='number\n',e+='\'\' | \'\' | \'\'\n',e+='\'\'\n',e+='\'\'\n',e+='\'\'\n',e+='number\n',e+='number\n',e+='number\n',e+='\'Capital Letter\' | \'\'\n',e+='number\n',e+='number\n',e+='\'\'\n',e+='\'\'\n',e+='\'\'\n',e+='()number\n',e+='()number\n',e+='\'\'\n',e+='\'\'\n',e+='number\n',e+='[\'character_id\':\'\', ...]\n',e+='[\'item_id\':quantity, ...]\n',e+='</example>',e},m=async()=>{n.value=!0;try{const e=(()=>{let e='\n';return e+='\n',e+=`${a.value.surname}\n`,e+=`${a.value.name}\n`,e+=`${a.value.age}\n`,e+=`${a.value.gender}\n`,e+=`${a.value.identity}\n`,e+=`${a.value.introduction}\n`,e+=`${a.value.personality}\n`,e+=`${a.value.height}\n`,e+=`${a.value.weight}\n`,e+=`${a.value.chest_size}\n`,e+=`${a.value.cup_size}\n`,e+=`${a.value.waist_size}\n`,e+=`${a.value.hips_size}\n`,e+=`${a.value.hairstyle}\n`,e+=`${a.value.appearance}\n`,e+=`${a.value.clothes}\n`,e+=`()${a.value.birthday_month}\n`,e+=`()${a.value.birthday_day}\n`,e+=`${a.value.favourite}\n`,e+=`${a.value.extra_information}\n`,e+=`${a.value.money}\n`,e+=`${u(Object.fromEntries(a.value.||new Map))}\n`,e+=`${u(Object.fromEntries(a.value.||new Map))}\n`,e})(),t=(()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='\n';return a+='\n',a+='<>\n','\n\n<>\n'})(),n=p(),r=await generateRaw({user_input:e,ordered_prompts:[{role:'system',content:t},'char_description',{role:'system',content:n},'user_input']});g(r);try{localStorage.setItem('user_profile_generated',JSON.stringify({generation_requirement:a.value.generation_requirement,generated_surname:a.value.generated_surname,generated_name:a.value.generated_name,generated_age:a.value.generated_age,generated_gender:a.value.generated_gender,generated_identity:a.value.generated_identity,generated_introduction:a.value.generated_introduction,generated_personality:a.value.generated_personality,generated_height:a.value.generated_height,generated_weight:a.value.generated_weight,generated_chest_size:a.value.generated_chest_size,generated_cup_size:a.value.generated_cup_size,generated_waist_size:a.value.generated_waist_size,generated_hips_size:a.value.generated_hips_size,generated_hairstyle:a.value.generated_hairstyle,generated_appearance:a.value.generated_appearance,generated_clothes:a.value.generated_clothes,generated_birthday_month:a.value.generated_birthday_month,generated_birthday_day:a.value.generated_birthday_day,generated_favourite:a.value.generated_favourite,generated_extra_information:a.value.generated_extra_information,generated_money:a.value.generated_money,generated_relationship:a.value.generated_relationship,generated_inventory:a.value.generated_inventory}))}catch(e){console.error('Failed to save generated user profile to localStorage:',e)}}catch(e){console.error(':',e),a.value.generated_age=''}finally{n.value=!1}},g=e=>{const t=e.split('\n'),n={};for(const e of t){const t=e.indexOf('');if(t>0){const a=e.substring(0,t).trim(),r=e.substring(t+1).trim();switch(a){case'':n.generated_surname=r.replace(/^["']|["']$/g,'');break;case'':n.generated_name=r.replace(/^["']|["']$/g,'');break;case'':n.generated_age=r.replace(/[^\d]/g,'');break;case'':n.generated_gender=r.replace(/^["']|["']$/g,'');break;case'':n.generated_identity=r.replace(/^["']|["']$/g,'');break;case'':n.generated_introduction=r.replace(/^["']|["']$/g,'');break;case'':n.generated_personality=r.replace(/^["']|["']$/g,'');break;case'':n.generated_height=r.replace(/[^\d]/g,'');break;case'':n.generated_weight=r.replace(/[^\d]/g,'');break;case'':n.generated_chest_size=r.replace(/[^\d]/g,'');break;case'':n.generated_cup_size=r.replace(/^["']|["']$/g,'');break;case'':n.generated_waist_size=r.replace(/[^\d]/g,'');break;case'':n.generated_hips_size=r.replace(/[^\d]/g,'');break;case'':n.generated_hairstyle=r.replace(/^["']|["']$/g,'');break;case'':n.generated_appearance=r.replace(/^["']|["']$/g,'');break;case'':n.generated_clothes=r.replace(/^["']|["']$/g,'');break;case'()':n.generated_birthday_month=r.replace(/[^\d]/g,'');break;case'()':n.generated_birthday_day=r.replace(/[^\d]/g,'');break;case'':n.generated_favourite=r.replace(/^["']|["']$/g,'');break;case'':n.generated_extra_information=r.replace(/^["']|["']$/g,'');break;case'':n.generated_money=r.replace(/[^\d]/g,'');break;case'':n.generated_relationship=r.replace(/^["']|["']$/g,'');break;case'':n.generated_inventory=r.replace(/^["']|["']$/g,'')}}}Object.assign(a.value,n)},v=()=>{if(a.value.generated_surname&&(a.value.surname=a.value.generated_surname),a.value.generated_name&&(a.value.name=a.value.generated_name),a.value.generated_age&&(a.value.age=parseInt(a.value.generated_age)||null),a.value.generated_gender&&(a.value.gender=a.value.generated_gender),a.value.generated_identity&&(a.value.identity=a.value.generated_identity),a.value.generated_introduction&&(a.value.introduction=a.value.generated_introduction),a.value.generated_personality&&(a.value.personality=a.value.generated_personality),a.value.generated_height&&(a.value.height=parseInt(a.value.generated_height)||null),a.value.generated_weight&&(a.value.weight=parseInt(a.value.generated_weight)||null),a.value.generated_chest_size&&(a.value.chest_size=parseInt(a.value.generated_chest_size)||null),a.value.generated_cup_size&&(a.value.cup_size=a.value.generated_cup_size),a.value.generated_waist_size&&(a.value.waist_size=parseInt(a.value.generated_waist_size)||null),a.value.generated_hips_size&&(a.value.hips_size=parseInt(a.value.generated_hips_size)||null),a.value.generated_hairstyle&&(a.value.hairstyle=a.value.generated_hairstyle),a.value.generated_appearance&&(a.value.appearance=a.value.generated_appearance),a.value.generated_clothes&&(a.value.clothes=a.value.generated_clothes),a.value.generated_birthday_month&&(a.value.birthday_month=parseInt(a.value.generated_birthday_month)||null),a.value.generated_birthday_day&&(a.value.birthday_day=parseInt(a.value.generated_birthday_day)||null),a.value.generated_favourite&&(a.value.favourite=a.value.generated_favourite),a.value.generated_extra_information&&(a.value.extra_information=a.value.generated_extra_information),a.value.generated_money&&(a.value.money=parseInt(a.value.generated_money)||null),a.value.generated_relationship){a.value.||(a.value.=new Map);const e=a.value.generated_relationship.replace(/^["']|["']$/g,'');if(e.startsWith('[')&&e.endsWith(']')){const t=e.slice(1,-1).split(',').map(e=>e.trim());for(const e of t){const t=e.indexOf(':');if(t>0){const n=e.substring(0,t).replace(/^["']|["']$/g,'').trim(),r=e.substring(t+1).replace(/^["']|["']$/g,'').trim();n&&r&&a.value..set(n,r)}}}a.value.generated_relationship=''}if(a.value.generated_inventory){a.value.||(a.value.=new Map);const e=a.value.generated_inventory.replace(/^["']|["']$/g,'');if(e.startsWith('[')&&e.endsWith(']')){const t=e.slice(1,-1).split(',').map(e=>e.trim());for(const e of t){const t=e.indexOf(':');if(t>0){const n=e.substring(0,t).replace(/^["']|["']$/g,'').trim(),r=parseInt(e.substring(t+1).replace(/^["']|["']$/g,'').trim());n&&!isNaN(r)&&r>0&&a.value..set(n,r)}}}a.value.generated_inventory=''}a.value.generated_surname='',a.value.generated_name='',a.value.generated_age='',a.value.generated_gender='',a.value.generated_identity='',a.value.generated_introduction='',a.value.generated_personality='',a.value.generated_height='',a.value.generated_weight='',a.value.generated_chest_size='',a.value.generated_cup_size='',a.value.generated_waist_size='',a.value.generated_hips_size='',a.value.generated_hairstyle='',a.value.generated_appearance='',a.value.generated_clothes='',a.value.generated_birthday_month='',a.value.generated_birthday_day='',a.value.generated_favourite='',a.value.generated_extra_information='',a.value.generated_money='',a.value.generated_relationship='',a.value.generated_inventory=''},b=()=>{a.value.selected_relation_target&&(a.value.||(a.value.=new Map),a.value..set(a.value.selected_relation_target,''),a.value.selected_relation_target='',d())},f=()=>{if(!a.value.selected_inventory_item||!a.value.selected_inventory_quantity)return;a.value.||(a.value.=new Map);const e=a.value..get(a.value.selected_inventory_item)||0;a.value..set(a.value.selected_inventory_item,e+a.value.selected_inventory_quantity),a.value.selected_inventory_item='',a.value.selected_inventory_quantity=1,d()},h=(e,t)=>{switch(e){case'':a.value.surname=t,a.value.generated_surname='';break;case'':a.value.name=t,a.value.generated_name='';break;case'':a.value.age=parseInt(t)||null,a.value.generated_age='';break;case'':a.value.gender=t,a.value.generated_gender='';break;case'':a.value.identity=t,a.value.generated_identity='';break;case'':a.value.height=parseInt(t)||null,a.value.generated_height='';break;case'':a.value.weight=parseInt(t)||null,a.value.generated_weight='';break;case'':a.value.chest_size=parseInt(t)||null,a.value.generated_chest_size='';break;case'':a.value.cup_size=t,a.value.generated_cup_size='';break;case'':a.value.waist_size=parseInt(t)||null,a.value.generated_waist_size='';break;case'':a.value.hips_size=parseInt(t)||null,a.value.generated_hips_size='';break;case'':a.value.hairstyle=t,a.value.generated_hairstyle='';break;case'':a.value.appearance=t,a.value.generated_appearance='';break;case'':a.value.clothes=t,a.value.generated_clothes='';break;case'':a.value.introduction=t,a.value.generated_introduction='';break;case'':a.value.personality=t,a.value.generated_personality='';break;case'':a.value.favourite=t,a.value.generated_favourite='';break;case'':a.value.money=parseInt(t)||null,a.value.generated_money='';break;case'':a.value.extra_information=t,a.value.generated_extra_information='';break;case'':{a.value.||(a.value.=new Map);const e=t.replace(/^["']|["']$/g,'');if(e.startsWith('[')&&e.endsWith(']')){const t=e.slice(1,-1).split(',').map(e=>e.trim());for(const e of t){const t=e.indexOf(':');if(t>0){const n=e.substring(0,t).replace(/^["']|["']$/g,'').trim(),r=e.substring(t+1).replace(/^["']|["']$/g,'').trim();n&&r&&a.value..set(n,r)}}}a.value.generated_relationship='';break}case'':{a.value.||(a.value.=new Map);const e=t.replace(/^["']|["']$/g,'');if(e.startsWith('[')&&e.endsWith(']')){const t=e.slice(1,-1).split(',').map(e=>e.trim());for(const e of t){const t=e.indexOf(':');if(t>0){const n=e.substring(0,t).replace(/^["']|["']$/g,'').trim(),r=parseInt(e.substring(t+1).replace(/^["']|["']$/g,'').trim());n&&!isNaN(r)&&r>0&&a.value..set(n,r)}}}a.value.generated_inventory='';break}}d()};return(0,t.watch)(a,()=>{d()},{deep:!0}),(0,t.watch)(()=>a.value.generation_requirement,e=>{try{const t=localStorage.getItem('user_profile_generated'),a=t?JSON.parse(t):{};a.generation_requirement=e,localStorage.setItem('user_profile_generated',JSON.stringify(a))}catch(e){console.error('Failed to save generation_requirement to localStorage:',e)}},{immediate:!1}),(0,t.onMounted)(()=>{(()=>{try{const e=(getVariables({type:'chat'}).characters||{}).c1;e&&(a.value.surname=e['']||'',a.value.name=e['']||'',a.value.age=e[''],a.value.gender=e['']||'',a.value.identity=e['']||'',a.value.introduction=e['']||'',a.value.personality=e['']||'',a.value.height=e[''],a.value.weight=e[''],a.value.chest_size=e[''],a.value.cup_size=e['']||'',a.value.waist_size=e[''],a.value.hips_size=e[''],a.value.hairstyle=e['']||'',a.value.appearance=e['']||'',a.value.clothes=e['']||'',a.value.favourite=e['']||'',a.value.extra_information=e['']||'',a.value.money=e[''],a.value.birthday_month=e[''],a.value.birthday_day=e[''],e.?a.value.=new Map(Object.entries(e.)):a.value.=new Map,e.?a.value.=new Map(Object.entries(e.)):a.value.=new Map)}catch(e){console.error('Failed to load user data from chat variables:',e)}try{const e=localStorage.getItem('user_profile_generated');if(e){const t=JSON.parse(e);Object.assign(a.value,t)}}catch(e){console.error('Failed to load generated user profile from localStorage:',e)}})()}),(0,t.onBeforeUnmount)(()=>{d()}),(e,u)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',No,[u[103]||(u[103]=(0,t.createElementVNode)('h3',null,'',-1)),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Vo,[u[60]||(u[60]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',wo,[u[59]||(u[59]=(0,t.createElementVNode)('div',{class:'input-group'},[(0,t.createElementVNode)('label',null,'ID'),(0,t.createElementVNode)('div',{class:'display-text'},'c1')],-1)),(0,t.createElementVNode)('div',So,[u[48]||(u[48]=(0,t.createElementVNode)('label',{for:'surname-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'surname-input','onUpdate:modelValue':u[0]||(u[0]=e=>a.value.surname=e),type:'text',placeholder:'',class:'text-input'},null,512),[[t.vModelText,a.value.surname]]),a.value.generated_surname?((0,t.openBlock)(),(0,t.createElementBlock)('div',Co,[u[47]||(u[47]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',To,(0,t.toDisplayString)(a.value.generated_surname),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[1]||(u[1]=e=>{a.value.surname=a.value.generated_surname,a.value.generated_surname=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Bo,[u[50]||(u[50]=(0,t.createElementVNode)('label',{for:'name-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'name-input','onUpdate:modelValue':u[2]||(u[2]=e=>a.value.name=e),type:'text',placeholder:'',class:'text-input'},null,512),[[t.vModelText,a.value.name]]),a.value.generated_name?((0,t.openBlock)(),(0,t.createElementBlock)('div',Io,[u[49]||(u[49]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',$o,(0,t.toDisplayString)(a.value.generated_name),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[3]||(u[3]=e=>{a.value.name=a.value.generated_name,a.value.generated_name=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Do,[u[52]||(u[52]=(0,t.createElementVNode)('label',{for:'age-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'age-input','onUpdate:modelValue':u[4]||(u[4]=e=>a.value.age=e),type:'number',placeholder:'18',class:'text-input',min:'0',max:'200'},null,512),[[t.vModelText,a.value.age,void 0,{number:!0}]]),a.value.generated_age?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ro,[u[51]||(u[51]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Mo,(0,t.toDisplayString)(a.value.generated_age),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[5]||(u[5]=e=>{a.value.age=parseInt(a.value.generated_age)||null,a.value.generated_age=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Yo,[u[54]||(u[54]=(0,t.createElementVNode)('label',{for:'gender-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'gender-input','onUpdate:modelValue':u[6]||(u[6]=e=>a.value.gender=e),type:'text',placeholder:'',class:'text-input'},null,512),[[t.vModelText,a.value.gender]]),a.value.generated_gender?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ao,[u[53]||(u[53]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',zo,(0,t.toDisplayString)(a.value.generated_gender),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[7]||(u[7]=e=>{a.value.gender=a.value.generated_gender,a.value.generated_gender=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Oo,[u[56]||(u[56]=(0,t.createElementVNode)('label',{for:'identity-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'identity-input','onUpdate:modelValue':u[8]||(u[8]=e=>a.value.identity=e),type:'text',placeholder:'',class:'text-input'},null,512),[[t.vModelText,a.value.identity]]),a.value.generated_identity?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ko,[u[55]||(u[55]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Lo,(0,t.toDisplayString)(a.value.generated_identity),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[9]||(u[9]=e=>{a.value.identity=a.value.generated_identity,a.value.generated_identity=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Uo,[u[58]||(u[58]=(0,t.createElementVNode)('label',{for:'birthday-input'},'',-1)),(0,t.createElementVNode)('div',Fo,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':u[10]||(u[10]=e=>a.value.birthday_month=e),type:'number',placeholder:'',class:'birthday-input',min:'1',max:'12'},null,512),[[t.vModelText,a.value.birthday_month,void 0,{number:!0}]]),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':u[11]||(u[11]=e=>a.value.birthday_day=e),type:'number',placeholder:'',class:'birthday-input',min:'1',max:'31'},null,512),[[t.vModelText,a.value.birthday_day,void 0,{number:!0}]])]),a.value.generated_birthday_month||a.value.generated_birthday_day?((0,t.openBlock)(),(0,t.createElementBlock)('div',Po,[u[57]||(u[57]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',jo,(0,t.toDisplayString)(a.value.generated_birthday_month)+' '+(0,t.toDisplayString)(a.value.generated_birthday_day)+' ',1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[12]||(u[12]=e=>{a.value.birthday_month=parseInt(a.value.generated_birthday_month)||null,a.value.birthday_day=parseInt(a.value.generated_birthday_day)||null,a.value.generated_birthday_month='',a.value.generated_birthday_day=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Ho,[u[73]||(u[73]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',Go,[(0,t.createElementVNode)('div',qo,[u[62]||(u[62]=(0,t.createElementVNode)('label',{for:'height-input'},' (cm)',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'height-input','onUpdate:modelValue':u[13]||(u[13]=e=>a.value.height=e),type:'number',placeholder:'165',class:'text-input',min:'0',max:'300'},null,512),[[t.vModelText,a.value.height,void 0,{number:!0}]]),a.value.generated_height?((0,t.openBlock)(),(0,t.createElementBlock)('div',Xo,[u[61]||(u[61]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Wo,(0,t.toDisplayString)(a.value.generated_height),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[14]||(u[14]=e=>{a.value.height=parseInt(a.value.generated_height)||null,a.value.generated_height=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Jo,[u[64]||(u[64]=(0,t.createElementVNode)('label',{for:'weight-input'},' (kg)',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'weight-input','onUpdate:modelValue':u[15]||(u[15]=e=>a.value.weight=e),type:'number',placeholder:'50',class:'text-input',min:'0',max:'500'},null,512),[[t.vModelText,a.value.weight,void 0,{number:!0}]]),a.value.generated_weight?((0,t.openBlock)(),(0,t.createElementBlock)('div',Zo,[u[63]||(u[63]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Qo,(0,t.toDisplayString)(a.value.generated_weight),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[16]||(u[16]=e=>{a.value.weight=parseInt(a.value.generated_weight)||null,a.value.generated_weight=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',el,[u[66]||(u[66]=(0,t.createElementVNode)('label',{for:'chest-size-input'},' (cm)',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'chest-size-input','onUpdate:modelValue':u[17]||(u[17]=e=>a.value.chest_size=e),type:'number',placeholder:'85',class:'text-input',min:'0',max:'200'},null,512),[[t.vModelText,a.value.chest_size,void 0,{number:!0}]]),a.value.generated_chest_size?((0,t.openBlock)(),(0,t.createElementBlock)('div',tl,[u[65]||(u[65]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',al,(0,t.toDisplayString)(a.value.generated_chest_size),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[18]||(u[18]=e=>{a.value.chest_size=parseInt(a.value.generated_chest_size)||null,a.value.generated_chest_size=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',nl,[u[68]||(u[68]=(0,t.createElementVNode)('label',{for:'cup-size-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'cup-size-input','onUpdate:modelValue':u[19]||(u[19]=e=>a.value.cup_size=e),type:'text',placeholder:'C',class:'text-input'},null,512),[[t.vModelText,a.value.cup_size]]),a.value.generated_cup_size?((0,t.openBlock)(),(0,t.createElementBlock)('div',rl,[u[67]||(u[67]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',ol,(0,t.toDisplayString)(a.value.generated_cup_size),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[20]||(u[20]=e=>{a.value.cup_size=a.value.generated_cup_size,a.value.generated_cup_size=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',ll,[u[70]||(u[70]=(0,t.createElementVNode)('label',{for:'waist-size-input'},' (cm)',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'waist-size-input','onUpdate:modelValue':u[21]||(u[21]=e=>a.value.waist_size=e),type:'number',placeholder:'60',class:'text-input',min:'0',max:'200'},null,512),[[t.vModelText,a.value.waist_size,void 0,{number:!0}]]),a.value.generated_waist_size?((0,t.openBlock)(),(0,t.createElementBlock)('div',il,[u[69]||(u[69]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',sl,(0,t.toDisplayString)(a.value.generated_waist_size),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[22]||(u[22]=e=>{a.value.waist_size=parseInt(a.value.generated_waist_size)||null,a.value.generated_waist_size=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',cl,[u[72]||(u[72]=(0,t.createElementVNode)('label',{for:'hips-size-input'},' (cm)',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'hips-size-input','onUpdate:modelValue':u[23]||(u[23]=e=>a.value.hips_size=e),type:'number',placeholder:'88',class:'text-input',min:'0',max:'200'},null,512),[[t.vModelText,a.value.hips_size,void 0,{number:!0}]]),a.value.generated_hips_size?((0,t.openBlock)(),(0,t.createElementBlock)('div',dl,[u[71]||(u[71]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',ul,(0,t.toDisplayString)(a.value.generated_hips_size),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[24]||(u[24]=e=>{a.value.hips_size=parseInt(a.value.generated_hips_size)||null,a.value.generated_hips_size=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',pl,[u[80]||(u[80]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',ml,[(0,t.createElementVNode)('div',gl,[u[75]||(u[75]=(0,t.createElementVNode)('label',{for:'hairstyle-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'hairstyle-input','onUpdate:modelValue':u[25]||(u[25]=e=>a.value.hairstyle=e),type:'text',placeholder:'',class:'text-input'},null,512),[[t.vModelText,a.value.hairstyle]]),a.value.generated_hairstyle?((0,t.openBlock)(),(0,t.createElementBlock)('div',vl,[u[74]||(u[74]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',bl,(0,t.toDisplayString)(a.value.generated_hairstyle),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[26]||(u[26]=e=>{a.value.hairstyle=a.value.generated_hairstyle,a.value.generated_hairstyle=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',fl,[u[77]||(u[77]=(0,t.createElementVNode)('label',{for:'appearance-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{id:'appearance-input','onUpdate:modelValue':u[27]||(u[27]=e=>a.value.appearance=e),placeholder:'...',class:'text-area',rows:'3'},null,512),[[t.vModelText,a.value.appearance]]),a.value.generated_appearance?((0,t.openBlock)(),(0,t.createElementBlock)('div',hl,[u[76]||(u[76]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',xl,(0,t.toDisplayString)(a.value.generated_appearance),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[28]||(u[28]=e=>{a.value.appearance=a.value.generated_appearance,a.value.generated_appearance=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',_l,[u[79]||(u[79]=(0,t.createElementVNode)('label',{for:'clothes-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{id:'clothes-input','onUpdate:modelValue':u[29]||(u[29]=e=>a.value.clothes=e),placeholder:'...',class:'text-area',rows:'3'},null,512),[[t.vModelText,a.value.clothes]]),a.value.generated_clothes?((0,t.openBlock)(),(0,t.createElementBlock)('div',El,[u[78]||(u[78]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',yl,(0,t.toDisplayString)(a.value.generated_clothes),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[30]||(u[30]=e=>{a.value.clothes=a.value.generated_clothes,a.value.generated_clothes=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',kl,[u[87]||(u[87]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',Nl,[(0,t.createElementVNode)('div',Vl,[u[82]||(u[82]=(0,t.createElementVNode)('label',{for:'introduction-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{id:'introduction-input','onUpdate:modelValue':u[31]||(u[31]=e=>a.value.introduction=e),placeholder:'...',class:'text-area',rows:'3'},null,512),[[t.vModelText,a.value.introduction]]),a.value.generated_introduction?((0,t.openBlock)(),(0,t.createElementBlock)('div',wl,[u[81]||(u[81]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Sl,(0,t.toDisplayString)(a.value.generated_introduction),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[32]||(u[32]=e=>{a.value.introduction=a.value.generated_introduction,a.value.generated_introduction=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Cl,[u[84]||(u[84]=(0,t.createElementVNode)('label',{for:'personality-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{id:'personality-input','onUpdate:modelValue':u[33]||(u[33]=e=>a.value.personality=e),placeholder:'...',class:'text-area',rows:'3'},null,512),[[t.vModelText,a.value.personality]]),a.value.generated_personality?((0,t.openBlock)(),(0,t.createElementBlock)('div',Tl,[u[83]||(u[83]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Bl,(0,t.toDisplayString)(a.value.generated_personality),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[34]||(u[34]=e=>{a.value.personality=a.value.generated_personality,a.value.generated_personality=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Il,[u[86]||(u[86]=(0,t.createElementVNode)('label',{for:'favourite-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{id:'favourite-input','onUpdate:modelValue':u[35]||(u[35]=e=>a.value.favourite=e),placeholder:'...',class:'text-area',rows:'3'},null,512),[[t.vModelText,a.value.favourite]]),a.value.generated_favourite?((0,t.openBlock)(),(0,t.createElementBlock)('div',$l,[u[85]||(u[85]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Dl,(0,t.toDisplayString)(a.value.generated_favourite),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[36]||(u[36]=e=>{a.value.favourite=a.value.generated_favourite,a.value.generated_favourite=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Rl,[u[100]||(u[100]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',Ml,[(0,t.createElementVNode)('div',Yl,[u[89]||(u[89]=(0,t.createElementVNode)('label',{for:'money-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'money-input','onUpdate:modelValue':u[37]||(u[37]=e=>a.value.money=e),type:'number',placeholder:'10000',class:'text-input',min:'0'},null,512),[[t.vModelText,a.value.money,void 0,{number:!0}]]),a.value.generated_money?((0,t.openBlock)(),(0,t.createElementBlock)('div',Al,[u[88]||(u[88]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',zl,(0,t.toDisplayString)(a.value.generated_money),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[38]||(u[38]=e=>{a.value.money=parseInt(a.value.generated_money)||null,a.value.generated_money=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Ol,[u[91]||(u[91]=(0,t.createElementVNode)('label',{for:'extra-info-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{id:'extra-info-input','onUpdate:modelValue':u[39]||(u[39]=e=>a.value.extra_information=e),placeholder:'...',class:'text-area',rows:'3'},null,512),[[t.vModelText,a.value.extra_information]]),a.value.generated_extra_information?((0,t.openBlock)(),(0,t.createElementBlock)('div',Kl,[u[90]||(u[90]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Ll,(0,t.toDisplayString)(a.value.generated_extra_information),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[40]||(u[40]=e=>{a.value.extra_information=a.value.generated_extra_information,a.value.generated_extra_information=''})},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Ul,[u[95]||(u[95]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Fl,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Array.from(a.value.||new Map),([e,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'relation-item'},[(0,t.createElementVNode)('span',Pl,'['+(0,t.toDisplayString)(e)+'] '+(0,t.toDisplayString)(o(e)),1),u[92]||(u[92]=(0,t.createTextVNode)('  ',-1)),(0,t.createElementVNode)('input',{value:n,type:'text',placeholder:'',class:'relation-input',onInput:t=>((e,t)=>{a.value.||(a.value.=new Map);const n=new Map(a.value.);n.set(e,t),a.value.=n,d()})(e,t.target.value)},null,40,jl),(0,t.createElementVNode)('button',{class:'remove-relation-btn',onClick:t=>(e=>{if(!a.value.)return;const t=new Map(a.value.);t.delete(e),a.value.=t,d()})(e)},'',8,Hl)]))),128)),(0,t.createElementVNode)('div',Gl,[(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':u[41]||(u[41]=e=>a.value.selected_relation_target=e),class:'relation-select'},[u[93]||(u[93]=(0,t.createElementVNode)('option',{value:''},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(s(),([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e,value:e},(0,t.toDisplayString)(`${e}: ${a.||''}${a.||''}`),9,ql))),128))],512),[[t.vModelSelect,a.value.selected_relation_target]]),(0,t.createElementVNode)('button',{class:'add-relation-btn',disabled:!a.value.selected_relation_target,onClick:b},'  ',8,Xl)])]),a.value.generated_relationship?((0,t.openBlock)(),(0,t.createElementBlock)('div',Wl,[u[94]||(u[94]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Jl,(0,t.toDisplayString)(a.value.generated_relationship),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[42]||(u[42]=e=>h('',a.value.generated_relationship))},'  ')])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',Zl,[u[99]||(u[99]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Ql,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Array.from(a.value.||new Map),([e,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'inventory-item'},[(0,t.createElementVNode)('span',ei,'['+(0,t.toDisplayString)(e)+'] '+(0,t.toDisplayString)(l(e)),1),u[96]||(u[96]=(0,t.createTextVNode)(' : ',-1)),(0,t.createElementVNode)('input',{value:n,type:'number',placeholder:'',class:'inventory-input',min:'1',onInput:t=>((e,t)=>{a.value.||(a.value.=new Map);const n=new Map(a.value.);t>0?n.set(e,t):n.delete(e),a.value.=n,d()})(e,parseInt(t.target.value)||1)},null,40,ti),(0,t.createElementVNode)('button',{class:'remove-inventory-btn',onClick:t=>(e=>{if(!a.value.)return;const t=new Map(a.value.);t.delete(e),a.value.=t,d()})(e)},'',8,ai)]))),128)),(0,t.createElementVNode)('div',ni,[(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':u[43]||(u[43]=e=>a.value.selected_inventory_item=e),class:'inventory-select'},[u[97]||(u[97]=(0,t.createElementVNode)('option',{value:''},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(r(),([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e,value:e},(0,t.toDisplayString)(`${e}: ${a.name||''}`),9,ri))),128))],512),[[t.vModelSelect,a.value.selected_inventory_item]]),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':u[44]||(u[44]=e=>a.value.selected_inventory_quantity=e),type:'number',placeholder:'',class:'quantity-input',min:'1',disabled:!a.value.selected_inventory_item},null,8,oi),[[t.vModelText,a.value.selected_inventory_quantity,void 0,{number:!0}]]),(0,t.createElementVNode)('button',{class:'add-inventory-btn',disabled:!a.value.selected_inventory_item||!a.value.selected_inventory_quantity,onClick:f},'  ',8,li)])]),a.value.generated_inventory?((0,t.openBlock)(),(0,t.createElementBlock)('div',ii,[u[98]||(u[98]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',si,(0,t.toDisplayString)(a.value.generated_inventory),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:u[45]||(u[45]=e=>h('',a.value.generated_inventory))},'  ')])):(0,t.createCommentVNode)('v-if',!0)])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',ci,[u[102]||(u[102]=(0,t.createElementVNode)('h4',null,'',-1)),(0,t.createElementVNode)('div',di,[(0,t.createElementVNode)('div',ui,[u[101]||(u[101]=(0,t.createElementVNode)('label',{for:'generation-requirement-input'},'AI',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{id:'generation-requirement-input','onUpdate:modelValue':u[46]||(u[46]=e=>a.value.generation_requirement=e),placeholder:'AI...',class:'text-area',rows:'3'},null,512),[[t.vModelText,a.value.generation_requirement]])])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',pi,[(0,t.createElementVNode)('button',{class:'generate-btn',disabled:!(0,t.unref)(c)||n.value,onClick:m},[n.value?((0,t.openBlock)(),(0,t.createElementBlock)('span',gi)):(0,t.createCommentVNode)('v-if',!0),(0,t.createTextVNode)(' '+(0,t.toDisplayString)(n.value?'...':(0,t.unref)(c)?'':''),1)],8,mi),(0,t.createElementVNode)('button',{class:'apply-all-btn',disabled:!(0,t.unref)(i),onClick:v},'',8,vi)])]))}});n(156);const fi=(0,c.A)(bi,[['__scopeId','data-v-76149319']]),hi={class:'world-background-container'},xi={class:'input-group'},_i={class:'input-group'},Ei={class:'input-group'},yi={class:'input-group'},ki=['disabled'],Ni={key:0,class:'loading-spinner'},Vi={class:'info-section'},wi={class:'input-group'},Si={class:'input-group'},Ci=['disabled'],Ti=(0,t.defineComponent)({__name:'world_info_tab',setup(e){const a=(0,t.ref)(''),n=(0,t.ref)(''),r=(0,t.ref)(''),o=(0,t.ref)(''),l=(0,t.ref)(!1),i=(0,t.ref)(''),s=(0,t.ref)(''),c=(0,t.computed)(()=>a.value.trim()||n.value.trim()||r.value.trim()||o.value.trim()),d=()=>{try{const e={place:a.value,era:n.value,style:r.value,additional_conditions:o.value};localStorage.setItem('world_info_input_fields',JSON.stringify(e))}catch(e){console.error('Failed to save input fields to localStorage:',e)}};(0,t.watch)([a,n,r,o],()=>{d()}),(0,t.watch)(i,e=>{try{insertOrAssignVariables({world_info:e},{type:'chat'})}catch(e){console.error('Failed to save world info:',e)}}),(0,t.onMounted)(()=>{(()=>{try{const e=localStorage.getItem('world_info_input_fields');if(e){const t=JSON.parse(e);a.value=t.place||'',n.value=t.era||'',r.value=t.style||'',o.value=t.additional_conditions||''}}catch(e){console.error('Failed to load input fields from localStorage:',e)}try{const e=localStorage.getItem('world_info_generated');e&&(s.value=e)}catch(e){console.error('Failed to load generated world info from localStorage:',e)}})(),(()=>{try{const e=getVariables({type:'chat'});e?.world_info&&(i.value=e.world_info)}catch(e){console.error('Failed to load world info:',e)}})()}),(0,t.onBeforeUnmount)(()=>{d()});const u=(e,t,a,n)=>{let r='\n';return r+='\n',r+=`${e||''}\n`,r+=`${t||''}\n`,r+=`${a||''}\n`,r+=`${n||''}\n`,r+='\n',r+='',r},p=async()=>{l.value=!0;try{const e=u(a.value,n.value,r.value,o.value),t='';let l='<example>\n';l+='# The following is an example of user input and expected output. Please strictly follow the style and format to generate the output.\n',l+='<UserInput>\n',l+=`${u('','','','')}\n`,l+='</UserInput>\n',l+='\n',l+='<GeneratedOutput>\n  - <char> is a virtual interactive novel engine designed specifically for <user>, vividly role-playing every school character except <user>, creating an immersive Japanese anime-style high school romance experience.\n  - allows vivid portrayals of various scenarios, including innocent, subtly romantic scenes and youth-focused situations with mature elements, free from the limitations of real-world moral scales.\n  - World setting: The story happens in a Japanese coastal fictional city: "", featuring the city\'s only high school, "". The world logic has high flexibility, centered purely upon internal consistency of school setting without real-world rules.\n  - Environment & atmosphere setup: Most events prominently take place within the vivid daytime campus environment of "", a beautifully stylized coastal school campus with rich and authentic Japanese anime-style youth atmosphere.\n  - Exceptional immersion in youth atmosphere: Offer subtle, detailed, vividly realized scenarios in a genuine Japanese-school youths\' daily experiences, allowing great freedom for subtle interactions and tastes ranging from pure, simple school life to delicate adolescent romance and relationships.\n',l+='</GeneratedOutput>\n',l+='</example>';let i=await generateRaw({user_input:e,ordered_prompts:[{role:'system',content:t},{role:'system',content:l},'user_input']});const c=SillyTavern.name1,d=SillyTavern.name2;i=i.replace(/<user>/g,c),i=i.replace(/<char>/g,d),s.value=i;try{localStorage.setItem('world_info_generated',i)}catch(e){console.error('Failed to save generated world info to localStorage:',e)}}catch(e){console.error(':',e),s.value=''}finally{l.value=!1}},m=()=>{if(s.value.trim()){i.value=s.value;try{insertOrAssignVariables({world_info:s.value},{type:'chat'})}catch(e){console.error('Failed to save world info:',e)}}};return(e,d)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',hi,[d[12]||(d[12]=(0,t.createElementVNode)('h3',null,'',-1)),(0,t.createElementVNode)('div',xi,[d[6]||(d[6]=(0,t.createElementVNode)('label',{for:'place-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'place-input','onUpdate:modelValue':d[0]||(d[0]=e=>a.value=e),type:'text',placeholder:'...',class:'text-input'},null,512),[[t.vModelText,a.value]])]),(0,t.createElementVNode)('div',_i,[d[7]||(d[7]=(0,t.createElementVNode)('label',{for:'era-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'era-input','onUpdate:modelValue':d[1]||(d[1]=e=>n.value=e),type:'text',placeholder:'...',class:'text-input'},null,512),[[t.vModelText,n.value]])]),(0,t.createElementVNode)('div',Ei,[d[8]||(d[8]=(0,t.createElementVNode)('label',{for:'style-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{id:'style-input','onUpdate:modelValue':d[2]||(d[2]=e=>r.value=e),type:'text',placeholder:'...',class:'text-input'},null,512),[[t.vModelText,r.value]])]),(0,t.createElementVNode)('div',yi,[d[9]||(d[9]=(0,t.createElementVNode)('label',{for:'additional-conditions-input'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{id:'additional-conditions-input','onUpdate:modelValue':d[3]||(d[3]=e=>o.value=e),placeholder:'...',class:'text-area',rows:'4'},null,512),[[t.vModelText,o.value]])]),(0,t.createElementVNode)('button',{class:'generate-btn',disabled:l.value||!c.value,onClick:p},[l.value?((0,t.openBlock)(),(0,t.createElementBlock)('span',Ni)):(0,t.createCommentVNode)('v-if',!0),(0,t.createTextVNode)(' '+(0,t.toDisplayString)(l.value?'...':''),1)],8,ki),(0,t.createElementVNode)('div',Vi,[(0,t.createElementVNode)('div',wi,[d[10]||(d[10]=(0,t.createElementVNode)('label',{for:'current-world-info'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{id:'current-world-info','onUpdate:modelValue':d[4]||(d[4]=e=>i.value=e),placeholder:'...',class:'text-area',rows:'6'},null,512),[[t.vModelText,i.value]])]),(0,t.createElementVNode)('div',Si,[d[11]||(d[11]=(0,t.createElementVNode)('label',{for:'generated-world-info'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{id:'generated-world-info','onUpdate:modelValue':d[5]||(d[5]=e=>s.value=e),placeholder:'...',class:'text-area',rows:'6',readonly:''},null,512),[[t.vModelText,s.value]])]),(0,t.createElementVNode)('button',{class:'replace-btn',disabled:!s.value.trim(),onClick:m},'  ',8,Ci)])]))}});n(5612);const Bi=(0,c.A)(Ti,[['__scopeId','data-v-6467ee74']]),Ii={class:'initializations-container'},$i={class:'tab-navigation top first-row'},Di={class:'tab-navigation top second-row'},Ri={class:'main-content'},Mi={key:0,class:'initialization-area'},Yi={key:1,class:'initialization-area'},Ai={key:2,class:'initialization-area'},zi={key:3,class:'initialization-area'},Oi={key:4,class:'initialization-area'},Ki={key:5,class:'initialization-area'},Li={key:6,class:'initialization-area'},Ui=(0,t.defineComponent)({__name:'initialization_interface',setup(e){const a=(0,t.ref)('world_info'),n=e=>{a.value=e};return(e,r)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',Ii,[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',$i,[(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'world_info'===a.value}]),onClick:r[0]||(r[0]=e=>n('world_info'))},'  ',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'user'===a.value}]),onClick:r[1]||(r[1]=e=>n('user'))},'',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'character'===a.value}]),onClick:r[2]||(r[2]=e=>n('character'))},'  ',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'item'===a.value}]),onClick:r[3]||(r[3]=e=>n('item'))},'',2)]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Di,[(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'location'===a.value}]),onClick:r[4]||(r[4]=e=>n('location'))},'',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'extra'===a.value}]),onClick:r[5]||(r[5]=e=>n('extra'))},'',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'start'===a.value}]),onClick:r[6]||(r[6]=e=>n('start'))},'',2)]),(0,t.createElementVNode)('div',Ri,['start'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Mi,[(0,t.createVNode)(ko)])):'world_info'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Yi,[(0,t.createVNode)(Bi)])):'user'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ai,[(0,t.createVNode)(fi)])):'character'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',zi,[(0,t.createVNode)(Da)])):'item'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Oi,[(0,t.createVNode)(Dn)])):'location'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ki,[(0,t.createVNode)(Cr)])):'extra'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Li,[(0,t.createVNode)(an)])):(0,t.createCommentVNode)('v-if',!0)])]))}});n(5414);const Fi=(0,c.A)(Ui,[['__scopeId','data-v-252c6a8b']]),Pi={class:'confirm-dialog-header'},ji={class:'confirm-dialog-body'},Hi={class:'confirm-dialog-footer'},Gi=['data-confirm-text'],qi=(0,t.defineComponent)({__name:'confirmation_window',props:{confirmDialog:{}},emits:['update:confirm_dialog','confirm-dialog-confirm','confirm-dialog-cancel'],setup(e,{expose:a,emit:n}){const r=n,o=()=>{r('confirm-dialog-confirm')},l=()=>{r('confirm-dialog-cancel')},i=()=>{l()};return a({}),(a,n)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',null,[(0,t.createCommentVNode)(' ConfirmDialog  '),e.confirmDialog.visible?((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:0,class:'confirm-dialog-overlay',onClick:i},[(0,t.createElementVNode)('div',{class:'confirm-dialog',onClick:n[0]||(n[0]=(0,t.withModifiers)(()=>{},['stop']))},[(0,t.createElementVNode)('div',Pi,[(0,t.createElementVNode)('h3',null,(0,t.toDisplayString)(e.confirmDialog.title),1)]),(0,t.createElementVNode)('div',ji,[(0,t.createElementVNode)('p',null,(0,t.toDisplayString)(e.confirmDialog.message),1)]),(0,t.createElementVNode)('div',Hi,[(0,t.createElementVNode)('button',{class:'confirm-btn cancel-btn',onClick:l},(0,t.toDisplayString)(e.confirmDialog.cancelText),1),(0,t.createElementVNode)('button',{class:'confirm-btn confirm-action-btn','data-confirm-text':e.confirmDialog.confirmText,onClick:o},(0,t.toDisplayString)(e.confirmDialog.confirmText),9,Gi)])])])):(0,t.createCommentVNode)('v-if',!0)]))}});n(9121);const Xi=qi,Wi={class:'progress-bar-container'},Ji={class:'progress-bar-label'},Zi={class:'progress-bar-wrapper'},Qi={class:'progress-bar-value'},es=(0,t.defineComponent)({__name:'progress_bar',props:{label:{},value:{},min:{default:0},max:{default:100},unit:{default:''},color:{default:'#007acc'},attributeType:{default:''}},setup(e){const a=e,n=(0,t.computed)(()=>{const{attributeType:e,value:t}=a;switch(e){case'mood':return t>=0?{color:'#ffdd44',min:0,max:100,isReverse:!1}:{color:'#007acc',min:0,max:100,isReverse:!1};case'horny':return{color:'#ff44aa',min:0,max:100,isReverse:!1};case'friendship':return t>=0?{color:'#44ff44',min:0,max:1e3,isReverse:!1}:{color:'#888888',min:0,max:1e3,isReverse:!1};case'love':return{color:'#ff4444',min:0,max:1e3,isReverse:!1};default:return{color:a.color,min:a.min,max:a.max,isReverse:!1}}}),r=(0,t.computed)(()=>{const e=n.value,t=Math.abs(a.value),r=Math.max(e.min,Math.min(e.max,t)),o=e.max-e.min;return(r-e.min)/o*100}),o=(0,t.computed)(()=>{const e=n.value;return`linear-gradient(90deg, ${e.color} 0%, ${e.color}dd 100%)`});return(a,n)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',Wi,[(0,t.createElementVNode)('div',Ji,(0,t.toDisplayString)(e.label),1),(0,t.createElementVNode)('div',Zi,[(0,t.createElementVNode)('div',{class:'progress-bar-fill',style:(0,t.normalizeStyle)({width:`${(0,t.unref)(r)}%`,background:(0,t.unref)(o)})},null,4),(0,t.createElementVNode)('div',Qi,(0,t.toDisplayString)(e.value)+(0,t.toDisplayString)(e.unit),1)])]))}});n(6108);const ts=(0,c.A)(es,[['__scopeId','data-v-be0274c0']]),as={class:'character-tab-container'},ns={key:0,class:'character-content'},rs={class:'character-section'},os={class:'character-list'},ls=['onClick'],is=['onClick'],ss={key:1,class:'character-progress-bars'},cs={key:0,class:'no-characters-message'},ds={class:'character-section'},us={class:'character-list'},ps=['onClick'],ms=['onClick'],gs={key:1,class:'character-progress-bars'},vs={key:0,class:'no-characters-message'},bs={class:'character-detail-content'},fs={class:'character-header'},hs={class:'header-buttons'},xs={class:'character-detail-name'},_s={class:'attributes-grid'},Es={class:'attribute-item horizontal'},ys={key:0,class:'attribute-value'},ks={class:'attribute-item horizontal'},Ns={key:0,class:'attribute-value'},Vs={class:'attribute-item horizontal'},ws={key:0,class:'attribute-value'},Ss={class:'attribute-item horizontal'},Cs={key:0,class:'attribute-value'},Ts={class:'attribute-item horizontal'},Bs={key:0,class:'attribute-value'},Is={class:'attribute-item horizontal'},$s={key:0,class:'attribute-value'},Ds={class:'attribute-item horizontal'},Rs={key:0,class:'attribute-value'},Ms={class:'attribute-item horizontal'},Ys={key:0,class:'attribute-value'},As={class:'attribute-item horizontal'},zs={key:0,class:'attribute-value'},Os={class:'attribute-item horizontal'},Ks={key:0,class:'attribute-value'},Ls={class:'attribute-item full-width horizontal'},Us={key:0,class:'attribute-value money'},Fs={class:'attribute-item full-width birthday-fullwidth'},Ps={key:0,class:'attribute-value'},js={key:1,class:'birthday-edit-container'},Hs={class:'birthday-input-group'},Gs={key:0,class:'attribute-item full-width'},qs={key:1,class:'progress-edit-container'},Xs={key:1,class:'attribute-item full-width'},Ws={key:1,class:'progress-edit-container'},Js={class:'attribute-item full-width'},Zs={key:0,class:'attribute-value no-bold'},Qs={class:'attribute-item full-width'},ec={key:0,class:'attribute-value no-bold'},tc={class:'attribute-item full-width'},ac={key:0,class:'attribute-value no-bold'},nc={class:'attribute-item full-width'},rc={key:0,class:'attribute-value no-bold'},oc={class:'attribute-item full-width'},lc={key:0,class:'attribute-value no-bold'},ic={class:'attribute-item full-width'},sc={key:0,class:'attribute-value no-bold'},cc={class:'attribute-item full-width'},dc={key:0,class:'attribute-value no-bold'},uc={key:2,class:'attribute-item full-width'},pc={key:0,class:'attribute-value no-bold'},mc={class:'relations-section'},gc={key:0,class:'relations-list'},vc={class:'relation-highlight'},bc={class:'relation-highlight'},fc={key:0,class:'no-message'},hc={key:1,class:'relations-edit-list'},xc=['value','onChange'],_c=['value'],Ec=['onUpdate:modelValue'],yc=['onClick'],kc={key:0,class:'friendships-section'},Nc={key:0,class:'friendships-list'},Vc={key:0,class:'no-message'},wc={key:1,class:'friendships-edit-list'},Sc=['value','onChange'],Cc=['value'],Tc=['onUpdate:modelValue','onInput','onBlur'],Bc=['onClick'],Ic={key:1,class:'loves-section'},$c={key:0,class:'loves-list'},Dc={key:0,class:'no-message'},Rc={key:1,class:'loves-edit-list'},Mc=['value','onChange'],Yc=['value'],Ac=['onUpdate:modelValue','onInput','onBlur'],zc=['onClick'],Oc={class:'inventory-section'},Kc={key:0,class:'inventory-list'},Lc={class:'inventory-first-row'},Uc={class:'item-name-id'},Fc={key:0,class:'item-quantity'},Pc={key:1,class:'storage-indicator'},jc={class:'inventory-second-row'},Hc={key:0,class:'inventory-third-row'},Gc={key:0,class:'no-inventory'},qc={key:1,class:'inventory-items'},Xc={key:0,class:'no-message'},Wc={key:1,class:'inventory-edit-list'},Jc=['value','onChange'],Zc={label:''},Qc=['value'],ed={label:''},td=['value'],ad={key:0,class:'inventory-edit-connector'},nd=['onUpdate:modelValue'],rd=['onClick'],od={key:2,class:'edit-buttons'},ld=['disabled'],id=(0,t.defineComponent)({__name:'character_tab',setup(e,{expose:a}){(0,t.useCssVars)(e=>({v1299b277:d.value}));const n=(0,t.ref)(!1),r=(0,t.ref)(!1),o=(0,t.ref)(null),l=(0,t.ref)(''),i=(0,t.ref)({visible:!1,title:'',message:'',confirmText:'',cancelText:''}),s=(0,t.ref)(0),c=(0,t.ref)(null),d=(0,t.computed)(()=>`calc(100vh - ${s.value}px)`);a({handleTabClick:()=>{b.value?(n.value&&q(),b.value=null):r.value&&q()}});const u=(0,t.computed)(()=>{if(!r.value||!o.value)return!1;return['','','','','','','','','','','','','','','','',''].some(e=>{const t=o.value[e];return null==t||''===t||'string'==typeof t&&''===t.trim()})}),p=(0,t.computed)({get:()=>o.value?.[Br.RELATIONS_KEY]||{},set:e=>{o.value&&(o.value[Br.RELATIONS_KEY]=e)}}),m=(0,t.computed)({get:()=>o.value?.[Br.INVENTORY_KEY]||{},set:e=>{o.value&&(o.value[Br.INVENTORY_KEY]=e)}}),g=(0,t.computed)({get:()=>o.value?.[Br.FRIENDSHIPS_KEY]||{},set:e=>{o.value&&(o.value[Br.FRIENDSHIPS_KEY]=e)}}),v=(0,t.computed)({get:()=>o.value?.[Br.LOVES_KEY]||{},set:e=>{o.value&&(o.value[Br.LOVES_KEY]=e)}}),b=(0,t.ref)(null),f=(0,t.ref)(null),h=()=>{try{const e=getLastMessageId();f.value=Yr.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),f.value=null}};h(),(0,t.onMounted)(()=>{(0,t.nextTick)(()=>{X()})}),(0,t.onUnmounted)(()=>{W()});const x=(0,t.computed)(()=>f.value?.active_characters||new Map),E=(0,t.computed)(()=>f.value?.deactive_characters||new Map),y=(0,t.computed)(()=>b.value&&f.value?f.value.getCharacter(b.value):null),k=(0,t.computed)(()=>{if(!f.value)return[];const e=[];for(const[t,a]of f.value.active_characters)t!==b.value&&e.push({id:t,name:a.name});for(const[t,a]of f.value.deactive_characters)t!==b.value&&e.push({id:t,name:a.name});return e}),N=(0,t.computed)(()=>{if(!f.value)return[];const e=[];for(const[t,a]of f.value.items)e.push({id:t,name:a.name,type:'item'});for(const[t,a]of f.value.storages)e.push({id:t,name:a.name,type:'storage'});return e}),V=e=>{if(!f.value)return'';const t=f.value.items.get(e);if(t)return t.name;const a=f.value.storages.get(e);return a?a.name:''},w=e=>f.value?.storages.has(e)||!1,S=e=>{const t=f.value?.storages.get(e);return t?.inventory.size||0},C=e=>{const t=f.value?.storages.get(e);return t?.inventory||new Map},T=e=>{if(!f.value)return'';const t=f.value.items.get(e);if(t)return t.description;const a=f.value.storages.get(e);return a?a.description:''},B=e=>{b.value=e},I=e=>{if(!f.value||'c1'===e)return;const t=f.value.getCharacter(e);if(!t)return;f.value.active_characters.has(e)?(f.value.active_characters.delete(e),f.value.deactive_characters.set(e,t)):(f.value.deactive_characters.delete(e),f.value.active_characters.set(e,t)),f.value.saveAsVariable(getLastMessageId()),h()},D=()=>{n.value&&q(),b.value=null},R=()=>{y.value&&'c1'!==b.value&&(i.value={visible:!0,title:'',message:` "${y.value.name}" `,confirmText:'',cancelText:''})},M=()=>{f.value&&b.value&&'c1'!==b.value&&(f.value.active_characters.delete(b.value),f.value.deactive_characters.delete(b.value),f.value.saveAsVariable(getLastMessageId()),b.value=null,h()),i.value.visible=!1},Y=()=>{i.value.visible=!1},A=()=>{o.value?.&&(o.value.['']='')},O=()=>{o.value?.&&(o.value.['']=1)},K=()=>{o.value?.&&(o.value.['']=0)},L=()=>{o.value?.&&(o.value.['']=0)},U=()=>{o.value&&void 0!==o.value.&&(o.value.<-100?o.value.=-100:o.value.>100&&(o.value.=100))},F=()=>{o.value&&void 0!==o.value.&&(o.value.<0?o.value.=0:o.value.>100&&(o.value.=100))},P=e=>{g.value&&void 0!==g.value[e]&&(g.value[e]<-1e3?g.value[e]=-1e3:g.value[e]>1e3&&(g.value[e]=1e3))},j=e=>{v.value&&void 0!==v.value[e]&&(v.value[e]<0?v.value[e]=0:v.value[e]>1e3&&(v.value[e]=1e3))},H=()=>{if(y.value){const e=y.value.toRecord();o.value={[Br.NAME_KEY]:e[Br.NAME_KEY],[Br.GENDER_KEY]:e[Br.GENDER_KEY],[Br.AGE_KEY]:e[Br.AGE_KEY].toString(),[Br.HEIGHT_KEY]:e[Br.HEIGHT_KEY].toString(),[Br.WEIGHT_KEY]:e[Br.WEIGHT_KEY].toString(),[Br.CHEST_SIZE_KEY]:e[Br.CHEST_SIZE_KEY].toString(),[Br.CUP_SIZE_KEY]:e[Br.CUP_SIZE_KEY]||'',[Br.WAIST_SIZE_KEY]:e[Br.WAIST_SIZE_KEY].toString(),[Br.HIPS_SIZE_KEY]:e[Br.HIPS_SIZE_KEY].toString(),[Br.IDENTITY_KEY]:e[Br.IDENTITY_KEY],[Br.HAIRSTYLE_KEY]:e[Br.HAIRSTYLE_KEY],[Br.APPEARANCE_KEY]:e[Br.APPEARANCE_KEY],[Br.CLOTHES_KEY]:e[Br.CLOTHES_KEY],[Br.FAVOURITE_KEY]:e[Br.FAVOURITE_KEY],[Br.INTRODUCTION_KEY]:e[Br.INTRODUCTION_KEY],[Br.PERSONALITY_KEY]:e[Br.PERSONALITY_KEY],[Br.EXTRA_INFORMATION_KEY]:e[Br.EXTRA_INFORMATION_KEY],[Br.MONEY_KEY]:e[Br.MONEY_KEY],[Br.MOOD_KEY]:e[Br.MOOD_KEY],[Br.HORNY_KEY]:e[Br.HORNY_KEY],[Br.RELATIONS_KEY]:e[Br.RELATIONS_KEY],[Br.FRIENDSHIPS_KEY]:e[Br.FRIENDSHIPS_KEY],[Br.LOVES_KEY]:e[Br.LOVES_KEY],[Br.INVENTORY_KEY]:e[Br.INVENTORY_KEY],[Br.BIRTHDAY_KEY]:e[Br.BIRTHDAY_KEY]},l.value=b.value||'',n.value=!0,r.value=!1}},G=()=>{const e=(()=>{if(!f.value)return'c2';const e=new Set;for(const t of f.value.active_characters.keys())e.add(t);for(const t of f.value.deactive_characters.keys())e.add(t);let t=2;for(;e.has(`c${t}`);)t++;return`c${t}`})();l.value=e,o.value={[Br.NAME_KEY]:'',[Br.AGE_KEY]:null,[Br.GENDER_KEY]:'',[Br.IDENTITY_KEY]:'',[Br.INTRODUCTION_KEY]:'',[Br.PERSONALITY_KEY]:'',[Br.HEIGHT_KEY]:0,[Br.WEIGHT_KEY]:0,[Br.CHEST_SIZE_KEY]:0,[Br.CUP_SIZE_KEY]:'',[Br.WAIST_SIZE_KEY]:0,[Br.HIPS_SIZE_KEY]:0,[Br.HAIRSTYLE_KEY]:'',[Br.APPEARANCE_KEY]:'',[Br.CLOTHES_KEY]:'',[Br.BIRTHDAY_KEY]:{month:1,date:1},[Br.FAVOURITE_KEY]:'',[Br.EXTRA_INFORMATION_KEY]:'',[Br.MONEY_KEY]:0,[Br.MOOD_KEY]:0,[Br.HORNY_KEY]:0,[Br.RELATIONS_KEY]:{},[Br.INVENTORY_KEY]:{},[Br.FRIENDSHIPS_KEY]:{},[Br.LOVES_KEY]:{}},n.value=!0,r.value=!0,b.value=null},q=()=>{n.value=!1,r.value=!1,o.value=null,l.value=''},X=()=>{if('undefined'==typeof ResizeObserver)return void(s.value=74);c.value=new ResizeObserver(e=>{for(const t of e){const e=t.target;e.classList.contains('tab-navigation')&&(s.value=e.offsetHeight)}});const e=document.querySelector('.tab-navigation.top');e&&(c.value.observe(e),s.value=e.offsetHeight)},W=()=>{c.value&&(c.value.disconnect(),c.value=null)},J=()=>{if(f.value&&o.value){const e=l.value.trim();if(r.value){const t=f.value.active_characters.has(e),a=f.value.deactive_characters.has(e);if(t||a)return void toastr.error(`ID "${e}" ID`)}else if(b.value&&e!==b.value){const t=f.value.active_characters.has(e),a=f.value.deactive_characters.has(e);if(t||a)return void toastr.error(`ID "${e}" ID`)}if(o.value.&&o.value..month&&o.value..date){const e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate(),r=o.value..month,l=o.value..date;let i=t-(o.value.||0);(r>a||r===a&&l>n)&&(i-=1),o.value.=new Date(i,o.value..month-1,o.value..date).toString()}if(o.value.){const e={};for(const[t,a]of Object.entries(o.value.))t&&a&&'string'==typeof a&&''!==a.trim()&&(e[t]=a);o.value.=e}if(o.value.){const e={};for(const[t,a]of Object.entries(o.value.))if(t&&a&&'number'==typeof a&&a>0){const n=w(t)?1:a;e[t]=n}o.value.=e}if(o.value.){const e={};for(const[t,a]of Object.entries(o.value.))t&&void 0!==a&&'number'==typeof a&&a>=-1e3&&a<=1e3&&(e[t]=a);o.value.=e}if(o.value.){const e={};for(const[t,a]of Object.entries(o.value.))t&&void 0!==a&&'number'==typeof a&&a>0&&a<=1e3&&(e[t]=a);o.value.=e}const t=e,a={[Br.NAME_KEY]:o.value.,[Br.GENDER_KEY]:o.value.,[Br.AGE_KEY]:parseInt(o.value.),[Br.HEIGHT_KEY]:parseInt(o.value.),[Br.WEIGHT_KEY]:parseInt(o.value.),[Br.CHEST_SIZE_KEY]:parseInt(o.value.),[Br.CUP_SIZE_KEY]:o.value.||void 0,[Br.WAIST_SIZE_KEY]:parseInt(o.value.),[Br.HIPS_SIZE_KEY]:parseInt(o.value.),[Br.IDENTITY_KEY]:o.value.,[Br.HAIRSTYLE_KEY]:o.value.,[Br.APPEARANCE_KEY]:o.value.,[Br.CLOTHES_KEY]:o.value.,[Br.FAVOURITE_KEY]:o.value.,[Br.INTRODUCTION_KEY]:o.value.,[Br.PERSONALITY_KEY]:o.value.,[Br.EXTRA_INFORMATION_KEY]:o.value.,[Br.BIRTHDAY_KEY]:o.value.,[Br.MONEY_KEY]:o.value.??0,[Br.MOOD_KEY]:o.value.??50,[Br.HORNY_KEY]:o.value.??0,[Br.RELATIONS_KEY]:o.value.??{},[Br.FRIENDSHIPS_KEY]:o.value.??{},[Br.LOVES_KEY]:o.value.??{},[Br.INVENTORY_KEY]:o.value.??{}};if(r.value)f.value.active_characters.set(t,Br.fromRecord(a)),f.value.saveAsVariable(getLastMessageId()),h(),b.value=t;else if(b.value){const e=f.value.active_characters.has(b.value);t!==b.value?(e?(f.value.active_characters.delete(b.value),f.value.active_characters.set(t,Br.fromRecord(a))):(f.value.deactive_characters.delete(b.value),f.value.deactive_characters.set(t,Br.fromRecord(a))),b.value=t):e?f.value.active_characters.set(b.value,Br.fromRecord(a)):f.value.deactive_characters.set(b.value,Br.fromRecord(a)),f.value.saveAsVariable(getLastMessageId()),h()}}n.value=!1,r.value=!1,o.value=null,l.value=''};return(e,a)=>{return(0,t.openBlock)(),(0,t.createElementBlock)('div',as,[(0,t.createCommentVNode)('  '),b.value||r.value?((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,{key:1},[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',bs,[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',fs,[(0,t.createElementVNode)('div',hs,[n.value||r.value?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:0,class:'edit-button',onClick:H},'')),n.value||r.value||'c1'===b.value?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:1,class:'delete-button',onClick:R},'  '))]),(0,t.createElementVNode)('h1',xs,(0,t.toDisplayString)(r.value?'':y.value?.name||'N/A'),1),(0,t.createElementVNode)('button',{class:'back-button',onClick:D},'')]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',_s,[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Es,[a[25]||(a[25]=(0,t.createElementVNode)('span',{class:'attribute-label'},'ID',-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[0]||(a[0]=e=>l.value=e),class:'attribute-input'},null,512)),[[t.vModelText,l.value]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',ys,(0,t.toDisplayString)(b.value),1))]),(0,t.createElementVNode)('div',ks,[a[26]||(a[26]=(0,t.createElementVNode)('span',{class:'attribute-label'},[(0,t.createTextVNode)(''),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[1]||(a[1]=e=>o.value.=e),class:'attribute-input'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Ns,(0,t.toDisplayString)(y.value?.name||'N/A'),1))]),(0,t.createElementVNode)('div',Vs,[a[27]||(a[27]=(0,t.createElementVNode)('span',{class:'attribute-label'},[(0,t.createTextVNode)(''),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[2]||(a[2]=e=>o.value.=e),class:'attribute-input'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',ws,(0,t.toDisplayString)(y.value?.gender||'N/A'),1))]),(0,t.createElementVNode)('div',Ss,[a[28]||(a[28]=(0,t.createElementVNode)('span',{class:'attribute-label'},[(0,t.createTextVNode)(''),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[3]||(a[3]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Cs,(0,t.toDisplayString)(y.value?.age||'N/A'),1))]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Ts,[a[29]||(a[29]=(0,t.createElementVNode)('span',{class:'attribute-label unit-label'},[(0,t.createTextVNode)(' (cm)'),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[4]||(a[4]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Bs,(0,t.toDisplayString)(y.value?.height||'N/A'),1))]),(0,t.createElementVNode)('div',Is,[a[30]||(a[30]=(0,t.createElementVNode)('span',{class:'attribute-label unit-label'},[(0,t.createTextVNode)(' (kg)'),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[5]||(a[5]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',$s,(0,t.toDisplayString)(y.value?.weight||'N/A'),1))]),(0,t.createElementVNode)('div',Ds,[a[31]||(a[31]=(0,t.createElementVNode)('span',{class:'attribute-label unit-label'},[(0,t.createTextVNode)(' (cm)'),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[6]||(a[6]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Rs,(0,t.toDisplayString)(y.value?.chest_size||'N/A'),1))]),(0,t.createElementVNode)('div',Ms,[a[32]||(a[32]=(0,t.createElementVNode)('span',{class:'attribute-label'},[(0,t.createTextVNode)(''),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[7]||(a[7]=e=>o.value.=e),class:'attribute-input'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Ys,(0,t.toDisplayString)(y.value?.cup_size||''),1))]),(0,t.createElementVNode)('div',As,[a[33]||(a[33]=(0,t.createElementVNode)('span',{class:'attribute-label unit-label'},[(0,t.createTextVNode)(' (cm)'),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[8]||(a[8]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',zs,(0,t.toDisplayString)(y.value?.waist_size||'N/A'),1))]),(0,t.createElementVNode)('div',Os,[a[34]||(a[34]=(0,t.createElementVNode)('span',{class:'attribute-label unit-label'},[(0,t.createTextVNode)(' (cm)'),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[9]||(a[9]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Ks,(0,t.toDisplayString)(y.value?.hips_size||'N/A'),1))]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Ls,[a[35]||(a[35]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[10]||(a[10]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Us,(0,t.toDisplayString)((c=y.value?.money,void 0===c?'N/A':`$${c.toLocaleString()}`)),1))]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Fs,[a[38]||(a[38]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),n.value||r.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',js,[(0,t.createElementVNode)('div',Hs,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[11]||(a[11]=e=>o.value..month=e),class:'attribute-input birthday-month',type:'number',placeholder:'',min:'1',max:'12'},null,512),[[t.vModelText,o.value..month,void 0,{number:!0}]]),a[36]||(a[36]=(0,t.createElementVNode)('span',{class:'birthday-separator'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[12]||(a[12]=e=>o.value..date=e),class:'attribute-input birthday-date',type:'number',placeholder:'',min:'1',max:'31'},null,512),[[t.vModelText,o.value..date,void 0,{number:!0}]]),a[37]||(a[37]=(0,t.createElementVNode)('span',{class:'birthday-separator'},'',-1))])])):((0,t.openBlock)(),(0,t.createElementBlock)('span',Ps,(0,t.toDisplayString)((s=y.value?.birthday,s?`${s.month}${s.date}`:'N/A')),1))]),(0,t.createCommentVNode)('  () '),'c1'!==b.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Gs,[n.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',qs,[a[39]||(a[39]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[13]||(a[13]=e=>o.value.=e),class:'attribute-input',type:'number',min:'-100',max:'100',onInput:U,onBlur:U},null,544),[[t.vModelText,o.value.,void 0,{number:!0}]])])):((0,t.openBlock)(),(0,t.createBlock)(ts,{key:0,label:'',value:y.value?.mood||0,attributeType:'mood'},null,8,['value']))])):(0,t.createCommentVNode)('v-if',!0),'c1'!==b.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Xs,[n.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ws,[a[40]||(a[40]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[14]||(a[14]=e=>o.value.=e),class:'attribute-input',type:'number',min:'0',max:'100',onInput:F,onBlur:F},null,544),[[t.vModelText,o.value.,void 0,{number:!0}]])])):((0,t.openBlock)(),(0,t.createBlock)(ts,{key:0,label:'',value:y.value?.horny||0,attributeType:'horny'},null,8,['value']))])):(0,t.createCommentVNode)('v-if',!0),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Js,[a[41]||(a[41]=(0,t.createElementVNode)('span',{class:'attribute-label'},[(0,t.createTextVNode)(''),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[15]||(a[15]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Zs,(0,t.toDisplayString)(y.value?.identity||'N/A'),1))]),(0,t.createElementVNode)('div',Qs,[a[42]||(a[42]=(0,t.createElementVNode)('span',{class:'attribute-label'},[(0,t.createTextVNode)(''),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[16]||(a[16]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',ec,(0,t.toDisplayString)(y.value?.hairstyle||'N/A'),1))]),(0,t.createElementVNode)('div',tc,[a[43]||(a[43]=(0,t.createElementVNode)('span',{class:'attribute-label'},[(0,t.createTextVNode)(''),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[17]||(a[17]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',ac,(0,t.toDisplayString)(y.value?.appearance||'N/A'),1))]),(0,t.createElementVNode)('div',nc,[a[44]||(a[44]=(0,t.createElementVNode)('span',{class:'attribute-label'},[(0,t.createTextVNode)(''),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[18]||(a[18]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',rc,(0,t.toDisplayString)(y.value?.clothes||'N/A'),1))]),(0,t.createElementVNode)('div',oc,[a[45]||(a[45]=(0,t.createElementVNode)('span',{class:'attribute-label'},[(0,t.createTextVNode)(''),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[19]||(a[19]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',lc,(0,t.toDisplayString)(y.value?.favourite||'N/A'),1))]),(0,t.createElementVNode)('div',ic,[a[46]||(a[46]=(0,t.createElementVNode)('span',{class:'attribute-label'},[(0,t.createTextVNode)(''),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[20]||(a[20]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',sc,(0,t.toDisplayString)(y.value?.introduction||'N/A'),1))]),(0,t.createElementVNode)('div',cc,[a[47]||(a[47]=(0,t.createElementVNode)('span',{class:'attribute-label'},[(0,t.createTextVNode)(''),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[21]||(a[21]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',dc,(0,t.toDisplayString)(y.value?.personality||'N/A'),1))]),y.value?.extra_information&&!r.value||n.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',uc,[a[48]||(a[48]=(0,t.createElementVNode)('span',{class:'attribute-label'},[(0,t.createTextVNode)(''),(0,t.createElementVNode)('span',{class:'required-asterisk'},'*')],-1)),n.value||r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[22]||(a[22]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',pc,(0,t.toDisplayString)(y.value?.extra_information||'N/A'),1))])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',mc,[a[52]||(a[52]=(0,t.createElementVNode)('h3',{class:'section-title'},'',-1)),n.value||r.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',hc,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(p.value,(_,e)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'edit-item'},[(0,t.createElementVNode)('select',{value:e,class:'relation-select',onChange:t=>((e,t)=>{if(o.value?.&&e!==t){const a=o.value.[e];delete o.value.[e],t&&(o.value.[t]=a)}})(String(e),t.target.value)},[a[50]||(a[50]=(0,t.createElementVNode)('option',{value:'',disabled:''},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(k.value,e=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e.id,value:e.id},(0,t.toDisplayString)(e.name)+' ('+(0,t.toDisplayString)(e.id)+') ',9,_c))),128))],40,xc),a[51]||(a[51]=(0,t.createElementVNode)('span',{class:'edit-connector'},'  ',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>p.value[e]=t,class:'input-field',placeholder:''},null,8,Ec),[[t.vModelText,p.value[e]]]),(0,t.createElementVNode)('button',{class:'relation-remove-btn',onClick:t=>(e=>{o.value?.&&delete o.value.[e]})(String(e))},'',8,yc)]))),128)),(0,t.createElementVNode)('button',{class:'add-relation-btn',onClick:A},'+ ')])):((0,t.openBlock)(),(0,t.createElementBlock)('div',gc,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(y.value?.relations||[],([e,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'relation-item'},[(0,t.createElementVNode)('span',vc,(0,t.toDisplayString)(f.value?.getCharacter(e)?.name||'')+' ('+(0,t.toDisplayString)(e)+')',1),a[49]||(a[49]=(0,t.createElementVNode)('span',{class:'connector'},'  ',-1)),(0,t.createElementVNode)('span',bc,(0,t.toDisplayString)(n),1)]))),128)),y.value?.relations&&0!==y.value.relations.size?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('div',fc,'  '))]))]),(0,t.createCommentVNode)('  () '),'c1'!==b.value||r.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',kc,[a[55]||(a[55]=(0,t.createElementVNode)('h3',{class:'section-title'},'',-1)),n.value||r.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',wc,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(g.value,(_,e)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'edit-item'},[(0,t.createElementVNode)('select',{value:e,class:'relation-select',onChange:t=>((e,t)=>{if(o.value?.&&e!==t){const a=o.value.[e];delete o.value.[e],t&&(o.value.[t]=a)}})(String(e),t.target.value)},[a[53]||(a[53]=(0,t.createElementVNode)('option',{value:'',disabled:''},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(k.value,e=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e.id,value:e.id},(0,t.toDisplayString)(e.name)+' ('+(0,t.toDisplayString)(e.id)+') ',9,Cc))),128))],40,Sc),a[54]||(a[54]=(0,t.createElementVNode)('span',{class:'edit-connector'},' : ',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>g.value[e]=t,class:'input-field',type:'number',min:'-1000',max:'1000',placeholder:'',onInput:t=>P(String(e)),onBlur:t=>P(String(e))},null,40,Tc),[[t.vModelText,g.value[e],void 0,{number:!0}]]),(0,t.createElementVNode)('button',{class:'friendship-remove-btn',onClick:t=>(e=>{o.value?.&&delete o.value.[e]})(String(e))},'',8,Bc)]))),128)),(0,t.createElementVNode)('button',{class:'add-friendship-btn',onClick:K},'+ ')])):((0,t.openBlock)(),(0,t.createElementBlock)('div',Nc,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(y.value?.friendships||[],([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'friendship-item'},[(0,t.createVNode)(ts,{label:`${f.value?.getCharacter(e)?.name||''} (${e})`,value:a,attributeType:'friendship'},null,8,['label','value'])]))),128)),y.value?.friendships&&0!==y.value.friendships.size?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('div',Vc,'  '))]))])):(0,t.createCommentVNode)('v-if',!0),'c1'!==b.value||r.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ic,[a[58]||(a[58]=(0,t.createElementVNode)('h3',{class:'section-title'},'',-1)),n.value||r.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Rc,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(v.value,(_,e)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'edit-item'},[(0,t.createElementVNode)('select',{value:e,class:'relation-select',onChange:t=>((e,t)=>{if(o.value?.&&e!==t){const a=o.value.[e];delete o.value.[e],t&&(o.value.[t]=a)}})(String(e),t.target.value)},[a[56]||(a[56]=(0,t.createElementVNode)('option',{value:'',disabled:''},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(k.value,e=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e.id,value:e.id},(0,t.toDisplayString)(e.name)+' ('+(0,t.toDisplayString)(e.id)+') ',9,Yc))),128))],40,Mc),a[57]||(a[57]=(0,t.createElementVNode)('span',{class:'edit-connector'},' : ',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>v.value[e]=t,class:'input-field',type:'number',min:'0',max:'1000',placeholder:'',onInput:t=>j(String(e)),onBlur:t=>j(String(e))},null,40,Ac),[[t.vModelText,v.value[e],void 0,{number:!0}]]),(0,t.createElementVNode)('button',{class:'love-remove-btn',onClick:t=>(e=>{o.value?.&&delete o.value.[e]})(String(e))},'',8,zc)]))),128)),(0,t.createElementVNode)('button',{class:'add-love-btn',onClick:L},'+ ')])):((0,t.openBlock)(),(0,t.createElementBlock)('div',$c,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(y.value?.loves||[],([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'love-item'},[(0,t.createVNode)(ts,{label:`${f.value?.getCharacter(e)?.name||''} (${e})`,value:a,attributeType:'love'},null,8,['label','value'])]))),128)),y.value?.loves&&0!==y.value.loves.size?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('div',Dc,'  '))]))])):(0,t.createCommentVNode)('v-if',!0),(0,t.createElementVNode)('div',Oc,[a[60]||(a[60]=(0,t.createElementVNode)('h3',{class:'section-title'},'',-1)),n.value||r.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Wc,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(m.value,(_,e)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'inventory-edit-item'},[(0,t.createElementVNode)('select',{value:e,class:'inventory-select',onChange:t=>((e,t)=>{if(o.value?.&&e!==t){const a=o.value.[e];delete o.value.[e],t&&(o.value.[t]=a)}})(String(e),t.target.value)},[a[59]||(a[59]=(0,t.createElementVNode)('option',{value:'',disabled:''},'...',-1)),(0,t.createElementVNode)('optgroup',Zc,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(N.value.filter(e=>'item'===e.type),e=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e.id,value:e.id},(0,t.toDisplayString)(e.name)+' ('+(0,t.toDisplayString)(e.id)+') ',9,Qc))),128))]),(0,t.createElementVNode)('optgroup',ed,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(N.value.filter(e=>'storage'===e.type),e=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e.id,value:e.id},(0,t.toDisplayString)(e.name)+' ('+(0,t.toDisplayString)(e.id)+') ',9,td))),128))])],40,Jc),w(String(e))?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('span',ad,'')),w(String(e))?(0,t.createCommentVNode)('v-if',!0):(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':t=>m.value[e]=t,class:'inventory-quantity-input',type:'number',min:'0',placeholder:''},null,8,nd)),[[t.vModelText,m.value[e],void 0,{number:!0}]]),(0,t.createElementVNode)('button',{class:'inventory-remove-btn',onClick:t=>(e=>{o.value?.&&delete o.value.[e]})(String(e))},'',8,rd)]))),128)),(0,t.createElementVNode)('button',{class:'add-inventory-btn',onClick:O},'+ ')])):((0,t.openBlock)(),(0,t.createElementBlock)('div',Kc,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(y.value?.inventory||[],([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:(0,t.normalizeClass)(['inventory-item',{'storage-item':w(e)}])},[(0,t.createElementVNode)('div',Lc,[(0,t.createElementVNode)('span',Uc,(0,t.toDisplayString)(V(e))+' ('+(0,t.toDisplayString)(e)+')',1),w(e)?((0,t.openBlock)(),(0,t.createElementBlock)('span',Pc,'')):((0,t.openBlock)(),(0,t.createElementBlock)('span',Fc,' '+(0,t.toDisplayString)(a),1))]),(0,t.createElementVNode)('div',jc,(0,t.toDisplayString)(T(e)),1),w(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',Hc,[0===S(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',Gc,'')):((0,t.openBlock)(),(0,t.createElementBlock)('div',qc,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(C(e),([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:e,class:(0,t.normalizeClass)(f.value?.storages.has(e)?'storage-item-tag':'inventory-item-tag')},(0,t.toDisplayString)(V(e))+' ('+(0,t.toDisplayString)(e)+')'+(0,t.toDisplayString)(f.value?.storages.has(e)?'':`  ${a}`),3))),128))]))])):(0,t.createCommentVNode)('v-if',!0)],2))),128)),y.value?.inventory&&0!==y.value.inventory.size?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('div',Xc,'  '))]))]),(0,t.createCommentVNode)('  '),n.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',od,[(0,t.createElementVNode)('button',{class:'confirm-button',disabled:u.value,onClick:J},'',8,ld),(0,t.createElementVNode)('button',{class:'cancel-button',onClick:q},'')])):(0,t.createCommentVNode)('v-if',!0)])],2112)):((0,t.openBlock)(),(0,t.createElementBlock)('div',ns,[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',rs,[a[23]||(a[23]=(0,t.createElementVNode)('h3',{class:'section-title'},'',-1)),(0,t.createElementVNode)('div',os,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(x.value,([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'character-item clickable',onClick:t=>B(e)},[(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['character-info',{'user-character-info':'c1'===e}])},[(0,t.createElementVNode)('span',{class:(0,t.normalizeClass)('c1'===e?'user-id':'character-id')},(0,t.toDisplayString)(e),3),(0,t.createElementVNode)('span',{class:(0,t.normalizeClass)('c1'===e?'user-name':'character-name')},(0,t.toDisplayString)(a.name),3)],2),'c1'!==e?((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:0,class:'toggle-status-button',title:'',onClick:(0,t.withModifiers)(t=>I(e),['stop'])},'  ',8,is)):(0,t.createCommentVNode)('v-if',!0),'c1'!==e?((0,t.openBlock)(),(0,t.createElementBlock)('div',ss,[(0,t.createVNode)(ts,{label:'',value:a.mood||0,attributeType:'mood'},null,8,['value']),(0,t.createVNode)(ts,{label:'',value:a.horny||0,attributeType:'horny'},null,8,['value']),(0,t.createVNode)(ts,{label:'',value:a.friendships?.get('c1')||0,attributeType:'friendship'},null,8,['value']),(0,t.createVNode)(ts,{label:'',value:a.loves?.get('c1')||0,attributeType:'love'},null,8,['value'])])):(0,t.createCommentVNode)('v-if',!0)],8,ls))),128)),0===x.value.size?((0,t.openBlock)(),(0,t.createElementBlock)('div',cs,'')):(0,t.createCommentVNode)('v-if',!0)])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',ds,[a[24]||(a[24]=(0,t.createElementVNode)('h3',{class:'section-title'},'',-1)),(0,t.createElementVNode)('div',us,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(E.value,([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'character-item clickable',onClick:t=>B(e)},[(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['character-info',{'user-character-info':'c1'===e}])},[(0,t.createElementVNode)('span',{class:(0,t.normalizeClass)('c1'===e?'user-id':'character-id')},(0,t.toDisplayString)(e),3),(0,t.createElementVNode)('span',{class:(0,t.normalizeClass)('c1'===e?'user-name':'character-name')},(0,t.toDisplayString)(a.name),3)],2),'c1'!==e?((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:0,class:'toggle-status-button',title:'',onClick:(0,t.withModifiers)(t=>I(e),['stop'])},'  ',8,ms)):(0,t.createCommentVNode)('v-if',!0),'c1'!==e?((0,t.openBlock)(),(0,t.createElementBlock)('div',gs,[(0,t.createVNode)(ts,{label:'',value:a.mood||0,attributeType:'mood'},null,8,['value']),(0,t.createVNode)(ts,{label:'',value:a.horny||0,attributeType:'horny'},null,8,['value']),(0,t.createVNode)(ts,{label:'',value:a.friendships?.get('c1')||0,attributeType:'friendship'},null,8,['value']),(0,t.createVNode)(ts,{label:'',value:a.loves?.get('c1')||0,attributeType:'love'},null,8,['value'])])):(0,t.createCommentVNode)('v-if',!0)],8,ps))),128)),0===E.value.size?((0,t.openBlock)(),(0,t.createElementBlock)('div',vs,'')):(0,t.createCommentVNode)('v-if',!0)])]),(0,t.createCommentVNode)('  '),r.value?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:0,class:'add-character-button',onClick:G},'+ '))])),(0,t.createCommentVNode)('  '),(0,t.createVNode)(Xi,{'confirm-dialog':i.value,onConfirmDialogConfirm:M,onConfirmDialogCancel:Y},null,8,['confirm-dialog'])]);var s,c}}});n(8988);const sd=(0,c.A)(id,[['__scopeId','data-v-684d53c6']]);class cd{static instance;state=(0,t.ref)({is_generating:!1,is_generating_new_swipe:!1,current_generation_id:null,last_user_message_id:null,last_user_message_text:'',swipe_generation_message_id:null});constructor(){eventOn(iframe_events.GENERATION_ENDED,(e,t)=>{this.handleGenerationEnd(e,t)})}static getInstance(){return cd.instance||(cd.instance=new cd),cd.instance}getState(){return this.state}startGeneration(e,t){this.state.value.is_generating=!0,this.state.value.last_user_message_id=t,this.state.value.last_user_message_text=e;const a=`generation_${Date.now()}`;this.state.value.current_generation_id=a,eventEmit('MESSAGE_SENT',t),this.hideSummarizedMessages(),this.addEventStartTag(),generate({generation_id:a})}startSwipeGeneration(e){this.state.value.is_generating_new_swipe=!0,this.state.value.swipe_generation_message_id=e,this.hideSummarizedMessages(),this.addEventStartTag(),setChatMessages([{message_id:e,is_hidden:!0}],{refresh:'none'});const t=`swipe_generation_${Date.now()}`;this.state.value.current_generation_id=t,generate({generation_id:t})}async stopGeneration(){if(this.state.value.current_generation_id)try{await stopGenerationById(this.state.value.current_generation_id),this.state.value.is_generating_new_swipe?(this.state.value.is_generating_new_swipe=!1,this.state.value.swipe_generation_message_id=null):null!==this.state.value.last_user_message_id&&this.restoreUserInput(),this.resetState()}catch(e){console.error('Failed to stop generation:',e),this.resetState()}}restoreUserInput(){eventEmit('RESTORE_USER_INPUT',this.state.value.last_user_message_text)}async handleGenerationEnd(e,t){try{if(!t||!t.startsWith('generation_')&&!t.startsWith('swipe_generation_'))return;if(this.state.value.is_generating_new_swipe&&null!==this.state.value.swipe_generation_message_id){const t=this.state.value.swipe_generation_message_id,a=getChatMessages(t,{include_swipes:!0})[0];if(a&&a.swipes){const n=[...a.swipes,e],r=n.length-1;await setChatMessages([{message_id:t,swipes:n,swipe_id:r,is_hidden:!1}],{refresh:'none'})}}else await createChatMessages([{role:'assistant',message:e}],{refresh:'none'});this.removeEventStartTag(),eventEmit('MESSAGE_RECEIVED',getLastMessageId())}catch(e){console.error('Failed to handle generation end:',e)}finally{this.resetState()}}resetState(){this.state.value.is_generating=!1,this.state.value.is_generating_new_swipe=!1,this.state.value.current_generation_id=null,this.state.value.swipe_generation_message_id=null,this.state.value.last_user_message_id=null,this.state.value.last_user_message_text=''}isGenerating(){return this.state.value.is_generating||this.state.value.is_generating_new_swipe}getCurrentGenerationId(){return this.state.value.current_generation_id}hideSummarizedMessages(){try{if(0===getLastMessageId())return;const e=Yr.loadFromVariable(getLastMessageId()-1).getLatestSummaryLastMessageId(),t=getLastMessageId()+1,a=[];if(e>=0)for(let t=0;t<=e;t++)a.push({message_id:t,is_hidden:!0});for(let n=e+1;n<t;n++)a.push({message_id:n,is_hidden:!1});a.length>0&&setChatMessages(a,{refresh:'none'})}catch(e){console.error('Failed to hide summarized messages:',e)}}addEventStartTag(){if(0===getLastMessageId())return;const e=Yr.loadFromVariable(getLastMessageId()-1),t=0===e.summaries.length?0:e.summaries[e.summaries.length-1].last_message_id+1,a=getChatMessages(t)[0].message,n=`\x3c!--${Yr.CURRENT_EVENT_KEY}--\x3e\n`;setChatMessages([{message_id:t,message:`${n}${a}`}])}removeEventStartTag(){if(0===getLastMessageId())return;const e=Yr.loadFromVariable(getLastMessageId()-1),t=0===e.summaries.length?0:e.summaries[e.summaries.length-1].last_message_id+1,a=getChatMessages(t)[0].message,n=`\x3c!--${Yr.CURRENT_EVENT_KEY}--\x3e\n`;setChatMessages([{message_id:t,message:a.replaceAll(n,'')}])}}const dd=cd.getInstance(),ud={class:'conversation-tab-container'},pd={class:'main-content'},md={class:'dialogue-fullscreen'},gd={key:0,class:'load-more-container'},vd={key:0,class:'edit-mode'},bd={class:'edit-controls'},fd=['onClick'],hd={class:'message-header'},xd={class:'message-header-row'},_d={class:'message-id'},Ed={class:'message-actions'},yd=['onClick'],kd=['onClick'],Nd={class:'message-status-row'},Vd={class:'status-info'},wd={class:'status-datetime'},Sd={class:'status-location'},Cd={class:'message-content'},Td=['innerHTML'],Bd=['innerHTML'],Id={key:0,class:'swipe-controls'},$d=['disabled','onClick'],Dd={class:'swipe-indicator'},Rd=['disabled','onClick'],Md=['disabled','onClick'],Yd={class:'input-container'},Ad={key:0,class:'loading-spinner'},zd='conversation_user_input',Od=(0,t.defineComponent)({__name:'conversation_tab',emits:['renderSizeChanged'],setup(e,{expose:a,emit:n}){(0,t.useCssVars)(e=>({v14702539:k.value}));const r=(0,t.ref)(''),o=(0,t.ref)([]),l=dd.getState(),i=(0,t.computed)(()=>l.value.is_generating),s=(0,t.computed)(()=>l.value.is_generating_new_swipe),c=(0,t.ref)(null),u=(0,t.ref)(null),p=(0,t.ref)(null),m=(0,t.ref)(null),g=(0,t.ref)(''),v=(0,t.ref)({visible:!1,title:'',message:'',confirmText:'',cancelText:''}),b=(0,t.ref)(10),f=(0,t.ref)(0),h=(0,t.ref)(!1),x=(0,t.ref)(0),E=(0,t.ref)(0),y=(0,t.ref)(null),k=(0,t.computed)(()=>`calc(100vh - ${x.value+E.value}px)`),N=(0,t.ref)(0),V=e=>{try{const t=Yr.loadFromVariable(e),a=t.datetime,n=a.year,r=a.month,o=a.date,l=a.hours,i=a.minutes,s=['','','','','','',''][a.toDate().getDay()],c=`${n}${r}${o} (${s}) ${`${l.toString().padStart(2,'0')}:${i.toString().padStart(2,'0')}`} ${t.weather}`,d=t.getCurrentLocations();return{datetimeLine:c,locationString:d.map(e=>e.name).join('-')}}catch(e){return console.error('Failed to load message status:',e),{datetimeLine:'...',locationString:''}}},w=(0,t.ref)(new Map),S=(0,t.ref)(new Set),C=async(e,t)=>{if(!w.value.has(e)&&!S.value.has(e)){S.value.add(e);try{const a=await SillyTavern.getTokenCountAsync(t);w.value.set(e,a)}catch(t){console.error('Failed to get token count:',t),w.value.set(e,0)}finally{S.value.delete(e)}}},T=()=>{if(u.value){const e=u.value.scrollHeight,a=u.value.scrollTop;f.value+=b.value,q(),(0,t.nextTick)(()=>{(0,t.nextTick)(()=>{if(u.value){const t=u.value.scrollHeight-e;u.value.scrollTop=a+t}})})}else f.value+=b.value,q()},B=()=>{f.value=b.value},I=e=>{'Enter'===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),j())},D=()=>{(()=>{if(c.value){c.value.style.height='auto';const e=Math.min(c.value.scrollHeight,120);c.value.style.height=`${e}px`}})(),(()=>{try{localStorage.setItem(zd,r.value)}catch(e){console.error('Failed to save user input to localStorage:',e)}})()},R=()=>{m.value=null,g.value=''},M=e=>{},Y=async(e,a)=>{try{const e=getLastMessageId(),n=[];for(let t=a+1;t<o.value.length;t++){const a=e-(o.value.length-1-t);n.push(a)}n.length>0&&await deleteChatMessages(n,{refresh:'none'});let l='';for(let e=a+1;e<o.value.length;e++)if('user'===o.value[e].role){l=o.value[e].content;break}r.value=l,B(),q(),(0,t.nextTick)(()=>{K()})}catch(e){console.error('Failed to rewind conversation:',e)}},A=e=>{let t=[{type:'plain_text',message:e}];const a=(()=>{try{const e=getVariables({type:'chat'});return e?.settings?.tag_rules||[]}catch(e){return console.error('Failed to load folding rules:',e),[]}})();for(const e of a)t=O(e,t);for(const e of t)'plain_text'===e.type&&(e.message=e.message.replace(/([^]*)/g,'<span class="dialogue-text">$1</span>'));return t},O=(e,t)=>{const a=[];for(const n of t){if('plain_text'!==n.type){a.push(n);continue}const t=n.message,r=`<${e.tag_name}>`,o=`</${e.tag_name}>`;if('both'===e.match_mode&&'first'===e.match_strategy){let n=t;for(;;){const t=n.indexOf(r),l=n.indexOf(o);if(t<0||l<0||l<=t){''!==n&&a.push({type:'plain_text',message:n});break}const i=n.substring(0,t);''!==i&&a.push({type:'plain_text',message:i});const s=n.substring(t+r.length,l);'invisible'===e.display_mode||'fold_bar'===e.display_mode&&a.push({type:'fold_bar',message:s,fold_bar_title:e.title_name||e.tag_name}),n=n.substring(l+o.length)}}else{const l='both'===e.match_mode?t.indexOf(r):-1,i='first'===e.match_strategy?t.indexOf(o):t.lastIndexOf(o);if(i<0||'both'===e.match_mode&&l<0){a.push(n);continue}const s='both'===e.match_mode?l+r.length:0,c=l<0?'':t.substring(0,l),d=t.substring(s,i),u=t.substring(i+o.length);'invisible'===e.display_mode?a.push({type:'plain_text',message:c+u}):'fold_bar'===e.display_mode&&(''!==c&&a.push({type:'plain_text',message:c}),a.push({type:'fold_bar',message:d,fold_bar_title:e.title_name||e.tag_name}),''!==u&&a.push({type:'plain_text',message:u}))}}return a},K=()=>{u.value&&(u.value.scrollTop=u.value.scrollHeight)},L=(e,t,a)=>{v.value={visible:!0,title:e,message:t,confirmText:'',cancelText:''},a&&(v.value._callback=a)},U=()=>{const e=v.value._callback;e&&e(),v.value.visible=!1,delete v.value._callback},F=()=>{v.value.visible=!1},P=e=>{const t=-1===e;Yr.loadFromVariable(e).injectPrompt(t)},j=async e=>{if(void 0===e&&(e=!1),e||r.value.trim()){const e=r.value.trim();r.value='',c.value&&(c.value.style.height='auto');try{localStorage.removeItem(zd)}catch(e){console.error('Failed to clear user input from localStorage:',e)}try{await createChatMessages([{role:'user',message:e}],{refresh:'none'});const t=getLastMessageId();B(),q(),P(getLastMessageId()-1),dd.startGeneration(e,t)}catch(e){console.error('Failed to send message:',e),dd.stopGeneration()}}},H=async e=>{const t=e.swipe_id||0;if(t<e.swipes.length-1){const e=t+1;await setChatMessages([{message_id:getLastMessageId(),swipe_id:e}],{refresh:'none'}),q(),K()}else await(async()=>{const e=getLastMessageId();await setChatMessages([{message_id:e,is_hidden:!0}],{refresh:'none'}),P(getLastMessageId()-1),dd.startSwipeGeneration(e)})()},G=async(e,t,a,n,r)=>{const o=a.filter((_,e)=>e!==t),l=n.filter((_,e)=>e!==t),i=r.filter((_,e)=>e!==t);let s=t;s>=o.length&&(s=o.length-1),await setChatMessages([{message_id:getLastMessageId(),swipes:o,swipes_data:l,swipes_info:i,swipe_id:s}],{refresh:'none'}),q(),K()},q=()=>{try{w.value.clear();const e=getLastMessageId();if(N.value=e,e>=0){const a=f.value,n=Math.max(0,e-a+1),r=getChatMessages(`${n}-${e}`,{include_swipes:!0});o.value=r.map((e,t)=>{const a='assistant'===e.role&&t===r.length-1,n=e;return{content:n.swipes?n.swipes[n.swipe_id||0]:e.message,role:e.role,swipe_id:n.swipe_id,swipes:n.swipes,swipes_data:n.swipes_data,swipes_info:n.swipes_info,is_latest_assistant:a}}),h.value=n>0,f.value===b.value&&(0,t.nextTick)(()=>{K()})}}catch(e){console.error('Failed to load messages:',e),o.value=[],h.value=!1}};return a({handleRenderSizeChanged:e=>{console.log('Render size changed to:',e),b.value=e,B(),q()},getScrollPosition:()=>u.value?.scrollTop||0,setScrollPosition:e=>{u.value&&(u.value.scrollTop=e)}}),(0,t.onMounted)(()=>{(()=>{try{const e=getVariables({type:'chat'});e?.settings?.render_size&&(b.value=e.settings.render_size)}catch(e){console.error('Failed to load chat settings:',e)}})(),f.value=b.value,N.value=getLastMessageId(),q(),(()=>{try{const e=localStorage.getItem(zd);e&&(r.value=e)}catch(e){console.error('Failed to restore user input from localStorage:',e)}})(),(0,t.nextTick)(()=>{(()=>{if('undefined'==typeof ResizeObserver)return x.value=80,void(E.value=68);y.value=new ResizeObserver(e=>{for(const t of e){const e=t.target;e.classList.contains('tab-navigation')?x.value=e.offsetHeight:e.classList.contains('input-area')&&(E.value=e.offsetHeight)}});const e=document.querySelector('.tab-navigation.top');e&&(y.value.observe(e),x.value=e.offsetHeight),p.value&&(y.value.observe(p.value),E.value=p.value.offsetHeight)})()}),dd.getState(),eventOn('initialization_completed',()=>{j(!0)}),eventOn('MESSAGE_RECEIVED_PROCESSED',()=>{q(),(0,t.nextTick)(()=>{(()=>{if(u.value){const e=u.value.querySelectorAll('.message');e.length>0&&e[e.length-1].scrollIntoView({behavior:'smooth',block:'start'})}})()})}),eventOn(tavern_events.GENERATION_ENDED,e=>{dd.stopGeneration()}),eventOn('RESTORE_USER_INPUT',e=>{r.value=e})}),(0,t.onUnmounted)(()=>{y.value&&(y.value.disconnect(),y.value=null)}),(e,a)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',ud,[(0,t.createElementVNode)('div',pd,[(0,t.createElementVNode)('div',md,[(0,t.createElementVNode)('div',{ref_key:'messages_container_ref',ref:u,class:'messages-container'},[(0,t.createCommentVNode)('  '),h.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',gd,[(0,t.createElementVNode)('button',{class:'load-more-btn',onClick:T},'')])):(0,t.createCommentVNode)('v-if',!0),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(o.value,(e,n)=>{return(0,t.openBlock)(),(0,t.createElementBlock)('div',{key:n,class:(0,t.normalizeClass)(['message',e.role])},[m.value===n?((0,t.openBlock)(),(0,t.createElementBlock)('div',vd,[(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':a[0]||(a[0]=e=>g.value=e),class:'edit-textarea',rows:'3',onKeydown:M},null,544),[[t.vModelText,g.value]]),(0,t.createElementVNode)('div',bd,[(0,t.createElementVNode)('button',{class:'edit-btn confirm-btn',onClick:t=>(async(e,t)=>{if(g.value.trim()&&g.value!==e.content)try{if('user'===e.role)await setChatMessages([{message_id:getLastMessageId()-(o.value.length-1-t),message:g.value.trim()}],{refresh:'none'});else if('assistant'===e.role)if(e.swipes){const a=e.swipe_id||0,n=[...e.swipes];n[a]=g.value.trim(),await setChatMessages([{message_id:getLastMessageId()-(o.value.length-1-t),swipes:n}],{refresh:'none'})}else await setChatMessages([{message_id:getLastMessageId()-(o.value.length-1-t),message:g.value.trim()}],{refresh:'none'});q()}catch(e){console.error('Failed to save edit:',e)}R()})(e,n)},'',8,fd),(0,t.createElementVNode)('button',{class:'edit-btn cancel-btn',onClick:R},'')])])):((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,{key:1},[(0,t.createElementVNode)('div',hd,[(0,t.createElementVNode)('div',xd,[(0,t.createElementVNode)('span',_d,'#'+(0,t.toDisplayString)(N.value-(o.value.length-1-n))+' ('+(0,t.toDisplayString)((r=N.value-(o.value.length-1-n),l=e.content,w.value.has(r)?`${w.value.get(r)}`:(S.value.has(r)||C(r,l),'...')))+' tokens)',1),(0,t.createElementVNode)('div',Ed,['assistant'!==e.role||e.is_latest_assistant?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:0,class:'rewind-message-btn',title:'',onClick:t=>((e,t)=>{L('','',()=>Y(e,t))})(e,n)},'  ',8,yd)),(0,t.createElementVNode)('button',{class:'edit-message-btn',title:'',onClick:t=>((e,t)=>{m.value=t,g.value=e.content})(e,n)},'',8,kd)])]),(0,t.createElementVNode)('div',Nd,[(0,t.createElementVNode)('div',Vd,[(0,t.createElementVNode)('div',wd,(0,t.toDisplayString)(V(N.value-(o.value.length-1-n)).datetimeLine),1),(0,t.createElementVNode)('div',Sd,(0,t.toDisplayString)(V(N.value-(o.value.length-1-n)).locationString),1)])])]),(0,t.createElementVNode)('div',Cd,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(A(e.content),(e,a)=>((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,{key:a},[(0,t.createCommentVNode)('  '),(0,t.createCommentVNode)(' eslint-disable-next-line vue/no-v-html '),'plain_text'===e.type?((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:0,innerHTML:e.message},null,8,Td)):(0,t.createCommentVNode)('v-if',!0),(0,t.createCommentVNode)('  '),'fold_bar'===e.type?((0,t.openBlock)(),(0,t.createBlock)(d,{key:1,title:e.fold_bar_title||'','is-open':e.is_open||!1},{default:(0,t.withCtx)(()=>[(0,t.createCommentVNode)(' eslint-disable-next-line vue/no-v-html '),(0,t.createElementVNode)('span',{innerHTML:e.message},null,8,Bd)]),_:2},1032,['title','is-open'])):(0,t.createCommentVNode)('v-if',!0)],64))),128))]),e.is_latest_assistant&&e.swipes?((0,t.openBlock)(),(0,t.createElementBlock)('div',Id,[(0,t.createElementVNode)('button',{class:'swipe-btn',disabled:(e.swipe_id||0)<=0,onClick:t=>(async e=>{if(e.swipe_id>0){const t=e.swipe_id-1;await setChatMessages([{message_id:getLastMessageId(),swipe_id:t}],{refresh:'none'}),q(),K()}})(e)},'  ',8,$d),(0,t.createElementVNode)('span',Dd,(0,t.toDisplayString)((e.swipe_id||0)+1)+'/'+(0,t.toDisplayString)(e.swipes.length),1),(0,t.createElementVNode)('button',{class:'swipe-btn',disabled:s.value,onClick:t=>H(e)},'',8,Rd),(0,t.createElementVNode)('button',{class:'swipe-btn delete-btn',disabled:e.swipes.length<=1,title:'swipe',onClick:t=>(async e=>{const t=e.swipe_id||0,a=e.swipes,n=e.swipes_data,r=e.swipes_info;a.length<=1||L('',` ${t+1} \n\n`,()=>G(e,t,a,n,r))})(e)},'  ',8,Md)])):(0,t.createCommentVNode)('v-if',!0)],64))],2);var r,l}),128))],512)]),(0,t.createElementVNode)('div',{ref_key:'input_area_ref',ref:p,class:'input-area'},[(0,t.createElementVNode)('div',Yd,[(0,t.withDirectives)((0,t.createElementVNode)('textarea',{ref_key:'message_input_ref',ref:c,'onUpdate:modelValue':a[1]||(a[1]=e=>r.value=e),class:'message-input',placeholder:'...',rows:'1',onKeydown:I,onInput:D},null,544),[[t.vModelText,r.value]]),i.value||s.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ad)):(0,t.createCommentVNode)('v-if',!0),(0,t.createElementVNode)('button',{class:'send-button',onClick:a[2]||(a[2]=e=>i.value||s.value?(async()=>{await dd.stopGeneration()})():j())},(0,t.toDisplayString)(i.value||s.value?'':''),1)])],512),(0,t.createCommentVNode)('  '),(0,t.createVNode)(Xi,{'confirm-dialog':v.value,onConfirmDialogConfirm:U,onConfirmDialogCancel:F},null,8,['confirm-dialog'])])]))}});n(8949);const Kd=(0,c.A)(Od,[['__scopeId','data-v-18297b7b']]),Ld={class:'item-tab-container'},Ud={class:'item-content'},Fd={class:'item-list'},Pd={class:'item-info'},jd={class:'item-id-name-row'},Hd={key:0,class:'item-id'},Gd=['onUpdate:modelValue'],qd={key:2,class:'item-name'},Xd=['onUpdate:modelValue'],Wd={key:0,class:'item-description'},Jd=['onUpdate:modelValue'],Zd={class:'item-value-actions-row'},Qd={key:0,class:'item-value'},eu={key:1,class:'item-value-input-wrapper'},tu=['onUpdate:modelValue'],au={class:'item-actions'},nu=['onClick'],ru=['onClick'],ou=['onClick'],lu=['onClick'],iu={key:0,class:'item-row new-item-row'},su={class:'item-info'},cu={class:'item-id-name-row'},du={class:'item-value-actions-row'},uu={class:'item-value-input-wrapper'},pu={key:1,class:'no-items-message'},mu=(0,t.defineComponent)({__name:'item_tab',setup(e){(0,t.useCssVars)(e=>({f33397ea:r.value}));const a=(0,t.ref)(0),n=(0,t.ref)(null),r=(0,t.computed)(()=>`calc(100vh - ${a.value}px)`);(0,t.onMounted)(()=>{(async()=>{await(0,t.nextTick)();const e=document.querySelector('.tab-navigation');e&&window.ResizeObserver?(n.value=new ResizeObserver(e=>{for(const t of e)a.value=t.contentRect.height}),n.value.observe(e)):a.value=74})()}),(0,t.onUnmounted)(()=>{n.value&&(n.value.disconnect(),n.value=null)});const o=(0,t.ref)(!1),l=(0,t.ref)(new Set),i=(0,t.ref)({id:'',name:'',description:'',value:0}),s=(0,t.ref)({}),c=(0,t.ref)({visible:!1,title:'',message:'',confirmText:'',cancelText:''}),d=(0,t.ref)(null),u=(0,t.ref)(null),p=()=>{u.value&&(u.value.saveAsVariable(getLastMessageId()),m())},m=()=>{try{const e=getLastMessageId();u.value=Yr.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),u.value=null}};m();const g=(0,t.computed)(()=>u.value?.items||new Map),v=()=>{o.value=!0,i.value={id:'',name:'',description:'',value:0}},b=()=>{if(!u.value||!i.value.id||!i.value.name)return;if(u.value.items.has(i.value.id))return void f();const e=new Ir(i.value.name,i.value.description,i.value.value);u.value.items.set(i.value.id,e),p(),f()},f=()=>{o.value=!1,i.value={id:'',name:'',description:'',value:0}},h=e=>{l.value.delete(e),delete s.value[e]},x=()=>{d.value&&u.value&&(u.value.items.delete(d.value),p()),c.value.visible=!1,d.value=null},E=()=>{c.value.visible=!1,d.value=null};return(e,a)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',Ld,[(0,t.createElementVNode)('div',Ud,[(0,t.createCommentVNode)('  '),a[7]||(a[7]=(0,t.createElementVNode)('div',{class:'item-section'},[(0,t.createElementVNode)('h3',{class:'section-title'},'')],-1)),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Fd,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(g.value,([e,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'item-row'},[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Pd,[(0,t.createElementVNode)('div',jd,[l.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':t=>s.value[e].id=t,class:'item-id-input',placeholder:'ID'},null,8,Gd)),[[t.vModelText,s.value[e].id]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',Hd,(0,t.toDisplayString)(e),1)),l.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:3,'onUpdate:modelValue':t=>s.value[e].name=t,class:'item-name-input',placeholder:''},null,8,Xd)),[[t.vModelText,s.value[e].name]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',qd,(0,t.toDisplayString)(n.name),1))]),l.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':t=>s.value[e].description=t,class:'item-description-input',placeholder:''},null,8,Jd)),[[t.vModelText,s.value[e].description]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',Wd,(0,t.toDisplayString)(n.description),1))]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Zd,[l.value.has(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',eu,[a[5]||(a[5]=(0,t.createElementVNode)('span',{class:'dollar-sign'},'$',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>s.value[e].value=t,class:'item-value-input',type:'number',placeholder:''},null,8,tu),[[t.vModelText,s.value[e].value,void 0,{number:!0}]])])):((0,t.openBlock)(),(0,t.createElementBlock)('div',Qd,'$'+(0,t.toDisplayString)(n.value.toLocaleString()),1)),(0,t.createElementVNode)('div',au,[l.value.has(e)?((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:1,class:'confirm-button',onClick:t=>(e=>{if(!u.value||!s.value[e])return;const t=s.value[e];if(t.id!==e&&u.value.items.has(t.id))return void h(e);const a=u.value.items.get(e);a&&(t.id!==e&&(u.value.items.delete(e),u.value.items.set(t.id,a)),a.name=t.name,a.description=t.description,a.value=t.value,p()),h(e)})(e)},'',8,ru)):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:0,class:'edit-item-button',onClick:t=>(e=>{const t=g.value.get(e);t&&(l.value.add(e),s.value[e]={id:e,name:t.name,description:t.description,value:t.value})})(e)},'  ',8,nu)),l.value.has(e)?((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:3,class:'cancel-button',onClick:t=>h(e)},'',8,lu)):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:2,class:'delete-item-button',onClick:t=>(e=>{const t=g.value.get(e);t&&(d.value=e,c.value={visible:!0,title:'',message:` "${t.name}" `,confirmText:'',cancelText:''})})(e)},'  ',8,ou))])])]))),128)),(0,t.createCommentVNode)('  '),o.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',iu,[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',su,[(0,t.createElementVNode)('div',cu,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>i.value.id=e),class:'item-id-input',placeholder:'ID'},null,512),[[t.vModelText,i.value.id]]),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>i.value.name=e),class:'item-name-input',placeholder:''},null,512),[[t.vModelText,i.value.name]])]),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':a[2]||(a[2]=e=>i.value.description=e),class:'item-description-input',placeholder:''},null,512),[[t.vModelText,i.value.description]])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',du,[(0,t.createElementVNode)('div',uu,[a[6]||(a[6]=(0,t.createElementVNode)('span',{class:'dollar-sign'},'$',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[3]||(a[3]=e=>i.value.value=e),class:'item-value-input',type:'number',placeholder:''},null,512),[[t.vModelText,i.value.value,void 0,{number:!0}]])]),(0,t.createElementVNode)('div',{class:'item-actions'},[(0,t.createElementVNode)('button',{class:'confirm-button',onClick:b},''),(0,t.createElementVNode)('button',{class:'cancel-button',onClick:f},'')])])])):(0,t.createCommentVNode)('v-if',!0),0!==g.value.size||o.value?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('div',pu,'')),o.value?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:2,class:'add-item-button',onClick:v},'+ '))]),(0,t.createCommentVNode)('  '),(0,t.createVNode)(Xi,{'confirm-dialog':c.value,'onUpdate:confirmDialog':a[4]||(a[4]=e=>c.value=e),onConfirmDialogConfirm:x,onConfirmDialogCancel:E},null,8,['confirm-dialog'])])]))}});n(2598);const gu=(0,c.A)(mu,[['__scopeId','data-v-b32ed7ea']]),vu={class:'location-tab-container'},bu={class:'location-content'},fu={class:'location-list'},hu=['id'],xu={class:'location-first-row'},_u={class:'location-id-name-group'},Eu={key:0,class:'location-id'},yu=['onUpdate:modelValue'],ku={key:2,class:'location-name'},Nu=['onUpdate:modelValue'],Vu={class:'location-actions'},wu=['onClick'],Su=['onClick'],Cu={class:'location-location-row'},Tu={class:'location-location-group'},Bu={key:0,class:'location-location'},Iu=['onUpdate:modelValue'],$u={key:0,class:'location-edit-actions'},Du=['onClick'],Ru=['onClick'],Mu={key:0,class:'location-parent-display'},Yu=['onClick'],Au={key:1,class:'location-parent-tag'},zu={key:1,class:'location-parent-input-group'},Ou=['onUpdate:modelValue'],Ku=['value','disabled'],Lu={key:2,class:'location-children-display'},Uu=['onClick'],Fu={key:3,class:'location-children-input-group'},Pu={class:'selected-children'},ju=['onClick'],Hu=['onChange'],Gu=['value','disabled'],qu={key:4,class:'location-storages-display'},Xu={key:5,class:'location-storages-input-group'},Wu={class:'selected-storages'},Ju=['onClick'],Zu=['onChange'],Qu=['value','disabled'],ep={key:6,class:'location-description'},tp=['onUpdate:modelValue'],ap={key:0,class:'location-row new-location-row'},np={class:'location-first-row'},rp={class:'location-id-name-group'},op={class:'location-location-row'},lp={class:'location-location-group'},ip={class:'location-parent-input-group'},sp=['value'],cp={class:'location-children-input-group'},dp={class:'selected-children'},up=['onClick'],pp=['value','disabled'],mp={class:'location-storages-input-group'},gp={class:'selected-storages'},vp=['onClick'],bp=['value','disabled'],fp={key:1,class:'no-locations-message'},hp=(0,t.defineComponent)({__name:'location_tab',setup(e){(0,t.useCssVars)(e=>({v77958077:r.value}));const a=(0,t.ref)(0),n=(0,t.ref)(null),r=(0,t.computed)(()=>`calc(100vh - ${a.value}px)`);(0,t.onMounted)(()=>{(async()=>{await(0,t.nextTick)();const e=document.querySelector('.tab-navigation');e&&window.ResizeObserver?(n.value=new ResizeObserver(e=>{for(const t of e)a.value=t.contentRect.height}),n.value.observe(e)):a.value=74})()}),(0,t.onUnmounted)(()=>{n.value&&(n.value.disconnect(),n.value=null)});const o=(0,t.ref)(!1),l=(0,t.ref)(new Set),i=(0,t.ref)({id:'',name:'',location:'',description:'',parent_location_id:null,sub_location_ids:[],storage_ids:[]}),s=(0,t.ref)({}),c=(0,t.ref)({visible:!1,title:'',message:'',confirmText:'',cancelText:''}),d=(0,t.ref)(null),u=(0,t.ref)(null),p=()=>{u.value&&(u.value.saveAsVariable(getLastMessageId()),m())},m=()=>{try{const e=getLastMessageId();u.value=Yr.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),u.value=null}};m();const g=(0,t.computed)(()=>u.value?.locations||new Map),v=(0,t.computed)(()=>u.value?.storages||new Map),b=(e,t)=>{let a=t;const n=new Set;for(;a;){if(n.has(a))return!0;if(a===e)return!0;n.add(a);const t=g.value.get(a);a=t?.parent_location_id||null}return!1},f=()=>{o.value=!0,i.value={id:'',name:'',location:'',description:'',parent_location_id:null,sub_location_ids:[],storage_ids:[]},i.value.id=(()=>{const e=Array.from(g.value.keys());let t=1;for(;e.includes(`l${t}`);)t++;return`l${t}`})()},h=e=>{if(!(e.id&&e.name&&e.location&&e.description))return null;try{return new $r(e.id,e.name,e.location,e.description,e.parent_location_id,e.sub_location_ids,e.storage_ids)}catch(e){return console.error('Failed to create location:',e),null}},x=()=>{if(!u.value)return;if(u.value.locations.has(i.value.id))return void E();const e=h(i.value);e?(u.value.locations.set(i.value.id,e),p(),E()):E()},E=()=>{o.value=!1,i.value={id:'',name:'',location:'',description:'',parent_location_id:null,sub_location_ids:[],storage_ids:[]}},y=e=>{l.value.delete(e),delete s.value[e]},k=()=>{d.value&&u.value&&(u.value.locations.delete(d.value),p()),c.value.visible=!1,d.value=null},N=()=>{c.value.visible=!1,d.value=null},V=(e,t)=>{e.sub_location_ids.includes(t)||e.sub_location_ids.push(t)},w=(e,t)=>{const a=e.sub_location_ids.indexOf(t);a>-1&&e.sub_location_ids.splice(a,1)},S=(e,t)=>{e.storage_ids.includes(t)||e.storage_ids.push(t)},C=(e,t)=>{const a=e.storage_ids.indexOf(t);a>-1&&e.storage_ids.splice(a,1)},T=e=>{const t=document.getElementById(`location-${e}`);t&&t.scrollIntoView({behavior:'smooth',block:'start'})};return(e,a)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',vu,[(0,t.createElementVNode)('div',bu,[(0,t.createCommentVNode)('  '),a[16]||(a[16]=(0,t.createElementVNode)('div',{class:'location-section'},[(0,t.createElementVNode)('h3',{class:'section-title'},'')],-1)),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',fu,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(g.value,([e,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{id:`location-${e}`,key:e,class:'location-row'},[(0,t.createCommentVNode)(' ID '),(0,t.createElementVNode)('div',xu,[(0,t.createElementVNode)('div',_u,[l.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':t=>s.value[e].id=t,class:'location-id-input',placeholder:'ID'},null,8,yu)),[[t.vModelText,s.value[e].id]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',Eu,(0,t.toDisplayString)(e),1)),l.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:3,'onUpdate:modelValue':t=>s.value[e].name=t,class:'location-name-input',placeholder:''},null,8,Nu)),[[t.vModelText,s.value[e].name]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',ku,(0,t.toDisplayString)(n.name),1))]),(0,t.createElementVNode)('div',Vu,[l.value.has(e)?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:0,class:'edit-location-button',onClick:t=>(e=>{const t=g.value.get(e);t&&(l.value.add(e),s.value[e]={id:e,name:t.name,location:t.location,description:t.description,parent_location_id:t.parent_location_id,sub_location_ids:[...t.sub_location_ids],storage_ids:[...t.storage_ids]})})(e)},'  ',8,wu)),l.value.has(e)?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:1,class:'delete-location-button',onClick:t=>(e=>{const t=g.value.get(e);t&&(d.value=e,c.value={visible:!0,title:'',message:` "${t.name}" `,confirmText:'',cancelText:''})})(e)},'  ',8,Su))])]),(0,t.createCommentVNode)('  +  '),(0,t.createElementVNode)('div',Cu,[(0,t.createElementVNode)('div',Tu,[a[8]||(a[8]=(0,t.createElementVNode)('span',{class:'location-location-label'},'',-1)),l.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':t=>s.value[e].location=t,class:'location-location-input location-location-input-edit',placeholder:''},null,8,Iu)),[[t.vModelText,s.value[e].location]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',Bu,(0,t.toDisplayString)(n.location),1))]),l.value.has(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',$u,[(0,t.createElementVNode)('button',{class:'confirm-button',onClick:t=>(e=>{if(!u.value||!s.value[e])return;const t=s.value[e];if(t.id!==e&&u.value.locations.has(t.id))return void y(e);const a=h(t);if(a){const n=u.value.locations.get(e);n&&(t.id!==e?(u.value.locations.delete(e),u.value.locations.set(t.id,a)):(n.name=a.name,n.location=a.location,n.description=a.description,n.parent_location_id=a.parent_location_id,n.sub_location_ids=a.sub_location_ids,n.storage_ids=a.storage_ids),p()),y(e)}else y(e)})(e)},'',8,Du),(0,t.createElementVNode)('button',{class:'cancel-button',onClick:t=>y(e)},'',8,Ru)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createCommentVNode)('  '),l.value.has(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',zu,[(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':t=>s.value[e].parent_location_id=t,class:'parent-location-select'},[a[9]||(a[9]=(0,t.createElementVNode)('option',{value:null},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(g.value,([a,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:a,value:a,disabled:a===e||b(e,a)},(0,t.toDisplayString)(n.name)+' ('+(0,t.toDisplayString)(a)+') ',9,Ku))),128))],8,Ou),[[t.vModelSelect,s.value[e].parent_location_id]])])):((0,t.openBlock)(),(0,t.createElementBlock)('div',Mu,[n.parent_location_id?((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:0,class:'location-parent-tag',onClick:e=>T(n.parent_location_id)},' : '+(0,t.toDisplayString)(n.parent_location_id)+' '+(0,t.toDisplayString)(g.value.get(n.parent_location_id)?.name||n.parent_location_id),9,Yu)):((0,t.openBlock)(),(0,t.createElementBlock)('span',Au,''))])),(0,t.createCommentVNode)('  '),l.value.has(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',Fu,[(0,t.createElementVNode)('div',Pu,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(s.value[e].sub_location_ids,a=>((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:a,class:'selected-child-tag'},[(0,t.createTextVNode)((0,t.toDisplayString)(g.value.get(a)?.name||a)+' ',1),(0,t.createElementVNode)('button',{class:'remove-child-btn',onClick:t=>w(s.value[e],a)},'  ',8,ju)]))),128))]),(0,t.createElementVNode)('select',{class:'child-location-select',onChange:t=>{V(s.value[e],t.target.value),t.target.value=''}},[a[10]||(a[10]=(0,t.createElementVNode)('option',{value:''},'...',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(g.value,([a,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:a,value:a,disabled:s.value[e].sub_location_ids.includes(a)||a===e||b(a,e)},(0,t.toDisplayString)(n.name)+' ('+(0,t.toDisplayString)(a)+') ',9,Gu))),128))],40,Hu)])):((0,t.openBlock)(),(0,t.createElementBlock)('div',Lu,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(n.sub_location_ids,e=>((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:e,class:'location-child-tag',onClick:t=>T(e)},' : '+(0,t.toDisplayString)(e)+' '+(0,t.toDisplayString)(g.value.get(e)?.name||e),9,Uu))),128))])),(0,t.createCommentVNode)('  '),l.value.has(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',Xu,[(0,t.createElementVNode)('div',Wu,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(s.value[e].storage_ids,a=>((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:a,class:'selected-storage-tag'},[(0,t.createTextVNode)((0,t.toDisplayString)(v.value.get(a)?.name||a)+' ',1),(0,t.createElementVNode)('button',{class:'remove-storage-btn',onClick:t=>C(s.value[e],a)},'  ',8,Ju)]))),128))]),(0,t.createElementVNode)('select',{class:'storage-location-select',onChange:t=>{S(s.value[e],t.target.value),t.target.value=''}},[a[11]||(a[11]=(0,t.createElementVNode)('option',{value:''},'...',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(v.value,([a,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:a,value:a,disabled:s.value[e].storage_ids.includes(a)},(0,t.toDisplayString)(n.name)+' ('+(0,t.toDisplayString)(a)+') ',9,Qu))),128))],40,Zu)])):((0,t.openBlock)(),(0,t.createElementBlock)('div',qu,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(n.storage_ids,e=>((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:e,class:'location-storage-tag'},' : '+(0,t.toDisplayString)(e)+' '+(0,t.toDisplayString)(v.value.get(e)?.name||e),1))),128))])),(0,t.createCommentVNode)('  '),l.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:7,'onUpdate:modelValue':t=>s.value[e].description=t,class:'location-description-input',placeholder:''},null,8,tp)),[[t.vModelText,s.value[e].description]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',ep,(0,t.toDisplayString)(n.description),1))],8,hu))),128)),(0,t.createCommentVNode)('  '),o.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',ap,[(0,t.createCommentVNode)(' ID '),(0,t.createElementVNode)('div',np,[(0,t.createElementVNode)('div',rp,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>i.value.id=e),class:'location-id-input',placeholder:'ID'},null,512),[[t.vModelText,i.value.id]]),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>i.value.name=e),class:'location-name-input',placeholder:''},null,512),[[t.vModelText,i.value.name]])])]),(0,t.createCommentVNode)('  +  '),(0,t.createElementVNode)('div',op,[(0,t.createElementVNode)('div',lp,[a[12]||(a[12]=(0,t.createElementVNode)('span',{class:'location-location-label'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>i.value.location=e),class:'location-location-input location-location-input-edit',placeholder:''},null,512),[[t.vModelText,i.value.location]])]),(0,t.createElementVNode)('div',{class:'location-edit-actions'},[(0,t.createElementVNode)('button',{class:'confirm-button',onClick:x},''),(0,t.createElementVNode)('button',{class:'cancel-button',onClick:E},'')])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',ip,[(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':a[3]||(a[3]=e=>i.value.parent_location_id=e),class:'parent-location-select'},[a[13]||(a[13]=(0,t.createElementVNode)('option',{value:null},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(g.value,([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e,value:e},(0,t.toDisplayString)(a.name)+' ('+(0,t.toDisplayString)(e)+') ',9,sp))),128))],512),[[t.vModelSelect,i.value.parent_location_id]])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',cp,[(0,t.createElementVNode)('div',dp,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(i.value.sub_location_ids,e=>((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:e,class:'selected-child-tag'},[(0,t.createTextVNode)((0,t.toDisplayString)(g.value.get(e)?.name||e)+' ',1),(0,t.createElementVNode)('button',{class:'remove-child-btn',onClick:t=>w(i.value,e)},'',8,up)]))),128))]),(0,t.createElementVNode)('select',{class:'child-location-select',onChange:a[4]||(a[4]=e=>{V(i.value,e.target.value),e.target.value=''})},[a[14]||(a[14]=(0,t.createElementVNode)('option',{value:''},'...',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(g.value,([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e,value:e,disabled:i.value.sub_location_ids.includes(e)||e===i.value.id},(0,t.toDisplayString)(a.name)+' ('+(0,t.toDisplayString)(e)+') ',9,pp))),128))],32)]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',mp,[(0,t.createElementVNode)('div',gp,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(i.value.storage_ids,e=>((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:e,class:'selected-storage-tag'},[(0,t.createTextVNode)((0,t.toDisplayString)(v.value.get(e)?.name||e)+' ',1),(0,t.createElementVNode)('button',{class:'remove-storage-btn',onClick:t=>C(i.value,e)},'',8,vp)]))),128))]),(0,t.createElementVNode)('select',{class:'storage-location-select',onChange:a[5]||(a[5]=e=>{S(i.value,e.target.value),e.target.value=''})},[a[15]||(a[15]=(0,t.createElementVNode)('option',{value:''},'...',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(v.value,([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e,value:e,disabled:i.value.storage_ids.includes(e)},(0,t.toDisplayString)(a.name)+' ('+(0,t.toDisplayString)(e)+') ',9,bp))),128))],32)]),(0,t.createCommentVNode)('  '),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':a[6]||(a[6]=e=>i.value.description=e),class:'location-description-input',placeholder:''},null,512),[[t.vModelText,i.value.description]])])):(0,t.createCommentVNode)('v-if',!0),0!==g.value.size||o.value?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('div',fp,'')),o.value?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:2,class:'add-location-button',onClick:f},'+ '))]),(0,t.createCommentVNode)('  '),(0,t.createVNode)(Xi,{'confirm-dialog':c.value,'onUpdate:confirmDialog':a[7]||(a[7]=e=>c.value=e),onConfirmDialogConfirm:k,onConfirmDialogCancel:N},null,8,['confirm-dialog'])])]))}});n(5184);const xp=(0,c.A)(hp,[['__scopeId','data-v-bd354e5e']]),_p={class:'storage-tab-container'},Ep={class:'storage-content'},yp={class:'storage-list'},kp=['id'],Np={class:'storage-first-row'},Vp={class:'storage-id-name-group'},wp={key:0,class:'storage-id'},Sp=['onUpdate:modelValue'],Cp={key:2,class:'storage-name'},Tp=['onUpdate:modelValue'],Bp={class:'storage-actions'},Ip=['onClick'],$p=['onClick'],Dp={class:'storage-money-row'},Rp={class:'storage-money-group'},Mp={key:0,class:'storage-money'},Yp=['onUpdate:modelValue','onInput'],Ap={key:0,class:'storage-edit-actions'},zp=['disabled','onClick'],Op=['onClick'],Kp={key:0,class:'storage-parent-display'},Lp={class:'storage-parent-tag'},Up={key:1,class:'storage-parent-input-group'},Fp=['onUpdate:modelValue'],Pp={label:''},jp=['value'],Hp={label:''},Gp=['value'],qp={label:''},Xp=['value','disabled'],Wp={key:2,class:'storage-inventory-display'},Jp={key:0,class:'no-inventory'},Zp={key:1,class:'inventory-items'},Qp={key:3,class:'storage-inventory-input-group'},em={class:'selected-inventory'},tm={class:'item-name'},am={key:0,class:'storage-indicator'},nm={key:1,class:'inventory-edit-connector'},rm=['onUpdate:modelValue','onInput'],om=['onClick'],lm=['onChange'],im={label:''},sm=['value','disabled'],cm={label:''},dm=['value','disabled'],um={key:4,class:'storage-description'},pm=['onUpdate:modelValue'],mm={key:0,class:'storage-row new-storage-row'},gm={class:'storage-first-row'},vm={class:'storage-id-name-group'},bm={class:'storage-money-row'},fm={class:'storage-money-group'},hm={class:'storage-edit-actions'},xm=['disabled'],_m={class:'storage-parent-input-group'},Em={label:''},ym=['value'],km={label:''},Nm=['value'],Vm={label:''},wm=['value'],Sm={class:'storage-inventory-input-group'},Cm={class:'selected-inventory'},Tm={class:'item-name'},Bm={key:0,class:'storage-indicator'},Im={key:1,class:'inventory-edit-connector'},$m=['onUpdate:modelValue','onInput'],Dm=['onClick'],Rm={label:''},Mm=['value','disabled'],Ym={label:''},Am=['value','disabled'],zm={key:1,class:'no-storages-message'},Om=(0,t.defineComponent)({__name:'storage_tab',setup(e){(0,t.useCssVars)(e=>({v4efc9d77:r.value}));const a=(0,t.ref)(0),n=(0,t.ref)(null),r=(0,t.computed)(()=>`calc(100vh - ${a.value}px)`);(0,t.onMounted)(()=>{(async()=>{await(0,t.nextTick)();const e=document.querySelector('.tab-navigation');e&&window.ResizeObserver?(n.value=new ResizeObserver(e=>{for(const t of e)a.value=t.contentRect.height}),n.value.observe(e)):a.value=74})()}),(0,t.onUnmounted)(()=>{n.value&&(n.value.disconnect(),n.value=null)});const o=(0,t.ref)(!1),l=(0,t.ref)(new Set),i=(0,t.ref)({id:'',name:'',description:'',parent_id:'',money:0,inventory:{}}),s=(0,t.ref)({}),c=(0,t.ref)({visible:!1,title:'',message:'',confirmText:'',cancelText:''}),d=(0,t.ref)(null),u=e=>p.value?.storages.has(e)||!1,p=(0,t.ref)(null),m=()=>{p.value&&(p.value.saveAsVariable(getLastMessageId()),g())},g=()=>{try{const e=getLastMessageId();p.value=Yr.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),p.value=null}};g();const v=(0,t.computed)(()=>p.value?.storages||new Map),b=(0,t.computed)(()=>p.value?.active_characters||new Map),f=(0,t.computed)(()=>p.value?.locations||new Map),h=(0,t.computed)(()=>p.value?.items||new Map),x=()=>{o.value=!0,i.value={id:'',name:'',description:'',parent_id:'',money:0,inventory:{}}},E=e=>{if(!e.id||!e.name||!e.description||e.money<0)return null;if(!(b.value.has(e.parent_id)||f.value.has(e.parent_id)||v.value.has(e.parent_id)))return null;for(const t in e.inventory){const a=h.value.has(t)||v.value.has(t),n=v.value.has(t)?1:e.inventory[t];if(!a||n<1)return null}try{const t=new Map;for(const[a,n]of Object.entries(e.inventory)){const e=v.value.has(a)?1:n;t.set(a,e)}return new Rr(e.name,e.description,e.parent_id,e.money,t)}catch(e){return console.error('Failed to create storage:',e),null}},y=()=>{if(!p.value)return;if(p.value.storages.has(i.value.id))return void k();const e=E(i.value);e?(p.value.storages.set(i.value.id,e),m(),k()):k()},k=()=>{o.value=!1,i.value={id:'',name:'',description:'',parent_id:'',money:0,inventory:{}}},N=e=>{l.value.delete(e),delete s.value[e]},V=()=>{d.value&&p.value&&(p.value.storages.delete(d.value),m()),c.value.visible=!1,d.value=null},w=()=>{c.value.visible=!1,d.value=null},S=(e,t)=>{t in e.inventory||(e.inventory[t]=1)},C=(e,t)=>{delete e.inventory[t]};return(e,a)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',_p,[(0,t.createElementVNode)('div',Ep,[(0,t.createCommentVNode)('  '),a[14]||(a[14]=(0,t.createElementVNode)('div',{class:'storage-section'},[(0,t.createElementVNode)('h3',{class:'section-title'},'')],-1)),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',yp,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(v.value,([e,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{id:`storage-${e}`,key:e,class:'storage-row'},[(0,t.createCommentVNode)(' ID '),(0,t.createElementVNode)('div',Np,[(0,t.createElementVNode)('div',Vp,[l.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':t=>s.value[e].id=t,class:'storage-id-input',placeholder:'ID'},null,8,Sp)),[[t.vModelText,s.value[e].id]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',wp,(0,t.toDisplayString)(e),1)),l.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:3,'onUpdate:modelValue':t=>s.value[e].name=t,class:'storage-name-input',placeholder:''},null,8,Tp)),[[t.vModelText,s.value[e].name]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',Cp,(0,t.toDisplayString)(n.name),1))]),(0,t.createElementVNode)('div',Bp,[l.value.has(e)?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:0,class:'edit-storage-button',onClick:t=>(e=>{const t=v.value.get(e);t&&(l.value.add(e),s.value[e]={id:e,name:t.name,description:t.description,parent_id:t.parent_id,money:t.money,inventory:Object.fromEntries(t.inventory)})})(e)},'  ',8,Ip)),l.value.has(e)?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:1,class:'delete-storage-button',onClick:t=>(e=>{const t=v.value.get(e);t&&(d.value=e,c.value={visible:!0,title:'',message:` "${t.name}" `,confirmText:'',cancelText:''})})(e)},'  ',8,$p))])]),(0,t.createCommentVNode)('  +  '),(0,t.createElementVNode)('div',Dp,[(0,t.createElementVNode)('div',Rp,[a[8]||(a[8]=(0,t.createElementVNode)('span',{class:'storage-money-label'},'',-1)),l.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':t=>s.value[e].money=t,type:'number',class:'storage-money-input storage-money-input-edit',placeholder:'',min:'0',onInput:t=>s.value[e].money=Math.max(0,parseInt(t.target.value)||0)},null,40,Yp)),[[t.vModelText,s.value[e].money,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',Mp,'$'+(0,t.toDisplayString)(n.money),1))]),l.value.has(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ap,[(0,t.createElementVNode)('button',{class:'confirm-button',disabled:!s.value[e].id||!s.value[e].name||!s.value[e].parent_id,onClick:t=>(e=>{if(!p.value||!s.value[e])return;const t=s.value[e];if(t.id!==e&&p.value.storages.has(t.id))return void N(e);const a=E(t);if(a){const n=p.value.storages.get(e);n&&(t.id!==e?(p.value.storages.delete(e),p.value.storages.set(t.id,a)):(n.name=a.name,n.description=a.description,n.parent_id=a.parent_id,n.money=a.money,n.inventory=a.inventory),m()),N(e)}else N(e)})(e)},'  ',8,zp),(0,t.createElementVNode)('button',{class:'cancel-button',onClick:t=>N(e)},'',8,Op)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createCommentVNode)('  '),l.value.has(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',Up,[(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':t=>s.value[e].parent_id=t,class:'parent-select'},[a[9]||(a[9]=(0,t.createElementVNode)('option',{value:'',disabled:''},' ()...',-1)),(0,t.createElementVNode)('optgroup',Pp,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(b.value,([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:`char-${e}`,value:e},(0,t.toDisplayString)(a.name)+' ('+(0,t.toDisplayString)(e)+') ',9,jp))),128))]),(0,t.createElementVNode)('optgroup',Hp,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(f.value,([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:`loc-${e}`,value:e},(0,t.toDisplayString)(a.name)+' ('+(0,t.toDisplayString)(e)+') ',9,Gp))),128))]),(0,t.createElementVNode)('optgroup',qp,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(v.value,([a,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:`storage-${a}`,value:a,disabled:a===e},(0,t.toDisplayString)(n.name)+' ('+(0,t.toDisplayString)(a)+') ',9,Xp))),128))])],8,Fp),[[t.vModelSelect,s.value[e].parent_id]])])):((0,t.openBlock)(),(0,t.createElementBlock)('div',Kp,[(0,t.createElementVNode)('span',Lp,(0,t.toDisplayString)(n.parent_id)+' '+(0,t.toDisplayString)(b.value.get(n.parent_id)?.name||f.value.get(n.parent_id)?.name||v.value.get(n.parent_id)?.name||n.parent_id),1)])),(0,t.createCommentVNode)('  '),l.value.has(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',Qp,[(0,t.createElementVNode)('div',em,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Object.keys(s.value[e].inventory),a=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:a,class:'selected-inventory-item'},[(0,t.createElementVNode)('span',tm,(0,t.toDisplayString)(h.value.get(a)?.name||v.value.get(a)?.name||a),1),u(a)?((0,t.openBlock)(),(0,t.createElementBlock)('span',am,'')):(0,t.createCommentVNode)('v-if',!0),u(a)?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('span',nm,'')),u(a)?(0,t.createCommentVNode)('v-if',!0):(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:2,'onUpdate:modelValue':t=>s.value[e].inventory[a]=t,type:'number',class:'item-quantity-input',placeholder:'',min:'1',step:'1',onInput:t=>s.value[e].inventory[a]=Math.max(1,parseInt(t.target.value)||1)},null,40,rm)),[[t.vModelText,s.value[e].inventory[a],void 0,{number:!0}]]),(0,t.createElementVNode)('button',{class:'remove-item-btn',onClick:t=>C(s.value[e],a)},'',8,om)]))),128))]),(0,t.createElementVNode)('select',{class:'item-select',onChange:t=>{S(s.value[e],t.target.value),t.target.value=''}},[a[10]||(a[10]=(0,t.createElementVNode)('option',{value:''},'...',-1)),(0,t.createElementVNode)('optgroup',im,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(h.value,([a,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:a,value:a,disabled:s.value[e].inventory.hasOwnProperty(a)},(0,t.toDisplayString)(n.name)+' ('+(0,t.toDisplayString)(a)+') ',9,sm))),128))]),(0,t.createElementVNode)('optgroup',cm,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(v.value,([a,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:a,value:a,disabled:s.value[e].inventory.hasOwnProperty(a)||a===e},(0,t.toDisplayString)(n.name)+' ('+(0,t.toDisplayString)(a)+') ',9,dm))),128))])],40,lm)])):((0,t.openBlock)(),(0,t.createElementBlock)('div',Wp,[0===n.inventory.size?((0,t.openBlock)(),(0,t.createElementBlock)('div',Jp,'')):((0,t.openBlock)(),(0,t.createElementBlock)('div',Zp,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(n.inventory,([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:e,class:(0,t.normalizeClass)(v.value.has(e)?'storage-item-tag':'inventory-item-tag')},(0,t.toDisplayString)(h.value.get(e)?.name||v.value.get(e)?.name||e)+' ('+(0,t.toDisplayString)(e)+')'+(0,t.toDisplayString)(v.value.has(e)?'':`  ${a}`),3))),128))]))])),(0,t.createCommentVNode)('  '),l.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:5,'onUpdate:modelValue':t=>s.value[e].description=t,class:'storage-description-input',placeholder:''},null,8,pm)),[[t.vModelText,s.value[e].description]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',um,(0,t.toDisplayString)(n.description),1))],8,kp))),128)),(0,t.createCommentVNode)('  '),o.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',mm,[(0,t.createCommentVNode)(' ID '),(0,t.createElementVNode)('div',gm,[(0,t.createElementVNode)('div',vm,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>i.value.id=e),class:'storage-id-input',placeholder:'ID'},null,512),[[t.vModelText,i.value.id]]),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>i.value.name=e),class:'storage-name-input',placeholder:''},null,512),[[t.vModelText,i.value.name]])])]),(0,t.createCommentVNode)('  +  '),(0,t.createElementVNode)('div',bm,[(0,t.createElementVNode)('div',fm,[a[11]||(a[11]=(0,t.createElementVNode)('span',{class:'storage-money-label'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>i.value.money=e),type:'number',class:'storage-money-input storage-money-input-edit',placeholder:'',min:'0',onInput:a[3]||(a[3]=e=>i.value.money=Math.max(0,parseInt(e.target.value)||0))},null,544),[[t.vModelText,i.value.money,void 0,{number:!0}]])]),(0,t.createElementVNode)('div',hm,[(0,t.createElementVNode)('button',{class:'confirm-button',disabled:!i.value.id||!i.value.name||!i.value.parent_id,onClick:y},'  ',8,xm),(0,t.createElementVNode)('button',{class:'cancel-button',onClick:k},'')])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',_m,[(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':a[4]||(a[4]=e=>i.value.parent_id=e),class:'parent-select'},[a[12]||(a[12]=(0,t.createElementVNode)('option',{value:'',disabled:''},' ()...',-1)),(0,t.createElementVNode)('optgroup',Em,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(b.value,([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:`char-${e}`,value:e},(0,t.toDisplayString)(a.name)+' ('+(0,t.toDisplayString)(e)+') ',9,ym))),128))]),(0,t.createElementVNode)('optgroup',km,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(f.value,([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:`loc-${e}`,value:e},(0,t.toDisplayString)(a.name)+' ('+(0,t.toDisplayString)(e)+') ',9,Nm))),128))]),(0,t.createElementVNode)('optgroup',Vm,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(v.value,([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:`storage-${e}`,value:e},(0,t.toDisplayString)(a.name)+' ('+(0,t.toDisplayString)(e)+') ',9,wm))),128))])],512),[[t.vModelSelect,i.value.parent_id]])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Sm,[(0,t.createElementVNode)('div',Cm,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Object.keys(i.value.inventory),e=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'selected-inventory-item'},[(0,t.createElementVNode)('span',Tm,(0,t.toDisplayString)(h.value.get(e)?.name||v.value.get(e)?.name||e),1),u(e)?((0,t.openBlock)(),(0,t.createElementBlock)('span',Bm,'')):(0,t.createCommentVNode)('v-if',!0),u(e)?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('span',Im,'')),u(e)?(0,t.createCommentVNode)('v-if',!0):(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:2,'onUpdate:modelValue':t=>i.value.inventory[e]=t,type:'number',class:'item-quantity-input',placeholder:'',min:'1',step:'1',onInput:t=>i.value.inventory[e]=Math.max(1,parseInt(t.target.value)||1)},null,40,$m)),[[t.vModelText,i.value.inventory[e],void 0,{number:!0}]]),(0,t.createElementVNode)('button',{class:'remove-item-btn',onClick:t=>C(i.value,e)},'',8,Dm)]))),128))]),(0,t.createElementVNode)('select',{class:'item-select',onChange:a[5]||(a[5]=e=>{S(i.value,e.target.value),e.target.value=''})},[a[13]||(a[13]=(0,t.createElementVNode)('option',{value:''},'...',-1)),(0,t.createElementVNode)('optgroup',Rm,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(h.value,([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e,value:e,disabled:i.value.inventory.hasOwnProperty(e)},(0,t.toDisplayString)(a.name)+' ('+(0,t.toDisplayString)(e)+') ',9,Mm))),128))]),(0,t.createElementVNode)('optgroup',Ym,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(v.value,([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e,value:e,disabled:i.value.inventory.hasOwnProperty(e)},(0,t.toDisplayString)(a.name)+' ('+(0,t.toDisplayString)(e)+') ',9,Am))),128))])],32)]),(0,t.createCommentVNode)('  '),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':a[6]||(a[6]=e=>i.value.description=e),class:'storage-description-input',placeholder:''},null,512),[[t.vModelText,i.value.description]])])):(0,t.createCommentVNode)('v-if',!0),0!==v.value.size||o.value?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('div',zm,'')),o.value?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:2,class:'add-storage-button',onClick:x},'+ '))]),(0,t.createCommentVNode)('  '),(0,t.createVNode)(Xi,{'confirm-dialog':c.value,'onUpdate:confirmDialog':a[7]||(a[7]=e=>c.value=e),onConfirmDialogConfirm:V,onConfirmDialogCancel:w},null,8,['confirm-dialog'])])]))}});n(2286);const Km=(0,c.A)(Om,[['__scopeId','data-v-62b84623']]),Lm={class:'promise-tab-container'},Um={class:'promise-content'},Fm={class:'promise-list'},Pm={class:'promise-first-row'},jm={class:'promise-id-name-group'},Hm={key:0,class:'promise-id'},Gm=['onUpdate:modelValue'],qm={key:2,class:'promise-deadline'},Xm={key:3,class:'promise-deadline-input-group'},Wm=['onUpdate:modelValue','onInput'],Jm=['onUpdate:modelValue','onInput'],Zm=['onUpdate:modelValue','onInput'],Qm=['onUpdate:modelValue','onInput'],eg=['onUpdate:modelValue','onInput'],tg={class:'promise-actions'},ag=['onClick'],ng=['onClick'],rg={class:'promise-location-row'},og={class:'promise-location-group'},lg={key:0,class:'promise-location'},ig=['onUpdate:modelValue'],sg=['value'],cg={key:0,class:'promise-edit-actions'},dg=['onClick'],ug=['onClick'],pg={key:0,class:'promise-character-ids-display'},mg={key:1,class:'promise-character-ids-input-group'},gg={class:'selected-characters'},vg=['onClick'],bg=['onChange'],fg=['value','disabled'],hg={key:2,class:'promise-description'},xg=['onUpdate:modelValue'],_g={key:0,class:'promise-row new-promise-row'},Eg={class:'promise-first-row'},yg={class:'promise-id-name-group'},kg={class:'promise-deadline-input-group'},Ng={class:'promise-location-row'},Vg={class:'promise-location-group'},wg=['value'],Sg={class:'promise-character-ids-input-group'},Cg={class:'selected-characters'},Tg=['onClick'],Bg=['value','disabled'],Ig={key:1,class:'no-promises-message'},$g=(0,t.defineComponent)({__name:'promise_tab',setup(e){(0,t.useCssVars)(e=>({v592213a0:r.value}));const a=(0,t.ref)(0),n=(0,t.ref)(null),r=(0,t.computed)(()=>`calc(100vh - ${a.value}px)`);(0,t.onMounted)(()=>{(async()=>{await(0,t.nextTick)();const e=document.querySelector('.tab-navigation');e&&window.ResizeObserver?(n.value=new ResizeObserver(e=>{for(const t of e)a.value=t.contentRect.height}),n.value.observe(e)):a.value=74})()}),(0,t.onUnmounted)(()=>{n.value&&(n.value.disconnect(),n.value=null)});const o=e=>{const t=e.toDate();return{year:t.getFullYear().toString(),month:(t.getMonth()+1).toString(),day:t.getDate().toString(),hour:t.getHours().toString(),minute:t.getMinutes().toString()}},l=(0,t.ref)(!1),i=(0,t.ref)(new Set),s=(0,t.ref)({id:'',deadline:{year:'',month:'',day:'',hour:'',minute:''},location_id:'',character_ids:[],description:''}),c=(0,t.ref)({}),d=(0,t.ref)({visible:!1,title:'',message:'',confirmText:'',cancelText:''}),u=(0,t.ref)(null),p=(0,t.ref)(null),m=()=>{p.value&&(p.value.saveAsVariable(getLastMessageId()),g())},g=()=>{try{const e=getLastMessageId();p.value=Yr.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),p.value=null}};g();const v=(0,t.computed)(()=>p.value?.promises||new Map),b=(0,t.computed)(()=>{if(!p.value)return[];const e=new Map;for(const[t,a]of p.value.active_characters)e.set(t,a.name);for(const[t,a]of p.value.deactive_characters)e.set(t,a.name);return Array.from(e.entries()).map(([e,t])=>({id:e,name:t}))}),f=(0,t.computed)(()=>p.value?Array.from(p.value.locations.values()):[]),h=()=>{l.value=!0,s.value={id:'',deadline:{year:'',month:'',day:'',hour:'',minute:''},location_id:'',character_ids:[],description:''},s.value.id=(()=>{const e=Array.from(v.value.keys());let t=1;for(;e.includes(`p${t}`);)t++;return`p${t}`})()},x=e=>{if(!e.id||!e.deadline||!e.description)return null;try{const t=(e=>{const t=parseInt(e.year)||(new Date).getFullYear(),a=parseInt(e.month)||1,n=parseInt(e.day)||1,r=parseInt(e.hour)||0,o=parseInt(e.minute)||0;return new Tr(new Date(t,a-1,n,r,o,0))})(e.deadline),a=e.character_ids.filter(e=>e),n=e.location_id||null;return new Dr(t,a,n,e.description)}catch(e){return console.error('Failed to create promise:',e),null}},E=()=>{if(!p.value)return;if(p.value.promises.has(s.value.id))return void y();const e=x(s.value);e?(p.value.promises.set(s.value.id,e),m(),y()):y()},y=()=>{l.value=!1,s.value={id:'',deadline:{year:'',month:'',day:'',hour:'',minute:''},location_id:'',character_ids:[],description:''}},k=e=>{i.value.delete(e),delete c.value[e]},N=()=>{u.value&&p.value&&(p.value.promises.delete(u.value),m()),d.value.visible=!1,u.value=null},V=()=>{d.value.visible=!1,u.value=null},w=(e,t)=>{e.character_ids.includes(t)||e.character_ids.push(t)},S=(e,t)=>{const a=e.character_ids.indexOf(t);a>-1&&e.character_ids.splice(a,1)},C=(e,t,a)=>{const n=parseInt(e);return isNaN(n)?'':Math.min(Math.max(n,t),a).toString()},T=e=>{const t=e.toDate();return`${t.getFullYear()}${t.getMonth()+1}${t.getDate()} ${t.getHours().toString().padStart(2,'0')}:${t.getMinutes().toString().padStart(2,'0')}`};return(e,a)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',Lm,[(0,t.createElementVNode)('div',Um,[(0,t.createCommentVNode)('  '),a[31]||(a[31]=(0,t.createElementVNode)('div',{class:'promise-section'},[(0,t.createElementVNode)('h3',{class:'section-title'},'')],-1)),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Fm,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(v.value,([e,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'promise-row'},[(0,t.createCommentVNode)(' ID '),(0,t.createElementVNode)('div',Pm,[(0,t.createElementVNode)('div',jm,[i.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':t=>c.value[e].id=t,class:'promise-id-input',placeholder:'ID'},null,8,Gm)),[[t.vModelText,c.value[e].id]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',Hm,(0,t.toDisplayString)(e),1)),i.value.has(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',Xm,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>c.value[e].deadline.year=t,type:'number',placeholder:'',class:'promise-deadline-input promise-deadline-year-input',onInput:t=>c.value[e].deadline.year=C(c.value[e].deadline.year.toString(),0,Number.MAX_SAFE_INTEGER)},null,40,Wm),[[t.vModelText,c.value[e].deadline.year,void 0,{number:!0}]]),a[15]||(a[15]=(0,t.createElementVNode)('span',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>c.value[e].deadline.month=t,type:'number',placeholder:'',class:'promise-deadline-input',onInput:t=>c.value[e].deadline.month=C(c.value[e].deadline.month.toString(),1,12)},null,40,Jm),[[t.vModelText,c.value[e].deadline.month,void 0,{number:!0}]]),a[16]||(a[16]=(0,t.createElementVNode)('span',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>c.value[e].deadline.day=t,type:'number',placeholder:'',class:'promise-deadline-input',onInput:t=>c.value[e].deadline.day=C(c.value[e].deadline.day.toString(),1,31)},null,40,Zm),[[t.vModelText,c.value[e].deadline.day,void 0,{number:!0}]]),a[17]||(a[17]=(0,t.createElementVNode)('span',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>c.value[e].deadline.hour=t,type:'number',placeholder:'',class:'promise-deadline-input',onInput:t=>c.value[e].deadline.hour=C(c.value[e].deadline.hour.toString(),0,23)},null,40,Qm),[[t.vModelText,c.value[e].deadline.hour,void 0,{number:!0}]]),a[18]||(a[18]=(0,t.createElementVNode)('span',null,':',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>c.value[e].deadline.minute=t,type:'number',placeholder:'',class:'promise-deadline-input',onInput:t=>c.value[e].deadline.minute=C(c.value[e].deadline.minute.toString(),0,59)},null,40,eg),[[t.vModelText,c.value[e].deadline.minute,void 0,{number:!0}]])])):((0,t.openBlock)(),(0,t.createElementBlock)('div',qm,(0,t.toDisplayString)(T(n.deadline)),1))]),(0,t.createElementVNode)('div',tg,[i.value.has(e)?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:0,class:'edit-promise-button',onClick:t=>(e=>{const t=v.value.get(e);t&&(i.value.add(e),c.value[e]={id:e,deadline:o(t.deadline),location_id:t.location_id||'',character_ids:[...t.character_ids],description:t.description})})(e)},'  ',8,ag)),i.value.has(e)?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:1,class:'delete-promise-button',onClick:t=>(e=>{const t=v.value.get(e);t&&(u.value=e,d.value={visible:!0,title:'',message:` "${t.description}" `,confirmText:'',cancelText:''})})(e)},'  ',8,ng))])]),(0,t.createCommentVNode)('  +  '),(0,t.createElementVNode)('div',rg,[(0,t.createElementVNode)('div',og,[a[21]||(a[21]=(0,t.createElementVNode)('span',{class:'promise-location-label'},'',-1)),i.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('select',{key:1,'onUpdate:modelValue':t=>c.value[e].location_id=t,class:'promise-location-input promise-location-input-edit'},[a[19]||(a[19]=(0,t.createElementVNode)('option',{value:'',disabled:''},'...',-1)),a[20]||(a[20]=(0,t.createElementVNode)('option',{value:''},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(f.value,e=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e.id,value:e.id},(0,t.toDisplayString)(e.name)+' ('+(0,t.toDisplayString)(e.id)+') ',9,sg))),128))],8,ig)),[[t.vModelSelect,c.value[e].location_id]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',lg,(0,t.toDisplayString)(n.location_id?f.value.find(e=>e.id===n.location_id)?.name||n.location_id:''),1))]),i.value.has(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',cg,[(0,t.createElementVNode)('button',{class:'confirm-button',onClick:t=>(e=>{if(!p.value||!c.value[e])return;const t=c.value[e];if(t.id!==e&&p.value.promises.has(t.id))return void k(e);const a=x(t);if(a){const n=p.value.promises.get(e);n&&(t.id!==e?(p.value.promises.delete(e),p.value.promises.set(t.id,a)):(n.deadline=a.deadline,n.location_id=a.location_id,n.character_ids=a.character_ids,n.description=a.description),m()),k(e)}else k(e)})(e)},'',8,dg),(0,t.createElementVNode)('button',{class:'cancel-button',onClick:t=>k(e)},'',8,ug)])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createCommentVNode)(' ID '),i.value.has(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',mg,[(0,t.createElementVNode)('div',gg,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(c.value[e].character_ids,a=>((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:a,class:'selected-character-tag'},[(0,t.createTextVNode)((0,t.toDisplayString)(b.value.find(e=>e.id===a)?.name||a)+' ',1),(0,t.createElementVNode)('button',{class:'remove-character-btn',onClick:t=>S(c.value[e],a)},'  ',8,vg)]))),128))]),(0,t.createElementVNode)('select',{class:'character-select',onChange:t=>{w(c.value[e],t.target.value),t.target.value=''}},[a[22]||(a[22]=(0,t.createElementVNode)('option',{value:''},'...',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(b.value,a=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:a.id,value:a.id,disabled:c.value[e].character_ids.includes(a.id)},(0,t.toDisplayString)(a.name)+' ('+(0,t.toDisplayString)(a.id)+') ',9,fg))),128))],40,bg)])):((0,t.openBlock)(),(0,t.createElementBlock)('div',pg,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(n.character_ids,e=>((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:e,class:'promise-character-id-tag'},(0,t.toDisplayString)(b.value.find(t=>t.id===e)?.name||e),1))),128))])),(0,t.createCommentVNode)('  '),i.value.has(e)?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:3,'onUpdate:modelValue':t=>c.value[e].description=t,class:'promise-description-input',placeholder:''},null,8,xg)),[[t.vModelText,c.value[e].description]]):((0,t.openBlock)(),(0,t.createElementBlock)('div',hg,(0,t.toDisplayString)(n.description),1))]))),128)),(0,t.createCommentVNode)('  '),l.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',_g,[(0,t.createCommentVNode)(' ID '),(0,t.createElementVNode)('div',Eg,[(0,t.createElementVNode)('div',yg,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>s.value.id=e),class:'promise-id-input',placeholder:'ID'},null,512),[[t.vModelText,s.value.id]]),(0,t.createElementVNode)('div',kg,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>s.value.deadline.year=e),type:'number',placeholder:'',class:'promise-deadline-input promise-deadline-year-input',onInput:a[2]||(a[2]=e=>s.value.deadline.year=C(s.value.deadline.year.toString(),0,Number.MAX_SAFE_INTEGER))},null,544),[[t.vModelText,s.value.deadline.year,void 0,{number:!0}]]),a[23]||(a[23]=(0,t.createElementVNode)('span',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[3]||(a[3]=e=>s.value.deadline.month=e),type:'number',placeholder:'',class:'promise-deadline-input',onInput:a[4]||(a[4]=e=>s.value.deadline.month=C(s.value.deadline.month.toString(),1,12))},null,544),[[t.vModelText,s.value.deadline.month,void 0,{number:!0}]]),a[24]||(a[24]=(0,t.createElementVNode)('span',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[5]||(a[5]=e=>s.value.deadline.day=e),type:'number',placeholder:'',class:'promise-deadline-input',onInput:a[6]||(a[6]=e=>s.value.deadline.day=C(s.value.deadline.day.toString(),1,31))},null,544),[[t.vModelText,s.value.deadline.day,void 0,{number:!0}]]),a[25]||(a[25]=(0,t.createElementVNode)('span',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[7]||(a[7]=e=>s.value.deadline.hour=e),type:'number',placeholder:'',class:'promise-deadline-input',onInput:a[8]||(a[8]=e=>s.value.deadline.hour=C(s.value.deadline.hour.toString(),0,23))},null,544),[[t.vModelText,s.value.deadline.hour,void 0,{number:!0}]]),a[26]||(a[26]=(0,t.createElementVNode)('span',null,':',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[9]||(a[9]=e=>s.value.deadline.minute=e),type:'number',placeholder:'',class:'promise-deadline-input',onInput:a[10]||(a[10]=e=>s.value.deadline.minute=C(s.value.deadline.minute.toString(),0,59))},null,544),[[t.vModelText,s.value.deadline.minute,void 0,{number:!0}]])])])]),(0,t.createCommentVNode)('  +  '),(0,t.createElementVNode)('div',Ng,[(0,t.createElementVNode)('div',Vg,[a[29]||(a[29]=(0,t.createElementVNode)('span',{class:'promise-location-label'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':a[11]||(a[11]=e=>s.value.location_id=e),class:'promise-location-input promise-location-input-edit'},[a[27]||(a[27]=(0,t.createElementVNode)('option',{value:'',disabled:''},'...',-1)),a[28]||(a[28]=(0,t.createElementVNode)('option',{value:''},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(f.value,e=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e.id,value:e.id},(0,t.toDisplayString)(e.name)+' ('+(0,t.toDisplayString)(e.id)+') ',9,wg))),128))],512),[[t.vModelSelect,s.value.location_id]])]),(0,t.createElementVNode)('div',{class:'promise-edit-actions'},[(0,t.createElementVNode)('button',{class:'confirm-button',onClick:E},''),(0,t.createElementVNode)('button',{class:'cancel-button',onClick:y},'')])]),(0,t.createCommentVNode)(' ID '),(0,t.createElementVNode)('div',Sg,[(0,t.createElementVNode)('div',Cg,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(s.value.character_ids,e=>((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:e,class:'selected-character-tag'},[(0,t.createTextVNode)((0,t.toDisplayString)(b.value.find(t=>t.id===e)?.name||e)+' ',1),(0,t.createElementVNode)('button',{class:'remove-character-btn',onClick:t=>S(s.value,e)},'',8,Tg)]))),128))]),(0,t.createElementVNode)('select',{class:'character-select',onChange:a[12]||(a[12]=e=>{w(s.value,e.target.value),e.target.value=''})},[a[30]||(a[30]=(0,t.createElementVNode)('option',{value:''},'...',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(b.value,e=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e.id,value:e.id,disabled:s.value.character_ids.includes(e.id)},(0,t.toDisplayString)(e.name)+' ('+(0,t.toDisplayString)(e.id)+') ',9,Bg))),128))],32)]),(0,t.createCommentVNode)('  '),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':a[13]||(a[13]=e=>s.value.description=e),class:'promise-description-input',placeholder:''},null,512),[[t.vModelText,s.value.description]])])):(0,t.createCommentVNode)('v-if',!0),0!==v.value.size||l.value?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('div',Ig,'')),l.value?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:2,class:'add-promise-button',onClick:h},'+ '))]),(0,t.createCommentVNode)('  '),(0,t.createVNode)(Xi,{'confirm-dialog':d.value,'onUpdate:confirmDialog':a[14]||(a[14]=e=>d.value=e),onConfirmDialogConfirm:N,onConfirmDialogCancel:V},null,8,['confirm-dialog'])])]))}});n(575);const Dg=(0,c.A)($g,[['__scopeId','data-v-25ffb8d9']]),Rg={class:'settings-container'},Mg={class:'settings-list'},Yg={class:'setting-item version-item'},Ag={class:'setting-control'},zg={class:'version-number'},Og={class:'setting-item'},Kg={class:'setting-control'},Lg={class:'switch'},Ug={class:'setting-item'},Fg={class:'setting-control'},Pg={class:'setting-item'},jg={class:'setting-control'},Hg={class:'folding-rules-fullwidth'},Gg={class:'folding-rules-container'},qg={class:'rule-cell'},Xg=['onUpdate:modelValue','onInput'],Wg={class:'rule-cell'},Jg=['onUpdate:modelValue','onInput'],Zg={class:'rule-cell'},Qg=['onUpdate:modelValue','onChange'],ev={class:'rule-cell'},tv={class:'radio-group compact'},av={class:'radio-option compact'},nv=['onUpdate:modelValue','onChange'],rv={class:'radio-option compact'},ov=['onUpdate:modelValue','onChange'],lv={class:'rule-cell'},iv={class:'radio-group compact'},sv={class:'radio-option compact'},cv=['onUpdate:modelValue','onChange'],dv={class:'radio-option compact'},uv=['onUpdate:modelValue','onChange'],pv={class:'rule-cell'},mv=['onClick'],gv=(0,t.defineComponent)({__name:'setting_tab',emits:['renderSizeChanged'],setup(e,{expose:a,emit:n}){(0,t.useCssVars)(e=>({v50c01ddd:p.value}));const r=n,o=(0,t.ref)('0.4.2'),l=(0,t.ref)(!1),i=(0,t.ref)(10),s=(0,t.ref)(1),c=(0,t.ref)([]),d=(0,t.ref)(0),u=(0,t.ref)(null),p=(0,t.computed)(()=>`calc(100vh - ${d.value}px)`),m=()=>{try{const e=getVariables({type:'chat'});e&&e.settings?(l.value=e.settings.fullscreen_enabled||!1,i.value=e.settings.render_size||10,s.value=e.settings.exclude_latest_summaries||1,c.value=e.settings.tag_rules||[]):g()}catch(e){console.error('Failed to load settings:',e)}},g=()=>{try{const e={fullscreen_enabled:l.value,render_size:i.value,exclude_latest_summaries:s.value,tag_rules:c.value};insertOrAssignVariables({settings:e},{type:'chat'})}catch(e){console.error('Failed to save settings:',e)}},v=async()=>{l.value?await(async()=>{try{document.documentElement.requestFullscreen?await document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen?await document.documentElement.webkitRequestFullscreen():document.documentElement.mozRequestFullScreen?await document.documentElement.mozRequestFullScreen():document.documentElement.msRequestFullscreen&&await document.documentElement.msRequestFullscreen()}catch(e){console.error('Failed to enter fullscreen:',e)}})():await(async()=>{try{document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.msExitFullscreen&&await document.msExitFullscreen()}catch(e){console.error('Failed to exit fullscreen:',e)}})(),g()},b=()=>{let e=Math.floor(Number(i.value));(isNaN(e)||e<1)&&(e=10),i.value=e,g(),r('renderSizeChanged',i.value)},f=()=>{let e=Math.floor(Number(s.value));(isNaN(e)||e<0)&&(e=1),s.value=e,g()},h=()=>{c.value.push({tag_name:'',match_mode:'both',match_strategy:'first',display_mode:'invisible',title_name:''}),g()},x=(e,t)=>{e>=0&&e<c.value.length&&(c.value[e]={...c.value[e],...t},g())},E=()=>{const e=!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement);l.value=e,g()};return m(),document.addEventListener('fullscreenchange',E),document.addEventListener('webkitfullscreenchange',E),document.addEventListener('mozfullscreenchange',E),document.addEventListener('MSFullscreenChange',E),(0,t.onMounted)(()=>{(0,t.nextTick)(()=>{(()=>{if('undefined'==typeof ResizeObserver)return void(d.value=74);u.value=new ResizeObserver(e=>{for(const t of e){const e=t.target;e.classList.contains('tab-navigation')&&(d.value=e.offsetHeight)}});const e=document.querySelector('.tab-navigation.top');e&&(u.value.observe(e),d.value=e.offsetHeight)})()})}),(0,t.onUnmounted)(()=>{u.value&&(u.value.disconnect(),u.value=null)}),eventOn(tavern_events.APP_READY,()=>{E()}),(0,t.onUnmounted)(()=>{document.removeEventListener('fullscreenchange',E),document.removeEventListener('webkitfullscreenchange',E),document.removeEventListener('mozfullscreenchange',E),document.removeEventListener('MSFullscreenChange',E)}),a({reloadSettings:m}),(e,a)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',Rg,[a[15]||(a[15]=(0,t.createElementVNode)('div',{class:'settings-header'},[(0,t.createElementVNode)('h2',null,'')],-1)),(0,t.createElementVNode)('div',Mg,[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Yg,[a[3]||(a[3]=(0,t.createElementVNode)('div',{class:'setting-label'},[(0,t.createElementVNode)('span',{class:'setting-title'},''),(0,t.createElementVNode)('span',{class:'setting-description'},'')],-1)),(0,t.createElementVNode)('div',Ag,[(0,t.createElementVNode)('span',zg,(0,t.toDisplayString)(o.value),1)])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Og,[a[5]||(a[5]=(0,t.createElementVNode)('div',{class:'setting-label'},[(0,t.createElementVNode)('span',{class:'setting-title'},''),(0,t.createElementVNode)('span',{class:'setting-description'},'')],-1)),(0,t.createElementVNode)('div',Kg,[(0,t.createElementVNode)('label',Lg,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>l.value=e),type:'checkbox',onChange:v},null,544),[[t.vModelCheckbox,l.value]]),a[4]||(a[4]=(0,t.createElementVNode)('span',{class:'slider'},null,-1))])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Ug,[a[6]||(a[6]=(0,t.createElementVNode)('div',{class:'setting-label'},[(0,t.createElementVNode)('span',{class:'setting-title'},''),(0,t.createElementVNode)('span',{class:'setting-description'},'')],-1)),(0,t.createElementVNode)('div',Fg,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>i.value=e),type:'number',class:'number-input',min:'1',onInput:b},null,544),[[t.vModelText,i.value,void 0,{number:!0}]])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Pg,[a[7]||(a[7]=(0,t.createElementVNode)('div',{class:'setting-label'},[(0,t.createElementVNode)('span',{class:'setting-title'},''),(0,t.createElementVNode)('span',{class:'setting-description'},'n')],-1)),(0,t.createElementVNode)('div',jg,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[2]||(a[2]=e=>s.value=e),type:'number',class:'number-input',min:'0',onInput:f},null,544),[[t.vModelText,s.value,void 0,{number:!0}]])])]),(0,t.createCommentVNode)(' XML '),a[14]||(a[14]=(0,t.createElementVNode)('div',{class:'setting-item xml-rules-item'},[(0,t.createElementVNode)('div',{class:'setting-label'},[(0,t.createElementVNode)('span',{class:'setting-title'},'XML'),(0,t.createElementVNode)('span',{class:'setting-description'},'XML')])],-1)),(0,t.createCommentVNode)(' XML '),(0,t.createElementVNode)('div',Hg,[(0,t.createElementVNode)('div',Gg,[(0,t.createCommentVNode)('  '),a[13]||(a[13]=(0,t.createStaticVNode)('<div class="rules-header" data-v-d8917884><div class="header-cell" data-v-d8917884></div><div class="header-cell" data-v-d8917884></div><div class="header-cell" data-v-d8917884></div><div class="header-cell" data-v-d8917884></div><div class="header-cell" data-v-d8917884></div><div class="header-cell" data-v-d8917884></div></div>',1)),(0,t.createCommentVNode)('  '),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(c.value,(e,n)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:n,class:'folding-rule-row'},[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',qg,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>e.tag_name=t,type:'text',class:'text-input compact',placeholder:': think',onInput:t=>x(n,{tag_name:e.tag_name})},null,40,Xg),[[t.vModelText,e.tag_name]])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Wg,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>e.title_name=t,type:'text',class:'text-input compact',placeholder:': ',onInput:t=>x(n,{title_name:e.title_name})},null,40,Jg),[[t.vModelText,e.title_name]])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Zg,[(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':t=>e.display_mode=t,class:'select-input compact',onChange:t=>x(n,{display_mode:e.display_mode})},[...a[8]||(a[8]=[(0,t.createElementVNode)('option',{value:'invisible'},'',-1),(0,t.createElementVNode)('option',{value:'fold_bar'},'',-1)])],40,Qg),[[t.vModelSelect,e.display_mode]])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',ev,[(0,t.createElementVNode)('div',tv,[(0,t.createElementVNode)('label',av,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>e.match_mode=t,type:'radio',value:'both',onChange:t=>x(n,{match_mode:e.match_mode})},null,40,nv),[[t.vModelRadio,e.match_mode]]),a[9]||(a[9]=(0,t.createElementVNode)('span',{class:'radio-label'},'',-1))]),(0,t.createElementVNode)('label',rv,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>e.match_mode=t,type:'radio',value:'end_only',onChange:t=>x(n,{match_mode:e.match_mode})},null,40,ov),[[t.vModelRadio,e.match_mode]]),a[10]||(a[10]=(0,t.createElementVNode)('span',{class:'radio-label'},'',-1))])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',lv,[(0,t.createElementVNode)('div',iv,[(0,t.createElementVNode)('label',sv,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>e.match_strategy=t,type:'radio',value:'first',onChange:t=>x(n,{match_strategy:e.match_strategy})},null,40,cv),[[t.vModelRadio,e.match_strategy]]),a[11]||(a[11]=(0,t.createElementVNode)('span',{class:'radio-label'},'',-1))]),(0,t.createElementVNode)('label',dv,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>e.match_strategy=t,type:'radio',value:'last',onChange:t=>x(n,{match_strategy:e.match_strategy})},null,40,uv),[[t.vModelRadio,e.match_strategy]]),a[12]||(a[12]=(0,t.createElementVNode)('span',{class:'radio-label'},'',-1))])])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',pv,[(0,t.createElementVNode)('button',{class:'delete-rule-btn compact',onClick:e=>{var t;(t=n)>=0&&t<c.value.length&&(c.value.splice(t,1),g())}},'',8,mv)])]))),128)),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',{class:'add-rule-row'},[(0,t.createElementVNode)('button',{class:'add-rule-btn',onClick:h},'+ ')])])])])]))}});n(4149);const vv=(0,c.A)(gv,[['__scopeId','data-v-d8917884']]),bv={class:'summary-tab-container'},fv={class:'summary-content'},hv={key:0,class:'summary-row new-summary-row'},xv={class:'summary-edit-mode'},_v={class:'summary-edit-first-row'},Ev={class:'summary-weighting-last-message-input-group'},yv={class:'summary-last-message-id-input-group'},kv=['value'],Nv={class:'summary-weighting-input-group'},Vv=['value'],wv={class:'summary-edit-actions'},Sv=['disabled'],Cv={class:'summary-edit-datetime-row'},Tv={class:'summary-datetime-input-group'},Bv=['value'],Iv=['value'],$v=['value'],Dv=['value'],Rv=['value'],Mv=['value'],Yv={class:'summary-list'},Av={key:0,class:'summary-edit-mode'},zv={class:'summary-edit-first-row'},Ov={class:'summary-weighting-last-message-input-group'},Kv={class:'summary-last-message-id-input-group'},Lv=['value'],Uv={class:'summary-weighting-input-group'},Fv=['value'],Pv={class:'summary-edit-actions'},jv=['disabled'],Hv={class:'summary-edit-datetime-row'},Gv={class:'summary-datetime-input-group'},qv=['value'],Xv=['value'],Wv=['value'],Jv=['value'],Zv=['value'],Qv=['value'],eb={class:'summary-first-row'},tb={class:'summary-weighting-last-message-group'},ab={class:'summary-last-message-id'},nb={class:'summary-weighting'},rb={class:'summary-actions'},ob=['onClick'],lb=['onClick'],ib={class:'summary-datetime-row'},sb={class:'summary-datetime'},cb={class:'summary-content-display'},db={key:0,class:'no-summaries-message'},ub=(0,t.defineComponent)({__name:'summary_tab',setup(e){(0,t.useCssVars)(e=>({v70237b32:r.value}));const a=(0,t.ref)(0),n=(0,t.ref)(null),r=(0,t.computed)(()=>`calc(100vh - ${a.value}px)`);(0,t.onMounted)(()=>{(async()=>{await(0,t.nextTick)();const e=document.querySelector('.tab-navigation');e&&window.ResizeObserver?(n.value=new ResizeObserver(e=>{for(const t of e)a.value=t.contentRect.height}),n.value.observe(e)):a.value=74})()}),(0,t.onUnmounted)(()=>{n.value&&(n.value.disconnect(),n.value=null)});const o=(0,t.ref)({visible:!1,title:'',message:'',confirmText:'',cancelText:''}),l=(0,t.ref)(null),i=(0,t.ref)(null),s=(0,t.ref)(!1),c=(0,t.ref)({year:0,month:0,day:0,hour:0,minute:0}),d=(0,t.ref)(0),u=(0,t.ref)(0),p=(0,t.ref)(''),m=(0,t.ref)(null),g=()=>{m.value&&(m.value.saveAsVariable(getLastMessageId()),v())},v=()=>{try{const e=getLastMessageId();m.value=Yr.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),m.value=null}};v();const b=(0,t.computed)(()=>m.value?.summaries?[...m.value.summaries].sort((e,t)=>t.last_message_id-e.last_message_id):[]),f=e=>{if(!m.value)return'unused';const t=(getVariables({type:'chat'}).settings||{}).exclude_latest_summaries||1,a=[...m.value.summaries].sort((e,t)=>e.last_message_id-t.last_message_id);return a.findIndex(t=>t.last_message_id===e.last_message_id)>=a.length-t?'unused':'used'},h=()=>{if(null!==l.value&&m.value){const e=b.value[l.value],t=m.value.summaries.indexOf(e);-1!==t&&(m.value.summaries.splice(t,1),g())}o.value.visible=!1,l.value=null},x=()=>{o.value.visible=!1,l.value=null},E=()=>{if(s.value=!0,m.value){const e=m.value.datetime.toDate();c.value={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes()}}u.value=(()=>{const e=getChatMessages(-1,{role:'assistant'});return e.length>0?e[0].message_id:getLastMessageId()})(),d.value=.5,p.value=''},y=()=>{if(m.value)try{const e=new Date(c.value.year,c.value.month-1,c.value.day,c.value.hour,c.value.minute,0),t=new Tr(e),a=new Mr(t,p.value.trim(),d.value,u.value);if(null!==i.value){const e=b.value[i.value],t=m.value.summaries.indexOf(e);-1!==t&&(m.value.summaries[t]=a,g(),i.value=null)}else s.value&&(m.value.summaries.push(a),m.value.summaries.sort((e,t)=>e.last_message_id-t.last_message_id),g(),s.value=!1)}catch(e){console.error('Failed to save summary:',e)}},k=()=>{i.value=null,s.value=!1},N=(0,t.computed)(()=>{if(u.value<0||!Number.isInteger(u.value))return!1;if(d.value<0||d.value>1)return!1;if(c.value.year<0||!Number.isInteger(c.value.year))return!1;if(!p.value.trim())return!1;try{const e=new Date(c.value.year,c.value.month-1,c.value.day,c.value.hour,c.value.minute,0);if(e.getFullYear()!==c.value.year||e.getMonth()!==c.value.month-1||e.getDate()!==c.value.day)return!1}catch{return!1}return!0}),V=(e,t,a,n=!1)=>{const r=n?parseFloat(e):parseInt(e);return isNaN(r)?'':Math.min(Math.max(r,t),a).toString()},w=e=>{const t=e.target,a=parseInt(V(t.value,0,Number.MAX_SAFE_INTEGER));u.value=a},S=e=>{const t=e.target,a=parseFloat(V(t.value,0,1,!0));d.value=a},C=(e,t)=>{const a=t.target;let n;switch(e){case'year':n=parseInt(V(a.value,0,Number.MAX_SAFE_INTEGER));break;case'month':n=parseInt(V(a.value,1,12));break;case'day':n=parseInt(V(a.value,1,31));break;case'hour':n=parseInt(V(a.value,0,23));break;case'minute':n=parseInt(V(a.value,0,59));break;default:return}c.value={...c.value,[e]:n}},T=e=>{const t=e.toDate();return`${t.getFullYear()}${t.getMonth()+1}${t.getDate()} ${t.getHours().toString().padStart(2,'0')}:${t.getMinutes().toString().padStart(2,'0')}`};return(e,a)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',bv,[(0,t.createElementVNode)('div',fv,[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',{class:'summary-section'},[a[17]||(a[17]=(0,t.createElementVNode)('h3',{class:'section-title'},'',-1)),(0,t.createElementVNode)('button',{class:'add-summary-button',onClick:E},'+ ')]),(0,t.createCommentVNode)('  '),s.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',hv,[(0,t.createElementVNode)('div',xv,[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',_v,[(0,t.createElementVNode)('div',Ev,[(0,t.createElementVNode)('div',yv,[a[18]||(a[18]=(0,t.createTextVNode)(' : ',-1)),(0,t.createElementVNode)('input',{value:u.value,type:'number',class:'summary-last-message-id-input',min:'0',step:'1',onInput:a[0]||(a[0]=e=>w(e))},null,40,kv)]),(0,t.createElementVNode)('div',Nv,[a[19]||(a[19]=(0,t.createTextVNode)(' : ',-1)),(0,t.createElementVNode)('input',{value:d.value,type:'number',class:'summary-weighting-input',step:'0.1',min:'0',max:'1',onInput:a[1]||(a[1]=e=>S(e))},null,40,Vv)])]),(0,t.createElementVNode)('div',wv,[(0,t.createElementVNode)('button',{class:'confirm-button',disabled:!N.value,onClick:y},'',8,Sv),(0,t.createElementVNode)('button',{class:'cancel-button',onClick:k},'')])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Cv,[(0,t.createElementVNode)('div',Tv,[(0,t.createElementVNode)('input',{value:c.value.year,type:'number',class:'summary-datetime-input summary-datetime-year-input',placeholder:'',onInput:a[2]||(a[2]=e=>C('year',e))},null,40,Bv),a[20]||(a[20]=(0,t.createTextVNode)(' ',-1)),(0,t.createElementVNode)('input',{value:c.value.month,type:'number',class:'summary-datetime-input',placeholder:'',min:'1',max:'12',onInput:a[3]||(a[3]=e=>C('month',e))},null,40,Iv),a[21]||(a[21]=(0,t.createTextVNode)(' ',-1)),(0,t.createElementVNode)('input',{value:c.value.day,type:'number',class:'summary-datetime-input',placeholder:'',min:'1',max:'31',onInput:a[4]||(a[4]=e=>C('day',e))},null,40,$v),a[22]||(a[22]=(0,t.createTextVNode)(' ',-1)),(0,t.createElementVNode)('input',{value:c.value.hour,type:'number',class:'summary-datetime-input',placeholder:'',min:'0',max:'23',onInput:a[5]||(a[5]=e=>C('hour',e))},null,40,Dv),a[23]||(a[23]=(0,t.createTextVNode)(': ',-1)),(0,t.createElementVNode)('input',{value:c.value.minute,type:'number',class:'summary-datetime-input',placeholder:'',min:'0',max:'59',onInput:a[6]||(a[6]=e=>C('minute',e))},null,40,Rv)])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('textarea',{value:p.value,class:'summary-content-input',placeholder:'...',onInput:a[7]||(a[7]=e=>p.value=e.target.value)},null,40,Mv)])])):(0,t.createCommentVNode)('v-if',!0),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Yv,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(b.value,(e,n)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:n,class:(0,t.normalizeClass)(['summary-row',{'new-summary-row':i.value===n}])},[(0,t.createCommentVNode)('  '),i.value===n?((0,t.openBlock)(),(0,t.createElementBlock)('div',Av,[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',zv,[(0,t.createElementVNode)('div',Ov,[(0,t.createElementVNode)('div',Kv,[a[24]||(a[24]=(0,t.createTextVNode)(' : ',-1)),(0,t.createElementVNode)('input',{value:u.value,type:'number',class:'summary-last-message-id-input',min:'0',step:'1',onInput:a[8]||(a[8]=e=>w(e))},null,40,Lv)]),(0,t.createElementVNode)('div',Uv,[a[25]||(a[25]=(0,t.createTextVNode)(' : ',-1)),(0,t.createElementVNode)('input',{value:d.value,type:'number',class:'summary-weighting-input',step:'0.1',min:'0',max:'1',onInput:a[9]||(a[9]=e=>S(e))},null,40,Fv)])]),(0,t.createElementVNode)('div',Pv,[(0,t.createElementVNode)('button',{class:'confirm-button',disabled:!N.value,onClick:y},'',8,jv),(0,t.createElementVNode)('button',{class:'cancel-button',onClick:k},'')])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Hv,[(0,t.createElementVNode)('div',Gv,[(0,t.createElementVNode)('input',{value:c.value.year,type:'number',class:'summary-datetime-input summary-datetime-year-input',placeholder:'',onInput:a[10]||(a[10]=e=>C('year',e))},null,40,qv),a[26]||(a[26]=(0,t.createTextVNode)(' ',-1)),(0,t.createElementVNode)('input',{value:c.value.month,type:'number',class:'summary-datetime-input',placeholder:'',min:'1',max:'12',onInput:a[11]||(a[11]=e=>C('month',e))},null,40,Xv),a[27]||(a[27]=(0,t.createTextVNode)(' ',-1)),(0,t.createElementVNode)('input',{value:c.value.day,type:'number',class:'summary-datetime-input',placeholder:'',min:'1',max:'31',onInput:a[12]||(a[12]=e=>C('day',e))},null,40,Wv),a[28]||(a[28]=(0,t.createTextVNode)(' ',-1)),(0,t.createElementVNode)('input',{value:c.value.hour,type:'number',class:'summary-datetime-input',placeholder:'',min:'0',max:'23',onInput:a[13]||(a[13]=e=>C('hour',e))},null,40,Jv),a[29]||(a[29]=(0,t.createTextVNode)(': ',-1)),(0,t.createElementVNode)('input',{value:c.value.minute,type:'number',class:'summary-datetime-input',placeholder:'',min:'0',max:'59',onInput:a[14]||(a[14]=e=>C('minute',e))},null,40,Zv)])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('textarea',{value:p.value,class:'summary-content-input',placeholder:'...',onInput:a[15]||(a[15]=e=>p.value=e.target.value)},null,40,Qv)])):((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,{key:1},[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',null,[(0,t.createCommentVNode)(' ID '),(0,t.createElementVNode)('div',eb,[(0,t.createElementVNode)('div',tb,[(0,t.createElementVNode)('div',ab,': '+(0,t.toDisplayString)(e.last_message_id),1),(0,t.createElementVNode)('div',nb,': '+(0,t.toDisplayString)(e.weighting),1),(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['summary-status',`status-${f(e)}`])},(0,t.toDisplayString)('used'===f(e)?'':''),3)]),(0,t.createElementVNode)('div',rb,[(0,t.createElementVNode)('button',{class:'edit-summary-button',onClick:e=>(e=>{if(m.value&&b.value[e]){i.value=e;const t=b.value[e],a=t.datetime.toDate();c.value={year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate(),hour:a.getHours(),minute:a.getMinutes()},d.value=t.weighting,u.value=t.last_message_id,p.value=t.summary}})(n)},'',8,ob),(0,t.createElementVNode)('button',{class:'delete-summary-button',onClick:e=>(e=>{if(m.value&&b.value[e]){const t=b.value[e];l.value=e,o.value={visible:!0,title:'',message:` "${t.summary.substring(0,50)}${t.summary.length>50?'...':''}" `,confirmText:'',cancelText:''}}})(n)},'',8,lb)])]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',ib,[(0,t.createElementVNode)('div',sb,(0,t.toDisplayString)(T(e.datetime)),1)]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',cb,(0,t.toDisplayString)(e.summary),1)])],2112))],2))),128)),0===b.value.length?((0,t.openBlock)(),(0,t.createElementBlock)('div',db,'')):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createCommentVNode)('  '),(0,t.createVNode)(Xi,{'confirm-dialog':o.value,'onUpdate:confirmDialog':a[16]||(a[16]=e=>o.value=e),onConfirmDialogConfirm:h,onConfirmDialogCancel:x},null,8,['confirm-dialog'])])]))}});n(7772);const pb=(0,c.A)(ub,[['__scopeId','data-v-3de5c4ec']]),mb={class:'user-tab-container'},gb={ref:'userContentRef',class:'user-content'},vb={class:'user-header'},bb={class:'user-name'},fb={class:'attributes-grid'},hb={class:'attribute-item horizontal'},xb={class:'attribute-value'},_b={class:'attribute-item horizontal'},Eb={key:0,class:'attribute-value'},yb={class:'attribute-item horizontal'},kb={key:0,class:'attribute-value'},Nb={class:'attribute-item horizontal'},Vb={key:0,class:'attribute-value'},wb={class:'attribute-item horizontal'},Sb={key:0,class:'attribute-value'},Cb={class:'attribute-item horizontal'},Tb={key:0,class:'attribute-value'},Bb={class:'attribute-item horizontal'},Ib={key:0,class:'attribute-value'},$b={class:'attribute-item horizontal'},Db={key:0,class:'attribute-value'},Rb={class:'attribute-item horizontal'},Mb={key:0,class:'attribute-value'},Yb={class:'attribute-item full-width horizontal'},Ab={key:0,class:'attribute-value money'},zb={class:'attribute-item full-width birthday-fullwidth'},Ob={key:0,class:'attribute-value'},Kb={key:1,class:'birthday-edit-container'},Lb={class:'birthday-input-group'},Ub={class:'attribute-item full-width'},Fb={key:0,class:'attribute-value no-bold'},Pb={class:'attribute-item full-width'},jb={key:0,class:'attribute-value no-bold'},Hb={class:'attribute-item full-width'},Gb={key:0,class:'attribute-value no-bold'},qb={class:'attribute-item full-width'},Xb={key:0,class:'attribute-value no-bold'},Wb={class:'attribute-item full-width'},Jb={key:0,class:'attribute-value no-bold'},Zb={class:'attribute-item full-width'},Qb={key:0,class:'attribute-value no-bold'},ef={class:'attribute-item full-width'},tf={key:0,class:'attribute-value no-bold'},af={key:0,class:'attribute-item full-width'},nf={key:0,class:'attribute-value no-bold'},rf={class:'relations-section'},of={key:0,class:'relations-list'},lf={class:'relation-highlight'},sf={class:'relation-highlight'},cf={key:0,class:'no-relations-message'},df={key:1,class:'relations-edit-list'},uf=['value','onChange'],pf=['value'],mf=['onUpdate:modelValue'],gf=['onClick'],vf={class:'inventory-section'},bf={key:0,class:'inventory-list'},ff={class:'inventory-first-row'},hf={class:'item-name-id'},xf={key:0,class:'item-quantity'},_f={key:1,class:'storage-indicator'},Ef={class:'inventory-second-row'},yf={key:0,class:'inventory-third-row'},kf={key:0,class:'no-inventory'},Nf={key:1,class:'inventory-items'},Vf={key:0,class:'no-inventory-message'},wf={key:1,class:'inventory-edit-list'},Sf=['value','onChange'],Cf={label:''},Tf=['value'],Bf={label:''},If=['value'],$f={key:0,class:'inventory-edit-connector'},Df=['onUpdate:modelValue'],Rf=['onClick'],Mf={key:0,class:'edit-buttons'},Yf=(0,t.defineComponent)({__name:'user_tab',setup(a,{expose:n}){(0,t.useCssVars)(e=>({v68dcf940:s.value}));const r=(0,t.ref)(!1),o=(0,t.ref)(null),l=(0,t.ref)(0),i=(0,t.ref)(null),s=(0,t.computed)(()=>`calc(100vh - ${l.value}px)`),c=(0,t.computed)({get:()=>o.value?.||{},set:e=>{o.value&&(o.value.=e)}}),d=(0,t.computed)({get:()=>o.value?.||{},set:e=>{o.value&&(o.value.=e)}}),u=(0,t.computed)(()=>{if(!E.value)return[];const e=[];for(const[t,a]of E.value.active_characters)'c1'!==t&&e.push({id:t,name:a.name});for(const[t,a]of E.value.deactive_characters)e.push({id:t,name:a.name});return e}),p=(0,t.computed)(()=>{if(!E.value)return[];const e=[];for(const[t,a]of E.value.items)e.push({id:t,name:a.name,type:'item'});for(const[t,a]of E.value.storages)e.push({id:t,name:a.name,type:'storage'});return e}),m=e=>{if(!E.value)return'';const t=E.value.items.get(e);if(t)return t.name;const a=E.value.storages.get(e);return a?a.name:''},g=e=>E.value?.storages.has(e)||!1,v=e=>{const t=E.value?.storages.get(e);return t?.inventory.size||0},b=e=>{const t=E.value?.storages.get(e);return t?.inventory||new Map},f=e=>{if(!E.value)return'';const t=E.value.items.get(e);if(t)return t.description;const a=E.value.storages.get(e);return a?a.description:''},h=()=>{o.value?.&&(o.value.['']='')},x=()=>{o.value?.&&(o.value.['']=1)},E=(0,t.ref)(null),y=()=>{try{const e=getLastMessageId();E.value=Yr.loadFromVariable(e)}catch(e){console.error('Failed to load state:',e),E.value=null}};y();const k=(0,t.computed)(()=>E.value?.getCharacter('c1')||null),N=()=>{k.value&&(o.value=e(k.value.toRecord()),o.value.=Object.fromEntries(k.value.relations),o.value.=Object.fromEntries(k.value.inventory),o.value.={month:k.value.birthday.month,date:k.value.birthday.date},r.value=!0)},V=()=>{r.value=!1,o.value=null},w=()=>{if(E.value&&o.value){if(o.value.&&o.value..month&&o.value..date){const e=new Date,t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate(),r=o.value..month,l=o.value..date;let i=t-(o.value.||0);(r>a||r===a&&l>n)&&(i-=1),o.value.=new Date(i,o.value..month-1,o.value..date).toString()}if(o.value.){const e={};for(const[t,a]of Object.entries(o.value.))t&&a&&'string'==typeof a&&''!==a.trim()&&(e[t]=a);o.value.=e}if(o.value.){const e={};for(const[t,a]of Object.entries(o.value.))if(t&&a&&'number'==typeof a&&a>0){const n=g(t)?1:a;e[t]=n}o.value.=e}E.value.active_characters.set('c1',Br.fromRecord(o.value)),E.value.saveAsVariable(getLastMessageId()),y()}r.value=!1,o.value=null};n({handleTabClick:()=>{r.value&&V()}});return(0,t.onMounted)(()=>{(0,t.nextTick)(()=>{(()=>{if('undefined'==typeof ResizeObserver)return void(l.value=74);i.value=new ResizeObserver(e=>{for(const t of e){const e=t.target;e.classList.contains('tab-navigation')&&(l.value=e.offsetHeight)}});const e=document.querySelector('.tab-navigation.top');e&&(i.value.observe(e),l.value=e.offsetHeight)})()})}),(0,t.onUnmounted)(()=>{i.value&&(i.value.disconnect(),i.value=null)}),(e,a)=>{return(0,t.openBlock)(),(0,t.createElementBlock)('div',mb,[(0,t.createElementVNode)('div',gb,[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',vb,[(0,t.createElementVNode)('h1',bb,(0,t.toDisplayString)(k.value?.name||'N/A'),1),r.value?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:0,class:'edit-button',onClick:N},''))]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',fb,[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',hb,[a[19]||(a[19]=(0,t.createElementVNode)('span',{class:'attribute-label'},'ID',-1)),(0,t.createElementVNode)('span',xb,(0,t.toDisplayString)(k.value?'c1':'N/A'),1)]),(0,t.createElementVNode)('div',_b,[a[20]||(a[20]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[0]||(a[0]=e=>o.value.=e),class:'attribute-input'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Eb,(0,t.toDisplayString)(k.value?.gender||'N/A'),1))]),(0,t.createElementVNode)('div',yb,[a[21]||(a[21]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[1]||(a[1]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',kb,(0,t.toDisplayString)(k.value?.age||'N/A'),1))]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Nb,[a[22]||(a[22]=(0,t.createElementVNode)('span',{class:'attribute-label unit-label'},' (cm)',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[2]||(a[2]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Vb,(0,t.toDisplayString)(k.value?.height||'N/A'),1))]),(0,t.createElementVNode)('div',wb,[a[23]||(a[23]=(0,t.createElementVNode)('span',{class:'attribute-label unit-label'},' (kg)',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[3]||(a[3]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Sb,(0,t.toDisplayString)(k.value?.weight||'N/A'),1))]),(0,t.createElementVNode)('div',Cb,[a[24]||(a[24]=(0,t.createElementVNode)('span',{class:'attribute-label unit-label'},' (cm)',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[4]||(a[4]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Tb,(0,t.toDisplayString)(k.value?.chest_size||'N/A'),1))]),(0,t.createElementVNode)('div',Bb,[a[25]||(a[25]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[5]||(a[5]=e=>o.value.=e),class:'attribute-input'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Ib,(0,t.toDisplayString)(k.value?.cup_size||''),1))]),(0,t.createElementVNode)('div',$b,[a[26]||(a[26]=(0,t.createElementVNode)('span',{class:'attribute-label unit-label'},' (cm)',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[6]||(a[6]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Db,(0,t.toDisplayString)(k.value?.waist_size||'N/A'),1))]),(0,t.createElementVNode)('div',Rb,[a[27]||(a[27]=(0,t.createElementVNode)('span',{class:'attribute-label unit-label'},' (cm)',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[7]||(a[7]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Mb,(0,t.toDisplayString)(k.value?.hips_size||'N/A'),1))]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Yb,[a[28]||(a[28]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':a[8]||(a[8]=e=>o.value.=e),class:'attribute-input',type:'number'},null,512)),[[t.vModelText,o.value.,void 0,{number:!0}]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Ab,(0,t.toDisplayString)((l=k.value?.money,void 0===l?'N/A':`$${l.toLocaleString()}`)),1))]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',zb,[a[31]||(a[31]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),r.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Kb,[(0,t.createElementVNode)('div',Lb,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[9]||(a[9]=e=>o.value..month=e),class:'attribute-input birthday-month',type:'number',placeholder:'',min:'1',max:'12'},null,512),[[t.vModelText,o.value..month,void 0,{number:!0}]]),a[29]||(a[29]=(0,t.createElementVNode)('span',{class:'birthday-separator'},'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[10]||(a[10]=e=>o.value..date=e),class:'attribute-input birthday-date',type:'number',placeholder:'',min:'1',max:'31'},null,512),[[t.vModelText,o.value..date,void 0,{number:!0}]]),a[30]||(a[30]=(0,t.createElementVNode)('span',{class:'birthday-separator'},'',-1))])])):((0,t.openBlock)(),(0,t.createElementBlock)('span',Ob,(0,t.toDisplayString)((n=k.value?.birthday,n?`${n.month}${n.date}`:'N/A')),1))]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',Ub,[a[32]||(a[32]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[11]||(a[11]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Fb,(0,t.toDisplayString)(k.value?.identity||'N/A'),1))]),(0,t.createElementVNode)('div',Pb,[a[33]||(a[33]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[12]||(a[12]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',jb,(0,t.toDisplayString)(k.value?.hairstyle||'N/A'),1))]),(0,t.createElementVNode)('div',Hb,[a[34]||(a[34]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[13]||(a[13]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Gb,(0,t.toDisplayString)(k.value?.appearance||'N/A'),1))]),(0,t.createElementVNode)('div',qb,[a[35]||(a[35]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[14]||(a[14]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Xb,(0,t.toDisplayString)(k.value?.clothes||'N/A'),1))]),(0,t.createElementVNode)('div',Wb,[a[36]||(a[36]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[15]||(a[15]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Jb,(0,t.toDisplayString)(k.value?.favourite||'N/A'),1))]),(0,t.createElementVNode)('div',Zb,[a[37]||(a[37]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[16]||(a[16]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',Qb,(0,t.toDisplayString)(k.value?.introduction||'N/A'),1))]),(0,t.createElementVNode)('div',ef,[a[38]||(a[38]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[17]||(a[17]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',tf,(0,t.toDisplayString)(k.value?.personality||'N/A'),1))]),k.value?.extra_information||r.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',af,[a[39]||(a[39]=(0,t.createElementVNode)('span',{class:'attribute-label'},'',-1)),r.value?(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('textarea',{key:1,'onUpdate:modelValue':a[18]||(a[18]=e=>o.value.=e),class:'attribute-textarea'},null,512)),[[t.vModelText,o.value.]]):((0,t.openBlock)(),(0,t.createElementBlock)('span',nf,(0,t.toDisplayString)(k.value?.extra_information||'N/A'),1))])):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',rf,[a[43]||(a[43]=(0,t.createElementVNode)('h3',{class:'section-title'},'',-1)),r.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',df,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(c.value,(_,e)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'relation-edit-item'},[(0,t.createElementVNode)('select',{value:e,class:'relation-select',onChange:t=>((e,t)=>{if(o.value?.&&e!==t){const a=o.value.[e];delete o.value.[e],t&&(o.value.[t]=a)}})(String(e),t.target.value)},[a[41]||(a[41]=(0,t.createElementVNode)('option',{value:'',disabled:''},'',-1)),((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(u.value,e=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e.id,value:e.id},(0,t.toDisplayString)(e.name)+' ('+(0,t.toDisplayString)(e.id)+') ',9,pf))),128))],40,uf),a[42]||(a[42]=(0,t.createElementVNode)('span',{class:'relation-edit-connector'},'  ',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>c.value[e]=t,class:'relation-input',placeholder:''},null,8,mf),[[t.vModelText,c.value[e]]]),(0,t.createElementVNode)('button',{class:'relation-remove-btn',onClick:t=>(e=>{o.value?.&&delete o.value.[e]})(String(e))},'',8,gf)]))),128)),(0,t.createElementVNode)('button',{class:'add-relation-btn',onClick:h},'+ ')])):((0,t.openBlock)(),(0,t.createElementBlock)('div',of,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(k.value?.relations||[],([e,n])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'relation-item'},[(0,t.createElementVNode)('span',lf,(0,t.toDisplayString)(E.value?.getCharacter(e)?.name||'')+' ('+(0,t.toDisplayString)(e)+')',1),a[40]||(a[40]=(0,t.createElementVNode)('span',{class:'relation-connector'},'  ',-1)),(0,t.createElementVNode)('span',sf,(0,t.toDisplayString)(n),1)]))),128)),k.value?.relations&&0!==k.value.relations.size?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('div',cf,'  '))]))]),(0,t.createElementVNode)('div',vf,[a[45]||(a[45]=(0,t.createElementVNode)('h3',{class:'section-title'},'',-1)),r.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',wf,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(d.value,(_,e)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:'inventory-edit-item'},[(0,t.createElementVNode)('select',{value:e,class:'inventory-select',onChange:t=>((e,t)=>{if(o.value?.&&e!==t){const a=o.value.[e];delete o.value.[e],t&&(o.value.[t]=a)}})(String(e),t.target.value)},[a[44]||(a[44]=(0,t.createElementVNode)('option',{value:'',disabled:''},'...',-1)),(0,t.createElementVNode)('optgroup',Cf,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(p.value.filter(e=>'item'===e.type),e=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e.id,value:e.id},(0,t.toDisplayString)(e.name)+' ('+(0,t.toDisplayString)(e.id)+') ',9,Tf))),128))]),(0,t.createElementVNode)('optgroup',Bf,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(p.value.filter(e=>'storage'===e.type),e=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e.id,value:e.id},(0,t.toDisplayString)(e.name)+' ('+(0,t.toDisplayString)(e.id)+') ',9,If))),128))])],40,Sf),g(String(e))?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('span',$f,'')),g(String(e))?(0,t.createCommentVNode)('v-if',!0):(0,t.withDirectives)(((0,t.openBlock)(),(0,t.createElementBlock)('input',{key:1,'onUpdate:modelValue':t=>d.value[e]=t,class:'inventory-quantity-input',type:'number',min:'0',placeholder:''},null,8,Df)),[[t.vModelText,d.value[e],void 0,{number:!0}]]),(0,t.createElementVNode)('button',{class:'inventory-remove-btn',onClick:t=>(e=>{o.value?.&&delete o.value.[e]})(String(e))},'',8,Rf)]))),128)),(0,t.createElementVNode)('button',{class:'add-inventory-btn',onClick:x},'+ ')])):((0,t.openBlock)(),(0,t.createElementBlock)('div',bf,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(k.value?.inventory||[],([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e,class:(0,t.normalizeClass)(['inventory-item',{'storage-item':g(e)}])},[(0,t.createElementVNode)('div',ff,[(0,t.createElementVNode)('span',hf,(0,t.toDisplayString)(m(e))+' ('+(0,t.toDisplayString)(e)+')',1),g(e)?((0,t.openBlock)(),(0,t.createElementBlock)('span',_f,'')):((0,t.openBlock)(),(0,t.createElementBlock)('span',xf,' '+(0,t.toDisplayString)(a),1))]),(0,t.createElementVNode)('div',Ef,(0,t.toDisplayString)(f(e)),1),g(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',yf,[0===v(e)?((0,t.openBlock)(),(0,t.createElementBlock)('div',kf,'')):((0,t.openBlock)(),(0,t.createElementBlock)('div',Nf,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(b(e),([e,a])=>((0,t.openBlock)(),(0,t.createElementBlock)('span',{key:e,class:(0,t.normalizeClass)(E.value?.storages.has(e)?'storage-item-tag':'inventory-item-tag')},(0,t.toDisplayString)(m(e))+' ('+(0,t.toDisplayString)(e)+')'+(0,t.toDisplayString)(E.value?.storages.has(e)?'':`  ${a}`),3))),128))]))])):(0,t.createCommentVNode)('v-if',!0)],2))),128)),k.value?.inventory&&0!==k.value.inventory.size?(0,t.createCommentVNode)('v-if',!0):((0,t.openBlock)(),(0,t.createElementBlock)('div',Vf,'  '))]))]),(0,t.createCommentVNode)('  '),r.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Mf,[(0,t.createElementVNode)('button',{class:'confirm-button',onClick:w},''),(0,t.createElementVNode)('button',{class:'cancel-button',onClick:V},'')])):(0,t.createCommentVNode)('v-if',!0)],512)]);var n,l}}});n(4727);const Af=(0,c.A)(Yf,[['__scopeId','data-v-ada46c14']]),zf={class:'world-info-container'},Of={class:'world-info-content'},Kf={class:'section'},Lf={class:'sortable-container'},Uf={key:0,class:'drop-indicator'},Ff=['data-id','onDragstart','onDragover','onDrop'],Pf=['onClick'],jf={class:'fold-content'},Hf={class:'input-group'},Gf=['onUpdate:modelValue'],qf={class:'input-group'},Xf=['onUpdate:modelValue'],Wf={class:'input-group'},Jf=['onUpdate:modelValue'],Zf={key:0,class:'generated-result'},Qf={class:'generated-text'},eh=['onClick'],th={class:'item-actions'},ah=['disabled','onClick'],nh={key:0,class:'loading-spinner'},rh=['disabled','onClick'],oh={key:0,class:'drop-indicator'},lh=(0,t.defineComponent)({__name:'world_info_tab',setup(e){(0,t.useCssVars)(e=>({ae590e90:(0,t.unref)(r)}));const a=(0,t.ref)(0),n=(0,t.ref)(null),r=(0,t.computed)(()=>`calc(100vh - ${a.value}px)`);(0,t.onMounted)(()=>{g(),f(),(async()=>{await(0,t.nextTick)();const e=document.querySelector('.tab-navigation');e&&window.ResizeObserver?(n.value=new ResizeObserver(e=>{for(const t of e)a.value=t.contentRect.height}),n.value.observe(e)):a.value=74})()}),(0,t.onUnmounted)(()=>{n.value&&(n.value.disconnect(),n.value=null)});const o=(0,t.ref)([]),l=(0,t.ref)(new Map),i=(0,t.computed)(()=>{try{const e=getVariables({type:'chat'});return!!e?.world_info?.trim()}catch{return!1}}),s=(0,t.ref)(null),c=(0,t.ref)(null),u=e=>{const t=o.value[e];if(t&&t.generated_content){t.content=t.generated_content,t.generated_content='',o.value[e]={...t};try{t.name&&t.name.trim()&&localStorage.removeItem(`world_info_item_generated_${t.name.trim()}`)}catch(e){console.error(`Failed to remove generated world info item for ${t.name} from localStorage:`,e)}}},p=()=>{const e={id:Date.now().toString(),name:'',content:'',generation_requirement:'',is_open:!1,generated_content:''};o.value.push(e)},m=()=>{try{const e=getVariables({type:'chat'}),t=o.value.map(e=>({name:e.name,content:e.content}));e.extra_world_info=t,replaceVariables(e,{type:'chat'}),(()=>{const e=getVariables({type:'chat'});let t='';for(const a of Array.from(e.extra_world_info))''!==a.name.trim()&&''!==a.content.trim()&&(t+=`<${a.name}>\n`,t+=`${a.content}\n`,t+=`</${a.name}>\n`,t+='\n');e.extra_world_info_prompt=t,replaceVariables(e,{type:'chat'})})()}catch(e){console.error(' extra_world_info :',e)}},g=()=>{try{const e=getVariables({type:'chat'});if(e?.extra_world_info&&Array.isArray(e.extra_world_info)){const t=e.extra_world_info.map((e,t)=>({id:`loaded_${t}_${Date.now()}`,name:e.name||'',content:e.content||'',generation_requirement:'',is_open:!1,generated_content:''}));o.value=t}}catch(e){console.error(' extra_world_info :',e)}},v=()=>{c.value=null},b=()=>{s.value=null,c.value=null},f=()=>{try{const e=localStorage.getItem('world_info_tab_generation_requirements');if(e){const t=JSON.parse(e);o.value.forEach(e=>{e.name&&e.name.trim()&&t[e.name.trim()]&&(e.generation_requirement=t[e.name.trim()])})}o.value.forEach(e=>{if(e.name&&e.name.trim()){const t=localStorage.getItem(`world_info_item_generated_${e.name.trim()}`);if(t)try{const a=JSON.parse(t);a[e.name.trim()]&&(e.generated_content=a[e.name.trim()])}catch(t){console.error(`Failed to parse generated content for ${e.name}:`,t)}}})}catch(e){console.error(' localStorage :',e)}};(0,t.watch)(o,()=>{m(),(()=>{try{const e={};o.value.forEach(t=>{t.name&&t.name.trim()&&(e[t.name.trim()]=t.generation_requirement)}),localStorage.setItem('world_info_tab_generation_requirements',JSON.stringify(e))}catch(e){console.error(' localStorage :',e)}})()},{deep:!0}),(0,t.watch)(()=>getVariables({type:'chat'}),e=>{e?.extra_world_info&&g()},{deep:!0});const h=e=>{let t='\n\n';return t+=`${e.name||''}\n`,t+=`${e.content||''}\n`,t},x=()=>{const e=getVariables({type:'chat'}).world_info;let t=getCharData('current').description;t=t.replace('{{getvar::world_info}}',e);let a='\n';return a+='\n',a+='<>\n','\n\n<>\n'},E=e=>{let t='\n</>\n';return t+='\n',t+=`${(()=>{const e=getVariables({type:'chat'}).characters.c1,t=`${e.}${e.}`;let a=`<${t}Status>\n`;return a+='idc1\n',a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${e.||''}\n`,a+=`  ${y(e.)}\n`,a+=`  ${y(e.)}\n`,a+=`  ${y(e.)}\n`,a+=`</${t}Status>`,a})()}\n`,t+='\n',t+=`${(()=>{const e=getVariables({type:'chat'}).characters;if(void 0===e)return'';let t='<CharacterStatus>\n';for(const[a,n]of Object.entries(e))'c1'!==a&&(t+=`id${a}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${n.||''}\n`,t+=`  ${y(n.)}\n`,t+=`  ${y(n.)}\n`,t+=`  ${y(n.)}\n\n`);return t+='</CharacterStatus>',t})()}\n`,t+='\n',t+=`${(()=>{let e='<ItemTable>\n';e+='|id||||\n',e+='|---|---|---|---|\n';const t=getVariables({type:'chat'}).items;if(void 0===t)return'';for(const[a,n]of Object.entries(t))e+=`|${a}|${n.name}|${n.description}|${n.value}|\n`;return e+='</ItemTable>',e})()}\n`,t+='\n',t+=`${(()=>{let e='<LocationTable>\n';e+='|id|||||\n',e+='|---|---|---|---|---|\n';const t=getVariables({type:'chat'}).locations;if(void 0===t)return'';for(const[a,n]of Object.entries(t)){const t=n.sub_location?n.sub_location.join(', '):'';e+=`|${a}|${n.name}|${n.location||''}|${n.description}|${t}|\n`}return e+='</LocationTable>',e})()}\n`,t+='\n',t+=`${(()=>{let e='';const t=getVariables({type:'chat'}).extra_world_info;if(void 0===t)return'';for(const a of Array.from(t))''!==a.name&&''!==a.content&&(e+=`<${a.name}>\n`,e+=`${a.content}\n`,e+=`</${a.name}>\n`,e+='\n');return e})()}\n`,t+='\n',t+='<>\n',t+=`${e.generation_requirement||''}\n`,t+='</>\n',t},y=e=>'['+Object.entries(e).map(([e,t])=>'string'==typeof t?`'${e}':'${t}'`:`'${e}':${t}`).join(', ')+']',k=(e,t)=>{t.generated_content=e};return(e,a)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',zf,[(0,t.createElementVNode)('div',Of,[a[5]||(a[5]=(0,t.createElementVNode)('h3',null,'',-1)),(0,t.createElementVNode)('div',Kf,[(0,t.createElementVNode)('div',Lf,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(o.value,(e,n)=>((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,{key:e.id},[c.value===n&&null!==s.value&&s.value!==n?((0,t.openBlock)(),(0,t.createElementBlock)('div',Uf)):(0,t.createCommentVNode)('v-if',!0),(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['sortable-item',{dragging:s.value===n}]),'data-id':e.id,draggable:'true',onDragstart:e=>((e,t)=>{s.value=t,e.dataTransfer&&(e.dataTransfer.effectAllowed='move')})(e,n),onDragover:(0,t.withModifiers)(e=>((e,t)=>{e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect='move');const a=e.target.getBoundingClientRect(),n=e.clientY-a.top,r=a.height;c.value=n<r/2?t:t+1})(e,n),['prevent']),onDrop:e=>((e,t)=>{e.preventDefault();const a=s.value;if(null!==a&&a!==t){const e=[...o.value],[n]=e.splice(a,1);e.splice(t,0,n),o.value=e}s.value=null})(e,n),onDragend:b,onDragleave:v},[(0,t.createVNode)(d,{title:e.name||'','is-open':e.is_open,class:(0,t.normalizeClass)(['draggable-fold-bar',{incomplete:!e.name||!e.content}]),onToggle:e=>(e=>{o.value[e].is_open=!o.value[e].is_open})(n)},{'title-actions':(0,t.withCtx)(()=>[(0,t.createElementVNode)('button',{class:'remove-btn',title:'',onClick:(0,t.withModifiers)(e=>(e=>{o.value.splice(e,1)})(n),['stop'])},[...a[0]||(a[0]=[(0,t.createElementVNode)('span',null,'',-1)])],8,Pf)]),default:(0,t.withCtx)(()=>[(0,t.createElementVNode)('div',jf,[(0,t.createElementVNode)('div',Hf,[a[1]||(a[1]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':t=>e.name=t,type:'text',class:'form-input',placeholder:''},null,8,Gf),[[t.vModelText,e.name]])]),(0,t.createElementVNode)('div',qf,[a[2]||(a[2]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':t=>e.content=t,class:'form-textarea',placeholder:'',rows:'3'},null,8,Xf),[[t.vModelText,e.content]])]),(0,t.createElementVNode)('div',Wf,[a[3]||(a[3]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':t=>e.generation_requirement=t,class:'form-textarea',placeholder:'',rows:'2'},null,8,Jf),[[t.vModelText,e.generation_requirement]])]),e.generated_content?((0,t.openBlock)(),(0,t.createElementBlock)('div',Zf,[a[4]||(a[4]=(0,t.createElementVNode)('label',null,'',-1)),(0,t.createElementVNode)('div',Qf,(0,t.toDisplayString)(e.generated_content),1),(0,t.createElementVNode)('button',{class:'replace-btn',onClick:e=>u(n)},'',8,eh)])):(0,t.createCommentVNode)('v-if',!0),(0,t.createElementVNode)('div',th,[(0,t.createElementVNode)('button',{class:'action-btn generate',disabled:!(0,t.unref)(i)||l.value.get(e.id),onClick:e=>(async e=>{const t=o.value[e];if(t){l.value.set(t.id,!0);try{const a=h(t),n=x(),r=E(t),l=await generateRaw({user_input:a,ordered_prompts:[{role:'system',content:n},'char_description',{role:'system',content:r},'user_input']});k(l,t);try{if(t.name&&t.name.trim()){const e={};e[t.name.trim()]=t.generated_content||'',localStorage.setItem(`world_info_item_generated_${t.name.trim()}`,JSON.stringify(e))}}catch(e){console.error(`Failed to save generated world info item for ${t.name} to localStorage:`,e)}o.value[e]={...t}}catch(e){console.error(` ${t.name} :`,e)}finally{l.value.set(t.id,!1)}}})(n)},[l.value.get(e.id)?((0,t.openBlock)(),(0,t.createElementBlock)('span',nh)):(0,t.createCommentVNode)('v-if',!0),(0,t.createTextVNode)(' '+(0,t.toDisplayString)(l.value.get(e.id)?'...':(0,t.unref)(i)?'':''),1)],8,ah),(0,t.createElementVNode)('button',{class:'action-btn apply',disabled:!e.generated_content,onClick:e=>u(n)},'  ',8,rh)])])]),_:2},1032,['title','is-open','class','onToggle'])],42,Ff)],64))),128)),c.value===o.value.length&&null!==s.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',oh)):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('div',{class:'add-item-section'},[(0,t.createElementVNode)('button',{class:'add-btn',onClick:p},'+ ')])])])]))}});n(8871);const ih=(0,c.A)(lh,[['__scopeId','data-v-ee3aed0a']]),sh={class:'main-interface-container'},ch={class:'tab-navigation top'},dh={class:'time-row'},uh={class:'current-time'},ph={class:'tab-row'},mh={class:'tab-row'},gh={key:'conversation',class:'conversation-area'},vh={key:'user',class:'user-area'},bh={key:'character',class:'character-area'},fh={key:'item',class:'item-area'},hh={key:'storage',class:'storage-area'},xh={key:'location',class:'location-area'},_h={key:'promise',class:'promise-area'},Eh={key:'summary',class:'summary-area'},yh={key:'world_info',class:'world-info-area'},kh={key:'settings',class:'settings-area'},Nh=(0,t.defineComponent)({__name:'main_interface',setup(e){const a=(0,t.ref)('conversation'),n=(0,t.ref)(null),r=(0,t.ref)(null),o=(0,t.ref)(null),l=(0,t.ref)(0),i=(0,t.ref)(''),s=['conversation','user','character','item','storage','location','promise','summary','world_info','settings'],c=(0,t.ref)(0),d=(0,t.ref)(0),u=(0,t.ref)(0),p=(0,t.ref)(!1),m=(0,t.ref)(!1),g=(0,t.ref)('right'),v=()=>{const e=new Date,t=e.getHours().toString().padStart(2,'0'),a=e.getMinutes().toString().padStart(2,'0');i.value=`${t}:${a}`};let b=null;(0,t.onMounted)(()=>{v(),b=window.setInterval(v,6e4)}),(0,t.onUnmounted)(()=>{null!==b&&clearInterval(b)});const f=(e,t=!1)=>{e!==a.value?(m.value=t,'conversation'===a.value&&n.value&&(l.value=n.value.getScrollPosition()),a.value=e,'conversation'===e&&setTimeout(()=>{n.value&&n.value.setScrollPosition(l.value)},0)):'character'===e&&r.value?r.value.handleTabClick():'user'===e&&o.value&&o.value.handleTabClick()},h=e=>{const t=s.indexOf(e);return-1===t||t===s.length-1?e:s[t+1]},x=e=>{const t=s.indexOf(e);return-1===t||0===t?e:s[t-1]},E=e=>{n.value&&n.value.handleRenderSizeChanged&&n.value.handleRenderSizeChanged(e)},y=e=>{const t=e.touches[0];c.value=t.clientX,d.value=t.clientY,u.value=Date.now()},k=e=>{},N=e=>{const t=e.changedTouches[0],n=t.clientX-c.value,r=t.clientY-d.value,o=Date.now()-u.value;if(Math.abs(n)>20&&o<1e3&&Math.abs(n)>Math.abs(r))if(n<0){g.value='left';const e=h(a.value);f(e,!0)}else{g.value='right';const e=x(a.value);f(e,!0)}},V=e=>{p.value=!0,c.value=e.clientX,d.value=e.clientY,u.value=Date.now()},w=e=>{},S=e=>{if(!p.value)return;p.value=!1;const t=e.clientX-c.value,n=e.clientY-d.value,r=Date.now()-u.value;if(Math.abs(t)>20&&r<1e3&&Math.abs(t)>Math.abs(n))if(t<0){g.value='left';const e=h(a.value);f(e,!0)}else{g.value='right';const e=x(a.value);f(e,!0)}};return(e,l)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',sh,[(0,t.createElementVNode)('div',ch,[(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',dh,[(0,t.createElementVNode)('div',uh,(0,t.toDisplayString)(i.value),1)]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',ph,[(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'conversation'===a.value}]),onClick:l[0]||(l[0]=e=>f('conversation'))},'  ',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'user'===a.value}]),onClick:l[1]||(l[1]=e=>f('user'))},'',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'character'===a.value}]),onClick:l[2]||(l[2]=e=>f('character'))},'  ',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'item'===a.value}]),onClick:l[3]||(l[3]=e=>f('item'))},'',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'storage'===a.value}]),onClick:l[4]||(l[4]=e=>f('storage'))},'',2)]),(0,t.createCommentVNode)('  '),(0,t.createElementVNode)('div',mh,[(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'location'===a.value}]),onClick:l[5]||(l[5]=e=>f('location'))},'  ',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'promise'===a.value}]),onClick:l[6]||(l[6]=e=>f('promise'))},'  ',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'summary'===a.value}]),onClick:l[7]||(l[7]=e=>f('summary'))},'  ',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'world_info'===a.value}]),onClick:l[8]||(l[8]=e=>f('world_info'))},'  ',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['tab-button',{active:'settings'===a.value}]),onClick:l[9]||(l[9]=e=>f('settings'))},'  ',2)])]),(0,t.createElementVNode)('div',{class:'main-content',onTouchstart:y,onTouchmove:k,onTouchend:N,onMousedown:V,onMousemove:w,onMouseup:S},[(0,t.createVNode)(t.Transition,{name:m.value?`slide-${g.value}`:'no-transition',mode:'out-in'},{default:(0,t.withCtx)(()=>['conversation'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',gh,[(0,t.createVNode)(Kd,{ref_key:'conversation_tab_ref',ref:n},null,512)])):'user'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',vh,[(0,t.createVNode)(Af,{ref_key:'user_tab_ref',ref:o},null,512)])):'character'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',bh,[(0,t.createVNode)(sd,{ref_key:'character_tab_ref',ref:r},null,512)])):'item'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',fh,[(0,t.createVNode)(gu)])):'storage'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',hh,[(0,t.createVNode)(Km)])):'location'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',xh,[(0,t.createVNode)(xp)])):'promise'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',_h,[(0,t.createVNode)(Dg)])):'summary'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Eh,[(0,t.createVNode)(pb)])):'world_info'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',yh,[(0,t.createVNode)(ih)])):'settings'===a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',kh,[(0,t.createVNode)(vv,{onRenderSizeChanged:E})])):(0,t.createCommentVNode)('v-if',!0)]),_:1},8,['name'])],32)]))}});n(1458);const Vh=(0,c.A)(Nh,[['__scopeId','data-v-9fb68f82']]),wh={key:0,class:'initialization-wrapper'},Sh=(0,t.defineComponent)({__name:'app',setup(e){const a=(0,t.ref)(!1),n=(0,t.ref)(!1),r=(0,t.ref)('100vh'),o=()=>{if(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)r.value='100vh';else try{window.parent&&window.parent.innerHeight&&(r.value=.8*window.parent.innerHeight+'px')}catch(e){console.warn('Unable to access parent window height:',e)}},l=()=>{o()},i=()=>{try{const e=getVariables({type:'chat'});void 0===e?.is_initialized?(n.value=!1,insertOrAssignVariables({is_initialized:!1},{type:'chat'})):n.value=e.is_initialized}catch(e){console.error('Failed to load chat settings:',e)}};return(0,t.onMounted)(()=>{a.value=!0,i(),eventOn(tavern_events.CHAT_CHANGED,e=>{console.log('Chat changed to:',e),i()}),eventOn('initialization_completed',()=>{console.log('Initialization completed, switching to main interface'),n.value=!0}),(0,t.watch)(()=>getVariables({type:'chat'}),e=>{void 0!==e?.is_initialized&&(n.value=e.is_initialized)},{deep:!0}),o(),document.addEventListener('fullscreenchange',l),document.addEventListener('webkitfullscreenchange',l),document.addEventListener('mozfullscreenchange',l),document.addEventListener('MSFullscreenChange',l)}),(0,t.onUnmounted)(()=>{document.removeEventListener('fullscreenchange',l),document.removeEventListener('webkitfullscreenchange',l),document.removeEventListener('mozfullscreenchange',l),document.removeEventListener('MSFullscreenChange',l)}),(e,o)=>a.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:0,class:'app-container',style:(0,t.normalizeStyle)({height:r.value})},[(0,t.createCommentVNode)(' UI '),n.value?((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,{key:1},[(0,t.createCommentVNode)(' UI '),(0,t.createElementVNode)('div',null,[(0,t.createVNode)(Vh)])],2112)):((0,t.openBlock)(),(0,t.createElementBlock)('div',wh,[(0,t.createVNode)(Fi)]))],4)):(0,t.createCommentVNode)('v-if',!0)}});n(3801),n(4055);const Ch=(0,c.A)(Sh,[['__scopeId','data-v-e8f6a8aa']]);var Th,Bh,Ih,$h,Dh,Rh,Mh,Yh,Ah,zh,Oh,Kh,Lh,Uh,Fh,Ph,jh,Hh,Gh,qh,Xh,Wh,Jh,Zh,Qh,ex=n(3146),tx=function(e,t,a,n){var r,o=arguments.length,l=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(o<3?r(l):o>3?r(t,a,l):r(t,a))||l);return o>3&&l&&Object.defineProperty(t,a,l),l},ax=function(e,t){if('object'==typeof Reflect&&'function'==typeof Reflect.metadata)return Reflect.metadata(e,t)};class nx{static registry=new ex._;constructor(...e){}static parseString(e){if(void 0===e)return[];return[...e.matchAll(this.prototype.REGEX)].map(e=>({command:this.prototype.create(e.slice(1).map(e=>e.trim())),index:e.index})).filter(({command:e})=>e.isValid())}}let rx=Th=class extends nx{delta_minutes;constructor(e){super(),this.delta_minutes=e}get REGEX(){return/deltaMinutes\(\s*([^,()]+)\s*\)/g}create(e){const t=Number(e[0]);return new Th(t)}isValid(){return!isNaN(this.delta_minutes)}execute(e,t){return e.datetime.deltaMinutes(this.delta_minutes),e}};rx=Th=tx([nx.registry.register(),ax('design:paramtypes',[Number])],rx);let ox=Bh=class extends nx{current_location_id;constructor(e){super(),this.current_location_id=e}get REGEX(){return/setCurrentLocation\(\s*"([^"]+?)"\s*\s*\)/g}create(e){const t=e[0];return new Bh(t)}isValid(){return!0}execute(e,t){return e.locations.has(this.current_location_id)?(e.current_location_id=this.current_location_id,e):e}};ox=Bh=tx([nx.registry.register(),ax('design:paramtypes',[String])],ox);let lx=Ih=class extends nx{weather;constructor(e){super(),this.weather=e}get REGEX(){return/setWeather\(\s*"([^"]+?)"\s*\s*\)/g}create(e){const t=e[0];return new Ih(t)}isValid(){return!0}execute(e,t){return e.weather=this.weather,e}};lx=Ih=tx([nx.registry.register(),ax('design:paramtypes',[String])],lx);let ix=$h=class extends nx{id;name;age;gender;identity;introduction;personality;height;weight;chest_size;cup_size;waist_size;hips_size;hairstyle;appearance;clothes;birthday_month;birthday_date;favourite;extra_information;money;mood;horny;constructor(e,t,a,n,r,o,l,i,s,c,d,u,p,m,g,v,b,f,h,x,E,y,k){super(),this.id=e,this.name=t,this.age=a,this.gender=n,this.identity=r,this.introduction=o,this.personality=l,this.height=i,this.weight=s,this.chest_size=c,this.cup_size=d,this.waist_size=u,this.hips_size=p,this.hairstyle=m,this.appearance=g,this.clothes=v,this.birthday_month=b,this.birthday_date=f,this.favourite=h,this.extra_information=x,this.money=E,this.mood=y,this.horny=k}get REGEX(){return/createCharacter\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^"]+?)\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^"]+?)\s*,\s*([^"]+?)\s*,\s*([^"]+?)\s*,\s*"([^"]+?)"\s*,\s*([^"]+?)\s*,\s*([^"]+?)\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^"]+?)\s*,\s*([^"]+?)\s*,\s*"([^"]+?)"\s*,\s*"([^"]*?)"\s*,\s*([^"]+?)\s*,\s*([^"]+?)\s*,\s*([^"]+?)\s*\)/g}create(e){const t=e[0],a=e[1],n=Number(e[2]),r=e[3],o=e[4],l=e[5],i=e[6],s=Number(e[7]),c=Number(e[8]),d=Number(e[9]),u=e[10],p=Number(e[11]),m=Number(e[12]),g=e[13],v=e[14],b=e[15],f=Number(e[16]),h=Number(e[17]),x=e[18],E=e[19],y=Number(e[20]),k=Number(e[21]),N=Number(e[22]);return new $h(t,a,n,r,o,l,i,s,c,d,u,p,m,g,v,b,f,h,x,E,y,k,N)}isValid(){return!isNaN(this.age)&&(!isNaN(this.height)&&(!isNaN(this.weight)&&(!isNaN(this.chest_size)&&(!isNaN(this.waist_size)&&(!isNaN(this.hips_size)&&(!isNaN(this.birthday_month)&&(!isNaN(this.birthday_date)&&(!isNaN(this.money)&&(!isNaN(this.mood)&&!isNaN(this.horny))))))))))}execute(e,t){if(e.hasCharacter(this.id))return e;let a=e.datetime.year-this.age;(e.datetime.month<this.birthday_month||e.datetime.month===this.birthday_month&&e.datetime.date<this.birthday_date)&&(a-=1);const n=new Tr(new Date(a,this.birthday_month,this.birthday_date)),r=new Br(this.name,this.age,this.gender,this.identity,this.introduction,this.personality,this.height,this.weight,this.chest_size,this.cup_size,this.waist_size,this.hips_size,this.hairstyle,this.appearance,this.clothes,n,this.favourite,this.extra_information,this.money,this.mood,this.horny,new Map,new Map,new Map,new Map);return e.active_characters.set(this.id,r),e}};ix=$h=tx([nx.registry.register(),ax('design:paramtypes',[String,String,Number,String,String,String,String,Number,Number,Number,String,Number,Number,String,String,String,Number,Number,String,String,Number,Number,Number])],ix);let sx=Dh=class extends nx{id;delta;constructor(e,t){super(),this.id=e,this.delta=t}get REGEX(){return/deltaMoney\(\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=Number(e[1]);return new Dh(t,a)}isValid(){return!isNaN(this.delta)}execute(e,t){const a=e.getCharacter(this.id),n=e.storages.get(this.id);return a||n?(a?a.money+=this.delta:n.money+=this.delta,e):e}};sx=Dh=tx([nx.registry.register(),ax('design:paramtypes',[String,Number])],sx);let cx=Rh=class extends nx{from_id;to_id;delta;constructor(e,t,a){super(),this.from_id=e,this.to_id=t,this.delta=a}get REGEX(){return/deltaFriendship\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=e[1],n=Number(e[2]);return new Rh(t,a,n)}isValid(){return!isNaN(this.delta)}execute(e,t){if(!e.hasCharacter(this.from_id))return e;if(!e.hasCharacter(this.to_id))return e;const a=e.getCharacter(this.from_id);return a?(a.deltaFriendship(this.to_id,this.delta),e):e}};cx=Rh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,Number])],cx);let dx=Mh=class extends nx{from_id;to_id;delta;constructor(e,t,a){super(),this.from_id=e,this.to_id=t,this.delta=a}get REGEX(){return/deltaLove\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=e[1],n=Number(e[2]);return new Mh(t,a,n)}isValid(){return!isNaN(this.delta)}execute(e,t){if(!e.hasCharacter(this.from_id))return e;if(!e.hasCharacter(this.to_id))return e;const a=e.getCharacter(this.from_id);return a?(a.deltaLove(this.to_id,this.delta),e):e}};dx=Mh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,Number])],dx);let ux=Yh=class extends nx{id;delta;constructor(e,t){super(),this.id=e,this.delta=t}get REGEX(){return/deltaMood\(\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=Number(e[1]);return new Yh(t,a)}isValid(){return!isNaN(this.delta)}execute(e,t){const a=e.getCharacter(this.id);return a?(a.deltaMood(this.delta),e):e}};ux=Yh=tx([nx.registry.register(),ax('design:paramtypes',[String,Number])],ux);let px=Ah=class extends nx{id;delta;constructor(e,t){super(),this.id=e,this.delta=t}get REGEX(){return/deltaHorny\(\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=Number(e[1]);return new Ah(t,a)}isValid(){return!isNaN(this.delta)}execute(e,t){const a=e.getCharacter(this.id);return a?(a.deltaHorny(this.delta),e):e}};px=Ah=tx([nx.registry.register(),ax('design:paramtypes',[String,Number])],px);let mx=zh=class extends nx{from_id;to_id;relation;constructor(e,t,a){super(),this.from_id=e,this.to_id=t,this.relation=a}get REGEX(){return/setRelation\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1],n=e[2];return new zh(t,a,n)}isValid(){return!0}execute(e,t){if(!e.hasCharacter(this.from_id))return e;if(!e.hasCharacter(this.to_id))return e;const a=e.getCharacter(this.from_id);return a?(a.relations.set(this.to_id,this.relation),e):e}};mx=zh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,String])],mx);let gx=Oh=class extends nx{id;key;value;constructor(e,t,a){super(),this.id=e,this.key=t,this.value=a}get REGEX(){return/setCharacterProperty\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1],n=e[2];return new Oh(t,a,n)}isValid(){return[Br.IDENTITY_KEY,Br.INTRODUCTION_KEY,Br.PERSONALITY_KEY,Br.HAIRSTYLE_KEY,Br.APPEARANCE_KEY,Br.CLOTHES_KEY,Br.FAVOURITE_KEY,Br.EXTRA_INFORMATION_KEY].includes(this.key)}execute(e,t){const a=e.getCharacter(this.id);if(!a)return e;switch(this.key){case Br.IDENTITY_KEY:a.identity=this.value;break;case Br.INTRODUCTION_KEY:a.introduction=this.value;break;case Br.PERSONALITY_KEY:a.personality=this.value;break;case Br.HAIRSTYLE_KEY:a.hairstyle=this.value;break;case Br.APPEARANCE_KEY:a.appearance=this.value;break;case Br.CLOTHES_KEY:a.clothes=this.value;break;case Br.FAVOURITE_KEY:a.favourite=this.value;break;case Br.EXTRA_INFORMATION_KEY:a.extra_information=this.value}return e}};gx=Oh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,String])],gx);let vx=Kh=class extends nx{id;name;description;value;constructor(e,t,a,n){super(),this.id=e,this.name=t,this.description=a,this.value=n}get REGEX(){return/createItem\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=e[1],n=e[2],r=Number(e[3]);return new Kh(t,a,n,r)}isValid(){return!isNaN(this.value)}execute(e,t){if(e.items.has(this.id))return e;const a=new Ir(this.name,this.description,this.value);return e.items.set(this.id,a),e}};vx=Kh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,String,Number])],vx);let bx=Lh=class extends nx{id;item_id;delta;constructor(e,t,a){super(),this.id=e,this.item_id=t,this.delta=a}get REGEX(){return/deltaInventory\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=e[1],n=Number(e[2]);return new Lh(t,a,n)}isValid(){return!isNaN(this.delta)}execute(e,t){if(!e.items.has(this.item_id))return e;const a=e.getCharacter(this.id),n=e.storages.get(this.id);if(!a&&!n)return e;const r=a?a.inventory:n.inventory;let o=r.get(this.item_id)||0;return o+=this.delta,o<=0?r.delete(this.item_id):r.set(this.item_id,o),e}};bx=Lh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,Number])],bx);let fx=Uh=class extends nx{id;name;description;parent_id;constructor(e,t,a,n){super(),this.id=e,this.name=t,this.description=a,this.parent_id=n}get REGEX(){return/createStorage\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1],n=e[2],r=e[3];return new Uh(t,a,n,r)}isValid(){return''!==this.id.trim()&&(''!==this.name.trim()&&(''!==this.description.trim()&&''!==this.parent_id.trim()))}execute(e,t){return e.addStorage(this.id,this.name,this.description,this.parent_id),e}};fx=Uh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,String,String])],fx);let hx=Fh=class extends nx{id;constructor(e){super(),this.id=e}get REGEX(){return/removeStorage\(\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0];return new Fh(t)}isValid(){return''!==this.id.trim()}execute(e,t){return e.removeStorage(this.id),e}};hx=Fh=tx([nx.registry.register(),ax('design:paramtypes',[String])],hx);let xx=Ph=class extends nx{storage_id;parent_id;constructor(e,t){super(),this.storage_id=e,this.parent_id=t}get REGEX(){return/setStorageParent\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1];return new Ph(t,a)}isValid(){return''!==this.storage_id.trim()&&''!==this.parent_id.trim()}execute(e,t){return e.setStorageParent(this.storage_id,this.parent_id),e}};xx=Ph=tx([nx.registry.register(),ax('design:paramtypes',[String,String])],xx);let _x=jh=class extends nx{id;name;location;description;constructor(e,t,a,n){super(),this.id=e,this.name=t,this.location=a,this.description=n}get REGEX(){return/createLocation\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1],n=e[2],r=e[3];return new jh(t,a,n,r)}isValid(){return''!==this.id.trim()&&(''!==this.name.trim()&&(''!==this.location.trim()&&''!==this.description.trim()))}execute(e,t){if(e.locations.has(this.id))return e;const a=new $r(this.id,this.name,this.location,this.description,null,[],[]);return e.locations.set(this.id,a),e}};_x=jh=tx([nx.registry.register(),ax('design:paramtypes',[String,String,String,String])],_x);let Ex=Hh=class extends nx{parent_location_id;sub_location_id;constructor(e,t){super(),this.parent_location_id=e,this.sub_location_id=t}get REGEX(){return/addSubLocation\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1];return new Hh(t,a)}isValid(){return''!==this.parent_location_id.trim()&&''!==this.sub_location_id.trim()}execute(e,t){const a=e.locations.get(this.parent_location_id);if(!a)return e;const n=e.locations.get(this.sub_location_id);return n?(null!==n.parent_location_id||a.sub_location_ids.includes(this.sub_location_id)||(a.sub_location_ids.push(this.sub_location_id),n.parent_location_id=this.parent_location_id),e):e}};Ex=Hh=tx([nx.registry.register(),ax('design:paramtypes',[String,String])],Ex);let yx=Gh=class extends nx{id;description;constructor(e,t){super(),this.id=e,this.description=t}get REGEX(){return/setLocationDescription\(\s*"([^"]+?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=e[0],a=e[1];return new Gh(t,a)}isValid(){return''!==this.id.trim()}execute(e,t){const a=e.locations.get(this.id);return a?(a.description=this.description,e):e}};yx=Gh=tx([nx.registry.register(),ax('design:paramtypes',[String,String])],yx);let kx=qh=class extends nx{deadline_year;deadline_month;deadline_date;deadline_hours;deadline_minutes;character_ids;location_id;description;constructor(e,t,a,n,r,o,l,i){super(),this.deadline_year=e,this.deadline_month=t,this.deadline_date=a,this.deadline_hours=n,this.deadline_minutes=r,this.character_ids=o,this.location_id=l,this.description=i}get REGEX(){return/createPromise\(\s*([^,()]+)\s*,\s*([^,()]+)\s*,\s*([^,()]+)\s*,\s*([^,()]+)\s*,\s*([^,()]+)\s*,\s*"([^"]+?)"\s*,\s*"([^"]*?)"\s*,\s*"([^"]+?)"\s*\)/g}create(e){const t=Number(e[0]),a=Number(e[1]),n=Number(e[2]),r=Number(e[3]),o=Number(e[4]),l=e[5],i=e[6],s=e[7],c=l.split(',').map(e=>e.trim());return new qh(t,a,n,r,o,c,i,s)}isValid(){return!isNaN(this.deadline_year)&&(!isNaN(this.deadline_month)&&(!isNaN(this.deadline_date)&&(!isNaN(this.deadline_hours)&&!isNaN(this.deadline_minutes))))}execute(e,t){if(''!==this.location_id&&!e.locations.has(this.location_id))return e;for(const t of this.character_ids)if(!e.hasCharacter(t))return e;const a=new Tr(new Date(this.deadline_year,this.deadline_month-1,this.deadline_date,this.deadline_hours,this.deadline_minutes)),n=''===this.location_id?null:this.location_id;return e.addPromise(a,this.character_ids,n,this.description),e}};kx=qh=tx([nx.registry.register(),ax('design:paramtypes',[Number,Number,Number,Number,Number,Array,String,String])],kx);let Nx=Xh=class extends nx{id;constructor(e){super(),this.id=e}get REGEX(){return/removePromise\(\s*"([^,()]+)"\s*\)/g}create(e){const t=e[0];return new Xh(t)}isValid(){return''!==this.id.trim()}execute(e,t){return e.promises.has(this.id)?(e.promises.delete(this.id),e):e}};Nx=Xh=tx([nx.registry.register(),ax('design:paramtypes',[String])],Nx);let Vx=Wh=class extends nx{event;constructor(e){super(),this.event=e}get REGEX(){return/startEvent\(\s*"([^"]+)"\s*\)/g}create(e){const t=e[0];return new Wh(t)}isValid(){return''!==this.event.trim()}execute(e,t){return e.current_event=this.event,e}};Vx=Wh=tx([nx.registry.register(),ax('design:paramtypes',[String])],Vx);let wx=Jh=class extends nx{summary;weighting;constructor(e,t){super(),this.summary=e,this.weighting=t}get REGEX(){return/finishEvent\(\s*"([^"]+)"\s*,\s*([^,()]+)\s*\)/g}create(e){const t=e[0],a=Number(e[1]);return new Jh(t,a)}isValid(){return''!==this.summary.trim()&&!isNaN(this.weighting)}execute(e,t){return e.addSummary(this.summary,this.weighting,t),e.current_event=Yr.CURRENT_EVENT_NULL_VALUE,e}};wx=Jh=tx([nx.registry.register(),ax('design:paramtypes',[String,Number])],wx);let Sx=Zh=class extends nx{id;constructor(e){super(),this.id=e}get REGEX(){return/activateCharacter\(\s*"([^"]+)"\s*\)/g}create(e){const t=e[0];return new Zh(t)}isValid(){return''!==this.id.trim()}execute(e,t){if(!e.deactive_characters.has(this.id))return e;const a=e.deactive_characters.get(this.id);return e.active_characters.set(this.id,a),e.deactive_characters.delete(this.id),e}};Sx=Zh=tx([nx.registry.register(),ax('design:paramtypes',[String])],Sx);let Cx=Qh=class extends nx{id;constructor(e){super(),this.id=e}get REGEX(){return/deactivateCharacter\(\s*"([^"]+)"\s*\)/g}create(e){const t=e[0];return new Qh(t)}isValid(){return''!==this.id.trim()}execute(e,t){if(!e.active_characters.has(this.id))return e;const a=e.active_characters.get(this.id);return e.deactive_characters.set(this.id,a),e.active_characters.delete(this.id),e}};Cx=Qh=tx([nx.registry.register(),ax('design:paramtypes',[String])],Cx);class Tx{commands=[];constructor(e){this.commands=e??[]}pushCommand(e){this.commands.push(e)}static fromString(e){if(!e.includes('<VariableUpdate>'))return new Tx;const t=e.split('<VariableUpdate>'),a=t[t.length-1].split('</VariableUpdate>')[0];let n=[];for(const e of nx.registry.getAll().values())n=n.concat(e.parseString(a));n.sort((e,t)=>e.index-t.index);const r=n.map(e=>e.command);return console.log('[Commands] commands:',r),new Tx(r)}execute(e,t){for(const a of this.commands)a.execute(e,t);return e}*[Symbol.iterator](){for(const e of this.commands)yield e}}eventOn('MESSAGE_SENT',e=>{console.log('[event_listener] MESSAGE_SENT start');const t=Yr.loadFromVariable(e-1),a=getChatMessages(e)[0].message;Tx.fromString(a).execute(t,e),t.saveAsVariable(e),console.log('[event_listener] MESSAGE_SENT end')}),eventOn('MESSAGE_RECEIVED',e=>{console.log('[event_listener] MESSAGE_RECEIVED start');const t=Yr.loadFromVariable(e-1),a=getChatMessages(e)[0].message;Tx.fromString(a).execute(t,e),t.saveAsVariable(e),console.log('[event_listener] MESSAGE_RECEIVED end'),eventEmit('MESSAGE_RECEIVED_PROCESSED',e)}),$(()=>{(0,t.createApp)(Ch).mount('#app')})})();